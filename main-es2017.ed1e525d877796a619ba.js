var _q=Object.defineProperty,yq=Object.defineProperties,vq=Object.getOwnPropertyDescriptors,X2=Object.getOwnPropertySymbols,wq=Object.prototype.hasOwnProperty,Eq=Object.prototype.propertyIsEnumerable,eU=(t,e,n)=>e in t?_q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,tU=(t,e)=>{for(var n in e||(e={}))wq.call(e,n)&&eU(t,n,e[n]);if(X2)for(var n of X2(e))Eq.call(e,n)&&eU(t,n,e[n]);return t},nU=(t,e)=>yq(t,vq(e));(self.webpackChunkthen_and_now=self.webpackChunkthen_and_now||[]).push([[179],{8255:function(t){function e(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=function(){return[]},e.resolve=e,e.id=8255,t.exports=e},7716:function(t,e,n){"use strict";n.d(e,{deG:function(){return tn},tb:function(){return Ll},AFp:function(){return Pl},ip1:function(){return kl},CZH:function(){return Al},hGG:function(){return ku},z2F:function(){return _u},sBO:function(){return Oa},Sil:function(){return $l},_Vd:function(){return ia},EJc:function(){return Vl},SBq:function(){return aa},qLn:function(){return Hi},vpe:function(){return hl},gxx:function(){return is},tBr:function(){return Sn},XFs:function(){return P},OlP:function(){return Xe},zs3:function(){return _s},ZZ4:function(){return Ea},aQg:function(){return ka},soG:function(){return Fl},YKP:function(){return Ba},v3s:function(){return wu},h0i:function(){return za},PXZ:function(){return pu},R0b:function(){return Kl},FiY:function(){return Cn},Lbi:function(){return Rl},g9A:function(){return Ol},Qsj:function(){return ca},FYo:function(){return ua},JOm:function(){return xn},Tiy:function(){return da},q3G:function(){return qi},tp0:function(){return En},EAV:function(){return Iu},Rgc:function(){return Va},dDg:function(){return nu},DyG:function(){return en},q4F:function(){return fa},GfV:function(){return pa},s_b:function(){return Ha},ifc:function(){return M},eFA:function(){return fu},G48:function(){return cu},Gpc:function(){return p},X6Q:function(){return uu},_c5:function(){return Eu},VLi:function(){return su},c2e:function(){return Ml},zSh:function(){return ss},wAp:function(){return zo},vHH:function(){return g},EiD:function(){return Ui},mCW:function(){return Ii},qzn:function(){return di},JVY:function(){return fi},pB0:function(){return _i},eBb:function(){return gi},L6k:function(){return mi},LAX:function(){return yi},cg1:function(){return Uo},Tjo:function(){return Cu},kL8:function(){return jo},yhl:function(){return pi},dqk:function(){return j},sIi:function(){return ks},CqO:function(){return Gs},QGY:function(){return $s},F4k:function(){return Ws},RDi:function(){return St},AaK:function(){return c},z3N:function(){return hi},qOj:function(){return ws},TTD:function(){return yt},_Bn:function(){return Xo},xp6:function(){return ar},uIk:function(){return Os},Tol:function(){return go},Gre:function(){return Oo},ekj:function(){return fo},Suo:function(){return Sl},Xpm:function(){return Y},lG2:function(){return rt},Yz7:function(){return b},cJS:function(){return T},oAB:function(){return et},Yjl:function(){return st},Y36:function(){return Us},_UZ:function(){return Zs},qZA:function(){return Bs},TgZ:function(){return zs},EpF:function(){return Hs},n5z:function(){return Ge},Ikx:function(){return Lo},LFG:function(){return vn},$8M:function(){return Qe},NdJ:function(){return Ks},CRH:function(){return Cl},oxw:function(){return Js},ALo:function(){return ll},lcZ:function(){return ul},Q6J:function(){return js},MGl:function(){return Xs},hYB:function(){return to},cQ8:function(){return eo},DdM:function(){return ol},iGM:function(){return Il},MAs:function(){return Vs},Jf7:function(){return Wi},CHM:function(){return zt},LSH:function(){return zi},kYT:function(){return nt},Jzz:function(){return Ro},YNc:function(){return Fs},W1O:function(){return xl},_uU:function(){return ko},Oqu:function(){return Ao},hij:function(){return Po},AsE:function(){return No},lnq:function(){return Do}});var i=n(9765),r=n(5319),s=n(7574),o=n(6682),a=n(8819);function l(t){for(let e in t)if(t[e]===l)return e;throw Error("Could not find renamed property on target object.")}function u(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function c(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(c).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function h(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const d=l({__forward_ref__:l});function p(t){return t.__forward_ref__=p,t.toString=function(){return c(this())},t}function f(t){return m(t)?t():t}function m(t){return"function"==typeof t&&t.hasOwnProperty(d)&&t.__forward_ref__===p}class g extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function y(t){return"string"==typeof t?t:null==t?"":String(t)}function _(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():y(t)}function v(t,e){const n=e?` in ${e}`:"";throw new g("201",`No provider for ${_(t)} found${n}`)}function w(t,e){null==t&&function(t,e,n,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${n} ${i} ${e} <=Actual]`))}(e,t,null,"!=")}function b(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function T(t){return{providers:t.providers||[],imports:t.imports||[]}}function I(t){return S(t,E)||S(t,k)}function S(t,e){return t.hasOwnProperty(e)?t[e]:null}function C(t){return t&&(t.hasOwnProperty(x)||t.hasOwnProperty(A))?t[x]:null}const E=l({"\u0275prov":l}),x=l({"\u0275inj":l}),k=l({ngInjectableDef:l}),A=l({ngInjectorDef:l});var P=(()=>((P=P||{})[P.Default=0]="Default",P[P.Host=1]="Host",P[P.Self=2]="Self",P[P.SkipSelf=4]="SkipSelf",P[P.Optional=8]="Optional",P))();let N;function D(t){const e=N;return N=t,e}function O(t,e,n){const i=I(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&P.Optional?null:void 0!==e?e:void v(c(t),"Injector")}function R(t){return{toString:t}.toString()}var L=(()=>((L=L||{})[L.OnPush=0]="OnPush",L[L.Default=1]="Default",L))(),M=(()=>((M=M||{})[M.Emulated=0]="Emulated",M[M.None=2]="None",M[M.ShadowDom=3]="ShadowDom",M))();const F="undefined"!=typeof globalThis&&globalThis,V="undefined"!=typeof window&&window,U="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,j=F||"undefined"!=typeof global&&global||V||U,q={},z=[],B=l({"\u0275cmp":l}),Z=l({"\u0275dir":l}),H=l({"\u0275pipe":l}),$=l({"\u0275mod":l}),W=l({"\u0275loc":l}),G=l({"\u0275fac":l}),K=l({__NG_ELEMENT_ID__:l});let Q=0;function Y(t){return R(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===L.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||z,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||M.Emulated,id:"c",styles:t.styles||z,_:null,setInput:null,schemas:t.schemas||null,tView:null},i=t.directives,r=t.features,s=t.pipes;return n.id+=Q++,n.inputs=it(t.inputs,e),n.outputs=it(t.outputs),r&&r.forEach(t=>t(n)),n.directiveDefs=i?()=>("function"==typeof i?i():i).map(J):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map(X):null,n})}function J(t){return ot(t)||function(t){return t[Z]||null}(t)}function X(t){return function(t){return t[H]||null}(t)}const tt={};function et(t){return R(()=>{const e={type:t.type,bootstrap:t.bootstrap||z,declarations:t.declarations||z,imports:t.imports||z,exports:t.exports||z,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(tt[t.id]=t.type),e})}function nt(t,e){return R(()=>{const n=at(t,!0);n.declarations=e.declarations||z,n.imports=e.imports||z,n.exports=e.exports||z})}function it(t,e){if(null==t)return q;const n={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,e&&(e[r]=s)}return n}const rt=Y;function st(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function ot(t){return t[B]||null}function at(t,e){const n=t[$]||null;if(!n&&!0===e)throw new Error(`Type ${c(t)} does not have '\u0275mod' property.`);return n}function lt(t){return Array.isArray(t)&&"object"==typeof t[1]}function ut(t){return Array.isArray(t)&&!0===t[1]}function ct(t){return 0!=(8&t.flags)}function ht(t){return 2==(2&t.flags)}function dt(t){return 1==(1&t.flags)}function pt(t){return null!==t.template}function ft(t){return 0!=(512&t[2])}function mt(t,e){return t.hasOwnProperty(G)?t[G]:null}class gt{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function yt(){return _t}function _t(t){return t.type.prototype.ngOnChanges&&(t.setInput=wt),vt}function vt(){const t=Tt(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===q)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function wt(t,e,n,i){const r=Tt(t)||function(t,e){return t[bt]=e}(t,{previous:q,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[n],l=o[a];s[a]=new gt(l&&l.currentValue,e,o===q),t[i]=e}yt.ngInherit=!0;const bt="__ngSimpleChanges__";function Tt(t){return t[bt]||null}let It;function St(t){It=t}function Ct(t){return!!t.listen}const Et={createRenderer:(t,e)=>void 0!==It?It:"undefined"!=typeof document?document:void 0};function xt(t){for(;Array.isArray(t);)t=t[0];return t}function kt(t,e){return xt(e[t])}function At(t,e){return xt(e[t.index])}function Pt(t,e){return t.data[e]}function Nt(t,e){return t[e]}function Dt(t,e){const n=e[t];return lt(n)?n:n[0]}function Ot(t){return 4==(4&t[2])}function Rt(t){return 128==(128&t[2])}function Lt(t,e){return null==e?null:t[e]}function Mt(t){t[18]=0}function Ft(t,e){t[5]+=e;let n=t,i=t[3];for(;null!==i&&(1===e&&1===n[5]||-1===e&&0===n[5]);)i[5]+=e,n=i,i=i[3]}const Vt={lFrame:ae(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ut(){return Vt.bindingsEnabled}function jt(){return Vt.lFrame.lView}function qt(){return Vt.lFrame.tView}function zt(t){return Vt.lFrame.contextLView=t,t[8]}function Bt(){let t=Zt();for(;null!==t&&64===t.type;)t=t.parent;return t}function Zt(){return Vt.lFrame.currentTNode}function Ht(t,e){const n=Vt.lFrame;n.currentTNode=t,n.isParent=e}function $t(){return Vt.lFrame.isParent}function Wt(){return Vt.isInCheckNoChangesMode}function Gt(t){Vt.isInCheckNoChangesMode=t}function Kt(){const t=Vt.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function Qt(){return Vt.lFrame.bindingIndex}function Yt(){return Vt.lFrame.bindingIndex++}function Jt(t){const e=Vt.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function Xt(t,e){const n=Vt.lFrame;n.bindingIndex=n.bindingRootIndex=t,te(e)}function te(t){Vt.lFrame.currentDirectiveIndex=t}function ee(){return Vt.lFrame.currentQueryIndex}function ne(t){Vt.lFrame.currentQueryIndex=t}function ie(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function re(t,e,n){if(n&P.SkipSelf){let i=e,r=t;for(;!(i=i.parent,null!==i||n&P.Host||(i=ie(r),null===i||(r=r[15],10&i.type))););if(null===i)return!1;e=i,t=r}const i=Vt.lFrame=oe();return i.currentTNode=e,i.lView=t,!0}function se(t){const e=oe(),n=t[1];Vt.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function oe(){const t=Vt.lFrame,e=null===t?null:t.child;return null===e?ae(t):e}function ae(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function le(){const t=Vt.lFrame;return Vt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ue=le;function ce(){const t=le();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function he(){return Vt.lFrame.selectedIndex}function de(t){Vt.lFrame.selectedIndex=t}function pe(){const t=Vt.lFrame;return Pt(t.tView,t.selectedIndex)}function fe(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:r,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=e;i&&(t.contentHooks||(t.contentHooks=[])).push(-n,i),r&&((t.contentHooks||(t.contentHooks=[])).push(n,r),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,r)),s&&(t.viewHooks||(t.viewHooks=[])).push(-n,s),o&&((t.viewHooks||(t.viewHooks=[])).push(n,o),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,o)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(n,a)}}function me(t,e,n){_e(t,e,3,n)}function ge(t,e,n,i){(3&t[2])===n&&_e(t,e,n,i)}function ye(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function _e(t,e,n,i){const r=null!=i?i:-1,s=e.length-1;let o=0;for(let a=void 0!==i?65535&t[18]:0;a<s;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=i&&o>=i)break}else e[a]<0&&(t[18]+=65536),(o<r||-1==r)&&(ve(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function ve(t,e,n,i){const r=n[i]<0,s=n[i+1],o=t[r?-n[i]:n[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}class we{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function be(t,e,n){const i=Ct(t);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const o=n[r++],a=n[r++],l=n[r++];i?t.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=n[++r];Ie(o)?i&&t.setProperty(e,o,a):i?t.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Te(t){return 3===t||4===t||6===t}function Ie(t){return 64===t.charCodeAt(0)}function Se(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?n=r:0===n||Ce(t,n,r,null,-1===n||2===n?e[++i]:null)}}return t}function Ce(t,e,n,i,r){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const n=t[s++];if("number"==typeof n){if(n===e){o=-1;break}if(n>e){o=s-1;break}}}for(;s<t.length;){const e=t[s];if("number"==typeof e)break;if(e===n){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}function Ee(t){return-1!==t}function xe(t){return 32767&t}function ke(t,e){let n=function(t){return t>>16}(t),i=e;for(;n>0;)i=i[15],n--;return i}let Ae=!0;function Pe(t){const e=Ae;return Ae=t,e}let Ne=0;function De(t,e){const n=Re(t,e);if(-1!==n)return n;const i=e[1];i.firstCreatePass&&(t.injectorIndex=e.length,Oe(i.data,t),Oe(e,null),Oe(i.blueprint,null));const r=Le(t,e),s=t.injectorIndex;if(Ee(r)){const t=xe(r),n=ke(r,e),i=n[1].data;for(let r=0;r<8;r++)e[s+r]=n[t+r]|i[t+r]}return e[s+8]=r,s}function Oe(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Re(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Le(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;null!==r;){const t=r[1],e=t.type;if(i=2===e?t.declTNode:1===e?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function Me(t,e,n){!function(t,e,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(K)&&(i=n[K]),null==i&&(i=n[K]=Ne++);const r=255&i;e.data[t+(r>>5)]|=1<<r}(t,e,n)}function Fe(t,e,n){if(n&P.Optional)return t;v(e,"NodeInjector")}function Ve(t,e,n,i){if(n&P.Optional&&void 0===i&&(i=null),0==(n&(P.Self|P.Host))){const r=t[9],s=D(void 0);try{return r?r.get(e,i,n&P.Optional):O(e,i,n&P.Optional)}finally{D(s)}}return Fe(i,e,n)}function Ue(t,e,n,i=P.Default,r){if(null!==t){const s=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(K)?t[K]:void 0;return"number"==typeof e?e>=0?255&e:qe:e}(n);if("function"==typeof s){if(!re(e,t,i))return i&P.Host?Fe(r,n,i):Ve(e,n,i,r);try{const t=s(i);if(null!=t||i&P.Optional)return t;v(n)}finally{ue()}}else if("number"==typeof s){let r=null,o=Re(t,e),a=-1,l=i&P.Host?e[16][6]:null;for((-1===o||i&P.SkipSelf)&&(a=-1===o?Le(t,e):e[o+8],-1!==a&&$e(i,!1)?(r=e[1],o=xe(a),e=ke(a,e)):o=-1);-1!==o;){const t=e[1];if(He(s,o,t.data)){const t=ze(o,e,n,r,i,l);if(t!==je)return t}a=e[o+8],-1!==a&&$e(i,e[1].data[o+8]===l)&&He(s,o,e)?(r=t,o=xe(a),e=ke(a,e)):o=-1}}}return Ve(e,n,i,r)}const je={};function qe(){return new We(Bt(),jt())}function ze(t,e,n,i,r,s){const o=e[1],a=o.data[t+8],l=Be(a,o,n,null==i?ht(a)&&Ae:i!=o&&0!=(3&a.type),r&P.Host&&s===a);return null!==l?Ze(e,o,l,a):je}function Be(t,e,n,i,r){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,u=s>>20,c=r?a+u:t.directiveEnd;for(let h=i?a:a+u;h<c;h++){const t=o[h];if(h<l&&n===t||h>=l&&t.type===n)return h}if(r){const t=o[l];if(t&&pt(t)&&t.type===n)return l}return null}function Ze(t,e,n,i){let r=t[n];const s=e.data;if(function(t){return t instanceof we}(r)){const o=r;o.resolving&&function(t,e){throw new g("200",`Circular dependency in DI detected for ${t}`)}(_(s[n]));const a=Pe(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?D(o.injectImpl):null;re(t,i,P.Default);try{r=t[n]=o.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&function(t,e,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const i=_t(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,i)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==l&&D(l),Pe(a),o.resolving=!1,ue()}}return r}function He(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function $e(t,e){return!(t&P.Self||t&P.Host&&e)}class We{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,n){return Ue(this._tNode,this._lView,t,n,e)}}function Ge(t){return R(()=>{const e=t.prototype.constructor,n=e[G]||Ke(e),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const t=r[G]||Ke(r);if(t&&t!==n)return t;r=Object.getPrototypeOf(r)}return t=>new t})}function Ke(t){return m(t)?()=>{const e=Ke(f(t));return e&&e()}:mt(t)}function Qe(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let i=0;for(;i<t;){const r=n[i];if(Te(r))break;if(0===r)i+=2;else if("number"==typeof r)for(i++;i<t&&"string"==typeof n[i];)i++;else{if(r===e)return n[i+1];i+=2}}}return null}(Bt(),t)}const Ye="__parameters__";function Je(t,e,n){return R(()=>{const i=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function r(...t){if(this instanceof r)return i.apply(this,t),this;const e=new r(...t);return n.annotation=e,n;function n(t,n,i){const r=t.hasOwnProperty(Ye)?t[Ye]:Object.defineProperty(t,Ye,{value:[]})[Ye];for(;r.length<=i;)r.push(null);return(r[i]=r[i]||[]).push(e),t}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class Xe{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=b({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const tn=new Xe("AnalyzeForEntryComponents"),en=Function;function nn(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)?(e===t&&(e=t.slice(0,n)),nn(i,e)):e!==t&&e.push(i)}return e}function rn(t,e){t.forEach(t=>Array.isArray(t)?rn(t,e):e(t))}function sn(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function on(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function an(t,e,n){let i=un(t,e);return i>=0?t[1|i]=n:(i=~i,function(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(1===r)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=n,t[e+1]=i}}(t,i,e,n)),i}function ln(t,e){const n=un(t,e);if(n>=0)return t[1|n]}function un(t,e){return function(t,e,n){let i=0,r=t.length>>n;for(;r!==i;){const s=i+(r-i>>1),o=t[s<<n];if(e===o)return s<<n;o>e?r=s:i=s+1}return~(r<<n)}(t,e,1)}const cn={},hn="__NG_DI_FLAG__",dn="ngTempTokenPath",pn=/\n/gm,fn="__source",mn=l({provide:String,useValue:l});let gn;function yn(t){const e=gn;return gn=t,e}function _n(t,e=P.Default){if(void 0===gn)throw new Error("inject() must be called from an injection context");return null===gn?O(t,void 0,e):gn.get(t,e&P.Optional?null:void 0,e)}function vn(t,e=P.Default){return(N||_n)(f(t),e)}function wn(t){const e=[];for(let n=0;n<t.length;n++){const i=f(t[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let t,n=P.Default;for(let e=0;e<i.length;e++){const r=i[e],s=Tn(r);"number"==typeof s?-1===s?t=r.token:n|=s:t=r}e.push(vn(t,n))}else e.push(vn(i))}return e}function bn(t,e){return t[hn]=e,t.prototype[hn]=e,t}function Tn(t){return t[hn]}function In(t,e,n,i){const r=t[dn];throw e[fn]&&r.unshift(e[fn]),t.message=function(t,e,n,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=c(e);if(Array.isArray(e))r=e.map(c).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let i=e[n];t.push(n+":"+("string"==typeof i?JSON.stringify(i):c(i)))}r=`{${t.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(pn,"\n  ")}`}("\n"+t.message,r,n,i),t.ngTokenPath=r,t[dn]=null,t}const Sn=bn(Je("Inject",t=>({token:t})),-1),Cn=bn(Je("Optional"),8),En=bn(Je("SkipSelf"),4);var xn=(()=>((xn=xn||{})[xn.Important=1]="Important",xn[xn.DashCase=2]="DashCase",xn))();const kn="__ngContext__";function An(t,e){t[kn]=e}function Pn(t){const e=function(t){return t[kn]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Nn(t,e){return undefined(t,e)}function Dn(t){const e=t[3];return ut(e)?e[3]:e}function On(t){return Ln(t[13])}function Rn(t){return Ln(t[4])}function Ln(t){for(;null!==t&&!ut(t);)t=t[4];return t}function Mn(t,e,n,i,r){if(null!=i){let s,o=!1;ut(i)?s=i:lt(i)&&(o=!0,i=i[0]);const a=xt(i);0===t&&null!==n?null==r?Zn(e,n,a):Bn(e,n,a,r||null,!0):1===t&&null!==n?Bn(e,n,a,r||null,!0):2===t?function(t,e,n){const i=$n(t,e);i&&function(t,e,n,i){Ct(t)?t.removeChild(e,n,i):e.removeChild(n)}(t,i,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function(t,e,n,i,r){const s=n[7];s!==xt(n)&&Mn(e,t,i,s,r);for(let o=10;o<n.length;o++){const r=n[o];ti(r[1],r,t,e,i,s)}}(e,t,s,n,r)}}function Fn(t,e,n){return Ct(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Vn(t,e){const n=t[9],i=n.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Ft(r,-1)),n.splice(i,1)}function Un(t,e){if(t.length<=10)return;const n=10+e,i=t[n];if(i){const r=i[17];null!==r&&r!==t&&Vn(r,i),e>0&&(t[n-1][4]=i[4]);const s=on(t,10+e);!function(t,e){ti(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function jn(t,e){if(!(256&e[2])){const n=e[11];Ct(n)&&n.destroyNode&&ti(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return qn(t[1],t);for(;e;){let n=null;if(lt(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)lt(e)&&qn(e[1],e),e=e[3];null===e&&(e=t),lt(e)&&qn(e[1],e),n=e&&e[4]}e=n}}(e)}}function qn(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let i=0;i<n.length;i+=2){const t=e[n[i]];if(!(t instanceof we)){const e=n[i+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2){const i=t[e[n]],r=e[n+1];try{r.call(i)}finally{}}else try{e.call(t)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,i=e[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const t=n[s+1],o="function"==typeof t?t(e):xt(e[t]),a=i[r=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],a,l):l>=0?i[r=l]():i[r=-l].unsubscribe(),s+=2}else{const t=i[r=n[s+1]];n[s].call(t)}if(null!==i){for(let t=r+1;t<i.length;t++)i[t]();e[7]=null}}(t,e),1===e[1].type&&Ct(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&ut(e[3])){n!==e[3]&&Vn(n,e);const i=e[19];null!==i&&i.detachView(t)}}}function zn(t,e,n){return function(t,e,n){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return n[0];if(2&i.flags){const e=t.data[i.directiveStart].encapsulation;if(e===M.None||e===M.Emulated)return null}return At(i,n)}(t,e.parent,n)}function Bn(t,e,n,i,r){Ct(t)?t.insertBefore(e,n,i,r):e.insertBefore(n,i,r)}function Zn(t,e,n){Ct(t)?t.appendChild(e,n):e.appendChild(n)}function Hn(t,e,n,i,r){null!==i?Bn(t,e,n,i,r):Zn(t,e,n)}function $n(t,e){return Ct(t)?t.parentNode(e):e.parentNode}let Wn,Gn=function(t,e,n){return 40&t.type?At(t,n):null};function Kn(t,e,n,i){const r=zn(t,i,e),s=e[11],o=function(t,e,n){return Gn(t,e,n)}(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(n))for(let a=0;a<n.length;a++)Hn(s,r,n[a],o,!1);else Hn(s,r,n,o,!1)}function Qn(t,e){if(null!==e){const n=e.type;if(3&n)return At(e,t);if(4&n)return Jn(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return Qn(t,n);{const n=t[e.index];return ut(n)?Jn(-1,n):xt(n)}}if(32&n)return Nn(e,t)()||xt(t[e.index]);{const n=Yn(t,e);return null!==n?Array.isArray(n)?n[0]:Qn(Dn(t[16]),n):Qn(t,e.next)}}return null}function Yn(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Jn(t,e){const n=10+t+1;if(n<e.length){const t=e[n],i=t[1].firstChild;if(null!==i)return Qn(t,i)}return e[7]}function Xn(t,e,n,i,r,s,o){for(;null!=n;){const a=i[n.index],l=n.type;if(o&&0===e&&(a&&An(xt(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)Xn(t,e,n.child,i,r,s,!1),Mn(e,t,r,a,s);else if(32&l){const o=Nn(n,i);let l;for(;l=o();)Mn(e,t,r,l,s);Mn(e,t,r,a,s)}else 16&l?ei(t,e,i,n,r,s):Mn(e,t,r,a,s);n=o?n.projectionNext:n.next}}function ti(t,e,n,i,r,s){Xn(n,i,t.firstChild,e,r,s,!1)}function ei(t,e,n,i,r,s){const o=n[16],a=o[6].projection[i.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Mn(e,t,r,a[l],s);else Xn(t,e,a,o[3],r,s,!0)}function ni(t,e,n){Ct(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function ii(t,e,n){Ct(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function ri(t){var e;return(null===(e=function(){if(void 0===Wn&&(Wn=null,j.trustedTypes))try{Wn=j.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return Wn}())||void 0===e?void 0:e.createHTML(t))||t}class si{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class oi extends si{getTypeName(){return"HTML"}}class ai extends si{getTypeName(){return"Style"}}class li extends si{getTypeName(){return"Script"}}class ui extends si{getTypeName(){return"URL"}}class ci extends si{getTypeName(){return"ResourceURL"}}function hi(t){return t instanceof si?t.changingThisBreaksApplicationSecurity:t}function di(t,e){const n=pi(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}function pi(t){return t instanceof si&&t.getTypeName()||null}function fi(t){return new oi(t)}function mi(t){return new ai(t)}function gi(t){return new li(t)}function yi(t){return new ui(t)}function _i(t){return new ci(t)}class vi{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(ri(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class wi{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const e=this.inertDocument.createElement("body");t.appendChild(e)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=ri(t),e;const n=this.inertDocument.createElement("body");return n.innerHTML=ri(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let i=e.length-1;0<i;i--){const n=e.item(i).name;("xmlns:ns1"===n||0===n.indexOf("ns1:"))&&t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const bi=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Ti=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ii(t){return(t=String(t)).match(bi)||t.match(Ti)?t:"unsafe:"+t}function Si(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function Ci(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const Ei=Si("area,br,col,hr,img,wbr"),xi=Si("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ki=Si("rp,rt"),Ai=Ci(Ei,Ci(xi,Si("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Ci(ki,Si("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Ci(ki,xi)),Pi=Si("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ni=Si("srcset"),Di=Ci(Pi,Ni,Si("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Si("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Oi=Si("script,style,template");class Ri{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Ai.hasOwnProperty(e))return this.sanitizedSomething=!0,!Oi.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let r=0;r<n.length;r++){const t=n.item(r),e=t.name,s=e.toLowerCase();if(!Di.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let o=t.value;Pi[s]&&(o=Ii(o)),Ni[s]&&(i=o,o=(i=String(i)).split(",").map(t=>Ii(t.trim())).join(", ")),this.buf.push(" ",e,'="',Fi(o),'"')}var i;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Ai.hasOwnProperty(e)&&!Ei.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Fi(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const Li=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Mi=/([^\#-~ |!])/g;function Fi(t){return t.replace(/&/g,"&amp;").replace(Li,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Mi,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Vi;function Ui(t,e){let n=null;try{Vi=Vi||function(t){const e=new wi(t);return function(){try{return!!(new window.DOMParser).parseFromString(ri(""),"text/html")}catch(t){return!1}}()?new vi(e):e}(t);let i=e?String(e):"";n=Vi.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=n.innerHTML,n=Vi.getInertBodyElement(i)}while(i!==s);return ri((new Ri).sanitizeChildren(ji(n)||n))}finally{if(n){const t=ji(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}function ji(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var qi=(()=>((qi=qi||{})[qi.NONE=0]="NONE",qi[qi.HTML=1]="HTML",qi[qi.STYLE=2]="STYLE",qi[qi.SCRIPT=3]="SCRIPT",qi[qi.URL=4]="URL",qi[qi.RESOURCE_URL=5]="RESOURCE_URL",qi))();function zi(t){const e=function(){const t=jt();return t&&t[12]}();return e?e.sanitize(qi.URL,t)||"":di(t,"URL")?hi(t):Ii(y(t))}function Bi(t){return t.ngOriginalError}function Zi(t,...e){t.error(...e)}class Hi{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),i=(r=t)&&r.ngErrorLogger||Zi;var r;i(this._console,"ERROR",t),e&&i(this._console,"ORIGINAL ERROR",e),n&&i(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?t.ngDebugContext||this._findContext(Bi(t)):null}_findOriginalError(t){let e=t&&Bi(t);for(;e&&Bi(e);)e=Bi(e);return e||null}}const $i=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(j))();function Wi(t){return t.ownerDocument.defaultView}function Gi(t){return t instanceof Function?t():t}function Ki(t,e,n){let i=t.length;for(;;){const r=t.indexOf(e,n);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const n=e.length;if(r+n===i||t.charCodeAt(r+n)<=32)return r}n=r+1}}const Qi="ng-template";function Yi(t,e,n){let i=0;for(;i<t.length;){let r=t[i++];if(n&&"class"===r){if(r=t[i],-1!==Ki(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Ji(t){return 4===t.type&&t.value!==Qi}function Xi(t,e,n){return e===(4!==t.type||n?t.value:Qi)}function tr(t,e,n){let i=4;const r=t.attrs||[],s=function(t){for(let e=0;e<t.length;e++)if(Te(t[e]))return e;return t.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Xi(t,l,n)||""===l&&1===e.length){if(er(i))return!1;o=!0}}else{const u=8&i?l:e[++a];if(8&i&&null!==t.attrs){if(!Yi(t.attrs,u,n)){if(er(i))return!1;o=!0}continue}const c=nr(8&i?"class":l,r,Ji(t),n);if(-1===c){if(er(i))return!1;o=!0;continue}if(""!==u){let t;t=c>s?"":r[c+1].toLowerCase();const e=8&i?t:null;if(e&&-1!==Ki(e,u,0)||2&i&&u!==t){if(er(i))return!1;o=!0}}}}else{if(!o&&!er(i)&&!er(l))return!1;if(o&&er(l))continue;o=!1,i=l|1&i}}return er(i)||o}function er(t){return 0==(1&t)}function nr(t,e,n,i){if(null===e)return-1;let r=0;if(i||!n){let n=!1;for(;r<e.length;){const i=e[r];if(i===t)return r;if(3===i||6===i)n=!0;else{if(1===i||2===i){let t=e[++r];for(;"string"==typeof t;)t=e[++r];continue}if(4===i)break;if(0===i){r+=4;continue}}r+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const i=t[n];if("number"==typeof i)return-1;if(i===e)return n;n++}return-1}(e,t)}function ir(t,e,n=!1){for(let i=0;i<e.length;i++)if(tr(t,e[i],n))return!0;return!1}function rr(t,e){return t?":not("+e.trim()+")":e}function sr(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&i){const e=t[++n];r+="["+o+(e.length>0?'="'+e+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!er(o)&&(e+=rr(s,r),r=""),i=o,s=s||!er(i);n++}return""!==r&&(e+=rr(s,r)),e}const or={};function ar(t){lr(qt(),jt(),he()+t,Wt())}function lr(t,e,n,i){if(!i)if(3==(3&e[2])){const i=t.preOrderCheckHooks;null!==i&&me(e,i,n)}else{const i=t.preOrderHooks;null!==i&&ge(e,i,0,n)}de(n)}function ur(t,e){return t<<17|e<<2}function cr(t){return t>>17&32767}function hr(t){return 2|t}function dr(t){return(131068&t)>>2}function pr(t,e){return-131069&t|e<<2}function fr(t){return 1|t}function mr(t,e){const n=t.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const n=t.data[s];ne(r),n.contentQueries(2,e[s],s)}}}function gr(t,e,n,i,r,s,o,a,l,u){const c=e.blueprint.slice();return c[0]=r,c[2]=140|i,Mt(c),c[3]=c[15]=t,c[8]=n,c[10]=o||t&&t[10],c[11]=a||t&&t[11],c[12]=l||t&&t[12]||null,c[9]=u||t&&t[9]||null,c[6]=s,c[16]=2==e.type?t[16]:c,c}function yr(t,e,n,i,r){let s=t.data[e];if(null===s)s=function(t,e,n,i,r){const s=Zt(),o=$t(),a=t.data[e]=function(t,e,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,i,r);return null===t.firstChild&&(t.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}(t,e,n,i,r),Vt.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const t=function(){const t=Vt.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===t?-1:t.injectorIndex}return Ht(s,!0),s}function _r(t,e,n,i){if(0===n)return-1;const r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function vr(t,e,n){se(e);try{const i=t.viewQuery;null!==i&&Kr(1,i,n);const r=t.template;null!==r&&Tr(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&mr(t,e),t.staticViewQueries&&Kr(2,t.viewQuery,n);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)Zr(t,e[n])}(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{e[2]&=-5,ce()}}function wr(t,e,n,i){const r=e[2];if(256==(256&r))return;se(e);const s=Wt();try{Mt(e),function(t){Vt.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&Tr(t,e,n,2,i);const o=3==(3&r);if(!s)if(o){const n=t.preOrderCheckHooks;null!==n&&me(e,n,null)}else{const n=t.preOrderHooks;null!==n&&ge(e,n,0,null),ye(e,0)}if(function(t){for(let e=On(t);null!==e;e=Rn(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],i=n[3];0==(1024&n[2])&&Ft(i,1),n[2]|=1024}}}(e),function(t){for(let e=On(t);null!==e;e=Rn(e))for(let t=10;t<e.length;t++){const n=e[t],i=n[1];Rt(n)&&wr(i,n,i.template,n[8])}}(e),null!==t.contentQueries&&mr(t,e),!s)if(o){const n=t.contentCheckHooks;null!==n&&me(e,n)}else{const n=t.contentHooks;null!==n&&ge(e,n,1),ye(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const i=n[t];if(i<0)de(~i);else{const r=i,s=n[++t],o=n[++t];Xt(s,r),o(2,e[r])}}}finally{de(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)zr(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&Kr(2,l,i),!s)if(o){const n=t.viewCheckHooks;null!==n&&me(e,n)}else{const n=t.viewHooks;null!==n&&ge(e,n,2),ye(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Ft(e[3],-1))}finally{ce()}}function br(t,e,n,i){const r=e[10],s=!Wt(),o=Ot(e);try{s&&!o&&r.begin&&r.begin(),o&&vr(t,e,i),wr(t,e,n,i)}finally{s&&!o&&r.end&&r.end()}}function Tr(t,e,n,i,r){const s=he(),o=2&i;try{de(-1),o&&e.length>20&&lr(t,e,20,Wt()),n(i,r)}finally{de(s)}}function Ir(t,e,n){!Ut()||(function(t,e,n,i){const r=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||De(n,e),An(i,e);const o=n.initialInputs;for(let a=r;a<s;a++){const i=t.data[a],s=pt(i);s&&Fr(e,n,i);const l=Ze(e,t,a,n);An(l,e),null!==o&&Ur(0,a-r,l,i,0,o),s&&(Dt(n.index,e)[8]=l)}}(t,e,n,At(n,e)),128==(128&n.flags)&&function(t,e,n){const i=n.directiveStart,r=n.directiveEnd,s=n.index,o=Vt.lFrame.currentDirectiveIndex;try{de(s);for(let n=i;n<r;n++){const i=t.data[n],r=e[n];te(n),(null!==i.hostBindings||0!==i.hostVars||null!==i.hostAttrs)&&Dr(i,r)}}finally{de(-1),te(o)}}(t,e,n))}function Sr(t,e,n=At){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(e,t):t[o];t[r++]=a}}}function Cr(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Er(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Er(t,e,n,i,r,s,o,a,l,u){const c=20+i,h=c+r,d=function(t,e){const n=[];for(let i=0;i<e;i++)n.push(i<t?null:or);return n}(c,h),p="function"==typeof u?u():u;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function xr(t,e,n,i){const r=Yr(e);null===n?r.push(i):(r.push(n),t.firstCreatePass&&Jr(t).push(i,r.length-1))}function kr(t,e,n){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(e,r):n[i]=[e,r]}return n}function Ar(t,e,n,i,r,s,o,a){const l=At(e,n);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(ts(t,n,u,i,r),ht(e)&&function(t,e){const n=Dt(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(i=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=o?o(r,e.value||"",i):r,Ct(s)?s.setProperty(l,i,r):Ie(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function Pr(t,e,n,i){let r=!1;if(Ut()){const s=function(t,e,n){const i=t.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];ir(n,o.selectors,!1)&&(r||(r=[]),Me(De(n,e),t,o.type),pt(o)?(Or(t,n),r.unshift(o)):r.push(o))}return r}(t,e,n),o=null===i?null:{"":-1};if(null!==s){r=!0,Lr(n,t.data.length,s.length);for(let t=0;t<s.length;t++){const e=s[t];e.providersResolver&&e.providersResolver(e)}let i=!1,a=!1,l=_r(t,e,s.length,null);for(let r=0;r<s.length;r++){const u=s[r];n.mergedAttrs=Se(n.mergedAttrs,u.hostAttrs),Mr(t,n,e,l,u),Rr(l,u,o),null!==u.contentQueries&&(n.flags|=8),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(n.flags|=128);const c=u.type.prototype;!i&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),i=!0),!a&&(c.ngOnChanges||c.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(t,e){const n=e.directiveEnd,i=t.data,r=e.attrs,s=[];let o=null,a=null;for(let l=e.directiveStart;l<n;l++){const t=i[l],n=t.inputs,u=null===r||Ji(e)?null:jr(n,r);s.push(u),o=kr(n,l,o),a=kr(t.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=o,e.outputs=a}(t,n)}o&&function(t,e,n){if(e){const i=t.localNames=[];for(let t=0;t<e.length;t+=2){const r=n[e[t+1]];if(null==r)throw new g("301",`Export of name '${e[t+1]}' not found!`);i.push(e[t],r)}}}(n,i,o)}return n.mergedAttrs=Se(n.mergedAttrs,n.attrs),r}function Nr(t,e,n,i,r,s){const o=s.hostBindings;if(o){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const s=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(i,r,o)}}function Dr(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Or(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Rr(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;pt(e)&&(n[""]=t)}}function Lr(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Mr(t,e,n,i,r){t.data[i]=r;const s=r.factory||(r.factory=mt(r.type)),o=new we(s,pt(r),null);t.blueprint[i]=o,n[i]=o,Nr(t,e,0,i,_r(t,n,r.hostVars,or),r)}function Fr(t,e,n){const i=At(e,t),r=Cr(n),s=t[10],o=Hr(t,gr(t,r,null,n.onPush?64:16,i,e,s,s.createRenderer(i,n),null,null));t[e.index]=o}function Vr(t,e,n,i,r,s){const o=At(t,e);!function(t,e,n,i,r,s,o){if(null==s)Ct(t)?t.removeAttribute(e,r,n):e.removeAttribute(r);else{const a=null==o?y(s):o(s,i||"",r);Ct(t)?t.setAttribute(e,r,a,n):n?e.setAttributeNS(n,r,a):e.setAttribute(r,a)}}(e[11],o,s,t.value,n,i,r)}function Ur(t,e,n,i,r,s){const o=s[e];if(null!==o){const t=i.setInput;for(let e=0;e<o.length;){const r=o[e++],s=o[e++],a=o[e++];null!==t?i.setInput(n,a,r,s):n[s]=a}}}function jr(t,e){let n=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,t[r],e[i+1])),i+=2}else i+=2;else i+=4}return n}function qr(t,e,n,i){return new Array(t,!0,!1,e,null,0,i,n,null,null)}function zr(t,e){const n=Dt(e,t);if(Rt(n)){const t=n[1];80&n[2]?wr(t,n,t.template,n[8]):n[5]>0&&Br(n)}}function Br(t){for(let n=On(t);null!==n;n=Rn(n))for(let t=10;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];wr(t,e,t.template,e[8])}else e[5]>0&&Br(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const i=Dt(e[n],t);Rt(i)&&i[5]>0&&Br(i)}}function Zr(t,e){const n=Dt(e,t),i=n[1];(function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(i,n),vr(i,n,n[8])}function Hr(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function $r(t){for(;t;){t[2]|=64;const e=Dn(t);if(ft(t)&&!e)return t;t=e}return null}function Wr(t,e,n){const i=e[10];i.begin&&i.begin();try{wr(t,e,t.template,n)}catch(r){throw Xr(e,r),r}finally{i.end&&i.end()}}function Gr(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],i=Pn(n),r=i[1];br(r,i,r.template,n)}}(t[8])}function Kr(t,e,n){ne(0),e(t,n)}const Qr=(()=>Promise.resolve(null))();function Yr(t){return t[7]||(t[7]=[])}function Jr(t){return t.cleanup||(t.cleanup=[])}function Xr(t,e){const n=t[9],i=n?n.get(Hi,null):null;i&&i.handleError(e)}function ts(t,e,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=e[o],u=t.data[o];null!==u.setInput?u.setInput(l,r,i,a):l[a]=r}}function es(t,e,n){const i=kt(e,t);!function(t,e,n){Ct(t)?t.setValue(e,n):e.textContent=n}(t[11],i,n)}function ns(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?s=t:1==s?r=h(r,t):2==s&&(i=h(i,t+": "+e[++o]+";"))}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}const is=new Xe("INJECTOR",-1);class rs{get(t,e=cn){if(e===cn){const e=new Error(`NullInjectorError: No provider for ${c(t)}!`);throw e.name="NullInjectorError",e}return e}}const ss=new Xe("Set Injector scope."),os={},as={};let ls;function us(){return void 0===ls&&(ls=new rs),ls}function cs(t,e=null,n=null,i){return new hs(t,n,e||us(),i)}class hs{constructor(t,e,n,i=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];e&&rn(e,n=>this.processProvider(n,t,e)),rn([t],t=>this.processInjectorType(t,[],r)),this.records.set(is,fs(void 0,this));const s=this.records.get(ss);this.scope=null!=s?s.value:null,this.source=i||("object"==typeof t?null:c(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=cn,n=P.Default){this.assertNotDestroyed();const i=yn(this),r=D(void 0);try{if(!(n&P.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(s=t)||"object"==typeof s&&s instanceof Xe)&&I(t);e=n&&this.injectableDefInScope(n)?fs(ds(t),os):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&P.Self?us():this.parent).get(t,e=n&P.Optional&&e===cn?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[dn]=o[dn]||[]).unshift(c(t)),i)throw o;return In(o,t,"R3InjectorError",this.source)}throw o}finally{D(r),yn(i)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(c(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=f(t)))return!1;let i=C(t);const r=null==i&&t.ngModule||void 0,s=void 0===r?t:r,o=-1!==n.indexOf(s);if(void 0!==r&&(i=C(r)),null==i)return!1;if(null!=i.imports&&!o){let t;n.push(s);try{rn(i.imports,i=>{this.processInjectorType(i,e,n)&&(void 0===t&&(t=[]),t.push(i))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:i}=t[e];rn(i,t=>this.processProvider(t,n,i||z))}}this.injectorDefTypes.add(s);const a=mt(s)||(()=>new s);this.records.set(s,fs(a,os));const l=i.providers;if(null!=l&&!o){const e=t;rn(l,t=>this.processProvider(t,e,l))}return void 0!==r&&void 0!==t.providers}processProvider(t,e,n){let i=gs(t=f(t))?t:f(t&&t.provide);const r=(s=t,ms(s)?fs(void 0,s.useValue):fs(ps(s),os));var s;if(gs(t)||!0!==t.multi)this.records.get(i);else{let e=this.records.get(i);e||(e=fs(void 0,os,!0),e.factory=()=>wn(e.multi),this.records.set(i,e)),i=t,e.multi.push(t)}this.records.set(i,r)}hydrate(t,e){return e.value===os&&(e.value=as,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value;var n}injectableDefInScope(t){if(!t.providedIn)return!1;const e=f(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function ds(t){const e=I(t),n=null!==e?e.factory:mt(t);if(null!==n)return n;if(t instanceof Xe)throw new Error(`Token ${c(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=function(t,e){const n=[];for(let i=0;i<t;i++)n.push(e);return n}(e,"?");throw new Error(`Can't resolve all parameters for ${c(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[E]||t[k]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function ps(t,e,n){let i;if(gs(t)){const e=f(t);return mt(e)||ds(e)}if(ms(t))i=()=>f(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...wn(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))i=()=>vn(f(t.useExisting));else{const e=f(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return mt(e)||ds(e);i=()=>new e(...wn(t.deps))}return i}function fs(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function ms(t){return null!==t&&"object"==typeof t&&mn in t}function gs(t){return"function"==typeof t}const ys=function(t,e,n){return function(t,e=null,n=null,i){const r=cs(t,e,n,i);return r._resolveInjectorDefTypes(),r}({name:n},e,t,n)};let _s=(()=>{class t{static create(t,e){return Array.isArray(t)?ys(t,e,""):ys(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=cn,t.NULL=new rs,t.\u0275prov=b({token:t,providedIn:"any",factory:()=>vn(is)}),t.__NG_ELEMENT_ID__=-1,t})();function vs(t,e){fe(Pn(t)[1],Bt())}function ws(t){let e=function(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const i=[t];for(;e;){let r;if(pt(t))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(n){i.push(r);const e=t;e.inputs=bs(t.inputs),e.declaredInputs=bs(t.declaredInputs),e.outputs=bs(t.outputs);const n=r.hostBindings;n&&Ss(t,n);const s=r.viewQuery,o=r.contentQueries;if(s&&Ts(t,s),o&&Is(t,o),u(t.inputs,r.inputs),u(t.declaredInputs,r.declaredInputs),u(t.outputs,r.outputs),pt(r)&&r.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(r.data.animation)}}const e=r.features;if(e)for(let i=0;i<e.length;i++){const r=e[i];r&&r.ngInherit&&r(t),r===ws&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Se(r.hostAttrs,n=Se(n,r.hostAttrs))}}(i)}function bs(t){return t===q?{}:t===z?[]:t}function Ts(t,e){const n=t.viewQuery;t.viewQuery=n?(t,i)=>{e(t,i),n(t,i)}:e}function Is(t,e){const n=t.contentQueries;t.contentQueries=n?(t,i,r)=>{e(t,i,r),n(t,i,r)}:e}function Ss(t,e){const n=t.hostBindings;t.hostBindings=n?(t,i)=>{e(t,i),n(t,i)}:e}let Cs=null;function Es(){if(!Cs){const t=j.Symbol;if(t&&t.iterator)Cs=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Cs=n)}}}return Cs}class xs{constructor(t){this.wrapped=t}static wrap(t){return new xs(t)}static unwrap(t){return xs.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof xs}}function ks(t){return!!As(t)&&(Array.isArray(t)||!(t instanceof Map)&&Es()in t)}function As(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Ps(t,e,n){return t[e]=n}function Ns(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Ds(t,e,n,i){const r=Ns(t,e,n);return Ns(t,e+1,i)||r}function Os(t,e,n,i){const r=jt();return Ns(r,Yt(),e)&&(qt(),Vr(pe(),r,t,e,n,i)),Os}function Rs(t,e,n,i){return Ns(t,Yt(),n)?e+y(n)+i:or}function Ls(t,e,n,i,r,s){const o=Ds(t,Qt(),n,r);return Jt(2),o?e+y(n)+i+y(r)+s:or}function Ms(t,e,n,i,r,s,o,a){const l=function(t,e,n,i,r){const s=Ds(t,e,n,i);return Ns(t,e+2,r)||s}(t,Qt(),n,r,o);return Jt(3),l?e+y(n)+i+y(r)+s+y(o)+a:or}function Fs(t,e,n,i,r,s,o,a){const l=jt(),u=qt(),c=t+20,h=u.firstCreatePass?function(t,e,n,i,r,s,o,a,l){const u=e.consts,c=yr(e,t,4,o||null,Lt(u,a));Pr(e,n,c,Lt(u,l)),fe(e,c);const h=c.tViews=Er(2,c,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u);return null!==e.queries&&(e.queries.template(e,c),h.queries=e.queries.embeddedTView(c)),c}(c,u,l,e,n,i,r,s,o):u.data[c];Ht(h,!1);const d=l[11].createComment("");Kn(u,l,d,h),An(d,l),Hr(l,l[c]=qr(d,l,d,h)),dt(h)&&Ir(u,l,h),null!=o&&Sr(l,h,a)}function Vs(t){return Nt(Vt.lFrame.contextLView,20+t)}function Us(t,e=P.Default){const n=jt();return null===n?vn(t,e):Ue(Bt(),n,f(t),e)}function js(t,e,n){const i=jt();return Ns(i,Yt(),e)&&Ar(qt(),pe(),i,t,e,i[11],n,!1),js}function qs(t,e,n,i,r){const s=r?"class":"style";ts(t,n,e.inputs[s],s,i)}function zs(t,e,n,i){const r=jt(),s=qt(),o=20+t,a=r[11],l=r[o]=Fn(a,e,Vt.lFrame.currentNamespace),u=s.firstCreatePass?function(t,e,n,i,r,s,o){const a=e.consts,l=yr(e,t,2,r,Lt(a,s));return Pr(e,n,l,Lt(a,o)),null!==l.attrs&&ns(l,l.attrs,!1),null!==l.mergedAttrs&&ns(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,0,e,n,i):s.data[o];Ht(u,!0);const c=u.mergedAttrs;null!==c&&be(a,l,c);const h=u.classes;null!==h&&ii(a,l,h);const d=u.styles;null!==d&&ni(a,l,d),64!=(64&u.flags)&&Kn(s,r,l,u),0===Vt.lFrame.elementDepthCount&&An(l,r),Vt.lFrame.elementDepthCount++,dt(u)&&(Ir(s,r,u),function(t,e,n){if(ct(e)){const i=e.directiveEnd;for(let r=e.directiveStart;r<i;r++){const e=t.data[r];e.contentQueries&&e.contentQueries(1,n[r],r)}}}(s,u,r)),null!==i&&Sr(r,u)}function Bs(){let t=Bt();$t()?Vt.lFrame.isParent=!1:(t=t.parent,Ht(t,!1));const e=t;Vt.lFrame.elementDepthCount--;const n=qt();n.firstCreatePass&&(fe(n,t),ct(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&qs(n,e,jt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&qs(n,e,jt(),e.stylesWithoutHost,!1)}function Zs(t,e,n,i){zs(t,e,n,i),Bs()}function Hs(){return jt()}function $s(t){return!!t&&"function"==typeof t.then}function Ws(t){return!!t&&"function"==typeof t.subscribe}const Gs=Ws;function Ks(t,e,n,i){const r=jt(),s=qt(),o=Bt();return function(t,e,n,i,r,s,o,a){const l=dt(i),u=t.firstCreatePass&&Jr(t),c=e[8],h=Yr(e);let d=!0;if(3&i.type||a){const p=At(i,e),f=a?a(p):p,m=h.length,g=a?t=>a(xt(t[i.index])):i.index;if(Ct(n)){let o=null;if(!a&&l&&(o=function(t,e,n,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const t=r[s];if(t===n&&r[s+1]===i){const t=e[7],n=r[s+2];return t.length>n?t[n]:null}"string"==typeof t&&(s+=2)}return null}(t,e,r,i.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,d=!1;else{s=Ys(i,e,c,s,!1);const t=n.listen(f,r,s);h.push(s,t),u&&u.push(r,g,m,m+1)}}else s=Ys(i,e,c,s,!0),f.addEventListener(r,s,o),h.push(s),u&&u.push(r,g,m,o)}else s=Ys(i,e,c,s,!1);const p=i.outputs;let f;if(d&&null!==p&&(f=p[r])){const t=f.length;if(t)for(let n=0;n<t;n+=2){const t=e[f[n]][f[n+1]].subscribe(s),o=h.length;h.push(s,t),u&&u.push(r,i.index,o,-(o+1))}}}(s,r,r[11],o,t,e,!!n,i),Ks}function Qs(t,e,n,i){try{return!1!==n(i)}catch(r){return Xr(t,r),!1}}function Ys(t,e,n,i,r){return function n(s){if(s===Function)return i;const o=2&t.flags?Dt(t.index,e):e;0==(32&e[2])&&$r(o);let a=Qs(e,0,i,s),l=n.__ngNextListenerFn__;for(;l;)a=Qs(e,0,l,s)&&a,l=l.__ngNextListenerFn__;return r&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function Js(t=1){return function(t){return(Vt.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Vt.lFrame.contextLView))[8]}(t)}function Xs(t,e,n,i,r){const s=jt(),o=Rs(s,e,n,i);return o!==or&&Ar(qt(),pe(),s,t,o,s[11],r,!1),Xs}function to(t,e,n,i,r,s,o){const a=jt(),l=Ls(a,e,n,i,r,s);return l!==or&&Ar(qt(),pe(),a,t,l,a[11],o,!1),to}function eo(t,e,n,i,r,s,o,a,l){const u=jt(),c=Ms(u,e,n,i,r,s,o,a);return c!==or&&Ar(qt(),pe(),u,t,c,u[11],l,!1),eo}function no(t,e,n,i,r){const s=t[n+1],o=null===e;let a=i?cr(s):dr(s),l=!1;for(;0!==a&&(!1===l||o);){const n=t[a+1];io(t[a],e)&&(l=!0,t[a+1]=i?fr(n):hr(n)),a=i?cr(n):dr(n)}l&&(t[n+1]=i?hr(s):fr(s))}function io(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&un(t,e)>=0}const ro={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function so(t){return t.substring(ro.key,ro.keyEnd)}function oo(t){return t.substring(ro.value,ro.valueEnd)}function ao(t,e){const n=ro.textEnd;return n===e?-1:(e=ro.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,ro.key=e,n),co(t,e,n))}function lo(t,e){const n=ro.textEnd;let i=ro.key=co(t,e,n);return n===i?-1:(i=ro.keyEnd=function(t,e,n){let i;for(;e<n&&(45===(i=t.charCodeAt(e))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)e++;return e}(t,i,n),i=ho(t,i,n),i=ro.value=co(t,i,n),i=ro.valueEnd=function(t,e,n){let i=-1,r=-1,s=-1,o=e,a=o;for(;o<n;){const l=t.charCodeAt(o++);if(59===l)return a;34===l||39===l?a=o=po(t,l,o,n):e===o-4&&85===s&&82===r&&76===i&&40===l?a=o=po(t,41,o,n):l>32&&(a=o),s=r,r=i,i=-33&l}return a}(t,i,n),ho(t,i,n))}function uo(t){ro.key=0,ro.keyEnd=0,ro.value=0,ro.valueEnd=0,ro.textEnd=t.length}function co(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function ho(t,e,n,i){return(e=co(t,e,n))<n&&e++,e}function po(t,e,n,i){let r=-1,s=n;for(;s<i;){const n=t.charCodeAt(s++);if(n==e&&92!==r)return s;r=92==n&&92===r?0:n}throw new Error}function fo(t,e){return function(t,e,n,i){const r=jt(),s=qt(),o=Jt(2);s.firstUpdatePass&&wo(s,t,o,i),e!==or&&Ns(r,o,e)&&So(s,s.data[he()],r,r[11],t,r[o+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=c(hi(t)))),t}(e,n),i,o)}(t,e,null,!0),fo}function mo(t,e){for(let n=function(t){return uo(t),lo(t,co(t,0,ro.textEnd))}(e);n>=0;n=lo(e,n))Io(t,so(e),oo(e))}function go(t){_o(an,yo,t,!0)}function yo(t,e){for(let n=function(t){return uo(t),ao(t,co(t,0,ro.textEnd))}(e);n>=0;n=ao(e,n))an(t,so(e),!0)}function _o(t,e,n,i){const r=qt(),s=Jt(2);r.firstUpdatePass&&wo(r,null,s,i);const o=jt();if(n!==or&&Ns(o,s,n)){const a=r.data[he()];if(xo(a,i)&&!vo(r,s)){let t=i?a.classesWithoutHost:a.stylesWithoutHost;null!==t&&(n=h(t,n||"")),qs(r,a,o,n,i)}else!function(t,e,n,i,r,s,o,a){r===or&&(r=z);let l=0,u=0,c=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==c||null!==h;){const d=l<r.length?r[l+1]:void 0,p=u<s.length?s[u+1]:void 0;let f,m=null;c===h?(l+=2,u+=2,d!==p&&(m=h,f=p)):null===h||null!==c&&c<h?(l+=2,m=c):(u+=2,m=h,f=p),null!==m&&So(t,e,n,i,m,f,o,a),c=l<r.length?r[l]:null,h=u<s.length?s[u]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(t,e,n){if(null==n||""===n)return z;const i=[],r=hi(n);if(Array.isArray(r))for(let s=0;s<r.length;s++)t(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&t(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(t,e,n),i,s)}}function vo(t,e){return e>=t.expandoStartIndex}function wo(t,e,n,i){const r=t.data;if(null===r[n+1]){const s=r[he()],o=vo(t,n);xo(s,i)&&null===e&&!o&&(e=!1),e=function(t,e,n,i){const r=function(t){const e=Vt.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(n=To(n=bo(null,t,e,n,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==r)if(n=bo(r,t,e,n,i),null===s){let n=function(t,e,n){const i=n?e.classBindings:e.styleBindings;if(0!==dr(i))return t[cr(i)]}(t,e,i);void 0!==n&&Array.isArray(n)&&(n=bo(null,t,e,n[1],i),n=To(n,e.attrs,i),function(t,e,n,i){t[cr(n?e.classBindings:e.styleBindings)]=i}(t,e,i,n))}else s=function(t,e,n){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=To(i,t[s].hostAttrs,n);return To(i,e.attrs,n)}(t,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),n}(r,s,e,i),function(t,e,n,i,r,s){let o=s?e.classBindings:e.styleBindings,a=cr(o),l=dr(o);t[i]=n;let u,c=!1;if(Array.isArray(n)){const t=n;u=t[1],(null===u||un(t,u)>0)&&(c=!0)}else u=n;if(r)if(0!==l){const e=cr(t[a+1]);t[i+1]=ur(e,a),0!==e&&(t[e+1]=pr(t[e+1],i)),t[a+1]=function(t,e){return 131071&t|e<<17}(t[a+1],i)}else t[i+1]=ur(a,0),0!==a&&(t[a+1]=pr(t[a+1],i)),a=i;else t[i+1]=ur(l,0),0===a?a=i:t[l+1]=pr(t[l+1],i),l=i;c&&(t[i+1]=hr(t[i+1])),no(t,u,i,!0),no(t,u,i,!1),function(t,e,n,i,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&un(s,e)>=0&&(n[i+1]=fr(n[i+1]))}(e,u,t,i,s),o=ur(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,n,o,i)}}function bo(t,e,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],i=To(i,s.hostAttrs,r),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),i}function To(t,e,n){const i=n?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),an(t,o,!!n||e[++s]))}return void 0===t?null:t}function Io(t,e,n){an(t,e,hi(n))}function So(t,e,n,i,r,s,o,a){if(!(3&e.type))return;const l=t.data,u=l[a+1];Eo(function(t){return 1==(1&t)}(u)?Co(l,e,n,r,dr(u),o):void 0)||(Eo(s)||function(t){return 2==(2&t)}(u)&&(s=Co(l,null,n,r,a,o)),function(t,e,n,i,r){const s=Ct(t);if(e)r?s?t.addClass(n,i):n.classList.add(i):s?t.removeClass(n,i):n.classList.remove(i);else{let e=-1===i.indexOf("-")?void 0:xn.DashCase;if(null==r)s?t.removeStyle(n,i,e):n.style.removeProperty(i);else{const o="string"==typeof r&&r.endsWith("!important");o&&(r=r.slice(0,-10),e|=xn.Important),s?t.setStyle(n,i,r,e):n.style.setProperty(i,r,o?"important":"")}}}(i,o,kt(he(),n),r,s))}function Co(t,e,n,i,r,s){const o=null===e;let a;for(;r>0;){const e=t[r],s=Array.isArray(e),l=s?e[1]:e,u=null===l;let c=n[r+1];c===or&&(c=u?z:void 0);let h=u?ln(c,i):l===i?c:void 0;if(s&&!Eo(h)&&(h=ln(e,i)),Eo(h)&&(a=h,o))return a;const d=t[r+1];r=o?cr(d):dr(d)}if(null!==e){let t=s?e.residualClasses:e.residualStyles;null!=t&&(a=ln(t,i))}return a}function Eo(t){return void 0!==t}function xo(t,e){return 0!=(t.flags&(e?16:32))}function ko(t,e=""){const n=jt(),i=qt(),r=t+20,s=i.firstCreatePass?yr(i,r,1,e,null):i.data[r],o=n[r]=function(t,e){return Ct(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Kn(i,n,o,s),Ht(s,!1)}function Ao(t){return Po("",t,""),Ao}function Po(t,e,n){const i=jt(),r=Rs(i,t,e,n);return r!==or&&es(i,he(),r),Po}function No(t,e,n,i,r){const s=jt(),o=Ls(s,t,e,n,i,r);return o!==or&&es(s,he(),o),No}function Do(t,e,n,i,r,s,o){const a=jt(),l=Ms(a,t,e,n,i,r,s,o);return l!==or&&es(a,he(),l),Do}function Oo(t,e,n){_o(an,yo,Rs(jt(),t,e,n),!0)}function Ro(t,e,n){!function(t){_o(Io,mo,t,!1)}(Rs(jt(),t,e,n))}function Lo(t,e,n){const i=jt();return Ns(i,Yt(),e)&&Ar(qt(),pe(),i,t,e,i[11],n,!0),Lo}const Mo=void 0;var Fo=["en",[["a","p"],["AM","PM"],Mo],[["AM","PM"],Mo,Mo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Mo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Mo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Mo,"{1} 'at' {0}",Mo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Vo={};function Uo(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=qo(e);if(n)return n;const i=e.split("-")[0];if(n=qo(i),n)return n;if("en"===i)return Fo;throw new Error(`Missing locale data for the locale "${t}".`)}function jo(t){return Uo(t)[zo.PluralCase]}function qo(t){return t in Vo||(Vo[t]=j.ng&&j.ng.common&&j.ng.common.locales&&j.ng.common.locales[t]),Vo[t]}var zo=(()=>((zo=zo||{})[zo.LocaleId=0]="LocaleId",zo[zo.DayPeriodsFormat=1]="DayPeriodsFormat",zo[zo.DayPeriodsStandalone=2]="DayPeriodsStandalone",zo[zo.DaysFormat=3]="DaysFormat",zo[zo.DaysStandalone=4]="DaysStandalone",zo[zo.MonthsFormat=5]="MonthsFormat",zo[zo.MonthsStandalone=6]="MonthsStandalone",zo[zo.Eras=7]="Eras",zo[zo.FirstDayOfWeek=8]="FirstDayOfWeek",zo[zo.WeekendRange=9]="WeekendRange",zo[zo.DateFormat=10]="DateFormat",zo[zo.TimeFormat=11]="TimeFormat",zo[zo.DateTimeFormat=12]="DateTimeFormat",zo[zo.NumberSymbols=13]="NumberSymbols",zo[zo.NumberFormats=14]="NumberFormats",zo[zo.CurrencyCode=15]="CurrencyCode",zo[zo.CurrencySymbol=16]="CurrencySymbol",zo[zo.CurrencyName=17]="CurrencyName",zo[zo.Currencies=18]="Currencies",zo[zo.Directionality=19]="Directionality",zo[zo.PluralCase=20]="PluralCase",zo[zo.ExtraData=21]="ExtraData",zo))();const Bo="en-US";let Zo=Bo;function Ho(t){w(t,"Expected localeId to be defined"),"string"==typeof t&&(Zo=t.toLowerCase().replace(/_/g,"-"))}function $o(t,e,n,i,r){if(t=f(t),Array.isArray(t))for(let s=0;s<t.length;s++)$o(t[s],e,n,i,r);else{const s=qt(),o=jt();let a=gs(t)?t:f(t.provide),l=ps(t);const u=Bt(),c=1048575&u.providerIndexes,h=u.directiveStart,d=u.providerIndexes>>20;if(gs(t)||!t.multi){const i=new we(l,r,Us),p=Ko(a,e,r?c:c+d,h);-1===p?(Me(De(u,o),s,a),Wo(s,t,e.length),e.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(i),o.push(i)):(n[p]=i,o[p]=i)}else{const p=Ko(a,e,c+d,h),f=Ko(a,e,c,c+d),m=p>=0&&n[p],g=f>=0&&n[f];if(r&&!g||!r&&!m){Me(De(u,o),s,a);const c=function(t,e,n,i,r){const s=new we(t,n,Us);return s.multi=[],s.index=e,s.componentProviders=0,Go(s,r,i&&!n),s}(r?Yo:Qo,n.length,r,i,l);!r&&g&&(n[f].providerFactory=c),Wo(s,t,e.length,0),e.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(c),o.push(c)}else Wo(s,t,p>-1?p:f,Go(n[r?f:p],l,!r&&i));!r&&i&&g&&n[f].componentProviders++}}}function Wo(t,e,n,i){const r=gs(e);if(r||function(t){return!!t.useClass}(e)){const s=(e.useClass||e).prototype.ngOnDestroy;if(s){const o=t.destroyHooks||(t.destroyHooks=[]);if(!r&&e.multi){const t=o.indexOf(n);-1===t?o.push(n,[i,s]):o[t+1].push(i,s)}else o.push(n,s)}}}function Go(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Ko(t,e,n,i){for(let r=n;r<i;r++)if(e[r]===t)return r;return-1}function Qo(t,e,n,i){return Jo(this.multi,[])}function Yo(t,e,n,i){const r=this.multi;let s;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Ze(n,n[1],this.providerFactory.index,i);s=e.slice(0,t),Jo(r,s);for(let n=t;n<e.length;n++)s.push(e[n])}else s=[],Jo(r,s);return s}function Jo(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Xo(t,e=[]){return n=>{n.providersResolver=(n,i)=>function(t,e,n){const i=qt();if(i.firstCreatePass){const r=pt(t);$o(n,i.data,i.blueprint,r,!0),$o(e,i.data,i.blueprint,r,!1)}}(n,i?i(t):t,e)}}class ta{}const ea="ngComponent";class na{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${c(t)}. Did you add it to @NgModule.entryComponents?`);return e[ea]=t,e}(t)}}let ia=(()=>{class t{}return t.NULL=new na,t})();function ra(...t){}function sa(t,e){return new aa(At(t,e))}const oa=function(){return sa(Bt(),jt())};let aa=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=oa,t})();function la(t){return t instanceof aa?t.nativeElement:t}class ua{}let ca=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ha(),t})();const ha=function(){const t=jt(),e=Dt(Bt().index,t);return function(t){return t[11]}(lt(e)?e:t)};let da=(()=>{class t{}return t.\u0275prov=b({token:t,providedIn:"root",factory:()=>null}),t})();class pa{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const fa=new pa("12.2.17");class ma{constructor(){}supports(t){return ks(t)}create(t){return new ya(t)}}const ga=(t,e)=>e;class ya{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||ga}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,i=0,r=null;for(;e||n;){const s=!n||e&&e.currentIndex<ba(n,i,r)?e:n,o=ba(s,i,r),a=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(e=e._next,null==s.previousIndex)i++;else{r||(r=[]);const t=o-i,e=a-i;if(t!=e){for(let n=0;n<t;n++){const i=n<r.length?r[n]:r[n]=0,s=i+n;e<=s&&s<t&&(r[n]=i+1)}r[s.previousIndex]=e-t}}o!==a&&t(s,o,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ks(t))throw new Error(`Error trying to diff '${c(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,i,r=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],i=this._trackByFn(e,n),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,n,i,e)),Object.is(r.item,n)||this._addIdentityChange(r,n)):(r=this._mismatch(r,n,i,e),s=!0),r=r._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Es()]();let i;for(;!(i=n.next()).done;)e(i.value)}}(t,t=>{i=this._trackByFn(e,t),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,t,i,e)),Object.is(r.item,t)||this._addIdentityChange(r,t)):(r=this._mismatch(r,t,i,e),s=!0),r=r._next,e++}),this.length=e;return this._truncate(r),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,i){let r;return null===t?r=this._itTail:(r=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,i)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,i)):t=this._addAfter(new _a(e,n),r,i),t}_verifyReinsertion(t,e,n,i){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==r?t=this._reinsertAfter(r,t._prev,i):t.currentIndex!=i&&(t.currentIndex=i,this._addToMoves(t,i)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const i=t._prevRemoved,r=t._nextRemoved;return null===i?this._removalsHead=r:i._nextRemoved=r,null===r?this._removalsTail=i:r._prevRemoved=i,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const i=null===e?this._itHead:e._next;return t._next=i,t._prev=e,null===i?this._itTail=t:i._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new wa),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wa),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class _a{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class va{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class wa{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new va,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ba(t,e,n){const i=t.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}class Ta{constructor(){}supports(t){return t instanceof Map||As(t)}create(){return new Ia}}class Ia{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||As(t)))throw new Error(`Error trying to diff '${c(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const i=n._prev,r=n._next;return i&&(i._next=r),r&&(r._prev=i),n._next=null,n._prev=null,n}const n=new Sa(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Sa{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ca(){return new Ea([new ma])}let Ea=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||Ca()),deps:[[t,new En,new Cn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(t){return t.name||typeof t}(t)}'`)}}return t.\u0275prov=b({token:t,providedIn:"root",factory:Ca}),t})();function xa(){return new ka([new Ta])}let ka=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||xa()),deps:[[t,new En,new Cn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=b({token:t,providedIn:"root",factory:xa}),t})();function Aa(t,e,n,i,r=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&i.push(xt(s)),ut(s))for(let t=10;t<s.length;t++){const e=s[t],n=e[1].firstChild;null!==n&&Aa(e[1],e,n,i)}const o=n.type;if(8&o)Aa(t,e,n.child,i);else if(32&o){const t=Nn(n,e);let r;for(;r=t();)i.push(r)}else if(16&o){const t=Yn(e,n);if(Array.isArray(t))i.push(...t);else{const n=Dn(e[16]);Aa(n[1],n,t,i,!0)}}n=r?n.projectionNext:n.next}return i}class Pa{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Aa(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(ut(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(Un(t,n),on(e,n))}this._attachedToViewContainer=!1}jn(this._lView[1],this._lView)}onDestroy(t){xr(this._lView[1],this._lView,null,t)}markForCheck(){$r(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Wr(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Gt(!0);try{Wr(t,e,n)}finally{Gt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,ti(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Na extends Pa{constructor(t){super(t),this._view=t}detectChanges(){Gr(this._view)}checkNoChanges(){!function(t){Gt(!0);try{Gr(t)}finally{Gt(!1)}}(this._view)}get context(){return null}}const Da=function(t){return function(t,e,n){if(ht(t)&&!n){const n=Dt(t.index,e);return new Pa(n,n)}return 47&t.type?new Pa(e[16],e):null}(Bt(),jt(),16==(16&t))};let Oa=(()=>{class t{}return t.__NG_ELEMENT_ID__=Da,t})();const Ra=[new Ta],La=new Ea([new ma]),Ma=new ka(Ra),Fa=function(){return qa(Bt(),jt())};let Va=(()=>{class t{}return t.__NG_ELEMENT_ID__=Fa,t})();const Ua=Va,ja=class extends Ua{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=gr(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const i=this._declarationLView[19];return null!==i&&(n[19]=i.createEmbeddedView(e)),vr(e,n,t),new Pa(n)}};function qa(t,e){return 4&t.type?new ja(e,t,sa(t,e)):null}class za{}class Ba{}const Za=function(){return Qa(Bt(),jt())};let Ha=(()=>{class t{}return t.__NG_ELEMENT_ID__=Za,t})();const $a=Ha,Wa=class extends $a{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return sa(this._hostTNode,this._hostLView)}get injector(){return new We(this._hostTNode,this._hostLView)}get parentInjector(){const t=Le(this._hostTNode,this._hostLView);if(Ee(t)){const e=ke(t,this._hostLView),n=xe(t);return new We(e[1].data[n+8],e)}return new We(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=Ga(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,n){const i=t.createEmbeddedView(e||{});return this.insert(i,n),i}createComponent(t,e,n,i,r){const s=n||this.parentInjector;if(!r&&null==t.ngModule&&s){const t=s.get(za,null);t&&(r=t)}const o=t.create(s,i,void 0,r);return this.insert(o.hostView,e),o}insert(t,e){const n=t._lView,i=n[1];if(ut(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],i=new Wa(e,e[6],e[3]);i.detach(i.indexOf(t))}}const r=this._adjustIndex(e),s=this._lContainer;!function(t,e,n,i){const r=10+i,s=n.length;i>0&&(n[r-1][4]=e),i<s-10?(e[4]=n[r],sn(n,10+i,e)):(n.push(e),e[4]=null),e[3]=n;const o=e[17];null!==o&&n!==o&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(i,n,s,r);const o=Jn(r,s),a=n[11],l=$n(a,s[7]);return null!==l&&function(t,e,n,i,r,s){i[0]=r,i[6]=e,ti(t,i,n,1,r,s)}(i,s[6],a,n,l,o),t.attachToViewContainerRef(),sn(Ka(s),r,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=Ga(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Un(this._lContainer,e);n&&(on(Ka(this._lContainer),e),jn(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=Un(this._lContainer,e);return n&&null!=on(Ka(this._lContainer),e)?new Pa(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function Ga(t){return t[8]}function Ka(t){return t[8]||(t[8]=[])}function Qa(t,e){let n;const i=e[t.index];if(ut(i))n=i;else{let r;if(8&t.type)r=xt(i);else{const n=e[11];r=n.createComment("");const i=At(t,e);Bn(n,$n(n,i),r,function(t,e){return Ct(t)?t.nextSibling(e):e.nextSibling}(n,i),!1)}e[t.index]=n=qr(i,e,r,t),Hr(e,n)}return new Wa(n,t,e)}const Ya={};class Ja extends ia{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=ot(t);return new el(e,this.ngModule)}}function Xa(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const tl=new Xe("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>$i});class el extends ta{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(sr).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Xa(this.componentDef.inputs)}get outputs(){return Xa(this.componentDef.outputs)}create(t,e,n,i){const r=(i=i||this.ngModule)?function(t,e){return{get:(n,i,r)=>{const s=t.get(n,Ya,r);return s!==Ya||i===Ya?s:e.get(n,i,r)}}}(t,i.injector):t,s=r.get(ua,Et),o=r.get(da,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",u=n?function(t,e,n){if(Ct(t))return t.selectRootElement(e,n===M.ShadowDom);let i="string"==typeof e?t.querySelector(e):e;return i.textContent="",i}(a,n,this.componentDef.encapsulation):Fn(s.createRenderer(null,this.componentDef),l,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),c=this.componentDef.onPush?576:528,h=function(t,e){return{components:[],scheduler:t||$i,clean:Qr,playerHandler:e||null,flags:0}}(),d=Er(0,null,null,1,0,null,null,null,null,null),p=gr(null,d,h,c,null,null,s,a,o,r);let f,m;se(p);try{const t=function(t,e,n,i,r,s){const o=n[1];n[20]=t;const a=yr(o,20,2,"#host",null),l=a.mergedAttrs=e.hostAttrs;null!==l&&(ns(a,l,!0),null!==t&&(be(r,t,l),null!==a.classes&&ii(r,t,a.classes),null!==a.styles&&ni(r,t,a.styles)));const u=i.createRenderer(t,e),c=gr(n,Cr(e),null,e.onPush?64:16,n[20],a,i,u,s||null,null);return o.firstCreatePass&&(Me(De(a,n),o,e.type),Or(o,a),Lr(a,n.length,1)),Hr(n,c),n[20]=c}(u,this.componentDef,p,s,a);if(u)if(n)be(a,u,["ng-version",fa.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&e.push(s,t[++i]):8===r&&n.push(s);else{if(!er(r))break;r=s}i++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&be(a,u,t),e&&e.length>0&&ii(a,u,e.join(" "))}if(m=Pt(d,20),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const i=e[n];t.push(null!=i?Array.from(i):null)}}f=function(t,e,n,i,r){const s=n[1],o=function(t,e,n){const i=Bt();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Mr(t,i,e,_r(t,e,1,null),n));const r=Ze(e,t,i.directiveStart,i);An(r,e);const s=At(i,e);return s&&An(s,e),r}(s,n,e);if(i.components.push(o),t[8]=o,r&&r.forEach(t=>t(o,e)),e.contentQueries){const t=Bt();e.contentQueries(1,o,t.directiveStart)}const a=Bt();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(de(a.index),Nr(n[1],a,0,a.directiveStart,a.directiveEnd,e),Dr(e,o)),o}(t,this.componentDef,p,h,[vs]),vr(d,p,null)}finally{ce()}return new nl(this.componentType,f,sa(m,p),p,m)}}class nl extends class{}{constructor(t,e,n,i,r){super(),this.location=n,this._rootLView=i,this._tNode=r,this.instance=e,this.hostView=this.changeDetectorRef=new Na(i),this.componentType=t}get injector(){return new We(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const il=new Map;class rl extends za{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Ja(this);const n=at(t),i=t[W]||null;i&&Ho(i),this._bootstrapComponents=Gi(n.bootstrap),this._r3Injector=cs(t,e,[{provide:za,useValue:this},{provide:ia,useValue:this.componentFactoryResolver}],c(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=_s.THROW_IF_NOT_FOUND,n=P.Default){return t===_s||t===za||t===is?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class sl extends Ba{constructor(t){super(),this.moduleType=t,null!==at(t)&&function(t){const e=new Set;!function t(n){const i=at(n,!0),r=i.id;null!==r&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${c(e)} vs ${c(e.name)}`)}(r,il.get(r),n),il.set(r,n));const s=Gi(i.imports);for(const o of s)e.has(o)||(e.add(o),t(o))}(t)}(t)}create(t){return new rl(this.moduleType,t)}}function ol(t,e,n){const i=Kt()+t,r=jt();return r[i]===or?Ps(r,i,n?e.call(n):e()):function(t,e){return t[e]}(r,i)}function al(t,e,n,i,r,s){const o=e+n;return Ns(t,o,r)?Ps(t,o+1,s?i.call(s,r):i(r)):function(t,e){const n=t[e];return n===or?void 0:n}(t,o+1)}function ll(t,e){const n=qt();let i;const r=t+20;n.firstCreatePass?(i=function(t,e){if(e)for(let n=e.length-1;n>=0;n--){const i=e[n];if(t===i.name)return i}throw new g("302",`The pipe '${t}' could not be found!`)}(e,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];const s=i.factory||(i.factory=mt(i.type)),o=D(Us);try{const t=Pe(!1),e=s();return Pe(t),function(t,e,n,i){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=i}(n,jt(),r,e),e}finally{D(o)}}function ul(t,e,n){const i=t+20,r=jt(),s=Nt(r,i);return function(t,e){xs.isWrapped(e)&&(e=xs.unwrap(e),t[Qt()]=or);return e}(r,function(t,e){return t[1].data[e].pure}(r,i)?al(r,Kt(),e,s.transform,n,s):s.transform(n))}function cl(t){return e=>{setTimeout(t,void 0,e)}}const hl=class extends i.xQ{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){var i,s,o;let a=t,l=e||(()=>null),u=n;if(t&&"object"==typeof t){const e=t;a=null===(i=e.next)||void 0===i?void 0:i.bind(e),l=null===(s=e.error)||void 0===s?void 0:s.bind(e),u=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}this.__isAsync&&(l=cl(l),a&&(a=cl(a)),u&&(u=cl(u)));const c=super.subscribe({next:a,error:l,complete:u});return t instanceof r.w&&t.add(c),c}};function dl(){return this._results[Es()]()}class pl{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Es(),n=pl.prototype;n[e]||(n[e]=dl)}get changes(){return this._changes||(this._changes=new hl)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const i=nn(t);(this._changesDetected=!function(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(n._results,i,e))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class fl{constructor(t){this.queryList=t,this.matches=null}clone(){return new fl(this.queryList)}setDirty(){this.queryList.setDirty()}}class ml{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,i=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);i.push(this.queries[n.indexInDeclarationView].clone())}return new ml(i)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==El(t,e).matches&&this.queries[e].setDirty()}}class gl{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class yl{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const i=null!==e?e.length:0,r=this.getByIndex(n).embeddedTView(t,i);r&&(r.indexInDeclarationView=n,null!==e?e.push(r):e=[r])}return null!==e?new yl(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class _l{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new _l(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const r=n[i];this.matchTNodeWithReadOption(t,e,vl(e,r)),this.matchTNodeWithReadOption(t,e,Be(e,t,r,!1,!1))}else n===Va?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Be(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===aa||i===Ha||i===Va&&4&e.type)this.addMatch(e.index,-2);else{const n=Be(e,t,i,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function vl(t,e){const n=t.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1];return null}function wl(t,e,n,i){return-1===n?function(t,e){return 11&t.type?sa(t,e):4&t.type?qa(t,e):null}(e,t):-2===n?function(t,e,n){return n===aa?sa(e,t):n===Va?qa(e,t):n===Ha?Qa(e,t):void 0}(t,e,i):Ze(t,t[1],n,e)}function bl(t,e,n,i){const r=e[19].queries[i];if(null===r.matches){const i=t.data,s=n.matches,o=[];for(let t=0;t<s.length;t+=2){const r=s[t];o.push(r<0?null:wl(e,i[r],s[t+1],n.metadata.read))}r.matches=o}return r.matches}function Tl(t,e,n,i){const r=t.queries.getByIndex(n),s=r.matches;if(null!==s){const o=bl(t,e,r,n);for(let t=0;t<s.length;t+=2){const n=s[t];if(n>0)i.push(o[t/2]);else{const r=s[t+1],o=e[-n];for(let t=10;t<o.length;t++){const e=o[t];e[17]===e[3]&&Tl(e[1],e,r,i)}if(null!==o[9]){const t=o[9];for(let e=0;e<t.length;e++){const n=t[e];Tl(n[1],n,r,i)}}}}}return i}function Il(t){const e=jt(),n=qt(),i=ee();ne(i+1);const r=El(n,i);if(t.dirty&&Ot(e)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?Tl(n,e,i,[]):bl(n,e,r,i);t.reset(s,la),t.notifyOnChanges()}return!0}return!1}function Sl(t,e,n,i){const r=qt();if(r.firstCreatePass){const s=Bt();(function(t,e,n){null===t.queries&&(t.queries=new yl),t.queries.track(new _l(e,n))})(r,new gl(e,n,i),s.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(r,t),2==(2&n)&&(r.staticContentQueries=!0)}!function(t,e,n){const i=new pl(4==(4&n));xr(t,e,i,i.destroy),null===e[19]&&(e[19]=new ml),e[19].queries.push(new fl(i))}(r,jt(),n)}function Cl(){return t=jt(),e=ee(),t[19].queries[e].queryList;var t,e}function El(t,e){return t.queries.getByIndex(e)}function xl(t,e){return qa(t,e)}const kl=new Xe("Application Initializer");let Al=(()=>{class t{constructor(t){this.appInits=t,this.resolve=ra,this.reject=ra,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();if($s(e))t.push(e);else if(Gs(e)){const n=new Promise((t,n)=>{e.subscribe({complete:t,error:n})});t.push(n)}}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(vn(kl,8))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();const Pl=new Xe("AppId"),Nl={provide:Pl,useFactory:function(){return`${Dl()}${Dl()}${Dl()}`},deps:[]};function Dl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Ol=new Xe("Platform Initializer"),Rl=new Xe("Platform ID"),Ll=new Xe("appBootstrapListener");let Ml=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();const Fl=new Xe("LocaleId"),Vl=new Xe("DefaultCurrencyCode");class Ul{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const jl=function(t){return new sl(t)},ql=jl,zl=function(t){return Promise.resolve(jl(t))},Bl=function(t){const e=jl(t),n=Gi(at(t).declarations).reduce((t,e)=>{const n=ot(e);return n&&t.push(new el(n)),t},[]);return new Ul(e,n)},Zl=Bl,Hl=function(t){return Promise.resolve(Bl(t))};let $l=(()=>{class t{constructor(){this.compileModuleSync=ql,this.compileModuleAsync=zl,this.compileModuleAndAllComponentsSync=Zl,this.compileModuleAndAllComponentsAsync=Hl}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();const Wl=(()=>Promise.resolve(0))();function Gl(t){"undefined"==typeof Zone?Wl.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Kl{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new hl(!1),this.onMicrotaskEmpty=new hl(!1),this.onStable=new hl(!1),this.onError=new hl(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&e,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let t=j.requestAnimationFrame,e=j.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(j,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Jl(t),t.isCheckStableRunning=!0,Yl(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Jl(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{try{return Xl(t),n.invokeTask(r,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),tu(t)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return Xl(t),n.invoke(r,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),tu(t)}},onHasTask:(e,n,i,r)=>{e.hasTask(i,r),n===i&&("microTask"==r.change?(t._hasPendingMicrotasks=r.microTask,Jl(t),Yl(t)):"macroTask"==r.change&&(t.hasPendingMacrotasks=r.macroTask))},onHandleError:(e,n,i,r)=>(e.handleError(i,r),t.runOutsideAngular(()=>t.onError.emit(r)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Kl.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Kl.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,i){const r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+i,t,Ql,ra,ra);try{return r.runTask(s,e,n)}finally{r.cancelTask(s)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const Ql={};function Yl(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Jl(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Xl(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function tu(t){t._nesting--,Yl(t)}class eu{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new hl,this.onMicrotaskEmpty=new hl,this.onStable=new hl,this.onError=new hl}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,i){return t.apply(e,n)}}let nu=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Kl.assertNotInAngularZone(),Gl(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Gl(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let i=-1;e&&e>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==i),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(vn(Kl))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})(),iu=(()=>{class t{constructor(){this._applications=new Map,ou.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return ou.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();class ru{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}function su(t){ou=t}let ou=new ru,au=!0,lu=!1;function uu(){return lu=!0,au}function cu(){if(lu)throw new Error("Cannot enable prod mode after platform setup.");au=!1}let hu;const du=new Xe("AllowMultipleToken");class pu{constructor(t,e){this.name=t,this.token=e}}function fu(t,e,n=[]){const i=`Platform: ${e}`,r=new Xe(i);return(e=[])=>{let s=mu();if(!s||s.injector.get(du,!1))if(t)t(n.concat(e).concat({provide:r,useValue:!0}));else{const t=n.concat(e).concat({provide:r,useValue:!0},{provide:ss,useValue:"platform"});!function(t){if(hu&&!hu.destroyed&&!hu.injector.get(du,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");hu=t.get(gu);const e=t.get(Ol,null);e&&e.forEach(t=>t())}(_s.create({providers:t,name:i}))}return function(t){const e=mu();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function mu(){return hu&&!hu.destroyed?hu:null}let gu=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new eu:("zone.js"===t?void 0:t)||new Kl({enableLongStackTrace:uu(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(e?e.ngZone:void 0,{ngZoneEventCoalescing:e&&e.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:e&&e.ngZoneRunCoalescing||!1}),i=[{provide:Kl,useValue:n}];return n.run(()=>{const r=_s.create({providers:i,parent:this.injector,name:t.moduleType.name}),s=t.create(r),o=s.injector.get(Hi,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{o.handleError(t)}});s.onDestroy(()=>{vu(this._modules,s),t.unsubscribe()})}),function(t,n,i){try{const e=i();return $s(e)?e.catch(e=>{throw n.runOutsideAngular(()=>t.handleError(e)),e}):e}catch(e){throw n.runOutsideAngular(()=>t.handleError(e)),e}}(o,n,()=>{const t=s.injector.get(Al);return t.runInitializers(),t.donePromise.then(()=>(Ho(s.injector.get(Fl,Bo)||Bo),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,e=[]){const n=yu({},e);return function(t,e,n){const i=new sl(n);return Promise.resolve(i)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(_u);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${c(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(vn(_s))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();function yu(t,e){return Array.isArray(e)?e.reduce(yu,t):Object.assign(Object.assign({},t),e)}let _u=(()=>{class t{constructor(t,e,n,i,r){this._zone=t,this._injector=e,this._exceptionHandler=n,this._componentFactoryResolver=i,this._initStatus=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const l=new s.y(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),u=new s.y(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{Kl.assertNotInAngularZone(),Gl(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Kl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=(0,o.T)(l,u.pipe((0,a.B)()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof ta?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const i=function(t){return t.isBoundToModule}(n)?void 0:this._injector.get(za),r=n.create(_s.NULL,[],e||n.selector,i),s=r.location.nativeElement,o=r.injector.get(nu,null),a=o&&r.injector.get(iu);return o&&a&&a.registerApplication(s,o),r.onDestroy(()=>{this.detachView(r.hostView),vu(this.components,r),a&&a.unregisterApplication(s)}),this._loadComponent(r),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;vu(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Ll,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(vn(Kl),vn(_s),vn(Hi),vn(ia),vn(Al))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();function vu(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class wu{}class bu{}const Tu={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Iu=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||Tu}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,i]=t.split("#");return void 0===i&&(i="default"),n(8255)(e).then(t=>t[i]).then(t=>Su(t,e,i)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,i]=t.split("#"),r="NgFactory";return void 0===i&&(i="default",r=""),n(8255)(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[i+r]).then(t=>Su(t,e,i))}}return t.\u0275fac=function(e){return new(e||t)(vn($l),vn(bu,8))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();function Su(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const Cu=function(t){return null},Eu=fu(null,"core",[{provide:Rl,useValue:"unknown"},{provide:gu,deps:[_s]},{provide:iu,deps:[]},{provide:Ml,deps:[]}]),xu=[{provide:_u,useClass:_u,deps:[Kl,_s,Hi,ia,Al]},{provide:tl,deps:[Kl],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Al,useClass:Al,deps:[[new Cn,kl]]},{provide:$l,useClass:$l,deps:[]},Nl,{provide:Ea,useFactory:function(){return La},deps:[]},{provide:ka,useFactory:function(){return Ma},deps:[]},{provide:Fl,useFactory:function(t){return Ho(t=t||"undefined"!=typeof $localize&&$localize.locale||Bo),t},deps:[[new Sn(Fl),new Cn,new En]]},{provide:Vl,useValue:"USD"}];let ku=(()=>{class t{constructor(t){}}return t.\u0275fac=function(e){return new(e||t)(vn(_u))},t.\u0275mod=et({type:t}),t.\u0275inj=T({providers:xu}),t})()},8939:function(t,e,n){"use strict";n.d(e,{hO:function(){return m},xv:function(){return h},Dh:function(){return c},GT:function(){return l},cc:function(){return g},on:function(){return d},pX:function(){return a}});var i=n(7716),r=n(2533),s=n(8445);t=n.hmd(t);const o=["ngOnDestroy"],a=(t,e,n,i={})=>new Proxy(t,{get:(r,s)=>n.runOutsideAngular(()=>{var r;if(t[s])return(null===(r=null==i?void 0:i.spy)||void 0===r?void 0:r.get)&&i.spy.get(s,t[s]),t[s];if(o.indexOf(s)>-1)return()=>{};const a=e.toPromise().then(t=>{const e=t&&t[s];return"function"==typeof e?e.bind(t):e&&e.then?e.then(t=>n.run(()=>t)):n.run(()=>e)});return new Proxy(()=>{},{get:(t,e)=>a[e],apply:(t,e,n)=>a.then(t=>{var e;const r=t&&t(...n);return(null===(e=null==i?void 0:i.spy)||void 0===e?void 0:e.apply)&&i.spy.apply(s,n,r),r})})})}),l=(t,e)=>{e.forEach(e=>{Object.getOwnPropertyNames(e.prototype||e).forEach(n=>{Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e.prototype||e,n))})})};class u{constructor(t){return t}}const c=new i.OlP("angularfire2.app.options"),h=new i.OlP("angularfire2.app.name");function d(e,n,i){const s="object"==typeof i&&i||{};s.name=s.name||"string"==typeof i&&i||"[DEFAULT]";const o=r.Z.apps.filter(t=>t&&t.name===s.name)[0]||n.runOutsideAngular(()=>r.Z.initializeApp(e,s));try{JSON.stringify(e)!==JSON.stringify(o.options)&&p("error",`${o.name} Firebase App already initialized with different options${t.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(a){}return new u(o)}const p=(t,...e)=>{(0,i.X6Q)()&&"undefined"!=typeof console&&console[t](...e)},f={provide:u,useFactory:d,deps:[c,i.R0b,[new i.FiY,h]]};let m=(()=>{class t{constructor(t){r.Z.registerVersion("angularfire",s.q4.full,"core"),r.Z.registerVersion("angularfire",s.q4.full,"app-compat"),r.Z.registerVersion("angular",i.q4F.full,t.toString())}static initializeApp(e,n){return{ngModule:t,providers:[{provide:c,useValue:e},{provide:h,useValue:n}]}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.Lbi))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[f]}),t})();function g(t,e,n,i,r){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(e=>e[0]===t)||[];if(s)return function(t,e){try{return t.toString()===e.toString()}catch(n){return t===e}}(r,o)||(_("error",`${e} was already initialized on the ${n} Firebase App with different settings.${y?" You may need to reload as Firebase is not HMR aware.":""}`),_("warn",{is:r,was:o})),s;{const e=i();return globalThis.\u0275AngularfireInstanceCache.push([t,e,r]),e}}const y=!!t.hot,_=(t,...e)=>{(0,i.X6Q)()&&"undefined"!=typeof console&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},8445:function(t,e,n){"use strict";n.d(e,{q4:function(){return qn},iC:function(){return ei},HU:function(){return Xn},vb:function(){return Kn},JM:function(){return Gn}});var i=n(7716),r=n(8213),s=n(8239),o=n(8026),a=n(3854),l=n(3910),u=n(5422),c=n(2373);const h="@firebase/installations",d="0.6.0",p=`w:${d}`,f="FIS_v2",m=new a.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function g(t){return t instanceof a.ZR&&t.code.includes("request-failed")}function y({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function _(t){return{token:t.token,requestStatus:2,expiresIn:C(t.expiresIn),creationTime:Date.now()}}function v(t,e){return w.apply(this,arguments)}function w(){return(w=(0,s.Z)(function*(t,e){const n=(yield e.json()).error;return m.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})})).apply(this,arguments)}function b({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function T(t,{refreshToken:e}){const n=b(t);return n.append("Authorization",function(t){return`${f} ${t}`}(e)),n}function I(t){return S.apply(this,arguments)}function S(){return(S=(0,s.Z)(function*(t){const e=yield t();return e.status>=500&&e.status<600?t():e})).apply(this,arguments)}function C(t){return Number(t.replace("s","000"))}function E(t,e){return x.apply(this,arguments)}function x(){return(x=(0,s.Z)(function*({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=y(t),r=b(t),s=e.getImmediate({optional:!0});if(s){const t=yield s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={method:"POST",headers:r,body:JSON.stringify({fid:n,authVersion:f,appId:t.appId,sdkVersion:p})},a=yield I(()=>fetch(i,o));if(a.ok){const t=yield a.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:_(t.authToken)}}throw yield v("Create Installation",a)})).apply(this,arguments)}function k(t){return new Promise(e=>{setTimeout(e,t)})}const A=/^[cdef][\w-]{21}$/;function P(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return function(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}(t).substr(0,22)}(t);return A.test(e)?e:""}catch(t){return""}}function N(t){return`${t.appName}!${t.appId}`}const D=new Map;function O(t,e){const n=N(t);R(n,e),function(t,e){const n=(!L&&"BroadcastChannel"in self&&(L=new BroadcastChannel("[Firebase] FID Change"),L.onmessage=t=>{R(t.data.key,t.data.fid)}),L);n&&n.postMessage({key:t,fid:e}),0===D.size&&L&&(L.close(),L=null)}(n,e)}function R(t,e){const n=D.get(t);if(n)for(const i of n)i(e)}let L=null;const M="firebase-installations-store";let F=null;function V(){return F||(F=(0,c.X3)("firebase-installations-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(M)}})),F}function U(t,e){return j.apply(this,arguments)}function j(){return(j=(0,s.Z)(function*(t,e){const n=N(t),i=(yield V()).transaction(M,"readwrite"),r=i.objectStore(M),s=yield r.get(n);return yield r.put(e,n),yield i.done,(!s||s.fid!==e.fid)&&O(t,e.fid),e})).apply(this,arguments)}function q(t){return z.apply(this,arguments)}function z(){return(z=(0,s.Z)(function*(t){const e=N(t),n=(yield V()).transaction(M,"readwrite");yield n.objectStore(M).delete(e),yield n.done})).apply(this,arguments)}function B(t,e){return Z.apply(this,arguments)}function Z(){return(Z=(0,s.Z)(function*(t,e){const n=N(t),i=(yield V()).transaction(M,"readwrite"),r=i.objectStore(M),s=yield r.get(n),o=e(s);return void 0===o?yield r.delete(n):yield r.put(o,n),yield i.done,o&&(!s||s.fid!==o.fid)&&O(t,o.fid),o})).apply(this,arguments)}function H(t){return $.apply(this,arguments)}function $(){return($=(0,s.Z)(function*(t){let e;const n=yield B(t.appConfig,n=>{const i=W(n),r=G(t,i);return e=r.registrationPromise,r.installationEntry});return""===n.fid?{installationEntry:yield e}:{installationEntry:n,registrationPromise:e}})).apply(this,arguments)}function W(t){return X(t||{fid:P(),registrationStatus:0})}function G(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(m.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function(t,e){return K.apply(this,arguments)}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Q(t)}:{installationEntry:e}}function K(){return(K=(0,s.Z)(function*(t,e){try{const n=yield E(t,e);return U(t.appConfig,n)}catch(n){throw g(n)&&409===n.customData.serverCode?yield q(t.appConfig):yield U(t.appConfig,{fid:e.fid,registrationStatus:0}),n}})).apply(this,arguments)}function Q(t){return Y.apply(this,arguments)}function Y(){return(Y=(0,s.Z)(function*(t){let e=yield J(t.appConfig);for(;1===e.registrationStatus;)yield k(100),e=yield J(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=yield H(t);return n||e}return e})).apply(this,arguments)}function J(t){return B(t,t=>{if(!t)throw m.create("installation-not-found");return X(t)})}function X(t){return function(t){return 1===t.registrationStatus&&t.registrationTime+1e4<Date.now()}(t)?{fid:t.fid,registrationStatus:0}:t}function tt(t,e){return et.apply(this,arguments)}function et(){return(et=(0,s.Z)(function*({appConfig:t,heartbeatServiceProvider:e},n){const i=nt(t,n),r=T(t,n),s=e.getImmediate({optional:!0});if(s){const t=yield s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={method:"POST",headers:r,body:JSON.stringify({installation:{sdkVersion:p,appId:t.appId}})},a=yield I(()=>fetch(i,o));if(a.ok)return _(yield a.json());throw yield v("Generate Auth Token",a)})).apply(this,arguments)}function nt(t,{fid:e}){return`${y(t)}/${e}/authTokens:generate`}function it(t){return rt.apply(this,arguments)}function rt(){return(rt=(0,s.Z)(function*(t,e=!1){let n;const i=yield B(t.appConfig,i=>{if(!ct(i))throw m.create("not-registered");const r=i.authToken;if(!e&&ht(r))return i;if(1===r.requestStatus)return n=st(t,e),i;{if(!navigator.onLine)throw m.create("app-offline");const e=dt(i);return n=lt(t,e),e}});return n?yield n:i.authToken})).apply(this,arguments)}function st(t,e){return ot.apply(this,arguments)}function ot(){return(ot=(0,s.Z)(function*(t,e){let n=yield at(t.appConfig);for(;1===n.authToken.requestStatus;)yield k(100),n=yield at(t.appConfig);const i=n.authToken;return 0===i.requestStatus?it(t,e):i})).apply(this,arguments)}function at(t){return B(t,t=>{if(!ct(t))throw m.create("not-registered");return function(t){return 1===t.requestStatus&&t.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function lt(t,e){return ut.apply(this,arguments)}function ut(){return(ut=(0,s.Z)(function*(t,e){try{const n=yield tt(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return yield U(t.appConfig,i),n}catch(n){if(!g(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield U(t.appConfig,n)}else yield q(t.appConfig);throw n}})).apply(this,arguments)}function ct(t){return void 0!==t&&2===t.registrationStatus}function ht(t){return 2===t.requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(t)}function dt(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function pt(){return(pt=(0,s.Z)(function*(t){const e=t,{installationEntry:n,registrationPromise:i}=yield H(e);return i?i.catch(console.error):it(e).catch(console.error),n.fid})).apply(this,arguments)}function ft(){return(ft=(0,s.Z)(function*(t,e=!1){const n=t;return yield mt(n),(yield it(n,e)).token})).apply(this,arguments)}function mt(t){return gt.apply(this,arguments)}function gt(){return(gt=(0,s.Z)(function*(t){const{registrationPromise:e}=yield H(t);e&&(yield e)})).apply(this,arguments)}function yt(t){return m.create("missing-app-config-values",{valueName:t})}const _t="installations";(0,o._registerComponent)(new l.wA(_t,t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw yt("App Configuration");if(!t.name)throw yt("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw yt(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,o._getProvider)(e,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),(0,o._registerComponent)(new l.wA("installations-internal",t=>{const e=t.getProvider("app").getImmediate(),n=(0,o._getProvider)(e,_t).getImmediate();return{getId:()=>function(t){return pt.apply(this,arguments)}(n),getToken:t=>function(t){return ft.apply(this,arguments)}(n,t)}},"PRIVATE")),(0,o.registerVersion)(h,d),(0,o.registerVersion)(h,d,"esm2017");const vt="@firebase/remote-config",wt=new a.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class bt{constructor(t,e,n,i){this.client=t,this.storage=e,this.storageCache=n,this.logger=i}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-e,i=n<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${i}.`),i}fetch(t){var e=this;return(0,s.Z)(function*(){const[n,i]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(i&&e.isCachedDataFresh(t.cacheMaxAgeMillis,n))return i;t.eTag=i&&i.eTag;const r=yield e.client.fetch(t),s=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===r.status&&s.push(e.storage.setLastSuccessfulFetchResponse(r)),yield Promise.all(s),r})()}}function Tt(t=navigator){return t.languages&&t.languages[0]||t.language}class It{constructor(t,e,n,i,r,s){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=i,this.apiKey=r,this.appId=s}fetch(t){var e=this;return(0,s.Z)(function*(){const[n,i]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),r=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},o={sdk_version:e.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:e.appId,language_code:Tt()},a={method:"POST",headers:s,body:JSON.stringify(o)},l=fetch(r,a),u=new Promise((e,n)=>{t.signal.addEventListener(()=>{const t=new Error("The operation was aborted.");t.name="AbortError",n(t)})});let c;try{yield Promise.race([l,u]),c=yield l}catch(m){let t="fetch-client-network";throw"AbortError"===(null==m?void 0:m.name)&&(t="fetch-timeout"),wt.create(t,{originalErrorMessage:null==m?void 0:m.message})}let h=c.status;const d=c.headers.get("ETag")||void 0;let p,f;if(200===c.status){let t;try{t=yield c.json()}catch(g){throw wt.create("fetch-client-parse",{originalErrorMessage:null==g?void 0:g.message})}p=t.entries,f=t.state}if("INSTANCE_STATE_UNSPECIFIED"===f?h=500:"NO_CHANGE"===f?h=304:("NO_TEMPLATE"===f||"EMPTY_CONFIG"===f)&&(p={}),304!==h&&200!==h)throw wt.create("fetch-status",{httpStatus:h});return{status:h,eTag:d,config:p}})()}}class St{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return(0,s.Z)(function*(){const n=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,n)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:n}){var i=this;return(0,s.Z)(function*(){yield function(t,e){return new Promise((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(s),i(wt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(t.signal,e);try{const e=yield i.client.fetch(t);return yield i.storage.deleteThrottleMetadata(),e}catch(r){if(!function(t){if(!(t instanceof a.ZR&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(r))throw r;const e={throttleEndTimeMillis:Date.now()+(0,a.$s)(n),backoffCount:n+1};return yield i.storage.setThrottleMetadata(e),i.attemptFetch(t,e)}})()}}class Ct{constructor(t,e,n,i,r){this.app=t,this._client=e,this._storageCache=n,this._storage=i,this._logger=r,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Et(t,e){const n=t.target.error||void 0;return wt.create(e,{originalErrorMessage:n&&(null==n?void 0:n.message)})}const xt="app_namespace_store";class kt{constructor(t,e,n,i=function(){return new Promise((t,n)=>{try{const e=indexedDB.open("firebase_remote_config",1);e.onerror=t=>{n(Et(t,"storage-open"))},e.onsuccess=e=>{t(e.target.result)},e.onupgradeneeded=t=>{0===t.oldVersion&&t.target.result.createObjectStore(xt,{keyPath:"compositeKey"})}}catch(e){n(wt.create("storage-open",{originalErrorMessage:null==e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return(0,s.Z)(function*(){const n=yield e.openDbPromise;return new Promise((i,r)=>{const s=n.transaction([xt],"readonly").objectStore(xt),o=e.createCompositeKey(t);try{const t=s.get(o);t.onerror=t=>{r(Et(t,"storage-get"))},t.onsuccess=t=>{const e=t.target.result;i(e?e.value:void 0)}}catch(a){r(wt.create("storage-get",{originalErrorMessage:null==a?void 0:a.message}))}})})()}set(t,e){var n=this;return(0,s.Z)(function*(){const i=yield n.openDbPromise;return new Promise((r,s)=>{const o=i.transaction([xt],"readwrite").objectStore(xt),a=n.createCompositeKey(t);try{const t=o.put({compositeKey:a,value:e});t.onerror=t=>{s(Et(t,"storage-set"))},t.onsuccess=()=>{r()}}catch(l){s(wt.create("storage-set",{originalErrorMessage:null==l?void 0:l.message}))}})})()}delete(t){var e=this;return(0,s.Z)(function*(){const n=yield e.openDbPromise;return new Promise((i,r)=>{const s=n.transaction([xt],"readwrite").objectStore(xt),o=e.createCompositeKey(t);try{const t=s.delete(o);t.onerror=t=>{r(Et(t,"storage-delete"))},t.onsuccess=()=>{i()}}catch(a){r(wt.create("storage-delete",{originalErrorMessage:null==a?void 0:a.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class At{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return(0,s.Z)(function*(){const e=t.storage.getLastFetchStatus(),n=t.storage.getLastSuccessfulFetchTimestampMillis(),i=t.storage.getActiveConfig(),r=yield e;r&&(t.lastFetchStatus=r);const s=yield n;s&&(t.lastSuccessfulFetchTimestampMillis=s);const o=yield i;o&&(t.activeConfig=o)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function Pt(){return Nt.apply(this,arguments)}function Nt(){return(Nt=(0,s.Z)(function*(){if(!(0,a.hl)())return!1;try{return yield(0,a.eu)()}catch(t){return!1}})).apply(this,arguments)}(0,o._registerComponent)(new l.wA("remote-config",function(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),i=t.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw wt.create("registration-window");if(!(0,a.hl)())throw wt.create("indexed-db-unavailable");const{projectId:r,apiKey:s,appId:l}=n.options;if(!r)throw wt.create("registration-project-id");if(!s)throw wt.create("registration-api-key");if(!l)throw wt.create("registration-app-id");const c=new kt(l,n.name,e=e||"firebase"),h=new At(c),d=new u.Yd(vt);d.logLevel=u.in.ERROR;const p=new It(i,o.SDK_VERSION,e,r,s,l),f=new St(p,c),m=new bt(f,c,h,d),g=new Ct(n,m,h,c,d);return function(t){const e=(0,a.m9)(t);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(g),g},"PUBLIC").setMultipleInstances(!0)),(0,o.registerVersion)(vt,"0.4.0"),(0,o.registerVersion)(vt,"0.4.0","esm2017");const Dt="/firebase-messaging-sw.js",Ot="/firebase-cloud-messaging-push-scope",Rt="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Lt="google.c.a.c_id",Mt="google.c.a.c_l",Ft="google.c.a.ts",Vt="google.c.a.e";var Ut=(()=>{return(t=Ut||(Ut={})).PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked",Ut;var t})();function jt(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function qt(t){const e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),i=new Uint8Array(n.length);for(let r=0;r<n.length;++r)i[r]=n.charCodeAt(r);return i}const zt="fcm_token_details_db",Bt="fcm_token_object_Store";function Zt(t){return Ht.apply(this,arguments)}function Ht(){return Ht=(0,s.Z)(function*(t){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(t=>t.name).includes(zt))return null;let e=null;return(yield(0,c.X3)(zt,5,{upgrade:(n=(0,s.Z)(function*(n,i,r,s){var o;if(i<2||!n.objectStoreNames.contains(Bt))return;const a=s.objectStore(Bt),l=yield a.index("fcmSenderId").get(t);if(yield a.clear(),l)if(2===i){const t=l;if(!t.auth||!t.p256dh||!t.endpoint)return;e={token:t.fcmToken,createTime:null!==(o=t.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:t.auth,p256dh:t.p256dh,endpoint:t.endpoint,swScope:t.swScope,vapidKey:"string"==typeof t.vapidKey?t.vapidKey:jt(t.vapidKey)}}}else if(3===i){const t=l;e={token:t.fcmToken,createTime:t.createTime,subscriptionOptions:{auth:jt(t.auth),p256dh:jt(t.p256dh),endpoint:t.endpoint,swScope:t.swScope,vapidKey:jt(t.vapidKey)}}}else if(4===i){const t=l;e={token:t.fcmToken,createTime:t.createTime,subscriptionOptions:{auth:jt(t.auth),p256dh:jt(t.p256dh),endpoint:t.endpoint,swScope:t.swScope,vapidKey:jt(t.vapidKey)}}}}),function(t,e,i,r){return n.apply(this,arguments)})})).close(),yield(0,c.Lj)(zt),yield(0,c.Lj)("fcm_vapid_details_db"),yield(0,c.Lj)("undefined"),$t(e)?e:null;var n}),Ht.apply(this,arguments)}function $t(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}const Wt="firebase-messaging-store";let Gt=null;function Kt(){return Gt||(Gt=(0,c.X3)("firebase-messaging-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(Wt)}})),Gt}function Qt(t){return Yt.apply(this,arguments)}function Yt(){return(Yt=(0,s.Z)(function*(t){const e=ne(t),n=yield(yield Kt()).transaction(Wt).objectStore(Wt).get(e);if(n)return n;{const e=yield Zt(t.appConfig.senderId);if(e)return yield Jt(t,e),e}})).apply(this,arguments)}function Jt(t,e){return Xt.apply(this,arguments)}function Xt(){return(Xt=(0,s.Z)(function*(t,e){const n=ne(t),i=(yield Kt()).transaction(Wt,"readwrite");return yield i.objectStore(Wt).put(e,n),yield i.done,e})).apply(this,arguments)}function te(t){return ee.apply(this,arguments)}function ee(){return(ee=(0,s.Z)(function*(t){const e=ne(t),n=(yield Kt()).transaction(Wt,"readwrite");yield n.objectStore(Wt).delete(e),yield n.done})).apply(this,arguments)}function ne({appConfig:t}){return t.appId}const ie=new a.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function re(t,e){return se.apply(this,arguments)}function se(){return(se=(0,s.Z)(function*(t,e){const n=yield he(t),i=pe(e),r={method:"POST",headers:n,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(ce(t.appConfig),r)).json()}catch(o){throw ie.create("token-subscribe-failed",{errorInfo:null==o?void 0:o.toString()})}if(s.error)throw ie.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw ie.create("token-subscribe-no-token");return s.token})).apply(this,arguments)}function oe(t,e){return ae.apply(this,arguments)}function ae(){return(ae=(0,s.Z)(function*(t,e){const n=yield he(t),i=pe(e.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(`${ce(t.appConfig)}/${e.token}`,r)).json()}catch(o){throw ie.create("token-update-failed",{errorInfo:null==o?void 0:o.toString()})}if(s.error)throw ie.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw ie.create("token-update-no-token");return s.token})).apply(this,arguments)}function le(t,e){return ue.apply(this,arguments)}function ue(){return(ue=(0,s.Z)(function*(t,e){const n={method:"DELETE",headers:yield he(t)};try{const i=yield(yield fetch(`${ce(t.appConfig)}/${e}`,n)).json();if(i.error)throw ie.create("token-unsubscribe-failed",{errorInfo:i.error.message})}catch(i){throw ie.create("token-unsubscribe-failed",{errorInfo:null==i?void 0:i.toString()})}})).apply(this,arguments)}function ce({projectId:t}){return`https://fcmregistrations.googleapis.com/v1/projects/${t}/registrations`}function he(t){return de.apply(this,arguments)}function de(){return(de=(0,s.Z)(function*({appConfig:t,installations:e}){const n=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})})).apply(this,arguments)}function pe({p256dh:t,auth:e,endpoint:n,vapidKey:i}){const r={web:{endpoint:n,auth:e,p256dh:t}};return i!==Rt&&(r.web.applicationPubKey=i),r}const fe=6048e5;function me(t){return ge.apply(this,arguments)}function ge(){return(ge=(0,s.Z)(function*(t){const e=yield Ie(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:jt(e.getKey("auth")),p256dh:jt(e.getKey("p256dh"))},i=yield Qt(t.firebaseDependencies);if(i){if(Ce(i.subscriptionOptions,n))return Date.now()>=i.createTime+fe?ve(t,{token:i.token,createTime:Date.now(),subscriptionOptions:n}):i.token;try{yield le(t.firebaseDependencies,i.token)}catch(r){console.warn(r)}return be(t.firebaseDependencies,n)}return be(t.firebaseDependencies,n)})).apply(this,arguments)}function ye(t){return _e.apply(this,arguments)}function _e(){return(_e=(0,s.Z)(function*(t){const e=yield Qt(t.firebaseDependencies);e&&(yield le(t.firebaseDependencies,e.token),yield te(t.firebaseDependencies));const n=yield t.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()})).apply(this,arguments)}function ve(t,e){return we.apply(this,arguments)}function we(){return(we=(0,s.Z)(function*(t,e){try{const n=yield oe(t.firebaseDependencies,e),i=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return yield Jt(t.firebaseDependencies,i),n}catch(n){throw yield ye(t),n}})).apply(this,arguments)}function be(t,e){return Te.apply(this,arguments)}function Te(){return(Te=(0,s.Z)(function*(t,e){const n={token:yield re(t,e),createTime:Date.now(),subscriptionOptions:e};return yield Jt(t,n),n.token})).apply(this,arguments)}function Ie(t,e){return Se.apply(this,arguments)}function Se(){return(Se=(0,s.Z)(function*(t,e){return(yield t.pushManager.getSubscription())||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:qt(e)})})).apply(this,arguments)}function Ce(t,e){return e.vapidKey===t.vapidKey&&e.endpoint===t.endpoint&&e.auth===t.auth&&e.p256dh===t.p256dh}function Ee(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return function(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const i=e.notification.body;i&&(t.notification.body=i);const r=e.notification.image;r&&(t.notification.image=r);const s=e.notification.icon;s&&(t.notification.icon=s)}(e,t),function(t,e){!e.data||(t.data=e.data)}(e,t),function(t,e){var n,i,r,s,o;if(!e.fcmOptions&&!(null===(n=e.notification)||void 0===n?void 0:n.click_action))return;t.fcmOptions={};const a=null!==(r=null===(i=e.fcmOptions)||void 0===i?void 0:i.link)&&void 0!==r?r:null===(s=e.notification)||void 0===s?void 0:s.click_action;a&&(t.fcmOptions.link=a);const l=null===(o=e.fcmOptions)||void 0===o?void 0:o.analytics_label;l&&(t.fcmOptions.analyticsLabel=l)}(e,t),e}function xe(t){return"object"==typeof t&&!!t&&Lt in t}function ke(t,e){const n=[];for(let i=0;i<t.length;i++)n.push(t.charAt(i)),i<e.length&&n.push(e.charAt(i));return n.join("")}function Ae(t){return ie.create("missing-app-config-values",{valueName:t})}ke("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ke("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Pe{constructor(t,e,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function(t){if(!t||!t.options)throw Ae("App Configuration Object");if(!t.name)throw Ae("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const i of e)if(!n[i])throw Ae(i);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:e,analyticsProvider:n}}_delete(){return Promise.resolve()}}function Ne(t){return De.apply(this,arguments)}function De(){return(De=(0,s.Z)(function*(t){try{t.swRegistration=yield navigator.serviceWorker.register(Dt,{scope:Ot}),t.swRegistration.update().catch(()=>{})}catch(e){throw ie.create("failed-service-worker-registration",{browserErrorMessage:null==e?void 0:e.message})}})).apply(this,arguments)}function Oe(t,e){return Re.apply(this,arguments)}function Re(){return(Re=(0,s.Z)(function*(t,e){if(!e&&!t.swRegistration&&(yield Ne(t)),e||!t.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw ie.create("invalid-sw-registration");t.swRegistration=e}})).apply(this,arguments)}function Le(t,e){return Me.apply(this,arguments)}function Me(){return(Me=(0,s.Z)(function*(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=Rt)})).apply(this,arguments)}function Fe(){return(Fe=(0,s.Z)(function*(t,e){if(!navigator)throw ie.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw ie.create("permission-blocked");return yield Le(t,null==e?void 0:e.vapidKey),yield Oe(t,null==e?void 0:e.serviceWorkerRegistration),me(t)})).apply(this,arguments)}function Ve(t,e,n){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,s.Z)(function*(t,e,n){const i=je(e);(yield t.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:n[Lt],message_name:n[Mt],message_time:n[Ft],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function je(t){switch(t){case Ut.NOTIFICATION_CLICKED:return"notification_open";case Ut.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function qe(){return(qe=(0,s.Z)(function*(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Ut.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(Ee(n)):t.onMessageHandler.next(Ee(n)));const i=n.data;xe(i)&&"1"===i[Vt]&&(yield Ve(t,n.messageType,i))})).apply(this,arguments)}const ze="@firebase/messaging";function Be(){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,s.Z)(function*(){try{yield(0,a.eu)()}catch(t){return!1}return"undefined"!=typeof window&&(0,a.hl)()&&(0,a.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}(0,o._registerComponent)(new l.wA("messaging",t=>{const e=new Pe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function(t,e){return qe.apply(this,arguments)}(e,t)),e},"PUBLIC")),(0,o._registerComponent)(new l.wA("messaging-internal",t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:t=>function(t,e){return Fe.apply(this,arguments)}(e,t)}},"PRIVATE")),(0,o.registerVersion)(ze,"0.12.0"),(0,o.registerVersion)(ze,"0.12.0","esm2017");const He="analytics",$e="firebase_id",We="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ge="https://www.googletagmanager.com/gtag/js",Ke=new u.Yd("@firebase/analytics");function Qe(t){return Promise.all(t.map(t=>t.catch(t=>t)))}function Ye(t,e){const n=document.createElement("script");n.src=`${Ge}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function Je(t,e,n,i,r,s){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,s.Z)(function*(t,e,n,i,r,s){const o=i[r];try{if(o)yield e[o];else{const t=(yield Qe(n)).find(t=>t.measurementId===r);t&&(yield e[t.appId])}}catch(a){Ke.error(a)}t("config",r,s)})).apply(this,arguments)}function tn(t,e,n,i,r){return en.apply(this,arguments)}function en(){return(en=(0,s.Z)(function*(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const i=yield Qe(n);for(const n of t){const t=i.find(t=>t.measurementId===n),r=t&&e[t.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),t("event",i,r||{})}catch(s){Ke.error(s)}})).apply(this,arguments)}function nn(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Ge)&&n.src.includes(t))return n;return null}const rn=new a.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),sn=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function on(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function an(t){return ln.apply(this,arguments)}function ln(){return(ln=(0,s.Z)(function*(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:on(i)},s=We.replace("{app-id}",n),o=yield fetch(s,r);if(200!==o.status&&304!==o.status){let t="";try{const n=yield o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(a){}throw rn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()})).apply(this,arguments)}function un(t){return cn.apply(this,arguments)}function cn(){return(cn=(0,s.Z)(function*(t,e=sn,n){const{appId:i,apiKey:r,measurementId:o}=t.options;if(!i)throw rn.create("no-app-id");if(!r){if(o)return{measurementId:o,appId:i};throw rn.create("no-api-key")}const a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new mn;return setTimeout((0,s.Z)(function*(){l.abort()}),void 0!==n?n:6e4),hn({appId:i,apiKey:r,measurementId:o},a,l,e)})).apply(this,arguments)}function hn(t,e,n){return dn.apply(this,arguments)}function dn(){return(dn=(0,s.Z)(function*(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=sn){var s;const{appId:o,measurementId:l}=t;try{yield pn(i,e)}catch(u){if(l)return Ke.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null==u?void 0:u.message}]`),{appId:o,measurementId:l};throw u}try{const e=yield an(t);return r.deleteThrottleMetadata(o),e}catch(u){const e=u;if(!fn(e)){if(r.deleteThrottleMetadata(o),l)return Ke.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:l};throw u}const c=503===Number(null===(s=null==e?void 0:e.customData)||void 0===s?void 0:s.httpStatus)?(0,a.$s)(n,r.intervalMillis,30):(0,a.$s)(n,r.intervalMillis),h={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return r.setThrottleMetadata(o,h),Ke.debug(`Calling attemptFetch again in ${c} millis`),hn(t,h,i,r)}})).apply(this,arguments)}function pn(t,e){return new Promise((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(s),i(rn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function fn(t){if(!(t instanceof a.ZR&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}class mn{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let gn,yn;function _n(){return(_n=(0,s.Z)(function*(t,e,n,i,r){if(r&&r.global)t("event",n,i);else{const r=yield e;t("event",n,Object.assign(Object.assign({},i),{send_to:r}))}})).apply(this,arguments)}function vn(t){yn=t}function wn(t){gn=t}function bn(){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,s.Z)(function*(){if(!(0,a.hl)())return Ke.warn(rn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,a.eu)()}catch(t){return Ke.warn(rn.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0})).apply(this,arguments)}function In(){return(In=(0,s.Z)(function*(t,e,n,i,r,s,o){var a;const l=un(t);l.then(e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Ke.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(t=>Ke.error(t)),e.push(l);const u=bn().then(t=>{if(t)return i.getId()}),[c,h]=yield Promise.all([l,u]);nn(s)||Ye(s,c.measurementId),yn&&(r("consent","default",yn),vn(void 0)),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d[$e]=h),r("config",c.measurementId,d),gn&&(r("set",gn),wn(void 0)),c.measurementId})).apply(this,arguments)}class Sn{constructor(t){this.app=t}_delete(){return delete Cn[this.app.options.appId],Promise.resolve()}}let Cn={},En=[];const xn={};let kn,An,Pn="dataLayer",Nn=!1;function Dn(t,e,n){!function(){const t=[];if((0,a.ru)()&&t.push("This is a browser extension environment."),(0,a.zI)()||t.push("Cookies are not available."),t.length>0){const e=t.map((t,e)=>`(${e+1}) ${t}`).join(" "),n=rn.create("invalid-analytics-context",{errorInfo:e});Ke.warn(n.message)}}();const i=t.options.appId;if(!i)throw rn.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw rn.create("no-api-key");Ke.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Cn[i])throw rn.create("already-exists",{id:i});if(!Nn){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Pn);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,r){let o=function(...t){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(o=window[r]),window[r]=function(t,e,n,i){function r(){return(r=(0,s.Z)(function*(r,s,o){try{"event"===r?yield tn(t,e,n,s,o):"config"===r?yield Je(t,e,n,i,s,o):"consent"===r?t("consent","update",o):t("set",s)}catch(a){Ke.error(a)}})).apply(this,arguments)}return function(t,e,n){return r.apply(this,arguments)}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[r]}}(Cn,En,xn,Pn,"gtag");An=t,kn=e,Nn=!0}return Cn[i]=function(t,e,n,i,r,s,o){return In.apply(this,arguments)}(t,En,xn,e,kn,Pn,n),new Sn(t)}function On(){return Rn.apply(this,arguments)}function Rn(){return(Rn=(0,s.Z)(function*(){if((0,a.ru)()||!(0,a.zI)()||!(0,a.hl)())return!1;try{return yield(0,a.eu)()}catch(t){return!1}})).apply(this,arguments)}const Ln="@firebase/analytics";(0,o._registerComponent)(new l.wA(He,(t,{options:e})=>Dn(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),(0,o._registerComponent)(new l.wA("analytics-internal",function(t){try{const e=t.getProvider(He).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=(0,a.m9)(t),function(t,e,n,i,r){return _n.apply(this,arguments)}(An,Cn[t.app.options.appId],e,n,i).catch(t=>Ke.error(t))}(e,t,n,i)}}catch(e){throw rn.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),(0,o.registerVersion)(Ln,"0.9.0"),(0,o.registerVersion)(Ln,"0.9.0","esm2017");var Mn=n(7771),Fn=n(3637),Vn=n(3342),Un=n(3101),jn=n(309);const qn=new i.GfV("7.5.0"),zn="__angularfire_symbol__analyticsIsSupportedValue",Bn="__angularfire_symbol__analyticsIsSupported",Zn="__angularfire_symbol__remoteConfigIsSupportedValue",Hn="__angularfire_symbol__remoteConfigIsSupported",$n="__angularfire_symbol__messagingIsSupportedValue",Wn="__angularfire_symbol__messagingIsSupported";function Gn(t,e,n){if(e){if(1===e.length)return e[0];const t=e.filter(t=>t.app===n);if(1===t.length)return t[0]}return n.container.getProvider(t).getImmediate({optional:!0})}globalThis[Bn]||(globalThis[Bn]=On().then(t=>globalThis[zn]=t).catch(()=>globalThis[zn]=!1)),globalThis[Wn]||(globalThis[Wn]=Be().then(t=>globalThis[$n]=t).catch(()=>globalThis[$n]=!1)),globalThis[Hn]||(globalThis[Hn]=Pt().then(t=>globalThis[Zn]=t).catch(()=>globalThis[Zn]=!1));const Kn=(t,e)=>{const n=e?[e]:(0,r.C6)(),i=[];return n.forEach(e=>{e.container.getProvider(t).instances.forEach(t=>{i.includes(t)||i.push(t)})}),i};function Qn(){}class Yn{constructor(t,e=Mn.N){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,n){const i=this.zone;return this.delegate.schedule(function(e){i.runGuarded(()=>{t.apply(this,[e])})},e,n)}}class Jn{constructor(t){this.zone=t,this.task=null}call(t,e){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Qn,{},Qn,Qn)),e.pipe((0,Vn.b)({next:n,complete:n,error:n})).subscribe(t).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Xn=(()=>{class t{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Yn(Zone.current)),this.insideAngular=t.run(()=>new Yn(Zone.current,Fn.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.R0b))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ti(){const t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return t}function ei(t){return ti(),function(t){return function(e){return(e=e.lift(new Jn(t.ngZone))).pipe((0,Un.R)(t.outsideAngular),(0,jn.QV)(t.insideAngular))}}(ti())(t)}},3854:function(t,e,n){"use strict";n.d(e,{BH:function(){return k},LL:function(){return N},ZR:function(){return P},gQ:function(){return W},zI:function(){return S},hu:function(){return i},g5:function(){return r},US:function(){return o},tV:function(){return u},h$:function(){return a},L:function(){return l},$s:function(){return it},r3:function(){return V},Sg:function(){return A},ne:function(){return G},p$:function(){return c},vZ:function(){return z},ZB:function(){return h},gK:function(){return J},pd:function(){return $},aH:function(){return E},Pz:function(){return x},m9:function(){return rt},z$:function(){return p},GJ:function(){return F},jU:function(){return g},ru:function(){return y},xb:function(){return j},w1:function(){return v},hl:function(){return T},uI:function(){return f},UG:function(){return m},Yr:function(){return w},b$:function(){return _},G6:function(){return b},w9:function(){return M},cI:function(){return O},UI:function(){return q},xO:function(){return Z},zd:function(){return H},DV:function(){return U},ug:function(){return nt},dS:function(){return et},Wl:function(){return R},Dv:function(){return Y},Wj:function(){return X},lb:function(){return tt},eu:function(){return I}});const i=function(t,e){if(!t)throw r(e)},r=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},s=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){const e=t[r],s=r+1<t.length,o=s?t[r+1]:0,a=r+2<t.length,l=a?t[r+2]:0;let u=(15&o)<<2|l>>6,c=63&l;a||(c=64,s||(u=64)),i.push(n[e>>2],n[(3&e)<<4|o>>4],n[u],n[c])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){const e=n[t.charAt(r++)],s=r<t.length?n[t.charAt(r)]:0;++r;const o=r<t.length?n[t.charAt(r)]:64;++r;const a=r<t.length?n[t.charAt(r)]:64;if(++r,null==e||null==s||null==o||null==a)throw Error();i.push(e<<2|s>>4),64!==o&&(i.push(s<<4&240|o>>2),64!==a&&i.push(o<<6&192|a))}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},a=function(t){const e=s(t);return o.encodeByteArray(e,!0)},l=function(t){return a(t).replace(/\./g,"")},u=function(t){try{return o.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function c(t){return h(void 0,t)}function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!d(n)||(t[n]=h(t[n],e[n]));return t}function d(t){return"__proto__"!==t}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())}function m(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}function g(){return"object"==typeof self&&self.self===self}function y(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function _(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function v(){const t=p();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function w(){return!1}function b(){return!m()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function T(){try{return"object"==typeof indexedDB}catch(t){return!1}}function I(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}})}function S(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}const C=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const e=t&&u(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},E=()=>{var t;return null===(t=C())||void 0===t?void 0:t.config},x=t=>{var e;return null===(e=C())||void 0===e?void 0:e[`_${t}`]};class k{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function A(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")}class P extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,P.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N.prototype.create)}}class N{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(D,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(r,n):"Error";return new P(i,`${this.serviceName}: ${s} (${i}).`,n)}}const D=/\{\$([^}]+)}/g;function O(t){return JSON.parse(t)}function R(t){return JSON.stringify(t)}const L=function(t){let e={},n={},i={},r="";try{const s=t.split(".");e=O(u(s[0])||""),n=O(u(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(s){}return{header:e,claims:n,data:i,signature:r}},M=function(t){const e=L(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},F=function(t){const e=L(t).claims;return"object"==typeof e&&!0===e.admin};function V(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function U(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function j(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function q(t,e,n){const i={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function z(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(B(n)&&B(s)){if(!z(n,s))return!1}else if(n!==s)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function B(t){return null!==t&&"object"==typeof t}function Z(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function H(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}}),e}function $(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class W{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const n=this.W_;if("string"==typeof t)for(let c=0;c<16;c++)n[c]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let c=0;c<16;c++)n[c]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let c=16;c<80;c++){const t=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=4294967295&(t<<1|t>>>31)}let i,r,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],u=this.chain_[4];for(let c=0;c<80;c++){c<40?c<20?(i=l^o&(a^l),r=1518500249):(i=o^a^l,r=1859775393):c<60?(i=o&a|l&(o|a),r=2400959708):(i=o^a^l,r=3395469782);const t=(s<<5|s>>>27)+i+u+r+n[c]&4294967295;u=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const n=e-this.blockSize;let i=0;const r=this.buf_;let s=this.inbuf_;for(;i<e;){if(0===s)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(r[s]=t.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<e;)if(r[s]=t[i],++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&e,e/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let e=24;e>=0;e-=8)t[n]=this.chain_[i]>>e&255,++n;return t}}function G(t,e){const n=new K(t,e);return n.subscribe.bind(n)}class K{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=Q),void 0===i.error&&(i.error=Q),void 0===i.complete&&(i.complete=Q);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}}),this.observers.push(i),r}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Q(){}const Y=function(t,e,n,i){let r;if(i<e?r="at least "+e:i>n&&(r=0===n?"none":"no more than "+n),r)throw new Error(t+" failed: Was called with "+i+(1===i?" argument.":" arguments.")+" Expects "+r+".")};function J(t,e){return`${t} failed: ${e} argument `}function X(t,e,n,i){if((!i||n)&&"function"!=typeof n)throw new Error(J(t,e)+"must be a valid function.")}function tt(t,e,n,i){if((!i||n)&&("object"!=typeof n||null===n))throw new Error(J(t,e)+"must be a valid context object.")}const et=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const e=s-55296;r++,i(r<t.length,"Surrogate pair missing trail surrogate."),s=65536+(e<<10)+(t.charCodeAt(r)-56320)}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},nt=function(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};function it(t,e=1e3,n=2){const i=e*Math.pow(n,t),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function rt(t){return t&&t._delegate?t._delegate:t}},4216:function(t,e){!function(t){"use strict";function e(t){var e,n,i,r;for(n=1,i=arguments.length;n<i;n++)for(e in r=arguments[n])t[e]=r[e];return t}var n=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function i(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}var r=0;function s(t){return"_leaflet_id"in t||(t._leaflet_id=++r),t._leaflet_id}function o(t,e,n){var i,r,s,o;return o=function(){i=!1,r&&(s.apply(n,r),r=!1)},s=function(){i?r=arguments:(t.apply(n,arguments),setTimeout(o,e),i=!0)},s}function a(t,e,n){var i=e[1],r=e[0],s=i-r;return t===i&&n?t:((t-r)%s+s)%s+r}function l(){return!1}function u(t,e){if(!1===e)return t;var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function c(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function h(t){return c(t).split(/\s+/)}function d(t,e){for(var i in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?n(t.options):{}),e)t.options[i]=e[i];return t.options}function p(t,e,n){var i=[];for(var r in t)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}var f=/\{ *([\w_ -]+) *\}/g;function m(t,e){return t.replace(f,function(t,n){var i=e[n];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i})}var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function y(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var _="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function v(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var w=0;function b(t){var e=+new Date,n=Math.max(0,16-(e-w));return w=e+n,window.setTimeout(t,n)}var T=window.requestAnimationFrame||v("RequestAnimationFrame")||b,I=window.cancelAnimationFrame||v("CancelAnimationFrame")||v("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function S(t,e,n){if(!n||T!==b)return T.call(window,i(t,e));t.call(e)}function C(t){t&&I.call(window,t)}var E={__proto__:null,extend:e,create:n,bind:i,get lastId(){return r},stamp:s,throttle:o,wrapNum:a,falseFn:l,formatNum:u,trim:c,splitWords:h,setOptions:d,getParamString:p,template:m,isArray:g,indexOf:y,emptyImageUrl:_,requestFn:T,cancelFn:I,requestAnimFrame:S,cancelAnimFrame:C};function x(){}x.extend=function(t){var i=function(){d(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},r=i.__super__=this.prototype,s=n(r);for(var o in s.constructor=i,i.prototype=s,this)Object.prototype.hasOwnProperty.call(this,o)&&"prototype"!==o&&"__super__"!==o&&(i[o]=this[o]);return t.statics&&e(i,t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=g(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),e.apply(null,[s].concat(t.includes))),e(s,t),delete s.statics,delete s.includes,s.options&&(s.options=r.options?n(r.options):{},e(s.options,t.options)),s._initHooks=[],s.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=s._initHooks.length;t<e;t++)s._initHooks[t].call(this)}},i},x.include=function(t){var n=this.prototype.options;return e(this.prototype,t),t.options&&(this.prototype.options=n,this.mergeOptions(t.options)),this},x.mergeOptions=function(t){return e(this.prototype.options,t),this},x.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var k={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var r=0,s=(t=h(t)).length;r<s;r++)this._on(t[r],e,n);return this},off:function(t,e,n){if(arguments.length)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else{t=h(t);for(var r=1===arguments.length,s=0,o=t.length;s<o;s++)r?this._off(t[s]):this._off(t[s],e,n)}else delete this._events;return this},_on:function(t,e,n,i){if("function"==typeof e){if(!1===this._listens(t,e,n)){n===this&&(n=void 0);var r={fn:e,ctx:n};i&&(r.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(r)}}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,n){var i,r,s;if(this._events&&(i=this._events[t])){if(1===arguments.length){if(this._firingCount)for(r=0,s=i.length;r<s;r++)i[r].fn=l;return void delete this._events[t]}if("function"!=typeof e)return void console.warn("wrong listener type: "+typeof e);var o=this._listens(t,e,n);!1!==o&&(this._firingCount&&(i[o].fn=l,this._events[t]=i=i.slice()),i.splice(o,1))}},fire:function(t,n,i){if(!this.listens(t,i))return this;var r=e({},n,{type:t,target:this,sourceTarget:n&&n.sourceTarget||this});if(this._events){var s=this._events[t];if(s){this._firingCount=this._firingCount+1||1;for(var o=0,a=s.length;o<a;o++){var l=s[o],u=l.fn;l.once&&this.off(t,u,l.ctx),u.call(l.ctx||this,r)}this._firingCount--}}return i&&this._propagateEvent(r),this},listens:function(t,e,n,i){"string"!=typeof t&&console.warn('"string" type argument expected');var r=e;"function"!=typeof e&&(i=!!e,r=void 0,n=void 0);var s=this._events&&this._events[t];if(s&&s.length&&!1!==this._listens(t,r,n))return!0;if(i)for(var o in this._eventParents)if(this._eventParents[o].listens(t,e,n,i))return!0;return!1},_listens:function(t,e,n){if(!this._events)return!1;var i=this._events[t]||[];if(!e)return!!i.length;n===this&&(n=void 0);for(var r=0,s=i.length;r<s;r++)if(i[r].fn===e&&i[r].ctx===n)return r;return!1},once:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e,!0);else for(var r=0,s=(t=h(t)).length;r<s;r++)this._on(t[r],e,n,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[s(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[s(t)],this},_propagateEvent:function(t){for(var n in this._eventParents)this._eventParents[n].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};k.addEventListener=k.on,k.removeEventListener=k.clearAllEventListeners=k.off,k.addOneTimeEventListener=k.once,k.fireEvent=k.fire,k.hasEventListeners=k.listens;var A=x.extend(k);function P(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var N=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function D(t,e,n){return t instanceof P?t:g(t)?new P(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new P(t.x,t.y):new P(t,e,n)}function O(t,e){if(t)for(var n=e?[t,e]:t,i=0,r=n.length;i<r;i++)this.extend(n[i])}function R(t,e){return!t||t instanceof O?t:new O(t,e)}function M(t,e){if(t)for(var n=e?[t,e]:t,i=0,r=n.length;i<r;i++)this.extend(n[i])}function F(t,e){return t instanceof M?t:new M(t,e)}function V(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function U(t,e,n){return t instanceof V?t:g(t)&&"object"!=typeof t[0]?3===t.length?new V(t[0],t[1],t[2]):2===t.length?new V(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new V(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new V(t,e,n)}P.prototype={clone:function(){return new P(this.x,this.y)},add:function(t){return this.clone()._add(D(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(D(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new P(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new P(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=N(this.x),this.y=N(this.y),this},distanceTo:function(t){var e=(t=D(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=D(t)).x===this.x&&t.y===this.y},contains:function(t){return t=D(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},O.prototype={extend:function(t){var e,n;if(!t)return this;if(t instanceof P||"number"==typeof t[0]||"x"in t)e=n=D(t);else if(n=(t=R(t)).max,!(e=t.min)||!n)return this;return this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=e.clone(),this.max=n.clone()),this},getCenter:function(t){return D((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return D(this.min.x,this.max.y)},getTopRight:function(){return D(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof P?D(t):R(t))instanceof O?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=R(t);var e=this.min,n=this.max,i=t.min,r=t.max;return r.x>=e.x&&i.x<=n.x&&r.y>=e.y&&i.y<=n.y},overlaps:function(t){t=R(t);var e=this.min,n=this.max,i=t.min,r=t.max;return r.x>e.x&&i.x<n.x&&r.y>e.y&&i.y<n.y},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,n=this.max,i=Math.abs(e.x-n.x)*t,r=Math.abs(e.y-n.y)*t;return R(D(e.x-i,e.y-r),D(n.x+i,n.y+r))},equals:function(t){return!!t&&(t=R(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},M.prototype={extend:function(t){var e,n,i=this._southWest,r=this._northEast;if(t instanceof V)e=t,n=t;else{if(!(t instanceof M))return t?this.extend(U(t)||F(t)):this;if(n=t._northEast,!(e=t._southWest)||!n)return this}return i||r?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),r.lat=Math.max(n.lat,r.lat),r.lng=Math.max(n.lng,r.lng)):(this._southWest=new V(e.lat,e.lng),this._northEast=new V(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,r=Math.abs(e.lng-n.lng)*t;return new M(new V(e.lat-i,e.lng-r),new V(n.lat+i,n.lng+r))},getCenter:function(){return new V((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new V(this.getNorth(),this.getWest())},getSouthEast:function(){return new V(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof V||"lat"in t?U(t):F(t);var e,n,i=this._southWest,r=this._northEast;return t instanceof M?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=r.lat&&e.lng>=i.lng&&n.lng<=r.lng},intersects:function(t){t=F(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),r=t.getNorthEast();return r.lat>=e.lat&&i.lat<=n.lat&&r.lng>=e.lng&&i.lng<=n.lng},overlaps:function(t){t=F(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),r=t.getNorthEast();return r.lat>e.lat&&i.lat<n.lat&&r.lng>e.lng&&i.lng<n.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=F(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},V.prototype={equals:function(t,e){return!!t&&(t=U(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+u(this.lat,t)+", "+u(this.lng,t)+")"},distanceTo:function(t){return z.distance(this,U(t))},wrap:function(){return z.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return F([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new V(this.lat,this.lng,this.alt)}};var j,q={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new O(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?a(t.lng,this.wrapLng,!0):t.lng;return new V(this.wrapLat?a(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,r=e.lng-n.lng;if(0===i&&0===r)return t;var s=t.getSouthWest(),o=t.getNorthEast();return new M(new V(s.lat-i,s.lng-r),new V(o.lat-i,o.lng-r))}},z=e({},q,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,r=e.lat*n,s=Math.sin((e.lat-t.lat)*n/2),o=Math.sin((e.lng-t.lng)*n/2),a=s*s+Math.cos(i)*Math.cos(r)*o*o,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),B={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),r=Math.sin(i*e);return new P(this.R*t.lng*e,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(t){var e=180/Math.PI;return new V((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(j=6378137*Math.PI,new O([-j,-j],[j,j]))};function Z(t,e,n,i){if(g(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function H(t,e,n,i){return new Z(t,e,n,i)}Z.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return t.x=(e=e||1)*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return new P((t.x/(e=e||1)-this._b)/this._a,(t.y/e-this._d)/this._c)}};var $=e({},z,{code:"EPSG:3857",projection:B,transformation:function(){var t=.5/(Math.PI*B.R);return H(t,.5,-t,.5)}()}),W=e({},$,{code:"EPSG:900913"});function G(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function K(t,e){var n,i,r,s,o,a,l="";for(n=0,r=t.length;n<r;n++){for(i=0,s=(o=t[n]).length;i<s;i++)l+=(i?"L":"M")+(a=o[i]).x+" "+a.y;l+=e?Dt.svg?"z":"x":""}return l||"M0 0"}var Q=document.documentElement.style,Y="ActiveXObject"in window,J=Y&&!document.addEventListener,X="msLaunchUri"in navigator&&!("documentMode"in document),tt=Nt("webkit"),et=Nt("android"),nt=Nt("android 2")||Nt("android 3"),it=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),rt=et&&Nt("Google")&&it<537&&!("AudioNode"in window),st=!!window.opera,ot=!X&&Nt("chrome"),at=Nt("gecko")&&!tt&&!st&&!Y,lt=!ot&&Nt("safari"),ut=Nt("phantom"),ct="OTransition"in Q,ht=0===navigator.platform.indexOf("Win"),dt=Y&&"transition"in Q,pt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!nt,ft="MozPerspective"in Q,mt=!window.L_DISABLE_3D&&(dt||pt||ft)&&!ct&&!ut,gt="undefined"!=typeof orientation||Nt("mobile"),yt=gt&&tt,_t=gt&&pt,vt=!window.PointerEvent&&window.MSPointerEvent,wt=!(!window.PointerEvent&&!vt),bt="ontouchstart"in window||!!window.TouchEvent,Tt=!window.L_NO_TOUCH&&(bt||wt),It=gt&&st,St=gt&&at,Ct=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Et=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",l,e),window.removeEventListener("testPassiveEventSupport",l,e)}catch(n){}return t}(),xt=!!document.createElement("canvas").getContext,kt=!(!document.createElementNS||!G("svg").createSVGRect),At=!!kt&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(t.firstChild&&t.firstChild.namespaceURI)}(),Pt=!kt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(n){return!1}}();function Nt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Dt={ie:Y,ielt9:J,edge:X,webkit:tt,android:et,android23:nt,androidStock:rt,opera:st,chrome:ot,gecko:at,safari:lt,phantom:ut,opera12:ct,win:ht,ie3d:dt,webkit3d:pt,gecko3d:ft,any3d:mt,mobile:gt,mobileWebkit:yt,mobileWebkit3d:_t,msPointer:vt,pointer:wt,touch:Tt,touchNative:bt,mobileOpera:It,mobileGecko:St,retina:Ct,passiveEvents:Et,canvas:xt,svg:kt,vml:Pt,inlineSvg:At,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},Ot=Dt.msPointer?"MSPointerDown":"pointerdown",Rt=Dt.msPointer?"MSPointerMove":"pointermove",Lt=Dt.msPointer?"MSPointerUp":"pointerup",Mt=Dt.msPointer?"MSPointerCancel":"pointercancel",Ft={touchstart:Ot,touchmove:Rt,touchend:Lt,touchcancel:Mt},Vt={touchstart:function(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&Le(e),Ht(t,e)},touchmove:Ht,touchend:Ht,touchcancel:Ht},Ut={},jt=!1;function qt(t,e,n){return"touchstart"===e&&(jt||(document.addEventListener(Ot,zt,!0),document.addEventListener(Rt,Bt,!0),document.addEventListener(Lt,Zt,!0),document.addEventListener(Mt,Zt,!0),jt=!0)),Vt[e]?(n=Vt[e].bind(this,n),t.addEventListener(Ft[e],n,!1),n):(console.warn("wrong event specified:",e),l)}function zt(t){Ut[t.pointerId]=t}function Bt(t){Ut[t.pointerId]&&(Ut[t.pointerId]=t)}function Zt(t){delete Ut[t.pointerId]}function Ht(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in e.touches=[],Ut)e.touches.push(Ut[n]);e.changedTouches=[e],t(e)}}var $t,Wt,Gt,Kt,Qt,Yt=pe(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Jt=pe(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Xt="webkitTransition"===Jt||"OTransition"===Jt?Jt+"End":"transitionend";function te(t){return"string"==typeof t?document.getElementById(t):t}function ee(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function ne(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function ie(t){var e=t.parentNode;e&&e.removeChild(t)}function re(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function se(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function oe(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ae(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=he(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function le(t,e){if(void 0!==t.classList)for(var n=h(e),i=0,r=n.length;i<r;i++)t.classList.add(n[i]);else if(!ae(t,e)){var s=he(t);ce(t,(s?s+" ":"")+e)}}function ue(t,e){void 0!==t.classList?t.classList.remove(e):ce(t,c((" "+he(t)+" ").replace(" "+e+" "," ")))}function ce(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function he(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function de(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(r){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}(t,e)}function pe(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function fe(t,e,n){var i=e||new P(0,0);t.style[Yt]=(Dt.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function me(t,e){t._leaflet_pos=e,Dt.any3d?fe(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function ge(t){return t._leaflet_pos||new P(0,0)}if("onselectstart"in document)$t=function(){Ce(window,"selectstart",Le)},Wt=function(){xe(window,"selectstart",Le)};else{var ye=pe(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);$t=function(){if(ye){var t=document.documentElement.style;Gt=t[ye],t[ye]="none"}},Wt=function(){ye&&(document.documentElement.style[ye]=Gt,Gt=void 0)}}function _e(){Ce(window,"dragstart",Le)}function ve(){xe(window,"dragstart",Le)}function we(t){for(;-1===t.tabIndex;)t=t.parentNode;!t.style||(be(),Kt=t,Qt=t.style.outline,t.style.outline="none",Ce(window,"keydown",be))}function be(){!Kt||(Kt.style.outline=Qt,Kt=void 0,Qt=void 0,xe(window,"keydown",be))}function Te(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Ie(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Se={__proto__:null,TRANSFORM:Yt,TRANSITION:Jt,TRANSITION_END:Xt,get:te,getStyle:ee,create:ne,remove:ie,empty:re,toFront:se,toBack:oe,hasClass:ae,addClass:le,removeClass:ue,setClass:ce,getClass:he,setOpacity:de,testProp:pe,setTransform:fe,setPosition:me,getPosition:ge,get disableTextSelection(){return $t},get enableTextSelection(){return Wt},disableImageDrag:_e,enableImageDrag:ve,preventOutline:we,restoreOutline:be,getSizedParentNode:Te,getScale:Ie};function Ce(t,e,n,i){if(e&&"object"==typeof e)for(var r in e)Pe(t,r,e[r],n);else for(var s=0,o=(e=h(e)).length;s<o;s++)Pe(t,e[s],n,i);return this}var Ee="_leaflet_events";function xe(t,e,n,i){if(1===arguments.length)ke(t),delete t[Ee];else if(e&&"object"==typeof e)for(var r in e)Ne(t,r,e[r],n);else if(e=h(e),2===arguments.length)ke(t,function(t){return-1!==y(e,t)});else for(var s=0,o=e.length;s<o;s++)Ne(t,e[s],n,i);return this}function ke(t,e){for(var n in t[Ee]){var i=n.split(/\d/)[0];(!e||e(i))&&Ne(t,i,null,null,n)}}var Ae={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Pe(t,e,n,i){var r=e+s(n)+(i?"_"+s(i):"");if(t[Ee]&&t[Ee][r])return this;var o=function(e){return n.call(i||t,e||window.event)},a=o;!Dt.touchNative&&Dt.pointer&&0===e.indexOf("touch")?o=qt(t,e,o):Dt.touch&&"dblclick"===e?o=function(t,e){t.addEventListener("dblclick",e);var n,i=0;function r(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var r=Fe(t);if(!r.some(function(t){return t instanceof HTMLLabelElement&&t.attributes.for})||r.some(function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement})){var s=Date.now();s-i<=200?2==++n&&e(function(t){var e,n,i={};for(n in t)i[n]=(e=t[n])&&e.bind?e.bind(t):e;return t=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}(t)):n=1,i=s}}}else n=t.detail}return t.addEventListener("click",r),{dblclick:e,simDblclick:r}}(t,o):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Ae[e]||e,o,!!Dt.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?t.addEventListener(Ae[e],o=function(e){e=e||window.event,qe(t,e)&&a(e)},!1):t.addEventListener(e,a,!1):t.attachEvent("on"+e,o),t[Ee]=t[Ee]||{},t[Ee][r]=o}function Ne(t,e,n,i,r){r=r||e+s(n)+(i?"_"+s(i):"");var o=t[Ee]&&t[Ee][r];if(!o)return this;!Dt.touchNative&&Dt.pointer&&0===e.indexOf("touch")?function(t,e,n){Ft[e]?t.removeEventListener(Ft[e],n,!1):console.warn("wrong event specified:",e)}(t,e,o):Dt.touch&&"dblclick"===e?function(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}(t,o):"removeEventListener"in t?t.removeEventListener(Ae[e]||e,o,!1):t.detachEvent("on"+e,o),t[Ee][r]=null}function De(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Oe(t){return Pe(t,"wheel",De),this}function Re(t){return Ce(t,"mousedown touchstart dblclick contextmenu",De),t._leaflet_disable_click=!0,this}function Le(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Me(t){return Le(t),De(t),this}function Fe(t){if(t.composedPath)return t.composedPath();for(var e=[],n=t.target;n;)e.push(n),n=n.parentNode;return e}function Ve(t,e){if(!e)return new P(t.clientX,t.clientY);var n=Ie(e),i=n.boundingClientRect;return new P((t.clientX-i.left)/n.x-e.clientLeft,(t.clientY-i.top)/n.y-e.clientTop)}var Ue=Dt.linux&&Dt.chrome?window.devicePixelRatio:Dt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function je(t){return Dt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Ue:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function qe(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(i){return!1}return n!==t}var ze={__proto__:null,on:Ce,off:xe,stopPropagation:De,disableScrollPropagation:Oe,disableClickPropagation:Re,preventDefault:Le,stop:Me,getPropagationPath:Fe,getMousePosition:Ve,getWheelDelta:je,isExternalTarget:qe,addListener:Ce,removeListener:xe},Be=A.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=ge(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=S(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),me(this._el,n),this.fire("step")},_complete:function(){C(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Ze=A.extend({options:{crs:$,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=d(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(U(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Jt&&Dt.any3d&&!Dt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ce(this._proxy,Xt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,n,i){return n=void 0===n?this._zoom:this._limitZoom(n),t=this._limitCenter(U(t),n,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=e({animate:i.animate},i.zoom),i.pan=e({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==n?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,n,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,n,i.pan&&i.pan.noMoveStart),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t=t||(Dt.any3d?this.options.zoomDelta:1)),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t=t||(Dt.any3d?this.options.zoomDelta:1)),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),r=this.getSize().divideBy(2),s=(t instanceof P?t:this.latLngToContainerPoint(t)).subtract(r).multiplyBy(1-1/i),o=this.containerPointToLatLng(r.add(s));return this.setView(o,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():F(t);var n=D(e.paddingTopLeft||e.padding||[0,0]),i=D(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,n.add(i));if((r="number"==typeof e.maxZoom?Math.min(e.maxZoom,r):r)===1/0)return{center:t.getCenter(),zoom:r};var s=i.subtract(n).divideBy(2),o=this.project(t.getSouthWest(),r),a=this.project(t.getNorthEast(),r);return{center:this.unproject(o.add(a).divideBy(2).add(s),r),zoom:r}},fitBounds:function(t,e){if(!(t=F(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=D(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Be,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){le(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!Dt.any3d)return this.setView(t,e,n);this._stop();var i=this.project(this.getCenter()),r=this.project(t),s=this.getSize(),o=this._zoom;t=U(t),e=void 0===e?o:e;var a=Math.max(s.x,s.y),l=a*this.getZoomScale(o,e),u=r.distanceTo(i)||1,c=1.42,h=c*c;function d(t){var e=(l*l-a*a+(t?-1:1)*h*h*u*u)/(2*(t?l:a)*h*u),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function p(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}var m=d(0);function g(t){return a*(f(m)*function(t){return p(t)/f(t)}(m+c*t)-p(m))/h}var y=Date.now(),_=(d(1)-m)/c,v=n.duration?1e3*n.duration:1e3*_*.8;return this._moveStart(!0,n.noMoveStart),(function n(){var s=(Date.now()-y)/v,l=function(t){return 1-Math.pow(1-t,1.5)}(s)*_;s<=1?(this._flyToFrame=S(n,this),this._move(this.unproject(i.add(r.subtract(i).multiplyBy(g(l)/u)),o),this.getScaleZoom(a/function(t){return a*(f(m)/f(m+c*t))}(l),o),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}).call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return t=F(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,F(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=D((e=e||{}).paddingTopLeft||e.padding||[0,0]),i=D(e.paddingBottomRight||e.padding||[0,0]),r=this.project(this.getCenter()),s=this.project(t),o=this.getPixelBounds(),a=R([o.min.add(n),o.max.subtract(i)]),l=a.getSize();if(!a.contains(s)){this._enforcingBounds=!0;var u=s.subtract(a.getCenter()),c=a.extend(s).getSize().subtract(l);r.x+=u.x<0?-c.x:c.x,r.y+=u.y<0?-c.y:c.y,this.panTo(this.unproject(r),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var n=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),s=n.divideBy(2).round(),o=r.divideBy(2).round(),a=s.subtract(o);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:n,newSize:r})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var n=i(this._handleGeolocationResponse,this),r=i(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(n,r,t):navigator.geolocation.getCurrentPosition(n,r,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new V(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),i=this._locateOptions;if(i.setView){var r=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(r,i.maxZoom):r)}var s={latlng:e,bounds:n,timestamp:t.timestamp};for(var o in t.coords)"number"==typeof t.coords[o]&&(s[o]=t.coords[o]);this.fire("locationfound",s)}},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ie(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(C(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)ie(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=ne("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new M(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=F(t),n=D(n||[0,0]);var i=this.getZoom()||0,r=this.getMinZoom(),s=this.getMaxZoom(),o=t.getNorthWest(),a=t.getSouthEast(),l=this.getSize().subtract(n),u=R(this.project(a,i),this.project(o,i)).getSize(),c=Dt.any3d?this.options.zoomSnap:1,h=l.x/u.x,d=l.y/u.y,p=e?Math.max(h,d):Math.min(h,d);return i=this.getScaleZoom(p,i),c&&(i=Math.round(i/(c/100))*(c/100),i=e?Math.ceil(i/c)*c:Math.floor(i/c)*c),Math.max(r,Math.min(s,i))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new P(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new O(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs,i=n.zoom(t*n.scale(e=void 0===e?this._zoom:e));return isNaN(i)?1/0:i},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(U(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(D(t),e)},layerPointToLatLng:function(t){var e=D(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(U(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(U(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(F(t))},distance:function(t,e){return this.options.crs.distance(U(t),U(e))},containerPointToLayerPoint:function(t){return D(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return D(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(D(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(U(t)))},mouseEventToContainerPoint:function(t){return Ve(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=te(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Ce(e,"scroll",this._onScroll,this),this._containerId=s(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Dt.any3d,le(t,"leaflet-container"+(Dt.touch?" leaflet-touch":"")+(Dt.retina?" leaflet-retina":"")+(Dt.ielt9?" leaflet-oldie":"")+(Dt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=ee(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),me(this._mapPane,new P(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(le(t.markerPane,"leaflet-zoom-hide"),le(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,n){me(this._mapPane,new P(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var r=this._zoom!==e;this._moveStart(r,n)._move(t,e)._moveEnd(r),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n,i){void 0===e&&(e=this._zoom);var r=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),i?n&&n.pinch&&this.fire("zoom",n):((r||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return C(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){me(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[s(this._container)]=this;var e=t?xe:Ce;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Dt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){C(this._resizeRequest),this._resizeRequest=S(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,i=[],r="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,a=!1;o;){if((n=this._targets[s(o)])&&("click"===e||"preclick"===e)&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)&&(r&&!qe(o,t)||(i.push(n),r))||o===this._container)break;o=o.parentNode}return!i.length&&!a&&!r&&this.listens(e,!0)&&(i=[this]),i},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var n=t.type;"mousedown"===n&&we(e),this._fireDOMEvent(t,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,n,i){if("click"===t.type){var r=e({},t);r.type="preclick",this._fireDOMEvent(r,r.type,i)}var s=this._findEventTargets(t,n);if(i){for(var o=[],a=0;a<i.length;a++)i[a].listens(n,!0)&&o.push(i[a]);s=o.concat(s)}if(s.length){"contextmenu"===n&&Le(t);var l=s[0],u={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var c=l.getLatLng&&(!l._radius||l._radius<=10);u.containerPoint=c?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(t),u.layerPoint=this.containerPointToLayerPoint(u.containerPoint),u.latlng=c?l.getLatLng():this.layerPointToLatLng(u.layerPoint)}for(a=0;a<s.length;a++)if(s[a].fire(n,u,!0),u.originalEvent._stopped||!1===s[a].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,n))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return ge(this._mapPane)||new P(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return R([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),r=this.getSize().divideBy(2),s=new O(i.subtract(r),i.add(r)),o=this._getBoundsOffset(s,n,e);return Math.abs(o.x)<=1&&Math.abs(o.y)<=1?t:this.unproject(i.add(o),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new O(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=R(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),r=i.min.subtract(t.min),s=i.max.subtract(t.max);return new P(this._rebound(r.x,-s.x),this._rebound(r.y,-s.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=Dt.any3d?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ue(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=ne("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=Yt,n=this._proxy.style[e];fe(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ie(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();fe(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(r)||(S(function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)},this),0))},_animateZoom:function(t,e,n,r){!this._mapPane||(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,le(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:r}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&ue(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});var He=x.extend({options:{position:"topright"},initialize:function(t){d(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return le(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ie(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),$e=function(t){return new He(t)};Ze.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=ne("div",e+"control-container",this._container);function i(i,r){t[i+r]=ne("div",e+i+" "+e+r,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ie(this._controlCorners[t]);ie(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var We=He.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){for(var i in d(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return He.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(s(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){le(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(le(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ue(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ue(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=ne("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Re(e),Oe(e);var i=this._section=ne("section",t+"-list");n&&(this._map.on("click",this.collapse,this),Ce(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var r=this._layersLink=ne("a",t+"-toggle",e);r.href="#",r.title="Layers",r.setAttribute("role","button"),Ce(r,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){Le(t),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=ne("div",t+"-base",i),this._separator=ne("div",t+"-separator",i),this._overlaysList=ne("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&s(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(i(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;re(this._baseLayersList),re(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,r=0;for(n=0;n<this._layers.length;n++)this._addItem(i=this._layers[n]),e=e||i.overlay,t=t||!i.overlay,r+=i.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(t=t&&r>1)?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(s(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=document.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers_"+s(this),i),this._layerControlInputs.push(e),e.layerId=s(t.layer),Ce(e,"click",this._onInputClick,this);var r=document.createElement("span");r.innerHTML=" "+t.name;var o=document.createElement("span");return n.appendChild(o),o.appendChild(e),o.appendChild(r),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,i=[],r=[];this._handlingClick=!0;for(var s=n.length-1;s>=0;s--)e=this._getLayer((t=n[s]).layerId).layer,t.checked?i.push(e):t.checked||r.push(e);for(s=0;s<r.length;s++)this._map.hasLayer(r[s])&&this._map.removeLayer(r[s]);for(s=0;s<i.length;s++)this._map.hasLayer(i[s])||this._map.addLayer(i[s]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,i=this._map.getZoom(),r=n.length-1;r>=0;r--)e=this._getLayer((t=n[r]).layerId).layer,t.disabled=void 0!==e.options.minZoom&&i<e.options.minZoom||void 0!==e.options.maxZoom&&i>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;Ce(t,"click",Le),this.expand(),setTimeout(function(){xe(t,"click",Le)})}}),Ge=He.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=ne("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,r){var s=ne("a",n,i);return s.innerHTML=t,s.href="#",s.title=e,s.setAttribute("role","button"),s.setAttribute("aria-label",e),Re(s),Ce(s,"click",Me),Ce(s,"click",r,this),Ce(s,"click",this._refocusOnMap,this),s},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";ue(this._zoomInButton,e),ue(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(le(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(le(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ze.mergeOptions({zoomControl:!0}),Ze.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ge,this.addControl(this.zoomControl))});var Ke=He.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=ne("div",e),i=this.options;return this._addScales(i,e+"-line",n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=ne("div",e,n)),t.imperial&&(this._iScale=ne("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t);this._updateScale(this._mScale,e<1e3?e+" m":e/1e3+" km",e/t)},_updateImperial:function(t){var e,n,i,r=3.2808399*t;r>5280?(n=this._getRoundNum(e=r/5280),this._updateScale(this._iScale,n+" mi",n/e)):(i=this._getRoundNum(r),this._updateScale(this._iScale,i+" ft",i/r))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),Qe=He.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Dt.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(t){d(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=ne("div","leaflet-control-attribution"),Re(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});Ze.mergeOptions({attributionControl:!0}),Ze.addInitHook(function(){this.options.attributionControl&&(new Qe).addTo(this)});He.Layers=We,He.Zoom=Ge,He.Scale=Ke,He.Attribution=Qe,$e.layers=function(t,e,n){return new We(t,e,n)},$e.zoom=function(t){return new Ge(t)},$e.scale=function(t){return new Ke(t)},$e.attribution=function(t){return new Qe(t)};var Ye=x.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ye.addTo=function(t,e){return t.addHandler(e,this),this};var Je,Xe={Events:k},tn=Dt.touch?"touchstart mousedown":"mousedown",en=A.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){d(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Ce(this._dragStartTarget,tn,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(en._dragging===this&&this.finishDrag(!0),xe(this._dragStartTarget,tn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!ae(this._element,"leaflet-zoom-anim"))){if(t.touches&&1!==t.touches.length)return void(en._dragging===this&&this.finishDrag());if(!(en._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(en._dragging=this,this._preventOutline&&we(this._element),_e(),$t(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,n=Te(this._element);this._startPoint=new P(e.clientX,e.clientY),this._startPos=ge(this._element),this._parentScale=Ie(n);var i="mousedown"===t.type;Ce(document,i?"mousemove":"touchmove",this._onMove,this),Ce(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new P(e.clientX,e.clientY)._subtract(this._startPoint);!n.x&&!n.y||Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Le(t),this._moved||(this.fire("dragstart"),this._moved=!0,le(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),le(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),me(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){!this._enabled||this.finishDrag()},finishDrag:function(t){ue(document.body,"leaflet-dragging"),this._lastTarget&&(ue(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),xe(document,"mousemove touchmove",this._onMove,this),xe(document,"mouseup touchend touchcancel",this._onUp,this),ve(),Wt(),this._moved&&this._moving&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,en._dragging=!1}});function nn(t,e){if(!e||!t.length)return t.slice();var n=e*e;return function(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,sn(t,i,e,0,n-1);var r,s=[];for(r=0;r<n;r++)i[r]&&s.push(t[r]);return s}(t=function(t,e){for(var n=[t[0]],i=1,r=0,s=t.length;i<s;i++)un(t[i],t[r])>e&&(n.push(t[i]),r=i);return r<s-1&&n.push(t[s-1]),n}(t,n),n)}function rn(t,e,n){return Math.sqrt(cn(t,e,n,!0))}function sn(t,e,n,i,r){var s,o,a,l=0;for(o=i+1;o<=r-1;o++)(a=cn(t[o],t[i],t[r],!0))>l&&(s=o,l=a);l>n&&(e[s]=1,sn(t,e,n,i,s),sn(t,e,n,s,r))}function on(t,e,n,i,r){var s,o,a,l=i?Je:ln(t,n),u=ln(e,n);for(Je=u;;){if(!(l|u))return[t,e];if(l&u)return!1;a=ln(o=an(t,e,s=l||u,n,r),n),s===l?(t=o,l=a):(e=o,u=a)}}function an(t,e,n,i,r){var s,o,a=e.x-t.x,l=e.y-t.y,u=i.min,c=i.max;return 8&n?(s=t.x+a*(c.y-t.y)/l,o=c.y):4&n?(s=t.x+a*(u.y-t.y)/l,o=u.y):2&n?(s=c.x,o=t.y+l*(c.x-t.x)/a):1&n&&(s=u.x,o=t.y+l*(u.x-t.x)/a),new P(s,o,r)}function ln(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function un(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function cn(t,e,n,i){var r,s=e.x,o=e.y,a=n.x-s,l=n.y-o,u=a*a+l*l;return u>0&&((r=((t.x-s)*a+(t.y-o)*l)/u)>1?(s=n.x,o=n.y):r>0&&(s+=a*r,o+=l*r)),a=t.x-s,l=t.y-o,i?a*a+l*l:new P(s,o)}function hn(t){return!g(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function dn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),hn(t)}function pn(t,e){var n,i,r,s,o,a,l,u;if(!t||0===t.length)throw new Error("latlngs not passed");hn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var c=[];for(var h in t)c.push(e.project(U(t[h])));var d=c.length;for(n=0,i=0;n<d-1;n++)i+=c[n].distanceTo(c[n+1])/2;if(0===i)u=c[0];else for(n=0,s=0;n<d-1;n++)if((s+=r=(o=c[n]).distanceTo(a=c[n+1]))>i){u=[a.x-(l=(s-i)/r)*(a.x-o.x),a.y-l*(a.y-o.y)];break}return e.unproject(D(u))}var fn={__proto__:null,simplify:nn,pointToSegmentDistance:rn,closestPointOnSegment:function(t,e,n){return cn(t,e,n)},clipSegment:on,_getEdgeIntersection:an,_getBitCode:ln,_sqClosestPointOnSegment:cn,isFlat:hn,_flat:dn,polylineCenter:pn};function mn(t,e,n){var i,r,s,o,a,l,u,c,h,d=[1,4,2,8];for(r=0,u=t.length;r<u;r++)t[r]._code=ln(t[r],e);for(o=0;o<4;o++){for(c=d[o],i=[],r=0,s=(u=t.length)-1;r<u;s=r++)l=t[s],(a=t[r])._code&c?l._code&c||((h=an(l,a,c,e,n))._code=ln(h,e),i.push(h)):(l._code&c&&((h=an(l,a,c,e,n))._code=ln(h,e),i.push(h)),i.push(a));t=i}return t}function gn(t,e){var n,i,r,s,o,a,l,u;if(!t||0===t.length)throw new Error("latlngs not passed");hn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var c=[];for(var h in t)c.push(e.project(U(t[h])));var d=c.length;for(a=l=u=0,n=0,i=d-1;n<d;i=n++)l+=((r=c[n]).x+(s=c[i]).x)*(o=r.y*s.x-s.y*r.x),u+=(r.y+s.y)*o,a+=3*o;return e.unproject(D(0===a?c[0]:[l/a,u/a]))}var yn={__proto__:null,clipPolygon:mn,polygonCenter:gn},_n={project:function(t){return new P(t.lng,t.lat)},unproject:function(t){return new V(t.y,t.x)},bounds:new O([-180,-90],[180,90])},vn={R:6378137,R_MINOR:6356752.314245179,bounds:new O([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,r=this.R_MINOR/n,s=Math.sqrt(1-r*r),o=s*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-o)/(1+o),s/2);return i=-n*Math.log(Math.max(a,1e-10)),new P(t.lng*e*n,i)},unproject:function(t){for(var e,n=180/Math.PI,i=this.R,r=this.R_MINOR/i,s=Math.sqrt(1-r*r),o=Math.exp(-t.y/i),a=Math.PI/2-2*Math.atan(o),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=s*Math.sin(a),e=Math.pow((1-e)/(1+e),s/2),a+=u=Math.PI/2-2*Math.atan(o*e)-a;return new V(a*n,t.x*n/i)}},wn={__proto__:null,LonLat:_n,Mercator:vn,SphericalMercator:B},bn=e({},z,{code:"EPSG:3395",projection:vn,transformation:function(){var t=.5/(Math.PI*vn.R);return H(t,.5,-t,.5)}()}),Tn=e({},z,{code:"EPSG:4326",projection:_n,transformation:H(1/180,1,-1/180,.5)}),In=e({},q,{projection:_n,transformation:H(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});q.Earth=z,q.EPSG3395=bn,q.EPSG3857=$,q.EPSG900913=W,q.EPSG4326=Tn,q.Simple=In;var Sn=A.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[s(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[s(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",function(){e.off(n,this)},this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});Ze.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=s(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=s(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return s(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?g(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[s(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=s(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var r=this._zoomBoundLayers[i].options;t=void 0===r.minZoom?t:Math.min(t,r.minZoom),e=void 0===r.maxZoom?e:Math.max(e,r.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Cn=Sn.extend({initialize:function(t,e){var n,i;if(d(this,e),this._layers={},t)for(n=0,i=t.length;n<i;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s(t)}}),En=Cn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Cn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Cn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new M;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),xn=x.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){d(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var r=D(i),s=D("shadow"===e&&n.shadowAnchor||n.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),s&&(t.style.marginLeft=-s.x+"px",t.style.marginTop=-s.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Dt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var kn=xn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof kn.imagePath&&(kn.imagePath=this._detectIconPath()),(this.options.imagePath||kn.imagePath)+xn.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,n){var i=e.exec(t);return i&&i[n]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=ne("div","leaflet-default-icon-path",document.body),e=ee(t,"background-image")||ee(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-"leaflet.css".length-1):""}}),An=Ye.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new en(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),le(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ue(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,i=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,s=ge(e._icon),o=n.getPixelBounds(),a=n.getPixelOrigin(),l=R(o.min._subtract(a).add(r),o.max._subtract(a).subtract(r));if(!l.contains(s)){var u=D((Math.max(l.max.x,s.x)-l.max.x)/(o.max.x-l.max.x)-(Math.min(l.min.x,s.x)-l.min.x)/(o.min.x-l.min.x),(Math.max(l.max.y,s.y)-l.max.y)/(o.max.y-l.max.y)-(Math.min(l.min.y,s.y)-l.min.y)/(o.min.y-l.min.y)).multiplyBy(i);n.panBy(u,{animate:!1}),this._draggable._newPos._add(u),this._draggable._startPos._add(u),me(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=S(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(C(this._panRequest),this._panRequest=S(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,i=ge(e._icon),r=e._map.layerPointToLatLng(i);n&&me(n,i),e._latlng=r,t.latlng=r,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){C(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Pn=Sn.extend({options:{icon:new kn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){d(this,e),this._latlng=U(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=U(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),le(n,e),t.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ce(n,"focus",this._panOnFocus,this);var r=t.icon.createShadow(this._shadow),s=!1;r!==this._shadow&&(this._removeShadow(),s=!0),r&&(le(r,e),r.alt=""),this._shadow=r,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&s&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&xe(this._icon,"focus",this._panOnFocus,this),ie(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ie(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&me(this._icon,t),this._shadow&&me(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(le(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),An)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new An(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&de(this._icon,t),this._shadow&&de(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,n=e.iconSize?D(e.iconSize):D(0,0),i=e.iconAnchor?D(e.iconAnchor):D(0,0);t.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Nn=Sn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return d(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Dn=Nn.extend({options:{fill:!0,radius:10},initialize:function(t,e){d(this,e),this._latlng=U(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=U(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Nn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new O(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var On=Dn.extend({initialize:function(t,n,i){if("number"==typeof n&&(n=e({},i,{radius:n})),d(this,n),this._latlng=U(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new M(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Nn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===z.distance){var r=Math.PI/180,s=this._mRadius/z.R/r,o=n.project([e+s,t]),a=n.project([e-s,t]),l=o.add(a).divideBy(2),u=n.unproject(l).lat,c=Math.acos((Math.cos(s*r)-Math.sin(e*r)*Math.sin(u*r))/(Math.cos(e*r)*Math.cos(u*r)))/r;(isNaN(c)||0===c)&&(c=s/Math.cos(Math.PI/180*e)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(c)?0:l.x-n.project([u,t-c]).x,this._radiusY=l.y-o.y}else{var h=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}});var Rn=Nn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){d(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=1/0,r=null,s=cn,o=0,a=this._parts.length;o<a;o++)for(var l=this._parts[o],u=1,c=l.length;u<c;u++){var h=s(t,e=l[u-1],n=l[u],!0);h<i&&(i=h,r=s(t,e,n))}return r&&(r.distance=Math.sqrt(i)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return pn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=U(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new M,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return hn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=hn(t),i=0,r=t.length;i<r;i++)n?(e[i]=U(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new O;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new P(t,t);!this._rawPxBounds||(this._pxBounds=new O([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,n){var i,r,s=t.length;if(t[0]instanceof V){for(r=[],i=0;i<s;i++)r[i]=this._map.latLngToLayerPoint(t[i]),n.extend(r[i]);e.push(r)}else for(i=0;i<s;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);var e,n,i,r,s,o,a,l=this._parts;for(e=0,i=0,r=this._rings.length;e<r;e++)for(n=0,s=(a=this._rings[e]).length;n<s-1;n++)(o=on(a[n],a[n+1],t,n,!0))&&(l[i]=l[i]||[],l[i].push(o[0]),(o[1]!==a[n+1]||n===s-2)&&(l[i].push(o[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=nn(t[n],e)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,r,s,o,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,s=this._parts.length;n<s;n++)for(i=0,r=(o=(a=this._parts[n]).length)-1;i<o;r=i++)if((e||0!==i)&&rn(t,a[r],a[i])<=l)return!0;return!1}});Rn._flat=dn;var Ln=Rn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=Rn.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof V&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){Rn.prototype._setLatLngs.call(this,t),hn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return hn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new P(e,e);if(t=new O(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);for(var i,r=0,s=this._rings.length;r<s;r++)(i=mn(this._rings[r],t,!0)).length&&this._parts.push(i)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,r,s,o,a,l,u=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(r=0,a=this._parts.length;r<a;r++)for(s=0,o=(l=(e=this._parts[r]).length)-1;s<l;o=s++)(n=e[s]).y>t.y!=(i=e[o]).y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(u=!u);return u||Rn.prototype._containsPoint.call(this,t,!0)}});var Mn=En.extend({initialize:function(t,e){d(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,r=g(t)?t:t.features;if(r){for(e=0,n=r.length;e<n;e++)((i=r[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var s=this.options;if(s.filter&&!s.filter(t))return this;var o=Fn(t,s);return o?(o.feature=Zn(t),o.defaultOptions=o.options,this.resetStyle(o),s.onEachFeature&&s.onEachFeature(t,o),this.addLayer(o)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Fn(t,e){var n,i,r,s,o="Feature"===t.type?t.geometry:t,a=o?o.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||Un;if(!a&&!o)return null;switch(o.type){case"Point":return Vn(u,t,n=c(a),e);case"MultiPoint":for(r=0,s=a.length;r<s;r++)n=c(a[r]),l.push(Vn(u,t,n,e));return new En(l);case"LineString":case"MultiLineString":return i=jn(a,"LineString"===o.type?0:1,c),new Rn(i,e);case"Polygon":case"MultiPolygon":return i=jn(a,"Polygon"===o.type?1:2,c),new Ln(i,e);case"GeometryCollection":for(r=0,s=o.geometries.length;r<s;r++){var h=Fn({geometry:o.geometries[r],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new En(l);case"FeatureCollection":for(r=0,s=o.features.length;r<s;r++){var d=Fn(o.features[r],e);d&&l.push(d)}return new En(l);default:throw new Error("Invalid GeoJSON object.")}}function Vn(t,e,n,i){return t?t(e,n):new Pn(n,i&&i.markersInheritOptions&&i)}function Un(t){return new V(t[1],t[0],t[2])}function jn(t,e,n){for(var i,r=[],s=0,o=t.length;s<o;s++)i=e?jn(t[s],e-1,n):(n||Un)(t[s]),r.push(i);return r}function qn(t,e){return void 0!==(t=U(t)).alt?[u(t.lng,e),u(t.lat,e),u(t.alt,e)]:[u(t.lng,e),u(t.lat,e)]}function zn(t,e,n,i){for(var r=[],s=0,o=t.length;s<o;s++)r.push(e?zn(t[s],hn(t[s])?0:e-1,n,i):qn(t[s],i));return!e&&n&&r.push(r[0].slice()),r}function Bn(t,n){return t.feature?e({},t.feature,{geometry:n}):Zn(n)}function Zn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Hn={toGeoJSON:function(t){return Bn(this,{type:"Point",coordinates:qn(this.getLatLng(),t)})}};function $n(t,e){return new Mn(t,e)}Pn.include(Hn),On.include(Hn),Dn.include(Hn),Rn.include({toGeoJSON:function(t){var e=!hn(this._latlngs);return Bn(this,{type:(e?"Multi":"")+"LineString",coordinates:zn(this._latlngs,e?1:0,!1,t)})}}),Ln.include({toGeoJSON:function(t){var e=!hn(this._latlngs),n=e&&!hn(this._latlngs[0]),i=zn(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),Bn(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),Cn.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(n){e.push(n.toGeoJSON(t).geometry.coordinates)}),Bn(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,i=[];return this.eachLayer(function(e){if(e.toGeoJSON){var r=e.toGeoJSON(t);if(n)i.push(r.geometry);else{var s=Zn(r);"FeatureCollection"===s.type?i.push.apply(i,s.features):i.push(s)}}}),n?Bn(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var Wn=$n,Gn=Sn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=F(e),d(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(le(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ie(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&se(this._image),this},bringToBack:function(){return this._map&&oe(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=F(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:ne("img");le(e,"leaflet-image-layer"),this._zoomAnimated&&le(e,"leaflet-zoom-animated"),this.options.className&&le(e,this.options.className),e.onselectstart=l,e.onmousemove=l,e.onload=i(this.fire,this,"load"),e.onerror=i(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;fe(this._image,n,e)},_reset:function(){var t=this._image,e=new O(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();me(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){de(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Kn=Gn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:ne("video");if(le(e,"leaflet-image-layer"),this._zoomAnimated&&le(e,"leaflet-zoom-animated"),this.options.className&&le(e,this.options.className),e.onselectstart=l,e.onmousemove=l,e.onloadeddata=i(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),r=[],s=0;s<n.length;s++)r.push(n[s].src);this._url=n.length>0?r:[e.src]}else{g(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var o=0;o<this._url.length;o++){var a=ne("source");a.src=this._url[o],e.appendChild(a)}}}});var Qn=Gn.extend({_initImage:function(){var t=this._image=this._url;le(t,"leaflet-image-layer"),this._zoomAnimated&&le(t,"leaflet-zoom-animated"),this.options.className&&le(t,this.options.className),t.onselectstart=l,t.onmousemove=l}});var Yn=Sn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof V||g(t))?(this._latlng=U(t),d(this,e)):(d(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&de(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&de(this._container,1),this.bringToFront(),this.options.interactive&&(le(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(de(this._container,0),this._removeTimeout=setTimeout(i(ie,void 0,this._container),200)):ie(this._container),this.options.interactive&&(ue(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=U(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&se(this._container),this},bringToBack:function(){return this._map&&oe(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof En){e=null;var n=this._source._layers;for(var i in n)if(n[i]._map){e=n[i];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=D(this.options.offset),n=this._getAnchor();this._zoomAnimated?me(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}});Ze.include({_initOverlay:function(t,e,n,i){var r=e;return r instanceof t||(r=new t(i).setContent(e)),n&&r.setLatLng(n),r}}),Sn.include({_initOverlay:function(t,e,n,i){var r=n;return r instanceof t?(d(r,i),r._source=this):(r=e&&!i?e:new t(i,this)).setContent(n),r}});var Jn=Yn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Yn.prototype.openOn.call(this,t)},onAdd:function(t){Yn.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Nn||this._source.on("preclick",De))},onRemove:function(t){Yn.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Nn||this._source.off("preclick",De))},getEvents:function(){var t=Yn.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=ne("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=ne("div",t+"-content-wrapper",e);if(this._contentNode=ne("div",t+"-content",n),Re(e),Oe(this._contentNode),Ce(e,"contextmenu",De),this._tipContainer=ne("div",t+"-tip-container",e),this._tip=ne("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=ne("a",t+"-close-button",e);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',Ce(i,"click",function(t){Le(t),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=this.options.maxHeight,r="leaflet-popup-scrolled";i&&t.offsetHeight>i?(e.height=i+"px",le(t,r)):ue(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();me(this._container,e.add(n))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)return void(this._autopanning=!1);var t=this._map,e=parseInt(ee(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,r=new P(this._containerLeft,-n-this._containerBottom);r._add(ge(this._container));var s=t.layerPointToContainerPoint(r),o=D(this.options.autoPanPadding),a=D(this.options.autoPanPaddingTopLeft||o),l=D(this.options.autoPanPaddingBottomRight||o),u=t.getSize(),c=0,h=0;s.x+i+l.x>u.x&&(c=s.x+i-u.x+l.x),s.x-c-a.x<0&&(c=s.x-a.x),s.y+n+l.y>u.y&&(h=s.y+n-u.y+l.y),s.y-h-a.y<0&&(h=s.y-a.y),(c||h)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([c,h]))}},_getAnchor:function(){return D(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Ze.mergeOptions({closePopupOnClick:!0}),Ze.include({openPopup:function(t,e,n){return this._initOverlay(Jn,t,e,n).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Sn.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Jn,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof En||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){Me(t);var e=t.layer||t.target;if(this._popup._source===e&&!(e instanceof Nn))return void(this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng));this._popup._source=e,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Xn=Yn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Yn.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Yn.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Yn.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){this._contentNode=this._container=ne("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide")),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+s(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,n,i=this._map,r=this._container,s=i.latLngToContainerPoint(i.getCenter()),o=i.layerPointToContainerPoint(t),a=this.options.direction,l=r.offsetWidth,u=r.offsetHeight,c=D(this.options.offset),h=this._getAnchor();"top"===a?(e=l/2,n=u):"bottom"===a?(e=l/2,n=0):"center"===a?(e=l/2,n=u/2):"right"===a?(e=0,n=u/2):"left"===a?(e=l,n=u/2):o.x<s.x?(a="right",e=0,n=u/2):(a="left",e=l+2*(c.x+h.x),n=u/2),t=t.subtract(D(e,n,!0)).add(c).add(h),ue(r,"leaflet-tooltip-right"),ue(r,"leaflet-tooltip-left"),ue(r,"leaflet-tooltip-top"),ue(r,"leaflet-tooltip-bottom"),le(r,"leaflet-tooltip-"+a),me(r,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&de(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return D(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Ze.include({openTooltip:function(t,e,n){return this._initOverlay(Xn,t,e,n).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Sn.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Xn,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof En||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e=t.getElement();e&&(Ce(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),Ce(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e=t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0))},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var ti=xn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(re(e),e.appendChild(n.html)):e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=D(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});xn.Default=kn;var ei=Sn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Dt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){d(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ie(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(se(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(oe(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof P?t:new P(t,t)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,i=-t(-1/0,1/0),r=0,s=n.length;r<s;r++)e=n[r].style.zIndex,n[r]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Dt.ielt9){de(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var r=this._tiles[i];if(r.current&&r.loaded){var s=Math.min(1,(t-r.loaded)/200);de(r.el,s),s<1?e=!0:(r.active?n=!0:this._onOpaqueTile(r),r.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(C(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this))}},_onOpaqueTile:l,_initContainer:function(){this._container||(this._container=ne("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(ie(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],r=this._map;return i||((i=this._levels[t]={}).el=ne("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,r.getCenter(),r.getZoom()),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:l,_onRemoveLevel:l,_onCreateLevel:l,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)return void this._removeAllTiles();for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ie(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,i){var r=Math.floor(t/2),s=Math.floor(e/2),o=n-1,a=new P(+r,+s);a.z=+o;var l=this._tileCoordsToKey(a),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),o>i&&this._retainParent(r,s,o,i))},_retainChildren:function(t,e,n,i){for(var r=2*t;r<2*t+2;r++)for(var s=2*e;s<2*e+2;s++){var o=new P(r,s);o.z=n+1;var a=this._tileCoordsToKey(o),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<i&&this._retainChildren(r,s,n+1,i))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var r=Math.round(e);r=void 0!==this.options.maxZoom&&r>this.options.maxZoom||void 0!==this.options.minZoom&&r<this.options.minZoom?void 0:this._clampZoom(r),(!i||this.options.updateWhenZooming&&r!==this._tileZoom)&&(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==r&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),r=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();Dt.any3d?fe(t.el,r,i):me(t.el,r)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),r=e.project(t,this._tileZoom).floor(),s=e.getSize().divideBy(2*i);return new O(r.subtract(s),r.add(s))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(i),s=r.getCenter(),o=[],a=this.options.keepBuffer,l=new O(r.getBottomLeft().subtract([a,-a]),r.getTopRight().add([a,-a]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var c=this._tiles[u].coords;(c.z!==this._tileZoom||!l.contains(new P(c.x,c.y)))&&(this._tiles[u].current=!1)}if(Math.abs(n-this._tileZoom)>1)return void this._setView(t,n);for(var h=r.min.y;h<=r.max.y;h++)for(var d=r.min.x;d<=r.max.x;d++){var p=new P(d,h);if(p.z=this._tileZoom,this._isValidTile(p)){var f=this._tiles[this._tileCoordsToKey(p)];f?f.current=!0:o.push(p)}}if(o.sort(function(t,e){return t.distanceTo(s)-e.distanceTo(s)}),0!==o.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<o.length;d++)this._addTile(o[d],m);this._level.el.appendChild(m)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return F(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),r=i.add(n);return[e.unproject(i,t.z),e.unproject(r,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new M(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new P(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];!e||(ie(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){le(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=l,t.onmousemove=l,Dt.ielt9&&this.options.opacity<1&&de(t,this.options.opacity)},_addTile:function(t,e){var n=this._getTilePos(t),r=this._tileCoordsToKey(t),s=this.createTile(this._wrapCoords(t),i(this._tileReady,this,t));this._initTile(s),this.createTile.length<2&&S(i(this._tileReady,this,t,null,s)),me(s,n),this._tiles[r]={el:s,coords:t,current:!0},e.appendChild(s),this.fire("tileloadstart",{tile:s,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var r=this._tileCoordsToKey(t);(n=this._tiles[r])&&(n.loaded=+new Date,this._map._fadeAnimated?(de(n.el,0),C(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(le(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Dt.ielt9||!this._map._fadeAnimated?S(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new P(this._wrapX?a(t.x,this._wrapX):t.x,this._wrapY?a(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new O(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var ni=ei.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=d(this,e)).detectRetina&&Dt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Ce(n,"load",i(this._tileOnLoad,this,e,n)),Ce(n,"error",i(this._tileOnError,this,e,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(t),n},getTileUrl:function(t){var n={r:Dt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(n.y=i),n["-y"]=i}return m(this._url,e(n,this.options))},_tileOnLoad:function(t,e){Dt.ielt9?setTimeout(i(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.getAttribute("src")!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom;return this.options.zoomReverse&&(t=this.options.maxZoom-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=l,e.onerror=l,!e.complete)){e.src=_;var n=this._tiles[t].coords;ie(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:n})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",_),ei.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==_))return ei.prototype._tileReady.call(this,t,e,n)}});function ii(t,e){return new ni(t,e)}var ri=ni.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,n){this._url=t;var i=e({},this.defaultWmsParams);for(var r in n)r in this.options||(i[r]=n[r]);var s=(n=d(this,n)).detectRetina&&Dt.retina?2:1,o=this.getTileSize();i.width=o.x*s,i.height=o.y*s,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,ni.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,i=R(n.project(e[0]),n.project(e[1])),r=i.min,s=i.max,o=(this._wmsVersion>=1.3&&this._crs===Tn?[r.y,r.x,s.y,s.x]:[r.x,r.y,s.x,s.y]).join(","),a=ni.prototype.getTileUrl.call(this,t);return a+p(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(t,n){return e(this.wmsParams,t),n||this.redraw(),this}});ni.WMS=ri,ii.wms=function(t,e){return new ri(t,e)};var si=Sn.extend({options:{padding:.1},initialize:function(t){d(this,t),s(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&le(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),s=i.multiplyBy(-n).add(r).subtract(this._map._getNewPixelOrigin(t,e));Dt.any3d?fe(this._container,s,n):me(this._container,s)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new O(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),oi=si.extend({options:{tolerance:0},getEvents:function(){var t=si.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){si.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Ce(t,"mousemove",this._onMouseMove,this),Ce(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ce(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){C(this._redrawRequest),delete this._ctx,ie(this._container),xe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){si.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=Dt.retina?2:1;me(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",Dt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){si.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[s(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[s(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,n,i=t.options.dashArray.split(/[, ]+/),r=[];for(n=0;n<i.length;n++){if(e=Number(i[n]),isNaN(e))return;r.push(e)}t.options._dashArray=r}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){!this._map||(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||S(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new O,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,r,s,o=t._parts,a=o.length,l=this._ctx;if(a){for(l.beginPath(),n=0;n<a;n++){for(i=0,r=o[n].length;i<r;i++)l[i?"lineTo":"moveTo"]((s=o[n][i]).x,s.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=Math.max(Math.round(t._radius),1),r=(Math.max(Math.round(t._radiusY),1)||i)/i;1!==r&&(n.save(),n.scale(1,r)),n.beginPath(),n.arc(e.x,e.y/r,i,0,2*Math.PI,!1),1!==r&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),r=this._drawFirst;r;r=r.next)(e=r.layer).options.interactive&&e._containsPoint(i)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(n=e);this._fireEvent(!!n&&[n],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(ue(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,r,s=this._drawFirst;s;s=s.next)(n=s.layer).options.interactive&&n._containsPoint(e)&&(r=n);r!==this._hoveredLayer&&(this._handleMouseOut(t),r&&(le(this._container,"leaflet-interactive"),this._fireEvent([r],t,"mouseover"),this._hoveredLayer=r)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(i(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;if(!n)return;n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t)}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;if(!i)return;i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}}});function ai(t){return Dt.canvas?new oi(t):null}var li=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(j){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ui={_initContainer:function(){this._container=ne("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(si.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=li("shape");le(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=li("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ie(e),t.removeInteractiveTarget(e),delete this._layers[s(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,r=t._container;r.stroked=!!i.stroke,r.filled=!!i.fill,i.stroke?(e||(e=t._stroke=li("stroke")),r.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,e.dashStyle=i.dashArray?g(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):"",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(r.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=li("fill")),r.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(r.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){se(t._container)},_bringToBack:function(t){oe(t._container)}},ci=Dt.vml?li:G,hi=si.extend({_initContainer:function(){this._container=ci("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ci("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ie(this._container),xe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){si.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;(!this._svgSize||!this._svgSize.equals(e))&&(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),me(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=ci("path");t.options.className&&le(e,t.options.className),t.options.interactive&&le(e,"leaflet-interactive"),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ie(t._path),t.removeInteractiveTarget(t._path),delete this._layers[s(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;!e||(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,K(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),i="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){se(t._path)},_bringToBack:function(t){oe(t._path)}});function di(t){return Dt.svg||Dt.vml?new hi(t):null}Dt.vml&&hi.include(ui),Ze.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&ai(t)||di(t)}});var pi=Ln.extend({initialize:function(t,e){Ln.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=F(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});hi.create=ci,hi.pointsToPath=K,Mn.geometryToLayer=Fn,Mn.coordsToLatLng=Un,Mn.coordsToLatLngs=jn,Mn.latLngToCoords=qn,Mn.latLngsToCoords=zn,Mn.getFeature=Bn,Mn.asFeature=Zn,Ze.mergeOptions({boxZoom:!0});var fi=Ye.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Ce(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){xe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ie(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),$t(),_e(),this._startPoint=this._map.mouseEventToContainerPoint(t),Ce(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ne("div","leaflet-zoom-box",this._container),le(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new O(this._point,this._startPoint),n=e.getSize();me(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(ie(this._box),ue(this._container,"leaflet-crosshair")),Wt(),ve(),xe(document,{contextmenu:Me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var e=new M(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ze.addInitHook("addHandler","boxZoom",fi),Ze.mergeOptions({doubleClickZoom:!0});var mi=Ye.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,r=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(r):e.setZoomAround(t.containerPoint,r)}});Ze.addInitHook("addHandler","doubleClickZoom",mi),Ze.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var gi=Ye.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new en(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}le(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ue(this._map._container,"leaflet-grab"),ue(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=F(this._map.options.maxBounds);this._offsetLimit=R(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,r=(i-e+n)%t+e-n,s=(i+e+n)%t-e-n,o=Math.abs(r+n)<Math.abs(s+n)?r:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=o},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{this._prunePositions(+new Date);var r=this._lastPos.subtract(this._positions[0]),s=n.easeLinearity,o=r.multiplyBy(s/((this._lastTime-this._times[0])/1e3)),a=o.distanceTo([0,0]),l=Math.min(n.inertiaMaxSpeed,a),u=o.multiplyBy(l/a),c=l/(n.inertiaDeceleration*s),h=u.multiplyBy(-c/2).round();h.x||h.y?(h=e._limitOffset(h,e.options.maxBounds),S(function(){e.panBy(h,{duration:c,easeLinearity:s,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}});Ze.addInitHook("addHandler","dragging",gi),Ze.mergeOptions({keyboard:!0,keyboardPanDelta:80});var yi=Ye.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Ce(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),xe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},r=this.keyCodes;for(e=0,n=r.left.length;e<n;e++)i[r.left[e]]=[-1*t,0];for(e=0,n=r.right.length;e<n;e++)i[r.right[e]]=[t,0];for(e=0,n=r.down.length;e<n;e++)i[r.down[e]]=[0,t];for(e=0,n=r.up.length;e<n;e++)i[r.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},r=this.keyCodes;for(e=0,n=r.zoomIn.length;e<n;e++)i[r.zoomIn[e]]=t;for(e=0,n=r.zoomOut.length;e<n;e++)i[r.zoomOut[e]]=-t},_addHooks:function(){Ce(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){xe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(e=this._panKeys[n],t.shiftKey&&(e=D(e).multiplyBy(3)),i.options.maxBounds&&(e=i._limitOffset(D(e),i.options.maxBounds)),i.options.worldCopyJump){var r=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(e)));i.panTo(r)}else i.panBy(e)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Me(t)}}});Ze.addInitHook("addHandler","keyboard",yi),Ze.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _i=Ye.extend({addHooks:function(){Ce(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){xe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=je(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var r=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),r),Me(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,r=n?Math.ceil(i/n)*n:i,s=t._limitZoom(e+(this._delta>0?r:-r))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});Ze.addInitHook("addHandler","scrollWheelZoom",_i);Ze.mergeOptions({tapHold:Dt.touchNative&&Dt.safari&&Dt.mobile,tapTolerance:15});var vi=Ye.extend({addHooks:function(){Ce(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){xe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new P(e.clientX,e.clientY),this._holdTimeout=setTimeout(i(function(){this._cancel(),this._isTapValid()&&(Ce(document,"touchend",Le),Ce(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))},this),600),Ce(document,"touchend touchcancel contextmenu",this._cancel,this),Ce(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){xe(document,"touchend",Le),xe(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),xe(document,"touchend touchcancel contextmenu",this._cancel,this),xe(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new P(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var n=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});n._simulated=!0,e.target.dispatchEvent(n)}});Ze.addInitHook("addHandler","tapHold",vi),Ze.mergeOptions({touchZoom:Dt.touch,bounceAtZoomLimits:!0});var wi=Ye.extend({addHooks:function(){le(this._map._container,"leaflet-touch-zoom"),Ce(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ue(this._map._container,"leaflet-touch-zoom"),xe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Ce(document,"touchmove",this._onTouchMove,this),Ce(document,"touchend touchcancel",this._onTouchEnd,this),Le(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]),s=n.distanceTo(r)/this._startDist;if(this._zoom=e.getScaleZoom(s,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&s<1||this._zoom>e.getMaxZoom()&&s>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var o=n._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===o.x&&0===o.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(o),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),C(this._animRequest);var a=i(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=S(a,this,!0),Le(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,C(this._animRequest),xe(document,"touchmove",this._onTouchMove,this),xe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Ze.addInitHook("addHandler","touchZoom",wi),Ze.BoxZoom=fi,Ze.DoubleClickZoom=mi,Ze.Drag=gi,Ze.Keyboard=yi,Ze.ScrollWheelZoom=_i,Ze.TapHold=vi,Ze.TouchZoom=wi,t.Bounds=O,t.Browser=Dt,t.CRS=q,t.Canvas=oi,t.Circle=On,t.CircleMarker=Dn,t.Class=x,t.Control=He,t.DivIcon=ti,t.DivOverlay=Yn,t.DomEvent=ze,t.DomUtil=Se,t.Draggable=en,t.Evented=A,t.FeatureGroup=En,t.GeoJSON=Mn,t.GridLayer=ei,t.Handler=Ye,t.Icon=xn,t.ImageOverlay=Gn,t.LatLng=V,t.LatLngBounds=M,t.Layer=Sn,t.LayerGroup=Cn,t.LineUtil=fn,t.Map=Ze,t.Marker=Pn,t.Mixin=Xe,t.Path=Nn,t.Point=P,t.PolyUtil=yn,t.Polygon=Ln,t.Polyline=Rn,t.Popup=Jn,t.PosAnimation=Be,t.Projection=wn,t.Rectangle=pi,t.Renderer=si,t.SVG=hi,t.SVGOverlay=Qn,t.TileLayer=ni,t.Tooltip=Xn,t.Transformation=Z,t.Util=E,t.VideoOverlay=Kn,t.bind=i,t.bounds=R,t.canvas=ai,t.circle=function(t,e,n){return new On(t,e,n)},t.circleMarker=function(t,e){return new Dn(t,e)},t.control=$e,t.divIcon=function(t){return new ti(t)},t.extend=e,t.featureGroup=function(t,e){return new En(t,e)},t.geoJSON=$n,t.geoJson=Wn,t.gridLayer=function(t){return new ei(t)},t.icon=function(t){return new xn(t)},t.imageOverlay=function(t,e,n){return new Gn(t,e,n)},t.latLng=U,t.latLngBounds=F,t.layerGroup=function(t,e){return new Cn(t,e)},t.map=function(t,e){return new Ze(t,e)},t.marker=function(t,e){return new Pn(t,e)},t.point=D,t.polygon=function(t,e){return new Ln(t,e)},t.polyline=function(t,e){return new Rn(t,e)},t.popup=function(t,e){return new Jn(t,e)},t.rectangle=function(t,e){return new pi(t,e)},t.setOptions=d,t.stamp=s,t.svg=di,t.svgOverlay=function(t,e,n){return new Qn(t,e,n)},t.tileLayer=ii,t.tooltip=function(t,e){return new Xn(t,e)},t.transformation=H,t.version="1.9.3",t.videoOverlay=function(t,e,n){return new Kn(t,e,n)};var bi=window.L;t.noConflict=function(){return window.L=bi,this},window.L=t}(e)},7574:function(t,e,n){"use strict";n.d(e,{y:function(){return u}});var i=n(7393),r=n(9181),s=n(6490),o=n(6554),a=n(4487);var l=n(2494);let u=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:o}=this,a=function(t,e,n){if(t){if(t instanceof i.L)return t;if(t[r.b])return t[r.b]()}return t||e||n?new i.L(t,e,n):new i.L(s.c)}(t,e,n);if(a.add(o?o.call(a,this.source):this.source||l.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),l.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(t){try{return this._subscribe(t)}catch(e){l.v.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof i.L?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=c(e))((e,n)=>{let i;i=this.subscribe(e=>{try{t(e)}catch(r){n(r),i&&i.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[o.L](){return this}pipe(...t){return 0===t.length?this:function(t){return 0===t.length?a.y:1===t.length?t[0]:function(e){return t.reduce((t,e)=>e(t),e)}}(t)(this)}toPromise(t){return new(t=c(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function c(t){if(t||(t=l.v.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},6490:function(t,e,n){"use strict";n.d(e,{c:function(){return s}});var i=n(2494),r=n(4449);const s={closed:!0,next(t){},error(t){if(i.v.useDeprecatedSynchronousErrorHandling)throw t;(0,r.z)(t)},complete(){}}},9765:function(t,e,n){"use strict";n.d(e,{Yc:function(){return u},xQ:function(){return c}});var i=n(7574),r=n(7393),s=n(5319),o=n(7971),a=n(8858),l=n(9181);class u extends r.L{constructor(t){super(t),this.destination=t}}let c=(()=>{class t extends i.y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[l.b](){return new u(this)}lift(t){const e=new h(this,this);return e.operator=t,e}next(t){if(this.closed)throw new o.N;if(!this.isStopped){const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].next(t)}}error(t){if(this.closed)throw new o.N;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].error(t);this.observers.length=0}complete(){if(this.closed)throw new o.N;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let i=0;i<e;i++)n[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new o.N;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new o.N;return this.hasError?(t.error(this.thrownError),s.w.EMPTY):this.isStopped?(t.complete(),s.w.EMPTY):(this.observers.push(t),new a.W(this,t))}asObservable(){const t=new i.y;return t.source=this,t}}return t.create=(t,e)=>new h(t,e),t})();class h extends c{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):s.w.EMPTY}}},8858:function(t,e,n){"use strict";n.d(e,{W:function(){return r}});var i=n(5319);class r extends i.w{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},7393:function(t,e,n){"use strict";n.d(e,{L:function(){return u}});var i=n(9105),r=n(6490),s=n(5319),o=n(9181),a=n(2494),l=n(4449);class u extends s.w{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=r.c;break;case 1:if(!t){this.destination=r.c;break}if("object"==typeof t){t instanceof u?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new c(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new c(this,t,e,n)}}[o.b](){return this}static create(t,e,n){const i=new u(t,e,n);return i.syncErrorThrowable=!1,i}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class c extends u{constructor(t,e,n,s){super(),this._parentSubscriber=t;let o,a=this;(0,i.m)(e)?o=e:e&&(o=e.next,n=e.error,s=e.complete,e!==r.c&&(a=Object.create(e),(0,i.m)(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=n,this._complete=s}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;a.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=a.v;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,l.z)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,l.z)(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);a.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),a.v.useDeprecatedSynchronousErrorHandling)throw n;(0,l.z)(n)}}__tryOrSetError(t,e,n){if(!a.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(i){return a.v.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=i,t.syncErrorThrown=!0,!0):((0,l.z)(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}},5319:function(t,e,n){"use strict";n.d(e,{w:function(){return a}});var i=n(9796),r=n(1555),s=n(9105);const o=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();class a{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:e,_ctorUnsubscribe:n,_unsubscribe:l,_subscriptions:c}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof a)e.remove(this);else if(null!==e)for(let i=0;i<e.length;++i)e[i].remove(this);if((0,s.m)(l)){n&&(this._unsubscribe=void 0);try{l.call(this)}catch(h){t=h instanceof o?u(h.errors):[h]}}if((0,i.k)(c)){let e=-1,n=c.length;for(;++e<n;){const n=c[e];if((0,r.K)(n))try{n.unsubscribe()}catch(d){t=t||[],d instanceof o?t=t.concat(u(d.errors)):t.push(d)}}}if(t)throw new o(t)}add(t){let e=t;if(!t)return a.EMPTY;switch(typeof t){case"function":e=new a(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof a)){const t=e;e=new a,e._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:n}=e;if(null===n)e._parentOrParents=this;else if(n instanceof a){if(n===this)return e;e._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return e;n.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[e]:i.push(e),e}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}var l;function u(t){return t.reduce((t,e)=>t.concat(e instanceof o?e.errors:e),[])}a.EMPTY=((l=new a).closed=!0,l)},2494:function(t,e,n){"use strict";n.d(e,{v:function(){return r}});let i=!1;const r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=t},get useDeprecatedSynchronousErrorHandling(){return i}}},5345:function(t,e,n){"use strict";n.d(e,{IY:function(){return o},Ds:function(){return a},ft:function(){return l}});var i=n(7393),r=n(7574),s=n(7444);class o extends i.L{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class a extends i.L{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function l(t,e){if(e.closed)return;if(t instanceof r.y)return t.subscribe(e);let n;try{n=(0,s.s)(t)(e)}catch(i){e.error(i)}return n}},2441:function(t,e,n){"use strict";n.d(e,{c:function(){return a},N:function(){return l}});var i=n(9765),r=n(7574),s=n(5319),o=n(1307);class a extends r.y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new s.w,t.add(this.source.subscribe(new u(this.getSubject(),this))),t.closed&&(this._connection=null,t=s.w.EMPTY)),t}refCount(){return(0,o.x)()(this)}}const l=(()=>{const t=a.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class u extends i.Yc{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}},9193:function(t,e,n){"use strict";n.d(e,{E:function(){return r},c:function(){return s}});var i=n(7574);const r=new i.y(t=>t.complete());function s(t){return t?function(t){return new i.y(e=>t.schedule(()=>e.complete()))}(t):r}},4402:function(t,e,n){"use strict";n.d(e,{D:function(){return h}});var i=n(7574),r=n(7444),s=n(5319),o=n(6554),a=n(4087),l=n(377),u=n(4072),c=n(9489);function h(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[o.L]}(t))return function(t,e){return new i.y(n=>{const i=new s.w;return i.add(e.schedule(()=>{const r=t[o.L]();i.add(r.subscribe({next(t){i.add(e.schedule(()=>n.next(t)))},error(t){i.add(e.schedule(()=>n.error(t)))},complete(){i.add(e.schedule(()=>n.complete()))}}))})),i})}(t,e);if((0,u.t)(t))return function(t,e){return new i.y(n=>{const i=new s.w;return i.add(e.schedule(()=>t.then(t=>{i.add(e.schedule(()=>{n.next(t),i.add(e.schedule(()=>n.complete()))}))},t=>{i.add(e.schedule(()=>n.error(t)))}))),i})}(t,e);if((0,c.z)(t))return(0,a.r)(t,e);if(function(t){return t&&"function"==typeof t[l.hZ]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new i.y(n=>{const i=new s.w;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=t[l.hZ](),i.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=r.next();t=n.value,e=n.done}catch(i){return void n.error(i)}e?n.complete():(n.next(t),this.schedule())}))})),i})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof i.y?t:new i.y((0,r.s)(t))}},6693:function(t,e,n){"use strict";n.d(e,{n:function(){return o}});var i=n(7574),r=n(5015),s=n(4087);function o(t,e){return e?(0,s.r)(t,e):new i.y((0,r.V)(t))}},6682:function(t,e,n){"use strict";n.d(e,{T:function(){return a}});var i=n(7574),r=n(4869),s=n(3282),o=n(6693);function a(...t){let e=Number.POSITIVE_INFINITY,n=null,a=t[t.length-1];return(0,r.K)(a)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof a&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof i.y?t[0]:(0,s.J)(e)((0,o.n)(t,n))}},5917:function(t,e,n){"use strict";n.d(e,{of:function(){return o}});var i=n(4869),r=n(6693),s=n(4087);function o(...t){let e=t[t.length-1];return(0,i.K)(e)?(t.pop(),(0,s.r)(t,e)):(0,r.n)(t)}},8002:function(t,e,n){"use strict";n.d(e,{U:function(){return r}});var i=n(7393);function r(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new s(t,e))}}class s{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new o(t,this.project,this.thisArg))}}class o extends i.L{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}},3282:function(t,e,n){"use strict";n.d(e,{J:function(){return s}});var i=n(9773),r=n(4487);function s(t=Number.POSITIVE_INFINITY){return(0,i.zg)(r.y,t)}},9773:function(t,e,n){"use strict";n.d(e,{zg:function(){return o}});var i=n(8002),r=n(4402),s=n(5345);function o(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?s=>s.pipe(o((n,s)=>(0,r.D)(t(n,s)).pipe((0,i.U)((t,i)=>e(n,t,s,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new a(t,n)))}class a{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new l(t,this.project,this.concurrent))}}class l extends s.Ds{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(e)}_innerSub(t){const e=new s.IY(this),n=this.destination;n.add(e);const i=(0,s.ft)(t,e);i!==e&&n.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},309:function(t,e,n){"use strict";n.d(e,{ht:function(){return c},QV:function(){return l}});var i=n(7393),r=n(9193),s=n(5917),o=n(7574);class a{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return(0,s.of)(this.value);case"E":return t=this.error,new o.y(e=>e.error(t));case"C":return(0,r.c)()}var t;throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new a("N",t):a.undefinedValueNotification}static createError(t){return new a("E",void 0,t)}static createComplete(){return a.completeNotification}}function l(t,e=0){return function(n){return n.lift(new u(t,e))}}a.completeNotification=new a("C"),a.undefinedValueNotification=new a("N",void 0);class u{constructor(t,e=0){this.scheduler=t,this.delay=e}call(t,e){return e.subscribe(new c(t,this.scheduler,this.delay))}}class c extends i.L{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(c.dispatch,this.delay,new h(t,this.destination)))}_next(t){this.scheduleMessage(a.createNext(t))}_error(t){this.scheduleMessage(a.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(a.createComplete()),this.unsubscribe()}}class h{constructor(t,e){this.notification=t,this.destination=e}}},1307:function(t,e,n){"use strict";n.d(e,{x:function(){return r}});var i=n(7393);function r(){return function(t){return t.lift(new s(t))}}class s{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const i=new o(t,n),r=e.subscribe(i);return i.closed||(i.connection=n.connect()),r}}class o extends i.L{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,i=t._connection;this.connection=null,i&&(!n||i===n)&&i.unsubscribe()}}},8819:function(t,e,n){"use strict";n.d(e,{B:function(){return a}});var i=n(2441);var r=n(1307),s=n(9765);function o(){return new s.xQ}function a(){return t=>(0,r.x)()(function(t,e){return function(e){let n;n="function"==typeof t?t:function(){return t};const r=Object.create(e,i.N);return r.source=e,r.subjectFactory=n,r}}(o)(t))}},3101:function(t,e,n){"use strict";n.d(e,{R:function(){return f}});var i=n(7574);let r=1;const s=Promise.resolve(),o={};function a(t){return t in o&&(delete o[t],!0)}const l={setImmediate(t){const e=r++;return o[e]=!0,s.then(()=>a(e)&&t()),e},clearImmediate(t){a(t)}};var u=n(6465),c=n(6102);const h=new class extends c.v{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,i=-1,r=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++i<r&&(t=e.shift()));if(this.active=!1,n){for(;++i<r&&(t=e.shift());)t.unsubscribe();throw n}}}(class extends u.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=l.setImmediate(t.flush.bind(t,null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(l.clearImmediate(e),t.scheduled=void 0)}});var d=n(9796);class p extends i.y{constructor(t,e=0,n=h){var i;super(),this.source=t,this.delayTime=e,this.scheduler=n,(!(!(0,d.k)(i=e)&&i-parseFloat(i)+1>=0)||e<0)&&(this.delayTime=0),(!n||"function"!=typeof n.schedule)&&(this.scheduler=h)}static create(t,e=0,n=h){return new p(t,e,n)}static dispatch(t){const{source:e,subscriber:n}=t;return this.add(e.subscribe(n))}_subscribe(t){return this.scheduler.schedule(p.dispatch,this.delayTime,{source:this.source,subscriber:t})}}function f(t,e=0){return function(n){return n.lift(new m(t,e))}}class m{constructor(t,e){this.scheduler=t,this.delay=e}call(t,e){return new p(e,this.delay,this.scheduler).subscribe(t)}}},3342:function(t,e,n){"use strict";n.d(e,{b:function(){return o}});var i=n(7393);function r(){}var s=n(9105);function o(t,e,n){return function(i){return i.lift(new a(t,e,n))}}class a{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new l(t,this.nextOrObserver,this.error,this.complete))}}class l extends i.L{constructor(t,e,n,i){super(t),this._tapNext=r,this._tapError=r,this._tapComplete=r,this._tapError=n||r,this._tapComplete=i||r,(0,s.m)(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||r,this._tapError=e.error||r,this._tapComplete=e.complete||r)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}},4087:function(t,e,n){"use strict";n.d(e,{r:function(){return s}});var i=n(7574),r=n(5319);function s(t,e){return new i.y(n=>{const i=new r.w;let s=0;return i.add(e.schedule(function(){s!==t.length?(n.next(t[s++]),n.closed||i.add(this.schedule())):n.complete()})),i})}},6465:function(t,e,n){"use strict";n.d(e,{o:function(){return s}});var i=n(5319);class r extends i.w{constructor(t,e){super()}schedule(t,e=0){return this}}class s extends r{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n,i=!1;try{this.work(t)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}},6102:function(t,e,n){"use strict";n.d(e,{v:function(){return r}});let i=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class r extends i{constructor(t,e=i.now){super(t,()=>r.delegate&&r.delegate!==this?r.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return r.delegate&&r.delegate!==this?r.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}},3637:function(t,e,n){"use strict";n.d(e,{z:function(){return r}});var i=n(6465);const r=new(n(6102).v)(i.o)},7771:function(t,e,n){"use strict";n.d(e,{c:function(){return o},N:function(){return s}});var i=n(6465),r=n(6102);const s=new class extends r.v{}(class extends i.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}),o=s},377:function(t,e,n){"use strict";n.d(e,{hZ:function(){return i}});const i="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},6554:function(t,e,n){"use strict";n.d(e,{L:function(){return i}});const i="function"==typeof Symbol&&Symbol.observable||"@@observable"},9181:function(t,e,n){"use strict";n.d(e,{b:function(){return i}});const i="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()},7971:function(t,e,n){"use strict";n.d(e,{N:function(){return i}});const i=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})()},4449:function(t,e,n){"use strict";function i(t){setTimeout(()=>{throw t},0)}n.d(e,{z:function(){return i}})},4487:function(t,e,n){"use strict";function i(t){return t}n.d(e,{y:function(){return i}})},9796:function(t,e,n){"use strict";n.d(e,{k:function(){return i}});const i=Array.isArray||(t=>t&&"number"==typeof t.length)},9489:function(t,e,n){"use strict";n.d(e,{z:function(){return i}});const i=t=>t&&"number"==typeof t.length&&"function"!=typeof t},9105:function(t,e,n){"use strict";function i(t){return"function"==typeof t}n.d(e,{m:function(){return i}})},1555:function(t,e,n){"use strict";function i(t){return null!==t&&"object"==typeof t}n.d(e,{K:function(){return i}})},4072:function(t,e,n){"use strict";function i(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}n.d(e,{t:function(){return i}})},4869:function(t,e,n){"use strict";function i(t){return t&&"function"==typeof t.schedule}n.d(e,{K:function(){return i}})},7444:function(t,e,n){"use strict";n.d(e,{s:function(){return c}});var i=n(5015),r=n(4449),s=n(377),o=n(6554),a=n(9489),l=n(4072),u=n(1555);const c=t=>{if(t&&"function"==typeof t[o.L])return(t=>e=>{const n=t[o.L]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)})(t);if((0,a.z)(t))return(0,i.V)(t);if((0,l.t)(t))return(t=>e=>(t.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,r.z),e))(t);if(t&&"function"==typeof t[s.hZ])return(t=>e=>{const n=t[s.hZ]();for(;;){let t;try{t=n.next()}catch(i){return e.error(i),e}if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e})(t);{const e=`You provided ${(0,u.K)(t)?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(e)}}},5015:function(t,e,n){"use strict";n.d(e,{V:function(){return i}});const i=t=>e=>{for(let n=0,i=t.length;n<i&&!e.closed;n++)e.next(t[n]);e.complete()}},4622:function(t,e,n){"use strict";var i=n(7716);let r=null;function s(){return r}const o=new i.OlP("DocumentToken");let a=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,i.Yz7)({factory:l,token:t,providedIn:"platform"}),t})();function l(){return(0,i.LFG)(c)}const u=new i.OlP("Location Initialized");let c=(()=>{class t extends a{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return s().getBaseHref(this._doc)}onPopState(t){const e=s().getGlobalEventTarget(this._doc,"window");return e.addEventListener("popstate",t,!1),()=>e.removeEventListener("popstate",t)}onHashChange(t){const e=s().getGlobalEventTarget(this._doc,"window");return e.addEventListener("hashchange",t,!1),()=>e.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){h()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){h()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=(0,i.Yz7)({factory:d,token:t,providedIn:"platform"}),t})();function h(){return!!window.history.pushState}function d(){return new c((0,i.LFG)(o))}function p(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function f(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function m(t){return t&&"?"!==t[0]?"?"+t:t}let g=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,i.Yz7)({factory:y,token:t,providedIn:"root"}),t})();function y(t){const e=(0,i.LFG)(o).location;return new v((0,i.LFG)(a),e&&e.origin||"")}const _=new i.OlP("appBaseHref");let v=(()=>{class t extends g{constructor(t,e){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return p(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+m(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,i){const r=this.prepareExternalUrl(n+m(i));this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){const r=this.prepareExternalUrl(n+m(i));this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformLocation).historyGo)||void 0===n||n.call(e,t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(a),i.LFG(_,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),w=(()=>{class t extends g{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=e&&(this._baseHref=e)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=p(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,i){let r=this.prepareExternalUrl(n+m(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){let r=this.prepareExternalUrl(n+m(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformLocation).historyGo)||void 0===n||n.call(e,t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(a),i.LFG(_,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),b=(()=>{class t{constructor(t,e){this._subject=new i.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=f(I(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+m(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,I(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+m(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+m(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformStrategy).historyGo)||void 0===n||n.call(e,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(g),i.LFG(a))},t.normalizeQueryParams=m,t.joinWithSlash=p,t.stripTrailingSlash=f,t.\u0275prov=(0,i.Yz7)({factory:T,token:t,providedIn:"root"}),t})();function T(){return new b((0,i.LFG)(g),(0,i.LFG)(a))}function I(t){return t.replace(/\/index.html$/,"")}var S=(()=>((S=S||{})[S.Zero=0]="Zero",S[S.One=1]="One",S[S.Two=2]="Two",S[S.Few=3]="Few",S[S.Many=4]="Many",S[S.Other=5]="Other",S))();const C=i.kL8;class E{}let x=(()=>{class t extends E{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(C(e||this.locale)(t)){case S.Zero:return"zero";case S.One:return"one";case S.Two:return"two";case S.Few:return"few";case S.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.soG))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function k(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[i,r]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(i.trim()===e)return decodeURIComponent(r)}return null}class A{constructor(t,e,n,i){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let P=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(t){throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(t){return t.name||typeof t}(e)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,i)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new A(null,this._ngForOf,-1,-1),null===i?void 0:i),r=new N(t,n);e.push(r)}else if(null==i)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const r=this._viewContainer.get(n);this._viewContainer.move(r,i);const s=new N(t,r);e.push(s)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,i=this._viewContainer.length;n<i;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=i,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.s_b),i.Y36(i.Rgc),i.Y36(i.ZZ4))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class N{constructor(t,e){this.record=t,this.view=e}}let D=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new O,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){R("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){R("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.s_b),i.Y36(i.Rgc))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class O{constructor(){this.$implicit=null,this.ngIf=null}}function R(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${(0,i.AaK)(e)}'.`)}class L{createSubscription(t,e){return t.subscribe({next:e,error:t=>{throw t}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}}class M{createSubscription(t,e){return t.then(e,t=>{throw t})}dispose(t){}onDestroy(t){}}const F=new M,V=new L;let U=(()=>{class t{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,e=>this._updateLatestValue(t,e))}_selectStrategy(e){if((0,i.QGY)(e))return F;if((0,i.F4k)(e))return V;throw function(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${(0,i.AaK)(t)}'`)}(t,e)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,e){t===this._obj&&(this._latestValue=e,this._ref.markForCheck())}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.sBO,16))},t.\u0275pipe=i.Yjl({name:"async",type:t,pure:!1}),t})(),j=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[{provide:E,useClass:x}]}),t})();function q(t){return"server"===t}let z=(()=>{class t{}return t.\u0275prov=(0,i.Yz7)({token:t,providedIn:"root",factory:()=>new B((0,i.LFG)(o),window)}),t})();class B{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const n=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const t=i.shadowRoot;if(t){const n=t.getElementById(e)||t.querySelector(`[name="${e}"]`);if(n)return n}i=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),this.attemptFocus(e))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,i=e.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(n-r[0],i-r[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=Z(this.window.history)||Z(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function Z(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class H{}class $ extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var t;t=new $,r||(r=t)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=(G=G||document.querySelector("base"),G?G.getAttribute("href"):null);return null==e?null:function(t){W=W||document.createElement("a"),W.setAttribute("href",t);const e=W.pathname;return"/"===e.charAt(0)?e:`/${e}`}(e)}resetBaseElement(){G=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return k(document.cookie,t)}}let W,G=null;const K=new i.OlP("TRANSITION_ID"),Q=[{provide:i.ip1,useFactory:function(t,e,n){return()=>{n.get(i.CZH).donePromise.then(()=>{const n=s(),i=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let t=0;t<i.length;t++)n.remove(i[t])})}},deps:[K,o,i.zs3],multi:!0}];class Y{static init(){(0,i.VLi)(new Y)}addToWindow(t){i.dqk.getAngularTestability=(e,n=!0)=>{const i=t.findTestabilityInTree(e,n);if(null==i)throw new Error("Could not find testability for element.");return i},i.dqk.getAllAngularTestabilities=()=>t.getAllTestabilities(),i.dqk.getAllAngularRootElements=()=>t.getAllRootElements(),i.dqk.frameworkStabilizers||(i.dqk.frameworkStabilizers=[]),i.dqk.frameworkStabilizers.push(t=>{const e=i.dqk.getAllAngularTestabilities();let n=e.length,r=!1;const s=function(e){r=r||e,n--,0==n&&t(r)};e.forEach(function(t){t.whenStable(s)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const i=t.getTestability(e);return null!=i?i:n?s().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let J=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const X=new i.OlP("EventManagerPlugins");let tt=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let i=0;i<n.length;i++){const e=n[i];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(X),i.LFG(i.R0b))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class et{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const i=s().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,n)}}let nt=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),it=(()=>{class t extends nt{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,e,n){t.forEach(t=>{const i=this._doc.createElement("style");i.textContent=t,n.push(e.appendChild(i))})}addHost(t){const e=[];this._addStylesToHost(this._stylesSet,t,e),this._hostNodes.set(t,e)}removeHost(t){const e=this._hostNodes.get(t);e&&e.forEach(rt),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((e,n)=>{this._addStylesToHost(t,n,e)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(rt))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function rt(t){s().remove(t)}const st={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ot=/%COMP%/g;function at(t,e,n){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?at(t,r,n):(r=r.replace(ot,t),n.push(r))}return n}function lt(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let ut=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new ct(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case i.ifc.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new ht(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case i.ifc.ShadowDom:return new dt(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=at(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(tt),i.LFG(it),i.LFG(i.AFp))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class ct{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(st[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,i){if(i){e=i+":"+e;const r=st[i];r?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const i=st[n];i?t.removeAttributeNS(i,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(i.JOm.DashCase|i.JOm.Important)?t.style.setProperty(e,n,r&i.JOm.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&i.JOm.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,lt(n)):this.eventManager.addEventListener(t,e,lt(n))}}class ht extends ct{constructor(t,e,n,i){super(t),this.component=n;const r=at(i+"-"+n.id,n.styles,[]);e.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(ot,i+"-"+n.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(ot,t)}(i+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class dt extends ct{constructor(t,e,n,i){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=at(i.id,i.styles,[]);for(let s=0;s<r.length;s++){const t=document.createElement("style");t.textContent=r[s],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let pt=(()=>{class t extends et{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const ft=["alt","control","meta","shift"],mt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gt={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},yt={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let _t=(()=>{class t extends et{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,i){const r=t.parseEventName(n),o=t.eventCallback(r.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>s().onAndCancel(e,r.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const r=t._normalizeKey(n.pop());let s="";if(ft.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),s+=t+".")}),s+=r,0!=n.length||0===r.length)return null;const o={};return o.domEventName=i,o.fullKey=s,o}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&gt.hasOwnProperty(e)&&(e=gt[e]))}return mt[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),ft.forEach(i=>{i!=n&&yt[i](t)&&(e+=i+".")}),e+=n,e}static eventCallback(e,n,i){return r=>{t.getEventFullKey(r)===e&&i.runGuarded(()=>n(r))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const vt=(0,i.eFA)(i._c5,"browser",[{provide:i.Lbi,useValue:"browser"},{provide:i.g9A,useValue:function(){$.makeCurrent(),Y.init()},multi:!0},{provide:o,useFactory:function(){return(0,i.RDi)(document),document},deps:[]}]),wt=[[],{provide:i.zSh,useValue:"root"},{provide:i.qLn,useFactory:function(){return new i.qLn},deps:[]},{provide:X,useClass:pt,multi:!0,deps:[o,i.R0b,i.Lbi]},{provide:X,useClass:_t,multi:!0,deps:[o]},[],{provide:ut,useClass:ut,deps:[tt,it,i.AFp]},{provide:i.FYo,useExisting:ut},{provide:nt,useExisting:it},{provide:it,useClass:it,deps:[o]},{provide:i.dDg,useClass:i.dDg,deps:[i.R0b]},{provide:tt,useClass:tt,deps:[X,i.R0b]},{provide:H,useClass:J,deps:[]},[]];let bt=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:i.AFp,useValue:e.appId},{provide:K,useExisting:i.AFp},Q]}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(t,12))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:wt,imports:[j,i.hGG]}),t})();"undefined"!=typeof window&&window;var Tt=n(8939),It=n(3637),St=n(7574),Ct=n(4402),Et=n(5917),xt=n(8445),kt=n(3282);function At(...t){return(0,kt.J)(1)((0,Et.of)(...t))}var Pt=n(4869);function Nt(...t){const e=t[t.length-1];return(0,Pt.K)(e)?(t.pop(),n=>At(t,n,e)):e=>At(t,e)}var Dt=n(7393);function Ot(){return t=>t.lift(new Rt)}class Rt{call(t,e){return e.subscribe(new Lt(t))}}class Lt extends Dt.L{constructor(t){super(t),this.hasPrev=!1}_next(t){let e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}var Mt=n(8002);function Ft(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new Vt(t,e,n))}}class Vt{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new Ut(t,this.accumulator,this.seed,this.hasSeed))}}class Ut extends Dt.L{constructor(t,e,n,i){super(t),this.accumulator=e,this._seed=n,this.hasSeed=i,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(i){this.destination.error(i)}this.seed=n,this.destination.next(n)}}function jt(t,e){return n=>n.lift(new qt(t,e))}class qt{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new zt(t,this.compare,this.keySelector))}}class zt extends Dt.L{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(i){return this.destination.error(i)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(i){return this.destination.error(i)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}function Bt(t,e){return function(n){return n.lift(new Zt(t,e))}}class Zt{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Ht(t,this.predicate,this.thisArg))}}class Ht extends Dt.L{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}n(3474);var $t,Wt=n(3394),Gt=n(8239),Kt=n(8026),Qt=n(3910),Yt=n(5422),Jt=n(3854),Xt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},te={},ee=ee||{},ne=Xt||self;function ie(){}function re(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function se(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var oe="closure_uid_"+(1e9*Math.random()>>>0),ae=0;function le(t,e,n){return t.call.apply(t.bind,arguments)}function ue(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ce(t,e,n){return(ce=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?le:ue).apply(null,arguments)}function he(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function de(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function pe(){this.s=this.s,this.o=this.o}pe.prototype.s=!1,pe.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,oe)&&t[oe]||(t[oe]=++ae))},pe.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const fe=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function me(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function ge(t,e){for(let n=1;n<arguments.length;n++){const e=arguments[n];if(re(e)){const n=t.length||0,i=e.length||0;t.length=n+i;for(let r=0;r<i;r++)t[n+r]=e[r]}else t.push(e)}}function ye(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ye.prototype.h=function(){this.defaultPrevented=!0};var _e=function(){if(!ne.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ne.addEventListener("test",ie,e),ne.removeEventListener("test",ie,e)}catch(n){}return t}();function ve(t){return/^[\s\xa0]*$/.test(t)}var we=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function be(t,e){return t<e?-1:t>e?1:0}function Te(){var t=ne.navigator;return t&&(t=t.userAgent)?t:""}function Ie(t){return-1!=Te().indexOf(t)}function Se(t){return Se[" "](t),t}Se[" "]=ie;var Ce,Ee,xe=Ie("Opera"),ke=Ie("Trident")||Ie("MSIE"),Ae=Ie("Edge"),Pe=Ae||ke,Ne=Ie("Gecko")&&!(-1!=Te().toLowerCase().indexOf("webkit")&&!Ie("Edge"))&&!(Ie("Trident")||Ie("MSIE"))&&!Ie("Edge"),De=-1!=Te().toLowerCase().indexOf("webkit")&&!Ie("Edge");function Oe(){var t=ne.document;return t?t.documentMode:void 0}t:{var Re="",Le=(Ee=Te(),Ne?/rv:([^\);]+)(\)|;)/.exec(Ee):Ae?/Edge\/([\d\.]+)/.exec(Ee):ke?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ee):De?/WebKit\/(\S+)/.exec(Ee):xe?/(?:Version)[ \/]?(\S+)/.exec(Ee):void 0);if(Le&&(Re=Le?Le[1]:""),ke){var Me=Oe();if(null!=Me&&Me>parseFloat(Re)){Ce=String(Me);break t}}Ce=Re}var Fe={};function Ve(){return t=Fe,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let t=0;const e=we(String(Ce)).split("."),n=we("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var r=e[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;t=be(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||be(0==r[2].length,0==s[2].length)||be(r[2],s[2]),r=r[3],s=s[3]}while(0==t)}return 0<=t}();var t}var Ue=ne.document&&ke&&(Oe()||parseInt(Ce,10))||void 0;function je(t,e){if(ye.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Ne){t:{try{Se(e.nodeName);var r=!0;break t}catch(s){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:qe[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&je.X.h.call(this)}}de(je,ye);var qe={2:"touch",3:"pen",4:"mouse"};je.prototype.h=function(){je.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ze="closure_listenable_"+(1e6*Math.random()|0),Be=0;function Ze(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ha=r,this.key=++Be,this.ba=this.ea=!1}function He(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function $e(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function We(t){const e={};for(const n in t)e[n]=t[n];return e}const Ge="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ke(t,e){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)t[n]=i[n];for(let e=0;e<Ge.length;e++)n=Ge[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Qe(t){this.src=t,this.g={},this.h=0}function Ye(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=fe(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(He(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Je(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ba&&s.listener==e&&s.capture==!!n&&s.ha==i)return r}return-1}Qe.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Je(t,e,i,r);return-1<o?(e=t[o],n||(e.ea=!1)):((e=new Ze(e,this.src,s,!!i,r)).ea=n,t.push(e)),e};var Xe="closure_lm_"+(1e6*Math.random()|0),tn={};function en(t,e,n,i,r){if(i&&i.once)return rn(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)en(t,e[s],n,i,r);return null}return n=hn(n),t&&t[ze]?t.N(e,n,se(i)?!!i.capture:!!i,r):nn(t,e,n,!1,i,r)}function nn(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=se(r)?!!r.capture:!!r,a=un(t);if(a||(t[Xe]=a=new Qe(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=ln;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)_e||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(an(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function rn(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)rn(t,e[s],n,i,r);return null}return n=hn(n),t&&t[ze]?t.O(e,n,se(i)?!!i.capture:!!i,r):nn(t,e,n,!0,i,r)}function sn(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)sn(t,e[s],n,i,r);else i=se(i)?!!i.capture:!!i,n=hn(n),t&&t[ze]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Je(s=t.g[e],n,i,r))&&(He(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=un(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Je(e,n,i,r)),(n=-1<t?e[t]:null)&&on(n))}function on(t){if("number"!=typeof t&&t&&!t.ba){var e=t.src;if(e&&e[ze])Ye(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(an(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=un(e))?(Ye(n,t),0==n.h&&(n.src=null,e[Xe]=null)):He(t)}}}function an(t){return t in tn?tn[t]:tn[t]="on"+t}function ln(t,e){if(t.ba)t=!0;else{e=new je(e,this);var n=t.listener,i=t.ha||t.src;t.ea&&on(t),t=n.call(i,e)}return t}function un(t){return(t=t[Xe])instanceof Qe?t:null}var cn="__closure_events_fn_"+(1e9*Math.random()>>>0);function hn(t){return"function"==typeof t?t:(t[cn]||(t[cn]=function(e){return t.handleEvent(e)}),t[cn])}function dn(){pe.call(this),this.i=new Qe(this),this.P=this,this.I=null}function pn(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new ye(e,t);else if(e instanceof ye)e.target=e.target||t;else{var r=e;Ke(e=new ye(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=fn(o,i,!0,e)&&r}if(r=fn(o=e.g=t,i,!0,e)&&r,r=fn(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=fn(o=e.g=n[s],i,!1,e)&&r}function fn(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ba&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.ea&&Ye(t.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}de(dn,pe),dn.prototype[ze]=!0,dn.prototype.removeEventListener=function(t,e,n,i){sn(this,t,e,n,i)},dn.prototype.M=function(){if(dn.X.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)He(n[i]);delete e.g[t],e.h--}}this.I=null},dn.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},dn.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var mn=ne.JSON.stringify;function gn(){var t=In;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var yn,_n=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new vn,t=>t.reset());class vn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function wn(t){ne.setTimeout(()=>{throw t},0)}function bn(t,e){yn||function(){var t=ne.Promise.resolve(void 0);yn=function(){t.then(Sn)}}(),Tn||(yn(),Tn=!0),In.add(t,e)}var Tn=!1,In=new class{constructor(){this.h=this.g=null}add(t,e){const n=_n.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Sn(){for(var t;t=gn();){try{t.h.call(t.g)}catch(n){wn(n)}var e=_n;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Tn=!1}function Cn(t,e){dn.call(this),this.h=t||1,this.g=e||ne,this.j=ce(this.lb,this),this.l=Date.now()}function En(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function xn(t,e,n){if("function"==typeof t)n&&(t=ce(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ce(t.handleEvent,t)}return 2147483647<Number(e)?-1:ne.setTimeout(t,e||0)}function kn(t){t.g=xn(()=>{t.g=null,t.i&&(t.i=!1,kn(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}de(Cn,dn),($t=Cn.prototype).ca=!1,$t.R=null,$t.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),pn(this,"tick"),this.ca&&(En(this),this.start()))}},$t.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},$t.M=function(){Cn.X.M.call(this),En(this),delete this.g};class An extends pe{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:kn(this)}M(){super.M(),this.g&&(ne.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pn(t){pe.call(this),this.h=t,this.g={}}de(Pn,pe);var Nn=[];function Dn(t,e,n,i){Array.isArray(n)||(n&&(Nn[0]=n.toString()),n=Nn);for(var r=0;r<n.length;r++){var s=en(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function On(t){$e(t.g,function(t,e){this.g.hasOwnProperty(e)&&on(t)},t),t.g={}}function Rn(){this.g=!0}function Ln(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return mn(n)}catch(a){return e}}(t,n)+(i?" "+i:"")})}Pn.prototype.M=function(){Pn.X.M.call(this),On(this)},Pn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Rn.prototype.Aa=function(){this.g=!1},Rn.prototype.info=function(){};var Mn={},Fn=null;function Vn(){return Fn=Fn||new dn}function Un(t){ye.call(this,Mn.Pa,t)}function jn(t){const e=Vn();pn(e,new Un(e))}function qn(t,e){ye.call(this,Mn.STAT_EVENT,t),this.stat=e}function zn(t){const e=Vn();pn(e,new qn(e,t))}function Bn(t,e){ye.call(this,Mn.Qa,t),this.size=e}function Zn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return ne.setTimeout(function(){t()},e)}Mn.Pa="serverreachability",de(Un,ye),Mn.STAT_EVENT="statevent",de(qn,ye),Mn.Qa="timingevent",de(Bn,ye);var Hn={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},$n={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function Wn(){}function Gn(){}Wn.prototype.h=null;var Kn,Qn={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Yn(){ye.call(this,"d")}function Jn(){ye.call(this,"c")}function Xn(){}function ti(t,e,n,i){this.l=t,this.j=e,this.m=n,this.U=i||1,this.S=new Pn(this),this.O=ni,this.T=new Cn(t=Pe?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new ei}function ei(){this.i=null,this.g="",this.h=!1}de(Yn,ye),de(Jn,ye),de(Xn,Wn),Xn.prototype.g=function(){return new XMLHttpRequest},Xn.prototype.i=function(){return{}},Kn=new Xn;var ni=45e3,ii={},ri={};function si(t,e,n){t.K=1,t.v=Si(vi(e)),t.s=n,t.P=!0,oi(t,null)}function oi(t,e){t.F=Date.now(),ci(t),t.A=vi(t.v);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),Fi(n.i,"t",i),t.C=0,n=t.l.H,t.h=new ei,t.g=Mr(t.l,n?e:null,!t.s),0<t.N&&(t.L=new An(ce(t.La,t,t.g),t.N)),Dn(t.S,t.g,"readystatechange",t.ib),e=t.H?We(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),jn(),function(t,e,n,i,r,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&"type"==h[1]?o+(c+"=")+u+"&":o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o})}(t.j,t.u,t.A,t.m,t.U,t.s)}function ai(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Da}function li(t,e,n){let i,r=!0;for(;!t.I&&t.C<n.length;){if(i=ui(t,n),i==ri){4==e&&(t.o=4,zn(14),r=!1),Ln(t.j,t.m,null,"[Incomplete Response]");break}if(i==ii){t.o=4,zn(15),Ln(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Ln(t.j,t.m,i,null),mi(t,i)}ai(t)&&i!=ri&&i!=ii&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,zn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),kr(e),e.K=!0,zn(11))):(Ln(t.j,t.m,n,"[Invalid Chunked Response]"),fi(t),pi(t))}function ui(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?ri:(n=Number(e.substring(n,i)),isNaN(n)?ii:(i+=1)+n>e.length?ri:(e=e.substr(i,n),t.C=i+n,e))}function ci(t){t.V=Date.now()+t.O,hi(t,t.O)}function hi(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Zn(ce(t.gb,t),e)}function di(t){t.B&&(ne.clearTimeout(t.B),t.B=null)}function pi(t){0==t.l.G||t.I||Nr(t.l,t)}function fi(t){di(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,En(t.T),On(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function mi(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Bi(n.h,t)))if(!t.J&&Bi(n.h,t)&&3==n.G){try{var i=n.Fa.g.parse(e)}catch(u){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0])t:if(n.u)n.Ba=r[1],0<n.Ba-n.T&&37500>r[2]&&n.L&&0==n.A&&!n.v&&(n.v=Zn(ce(n.cb,n),6e3));else{if(n.g){if(!(n.g.F+3e3<t.F))break t;Pr(n),wr(n)}xr(n),zn(18)}if(1>=zi(n.h)&&n.ja){try{n.ja()}catch(u){}n.ja=void 0}}else Or(n,11)}else if((t.J||n.g==t)&&Pr(n),!ve(e))for(r=n.Fa.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.I=u[1],n.ka=u[2];const e=u[3];null!=e&&(n.ma=e,n.j.info("VER="+n.ma));const r=u[4];null!=r&&(n.Ca=r,n.j.info("SVER="+n.Ca));const c=u[5];null!=c&&"number"==typeof c&&0<c&&(n.J=i=1.5*c,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Zi(s,s.h),s.h=null))}if(i.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.za=t,Ii(i.F,i.D,t))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=t;if((i=n).sa=Lr(i,i.H?i.ka:null,i.V),o.J){Hi(i.h,o);var a=o,l=i.J;l&&a.setTimeout(l),a.B&&(di(a),ci(a)),i.g=o}else Er(i);0<n.i.length&&Tr(n)}else"stop"!=u[0]&&"close"!=u[0]||Or(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Or(n,7):vr(n):"noop"!=u[0]&&n.l&&n.l.wa(u),n.A=0)}jn()}catch(u){}}function gi(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(re(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(re(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.W&&"function"==typeof t.W)return t.W();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(re(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}($t=ti.prototype).setTimeout=function(t){this.O=t},$t.ib=function(t){t=t.target;const e=this.L;e&&3==pr(t)?e.l():this.La(t)},$t.La=function(t){try{if(t==this.g)t:{const c=pr(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>c)&&(3!=c||Pe||this.g&&(this.h.h||this.g.fa()||fr(this.g)))){this.I||4!=c||7==e||jn(),di(this);var n=this.g.aa();this.Y=n;e:if(ai(this)){var i=fr(this.g);t="";var r=i.length,s=4==pr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){fi(this),pi(this);var o="";break e}this.h.i=new ne.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.U,c,n),this.i){if(this.Z&&!this.J){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ve(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.o=3,zn(12),fi(this),pi(this);break t}Ln(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,mi(this,n)}this.P?(li(this,c,o),Pe&&this.i&&3==c&&(Dn(this.S,this.T,"tick",this.hb),this.T.start())):(Ln(this.j,this.m,o,null),mi(this,o)),4==c&&fi(this),this.i&&!this.I&&(4==c?Nr(this.l,this):(this.i=!1,ci(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,zn(12)):(this.o=0,zn(13)),fi(this),pi(this)}}}catch(c){}},$t.hb=function(){if(this.g){var t=pr(this.g),e=this.g.fa();this.C<e.length&&(di(this),li(this,t,e),this.i&&4!=t&&ci(this))}},$t.cancel=function(){this.I=!0,fi(this)},$t.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(jn(),zn(17)),fi(this),this.o=2,pi(this)):hi(this,this.V-t)};var yi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _i(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof _i){this.h=void 0!==e?e:t.h,wi(this,t.j),this.s=t.s,this.g=t.g,bi(this,t.m),this.l=t.l,e=t.i;var n=new Oi;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Ti(this,n),this.o=t.o}else t&&(n=String(t).match(yi))?(this.h=!!e,wi(this,n[1]||"",!0),this.s=Ci(n[2]||""),this.g=Ci(n[3]||"",!0),bi(this,n[4]),this.l=Ci(n[5]||"",!0),Ti(this,n[6]||"",!0),this.o=Ci(n[7]||"")):(this.h=!!e,this.i=new Oi(null,this.h))}function vi(t){return new _i(t)}function wi(t,e,n){t.j=n?Ci(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function bi(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ti(t,e,n){e instanceof Oi?(t.i=e,function(t,e){e&&!t.j&&(Ri(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Li(this,e),Fi(this,n,t))},t)),t.j=e}(t.i,t.h)):(n||(e=Ei(e,Ni)),t.i=new Oi(e,t.h))}function Ii(t,e,n){t.i.set(e,n)}function Si(t){return Ii(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ci(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ei(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,xi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function xi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}_i.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ei(e,ki,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Ei(e,ki,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ei(n,"/"==n.charAt(0)?Pi:Ai,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ei(n,Di)),t.join("")};var ki=/[#\/\?@]/g,Ai=/[#\?:]/g,Pi=/[#\?]/g,Ni=/[#\?@]/g,Di=/#/g;function Oi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ri(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Li(t,e){Ri(t),e=Vi(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Mi(t,e){return Ri(t),e=Vi(t,e),t.g.has(e)}function Fi(t,e,n){Li(t,e),0<n.length&&(t.i=null,t.g.set(Vi(t,e),me(n)),t.h+=n.length)}function Vi(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ui(t){this.l=t||ji,t=ne.PerformanceNavigationTiming?0<(t=ne.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(ne.g&&ne.g.Ga&&ne.g.Ga()&&ne.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}($t=Oi.prototype).add=function(t,e){Ri(this),this.i=null,t=Vi(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},$t.forEach=function(t,e){Ri(this),this.g.forEach(function(n,i){n.forEach(function(n){t.call(e,n,i,this)},this)},this)},$t.oa=function(){Ri(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},$t.W=function(t){Ri(this);let e=[];if("string"==typeof t)Mi(this,t)&&(e=e.concat(this.g.get(Vi(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},$t.set=function(t,e){return Ri(this),this.i=null,Mi(this,t=Vi(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},$t.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},$t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.W(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var ji=10;function qi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function zi(t){return t.h?1:t.g?t.g.size:0}function Bi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Zi(t,e){t.g?t.g.add(e):t.h=e}function Hi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function $i(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return me(t.i)}function Wi(){}function Gi(){this.g=new Wi}function Ki(t,e,n){const i=n||"";try{gi(t,function(t,n){let r=t;se(t)&&(r=mn(t)),e.push(i+n+"="+encodeURIComponent(r))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function Qi(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(s){}}function Yi(t){this.l=t.ac||null,this.j=t.jb||!1}function Ji(t,e){dn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Xi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ui.prototype.cancel=function(){if(this.i=$i(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},Wi.prototype.stringify=function(t){return ne.JSON.stringify(t,void 0)},Wi.prototype.parse=function(t){return ne.JSON.parse(t,void 0)},de(Yi,Wn),Yi.prototype.g=function(){return new Ji(this.l,this.j)},Yi.prototype.i=function(t){return function(){return t}}({}),de(Ji,dn);var Xi=0;function tr(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function er(t){t.readyState=4,t.l=null,t.j=null,t.A=null,nr(t)}function nr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}($t=Ji.prototype).open=function(t,e){if(this.readyState!=Xi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,nr(this)},$t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ne).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},$t.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,er(this)),this.readyState=Xi},$t.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,nr(this)),this.g&&(this.readyState=3,nr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==ne.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;tr(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},$t.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?er(this):nr(this),3==this.readyState&&tr(this)}},$t.Va=function(t){this.g&&(this.response=this.responseText=t,er(this))},$t.Ua=function(t){this.g&&(this.response=t,er(this))},$t.ga=function(){this.g&&er(this)},$t.setRequestHeader=function(t,e){this.v.append(t,e)},$t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},$t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ji.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var ir=ne.JSON.parse;function rr(t){dn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=sr,this.K=this.L=!1}de(rr,dn);var sr="",or=/^https?$/i,ar=["POST","PUT"];function lr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ur(t),hr(t)}function ur(t){t.D||(t.D=!0,pn(t,"complete"),pn(t,"error"))}function cr(t){if(t.h&&void 0!==ee&&(!t.C[1]||4!=pr(t)||2!=t.aa()))if(t.v&&4==pr(t))xn(t.Ha,0,t);else if(pn(t,"readystatechange"),4==pr(t)){t.h=!1;try{const l=t.aa();t:switch(l){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===l){var r=String(t.H).match(yi)[1]||null;if(!r&&ne.self&&ne.self.location){var s=ne.self.location.protocol;r=s.substr(0,s.length-1)}i=!or.test(r?r.toLowerCase():"")}n=i}if(n)pn(t,"complete"),pn(t,"success");else{t.m=6;try{var o=2<pr(t)?t.g.statusText:""}catch(a){o=""}t.j=o+" ["+t.aa()+"]",ur(t)}}finally{hr(t)}}}function hr(t,e){if(t.g){dr(t);const i=t.g,r=t.C[0]?ie:null;t.g=null,t.C=null,e||pn(t,"ready");try{i.onreadystatechange=r}catch(n){}}}function dr(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ne.clearTimeout(t.A),t.A=null)}function pr(t){return t.g?t.g.readyState:0}function fr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case sr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function mr(t){let e="";return $e(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function gr(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=mr(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ii(t,e,n))}function yr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function _r(t){this.Ca=0,this.i=[],this.j=new Rn,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=yr("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=yr("baseRetryDelayMs",5e3,t),this.bb=yr("retryDelaySeedMs",1e4,t),this.$a=yr("forwardChannelMaxRetries",2,t),this.ta=yr("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Ui(t&&t.concurrentRequestLimit),this.Fa=new Gi,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function vr(t){if(br(t),3==t.G){var e=t.U++,n=vi(t.F);Ii(n,"SID",t.I),Ii(n,"RID",e),Ii(n,"TYPE","terminate"),Sr(t,n),(e=new ti(t,t.j,e,void 0)).K=2,e.v=Si(vi(n)),n=!1,ne.navigator&&ne.navigator.sendBeacon&&(n=ne.navigator.sendBeacon(e.v.toString(),"")),!n&&ne.Image&&((new Image).src=e.v,n=!0),n||(e.g=Mr(e.l,null),e.g.da(e.v)),e.F=Date.now(),ci(e)}Rr(t)}function wr(t){t.g&&(kr(t),t.g.cancel(),t.g=null)}function br(t){wr(t),t.u&&(ne.clearTimeout(t.u),t.u=null),Pr(t),t.h.cancel(),t.m&&("number"==typeof t.m&&ne.clearTimeout(t.m),t.m=null)}function Tr(t){qi(t.h)||t.m||(t.m=!0,bn(t.Ja,t),t.C=0)}function Ir(t,e){var n;n=e?e.m:t.U++;const i=vi(t.F);Ii(i,"SID",t.I),Ii(i,"RID",n),Ii(i,"AID",t.T),Sr(t,i),t.o&&t.s&&gr(i,t.o,t.s),n=new ti(t,t.j,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=Cr(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),Zi(t.h,n),si(n,i,e)}function Sr(t,e){t.ia&&$e(t.ia,function(t,n){Ii(e,n,t)}),t.l&&gi({},function(t,n){Ii(e,n,t)})}function Cr(t,e,n){n=Math.min(t.i.length,n);var i=t.l?ce(t.l.Ra,t.l,t):null;t:{var r=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let a=0;a<n;a++){let n=r[a].h;const l=r[a].g;if(n-=e,0>n)e=Math.max(0,r[a].h-100),o=!1;else try{Ki(l,t,"req"+n+"_")}catch(s){i&&i(l)}}if(o){i=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,i}function Er(t){t.g||t.u||(t.Z=1,bn(t.Ia,t),t.A=0)}function xr(t){return!(t.g||t.u||3<=t.A||(t.Z++,t.u=Zn(ce(t.Ia,t),Dr(t,t.A)),t.A++,0))}function kr(t){null!=t.B&&(ne.clearTimeout(t.B),t.B=null)}function Ar(t){t.g=new ti(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=vi(t.sa);Ii(e,"RID","rpc"),Ii(e,"SID",t.I),Ii(e,"CI",t.L?"0":"1"),Ii(e,"AID",t.T),Ii(e,"TYPE","xmlhttp"),Sr(t,e),t.o&&t.s&&gr(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=Si(vi(e)),n.s=null,n.P=!0,oi(n,t)}function Pr(t){null!=t.v&&(ne.clearTimeout(t.v),t.v=null)}function Nr(t,e){var n=null;if(t.g==e){Pr(t),kr(t),t.g=null;var i=2}else{if(!Bi(t.h,e))return;n=e.D,Hi(t.h,e),i=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;pn(i=Vn(),new Bn(i,n)),Tr(t)}else Er(t);else if(3==(r=e.o)||0==r&&0<t.pa||!(1==i&&function(t,e){return!(zi(t.h)>=t.h.j-(t.m?1:0)||(t.m?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.C>=(t.Za?0:t.$a)||(t.m=Zn(ce(t.Ja,t,e),Dr(t,t.C)),t.C++,0)))}(t,e)||2==i&&xr(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),r){case 1:Or(t,5);break;case 4:Or(t,10);break;case 3:Or(t,6);break;default:Or(t,2)}}function Dr(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function Or(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var i=ce(t.kb,t);n||(n=new _i("//www.google.com/images/cleardot.gif"),ne.location&&"http"==ne.location.protocol||wi(n,"https"),Si(n)),function(t,e){const n=new Rn;if(ne.Image){const i=new Image;i.onload=he(Qi,n,i,"TestLoadImage: loaded",!0,e),i.onerror=he(Qi,n,i,"TestLoadImage: error",!1,e),i.onabort=he(Qi,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=he(Qi,n,i,"TestLoadImage: timeout",!1,e),ne.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else zn(2);t.G=0,t.l&&t.l.va(e),Rr(t),br(t)}function Rr(t){if(t.G=0,t.la=[],t.l){const e=$i(t.h);(0!=e.length||0!=t.i.length)&&(ge(t.la,e),ge(t.la,t.i),t.h.i.length=0,me(t.i),t.i.length=0),t.l.ua()}}function Lr(t,e,n){var i=n instanceof _i?vi(n):new _i(n,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),bi(i,i.m);else{var r=ne.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new _i(null,void 0);i&&wi(s,i),e&&(s.g=e),r&&bi(s,r),n&&(s.l=n),i=s}return e=t.za,(n=t.D)&&e&&Ii(i,n,e),Ii(i,"VER",t.ma),Sr(t,i),i}function Mr(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new rr(n&&t.Da&&!t.ra?new Yi({jb:!0}):t.ra)).Ka(t.H),e}function Fr(){}function Vr(){if(ke&&!(10<=Number(Ue)))throw Error("Environmental error: no available transport.")}function Ur(t,e){dn.call(this),this.g=new _r(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!ve(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ve(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new zr(this)}function jr(t){Yn.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function qr(){Jn.call(this),this.status=1}function zr(t){this.g=t}($t=rr.prototype).Ka=function(t){this.L=t},$t.da=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Kn.g(),this.C=function(t){return t.h||(t.h=t.i())}(this.u?this.u:Kn),this.g.onreadystatechange=ce(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(s){return void lr(this,s)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find(t=>"content-type"==t.toLowerCase()),r=ne.FormData&&t instanceof ne.FormData,!(0<=fe(ar,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{dr(this),0<this.B&&((this.K=function(t){return ke&&Ve()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ce(this.qa,this)):this.A=xn(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){lr(this,s)}},$t.qa=function(){void 0!==ee&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,pn(this,"timeout"),this.abort(8))},$t.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,pn(this,"complete"),pn(this,"abort"),hr(this))},$t.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),hr(this,!0)),rr.X.M.call(this)},$t.Ha=function(){this.s||(this.F||this.v||this.l?cr(this):this.fb())},$t.fb=function(){cr(this)},$t.aa=function(){try{return 2<pr(this)?this.g.status:-1}catch(Ee){return-1}},$t.fa=function(){try{return this.g?this.g.responseText:""}catch(Ee){return""}},$t.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ir(e)}},$t.Ea=function(){return this.m},$t.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},($t=_r.prototype).ma=8,$t.G=1,$t.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const r=new ti(this,this.j,t,void 0);let s=this.s;if(this.S&&(s?(s=We(s),Ke(s,this.S)):s=this.S),null!==this.o||this.N||(r.H=s,s=null),this.O)t:{for(var e=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Cr(this,r,e),Ii(n=vi(this.F),"RID",t),Ii(n,"CVER",22),this.D&&Ii(n,"X-HTTP-Session-Id",this.D),Sr(this,n),s&&(this.N?e="headers="+encodeURIComponent(String(mr(s)))+"&"+e:this.o&&gr(n,this.o,s)),Zi(this.h,r),this.Ya&&Ii(n,"TYPE","init"),this.O?(Ii(n,"$req",e),Ii(n,"SID","null"),r.Z=!0,si(r,n,null)):si(r,n,e),this.G=2}}else 3==this.G&&(t?Ir(this,t):0==this.i.length||qi(this.h)||Ir(this))},$t.Ia=function(){if(this.u=null,Ar(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=Zn(ce(this.eb,this),t)}},$t.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,zn(10),wr(this),Ar(this))},$t.cb=function(){null!=this.v&&(this.v=null,wr(this),xr(this),zn(19))},$t.kb=function(t){t?(this.j.info("Successfully pinged google.com"),zn(2)):(this.j.info("Failed to ping google.com"),zn(1))},($t=Fr.prototype).xa=function(){},$t.wa=function(){},$t.va=function(){},$t.ua=function(){},$t.Ra=function(){},Vr.prototype.g=function(t,e){return new Ur(t,e)},de(Ur,dn),Ur.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;zn(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=Lr(t,null,t.V),Tr(t)},Ur.prototype.close=function(){vr(this.g)},Ur.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=mn(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.ab++,t)),3==e.G&&Tr(e)},Ur.prototype.M=function(){this.g.l=null,delete this.j,vr(this.g),delete this.g,Ur.X.M.call(this)},de(jr,Yn),de(qr,Jn),de(zr,Fr),zr.prototype.xa=function(){pn(this.g,"a")},zr.prototype.wa=function(t){pn(this.g,new jr(t))},zr.prototype.va=function(t){pn(this.g,new qr)},zr.prototype.ua=function(){pn(this.g,"b")},Vr.prototype.createWebChannel=Vr.prototype.g,Ur.prototype.send=Ur.prototype.u,Ur.prototype.open=Ur.prototype.m,Ur.prototype.close=Ur.prototype.close,Hn.NO_ERROR=0,Hn.TIMEOUT=8,Hn.HTTP_ERROR=6,$n.COMPLETE="complete",Gn.EventType=Qn,Qn.OPEN="a",Qn.CLOSE="b",Qn.ERROR="c",Qn.MESSAGE="d",dn.prototype.listen=dn.prototype.N,rr.prototype.listenOnce=rr.prototype.O,rr.prototype.getLastError=rr.prototype.Oa,rr.prototype.getLastErrorCode=rr.prototype.Ea,rr.prototype.getStatus=rr.prototype.aa,rr.prototype.getResponseJson=rr.prototype.Sa,rr.prototype.getResponseText=rr.prototype.fa,rr.prototype.send=rr.prototype.da,rr.prototype.setWithCredentials=rr.prototype.Ka;var Br=te.createWebChannelTransport=function(){return new Vr},Zr=te.getStatEventTarget=function(){return Vn()},Hr=te.ErrorCode=Hn,$r=te.EventType=$n,Wr=te.Event=Mn,Gr=te.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Kr=te.FetchXmlHttpFactory=Yi,Qr=te.WebChannel=Gn,Yr=te.XhrIo=rr;const Jr="@firebase/firestore";class Xr{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Xr.UNAUTHENTICATED=new Xr(null),Xr.GOOGLE_CREDENTIALS=new Xr("google-credentials-uid"),Xr.FIRST_PARTY=new Xr("first-party-uid"),Xr.MOCK_USER=new Xr("mock-user");let ts="9.15.0";const es=new Yt.Yd("@firebase/firestore");function ns(){return es.logLevel}function is(t,...e){if(es.logLevel<=Yt.in.DEBUG){const n=e.map(os);es.debug(`Firestore (${ts}): ${t}`,...n)}}function rs(t,...e){if(es.logLevel<=Yt.in.ERROR){const n=e.map(os);es.error(`Firestore (${ts}): ${t}`,...n)}}function ss(t,...e){if(es.logLevel<=Yt.in.WARN){const n=e.map(os);es.warn(`Firestore (${ts}): ${t}`,...n)}}function os(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function as(t="Unexpected state"){const e=`FIRESTORE (${ts}) INTERNAL ASSERTION FAILED: `+t;throw rs(e),new Error(e)}function ls(t,e){t||as()}function us(t,e){return t}const cs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class hs extends Jt.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ds{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class ps{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class fs{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Xr.UNAUTHENTICATED))}shutdown(){}}class ms{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class gs{constructor(t){this.t=t,this.currentUser=Xr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var n=this;let i=this.i;const r=t=>this.i!==i?(i=this.i,e(t)):Promise.resolve();let s=new ds;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ds,t.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const e=s;t.enqueueRetryable((0,Gt.Z)(function*(){yield e.promise,yield r(n.currentUser)}))},a=t=>{is("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(t=>a(t)),setTimeout(()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?a(t):(is("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ds)}},0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(is("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(ls("string"==typeof e.accessToken),new ps(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return ls(null===t||"string"==typeof t),new Xr(t)}}class ys{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i,this.type="FirstParty",this.user=Xr.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(ls(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class _s{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i}getToken(){return Promise.resolve(new ys(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(Xr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vs{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ws{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const n=t=>{null!=t.error&&is("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.A;return this.A=t.token,is("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>n(e))};const i=t=>{is("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.T.onInit(t=>i(t)),setTimeout(()=>{if(!this.appCheck){const t=this.T.getImmediate({optional:!0});t?i(t):is("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(t=>t?(ls("string"==typeof t.token),this.A=t.token,new vs(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function bs(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Ts{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=bs(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length))}return n}}function Is(t,e){return t<e?-1:t>e?1:0}function Ss(t,e,n){return t.length===e.length&&t.every((t,i)=>n(t,e[i]))}function Cs(t){return t+"\0"}class Es{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new hs(cs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new hs(cs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new hs(cs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new hs(cs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Es.fromMillis(Date.now())}static fromDate(t){return Es.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Es(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Is(this.nanoseconds,t.nanoseconds):Is(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class xs{constructor(t){this.timestamp=t}static fromTimestamp(t){return new xs(t)}static min(){return new xs(new Es(0,0))}static max(){return new xs(new Es(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ks{constructor(t,e,n){void 0===e?e=0:e>t.length&&as(),void 0===n?n=t.length-e:n>t.length-e&&as(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===ks.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof ks?t.forEach(t=>{e.push(t)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class As extends ks{construct(t,e,n){return new As(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new hs(cs.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new As(e)}static emptyPath(){return new As([])}}const Ps=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ns extends ks{construct(t,e,n){return new Ns(t,e,n)}static isValidIdentifier(t){return Ps.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ns.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ns(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new hs(cs.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new hs(cs.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new hs(cs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new hs(cs.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ns(e)}static emptyPath(){return new Ns([])}}class Ds{constructor(t){this.path=t}static fromPath(t){return new Ds(As.fromString(t))}static fromName(t){return new Ds(As.fromString(t).popFirst(5))}static empty(){return new Ds(As.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===As.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return As.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ds(new As(t.slice()))}}class Os{constructor(t,e,n,i){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=i}}function Rs(t){return t.fields.find(t=>2===t.kind)}function Ls(t){return t.fields.filter(t=>2!==t.kind)}Os.UNKNOWN_ID=-1;class Ms{constructor(t,e){this.fieldPath=t,this.kind=e}}class Fs{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new Fs(0,js.min())}}function Vs(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=xs.fromTimestamp(1e9===i?new Es(n+1,0):new Es(n,i));return new js(r,Ds.empty(),e)}function Us(t){return new js(t.readTime,t.key,-1)}class js{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new js(xs.min(),Ds.empty(),-1)}static max(){return new js(xs.max(),Ds.empty(),-1)}}function qs(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Ds.comparator(t.documentKey,e.documentKey),0!==n?n:Is(t.largestBatchId,e.largestBatchId))}const zs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Bs{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}function Zs(t){return Hs.apply(this,arguments)}function Hs(){return Hs=(0,Gt.Z)(function*(t){if(t.code!==cs.FAILED_PRECONDITION||t.message!==zs)throw t;is("LocalStore","Unexpectedly lost primary lease")}),Hs.apply(this,arguments)}class $s{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&as(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new $s((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof $s?e:$s.resolve(e)}catch(e){return $s.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):$s.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):$s.reject(e)}static resolve(t){return new $s((e,n)=>{e(t)})}static reject(t){return new $s((e,n)=>{n(t)})}static waitFor(t){return new $s((e,n)=>{let i=0,r=0,s=!1;t.forEach(t=>{++i,t.next(()=>{++r,s&&r===i&&e()},t=>n(t))}),s=!0,r===i&&e()})}static or(t){let e=$s.resolve(!1);for(const n of t)e=e.next(t=>t?$s.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,i)=>{n.push(e.call(this,t,i))}),this.waitFor(n)}static mapArray(t,e){return new $s((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const l=a;e(t[l]).next(t=>{s[l]=t,++o,o===r&&n(s)},t=>i(t))}})}static doWhile(t,e){return new $s((n,i)=>{const r=()=>{!0===t()?e().next(()=>{r()},i):n()};r()})}}class Ws{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.P=new ds,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{e.error?this.P.reject(new Qs(t,e.error)):this.P.resolve()},this.transaction.onerror=e=>{const n=eo(e.target.error);this.P.reject(new Qs(t,n))}}static open(t,e,n,i){try{return new Ws(e,t.transaction(i,n))}catch(r){throw new Qs(e,r)}}get v(){return this.P.promise}abort(t){t&&this.P.reject(t),this.aborted||(is("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Js(e)}}class Gs{constructor(t,e,n){this.name=t,this.version=e,this.S=n,12.2===Gs.D((0,Jt.z$)())&&rs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return is("SimpleDb","Removing database:",t),Xs(window.indexedDB.deleteDatabase(t)).toPromise()}static C(){if(!(0,Jt.hl)())return!1;if(Gs.N())return!0;const t=(0,Jt.z$)(),e=Gs.D(t),n=0<e&&e<10,i=Gs.k(t),r=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||r)}static N(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.O)}static M(t,e){return t.store(e)}static D(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static k(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}F(t){var e=this;return(0,Gt.Z)(function*(){return e.db||(is("SimpleDb","Opening database:",e.name),e.db=yield new Promise((n,i)=>{const r=indexedDB.open(e.name,e.version);r.onsuccess=t=>{n(t.target.result)},r.onblocked=()=>{i(new Qs(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=e=>{const n=e.target.error;i("VersionError"===n.name?new hs(cs.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===n.name?new hs(cs.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n):new Qs(t,n))},r.onupgradeneeded=t=>{is("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',t.oldVersion),e.S.$(t.target.result,r.transaction,t.oldVersion,e.version).next(()=>{is("SimpleDb","Database upgrade to version "+e.version+" complete")})}})),e.B&&(e.db.onversionchange=t=>e.B(t)),e.db})()}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}runTransaction(t,e,n,i){var r=this;return(0,Gt.Z)(function*(){const s="readonly"===e;let o=0;for(;;){++o;try{r.db=yield r.F(t);const e=Ws.open(r.db,t,s?"readonly":"readwrite",n),o=i(e).next(t=>(e.V(),t)).catch(t=>(e.abort(t),$s.reject(t))).toPromise();return o.catch(()=>{}),yield e.v,o}catch(a){const t=a,e="FirebaseError"!==t.name&&o<3;if(is("SimpleDb","Transaction failed with error:",t.message,"Retrying:",e),r.close(),!e)return Promise.reject(t)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Ks{constructor(t){this.q=t,this.U=!1,this.K=null}get isDone(){return this.U}get G(){return this.K}set cursor(t){this.q=t}done(){this.U=!0}j(t){this.K=t}delete(){return Xs(this.q.delete())}}class Qs extends hs{constructor(t,e){super(cs.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Ys(t){return"IndexedDbTransactionError"===t.name}class Js{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(is("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(is("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Xs(n)}add(t){return is("SimpleDb","ADD",this.store.name,t,t),Xs(this.store.add(t))}get(t){return Xs(this.store.get(t)).next(e=>(void 0===e&&(e=null),is("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return is("SimpleDb","DELETE",this.store.name,t),Xs(this.store.delete(t))}count(){return is("SimpleDb","COUNT",this.store.name),Xs(this.store.count())}W(t,e){const n=this.options(t,e);if(n.index||"function"!=typeof this.store.getAll){const t=this.cursor(n),e=[];return this.H(t,(t,n)=>{e.push(n)}).next(()=>e)}{const t=this.store.getAll(n.range);return new $s((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}})}}J(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new $s((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}})}Y(t,e){is("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.X=!1;const i=this.cursor(n);return this.H(i,(t,e,n)=>n.delete())}Z(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.H(i,e)}tt(t){const e=this.cursor({});return new $s((n,i)=>{e.onerror=t=>{const e=eo(t.target.error);i(e)},e.onsuccess=e=>{const i=e.target.result;i?t(i.primaryKey,i.value).next(t=>{t?i.continue():n()}):n()}})}H(t,e){const n=[];return new $s((i,r)=>{t.onerror=t=>{r(t.target.error)},t.onsuccess=t=>{const r=t.target.result;if(!r)return void i();const s=new Ks(r),o=e(r.primaryKey,r.value,s);if(o instanceof $s){const t=o.catch(t=>(s.done(),$s.reject(t)));n.push(t)}s.isDone?i():null===s.G?r.continue():r.continue(s.G)}}).next(()=>$s.waitFor(n))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.X?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Xs(t){return new $s((e,n)=>{t.onsuccess=t=>{e(t.target.result)},t.onerror=t=>{const e=eo(t.target.error);n(e)}})}let to=!1;function eo(t){const e=Gs.D((0,Jt.z$)());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new hs("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return to||(to=!0,setTimeout(()=>{throw t},0)),t}}return t}class no{constructor(t,e){this.asyncQueue=t,this.et=e,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(t){var e=this;is("IndexBackiller",`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,(0,Gt.Z)(function*(){e.task=null;try{is("IndexBackiller",`Documents written: ${yield e.et.st()}`)}catch(t){Ys(t)?is("IndexBackiller","Ignoring IndexedDB error during index backfill: ",t):yield Zs(t)}yield e.nt(6e4)}))}}class io{constructor(t,e){this.localStore=t,this.persistence=e}st(t=50){var e=this;return(0,Gt.Z)(function*(){return e.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>e.it(n,t))})()}it(t,e){const n=new Set;let i=e,r=!0;return $s.doWhile(()=>!0===r&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(e=>{if(null!==e&&!n.has(e))return is("IndexBackiller",`Processing collection: ${e}`),this.rt(t,e,i).next(t=>{i-=t,n.add(e)});r=!1})).next(()=>e-i)}rt(t,e,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next(i=>this.localStore.localDocuments.getNextDocuments(t,e,i,n).next(n=>{const r=n.changes;return this.localStore.indexManager.updateIndexEntries(t,r).next(()=>this.ot(i,n)).next(n=>(is("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(t,e,n))).next(()=>r.size)}))}ot(t,e){let n=t;return e.changes.forEach((t,e)=>{const i=Us(e);qs(i,n)>0&&(n=i)}),new js(n.readTime,n.documentKey,Math.max(e.batchId,t.largestBatchId))}}let ro=(()=>{class t{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ut(t),this.ct=t=>e.writeSequenceNumber(t))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}return t.at=-1,t})();class so{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class oo{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new oo("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof oo&&t.projectId===this.projectId&&t.database===this.database}}function ao(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function uo(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function co(t){return null==t}function ho(t){return 0===t&&1/t==-1/0}function po(t){return"number"==typeof t&&Number.isInteger(t)&&!ho(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}class fo{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new fo(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new fo(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Is(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}fo.EMPTY_BYTE_STRING=new fo("");const mo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){if(ls(!!t),"string"==typeof t){let e=0;const n=mo.exec(t);if(ls(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:yo(t.seconds),nanos:yo(t.nanos)}}function yo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _o(t){return"string"==typeof t?fo.fromBase64String(t):fo.fromUint8Array(t)}function vo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function wo(t){const e=t.mapValue.fields.__previous_value__;return vo(e)?wo(e):e}function bo(t){const e=go(t.mapValue.fields.__local_write_time__.timestampValue);return new Es(e.seconds,e.nanos)}const To={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Io={nullValue:"NULL_VALUE"};function So(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vo(t)?4:Vo(t)?9007199254740991:10:as()}function Co(t,e){if(t===e)return!0;const n=So(t);if(n!==So(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bo(t).isEqual(bo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=go(t.timestampValue),i=go(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return i=e,_o(t.bytesValue).isEqual(_o(i.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return yo(t.geoPointValue.latitude)===yo(e.geoPointValue.latitude)&&yo(t.geoPointValue.longitude)===yo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return yo(t.integerValue)===yo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=yo(t.doubleValue),i=yo(e.doubleValue);return n===i?ho(n)===ho(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Ss(t.arrayValue.values||[],e.arrayValue.values||[],Co);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(ao(n)!==ao(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!Co(n[r],i[r])))return!1;return!0}(t,e);default:return as()}var i}function Eo(t,e){return void 0!==(t.values||[]).find(t=>Co(t,e))}function xo(t,e){if(t===e)return 0;const n=So(t),i=So(e);if(n!==i)return Is(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Is(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=yo(t.integerValue||t.doubleValue),i=yo(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return ko(t.timestampValue,e.timestampValue);case 4:return ko(bo(t),bo(e));case 5:return Is(t.stringValue,e.stringValue);case 6:return function(t,e){const n=_o(t),i=_o(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let r=0;r<n.length&&r<i.length;r++){const t=Is(n[r],i[r]);if(0!==t)return t}return Is(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Is(yo(t.latitude),yo(e.latitude));return 0!==n?n:Is(yo(t.longitude),yo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let r=0;r<n.length&&r<i.length;++r){const t=xo(n[r],i[r]);if(t)return t}return Is(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===To.mapValue&&e===To.mapValue)return 0;if(t===To.mapValue)return 1;if(e===To.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){const t=Is(i[o],s[o]);if(0!==t)return t;const e=xo(n[i[o]],r[s[o]]);if(0!==e)return e}return Is(i.length,s.length)}(t.mapValue,e.mapValue);default:throw as()}}function ko(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Is(t,e);const n=go(t),i=go(e),r=Is(n.seconds,i.seconds);return 0!==r?r:Is(n.nanos,i.nanos)}function Ao(t){return Po(t)}function Po(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=go(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?_o(t.bytesValue).toBase64():"referenceValue"in t?Ds.fromName(t.referenceValue).toString():"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Po(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${Po(t.fields[r])}`;return n+"}"}(t.mapValue):as();var e}function No(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Do(t){return!!t&&"integerValue"in t}function Oo(t){return!!t&&"arrayValue"in t}function Ro(t){return!!t&&"nullValue"in t}function Lo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Mo(t){return!!t&&"mapValue"in t}function Fo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return lo(t.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Fo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Vo(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}function Uo(t){return"nullValue"in t?Io:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?No(oo.empty(),Ds.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:as()}function jo(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?No(oo.empty(),Ds.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?To:as()}function qo(t,e){const n=xo(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function zo(t,e){const n=xo(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class Bo{constructor(t,e){this.position=t,this.inclusive=e}}function Zo(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Ds.comparator(Ds.fromName(o.referenceValue),n.key):xo(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Ho(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Co(t.position[n],e.position[n]))return!1;return!0}class $o{}class Wo extends $o{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new ia(t,e,n):"array-contains"===e?new aa(t,n):"in"===e?new la(t,n):"not-in"===e?new ua(t,n):"array-contains-any"===e?new ca(t,n):new Wo(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new ra(t,n):new sa(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(xo(e,this.value)):null!==e&&So(this.value)===So(e)&&this.matchesComparison(xo(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return as()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Go extends $o{constructor(t,e){super(),this.filters=t,this.op=e,this.ht=null}static create(t,e){return new Go(t,e)}matches(t){return Ko(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.lt(t=>t.isInequality());return null!==t?t.field:null}lt(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function Ko(t){return"and"===t.op}function Qo(t){return"or"===t.op}function Yo(t){return Jo(t)&&Ko(t)}function Jo(t){for(const e of t.filters)if(e instanceof Go)return!1;return!0}function Xo(t){if(t instanceof Wo)return t.field.canonicalString()+t.op.toString()+Ao(t.value);{const e=t.filters.map(t=>Xo(t)).join(",");return`${t.op}(${e})`}}function ta(t,e){return t instanceof Wo?(n=t,(i=e)instanceof Wo&&n.op===i.op&&n.field.isEqual(i.field)&&Co(n.value,i.value)):t instanceof Go?function(t,e){return e instanceof Go&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((t,n,i)=>t&&ta(n,e.filters[i]),!0)}(t,e):void as();var n,i}function ea(t,e){const n=t.filters.concat(e);return Go.create(n,t.op)}function na(t){return t instanceof Wo?`${(e=t).field.canonicalString()} ${e.op} ${Ao(e.value)}`:t instanceof Go?function(t){return t.op.toString()+" {"+t.getFilters().map(na).join(" ,")+"}"}(t):"Filter";var e}class ia extends Wo{constructor(t,e,n){super(t,e,n),this.key=Ds.fromName(n.referenceValue)}matches(t){const e=Ds.comparator(t.key,this.key);return this.matchesComparison(e)}}class ra extends Wo{constructor(t,e){super(t,"in",e),this.keys=oa(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class sa extends Wo{constructor(t,e){super(t,"not-in",e),this.keys=oa(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function oa(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>Ds.fromName(t.referenceValue))}class aa extends Wo{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Oo(e)&&Eo(e.arrayValue,this.value)}}class la extends Wo{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Eo(this.value.arrayValue,e)}}class ua extends Wo{constructor(t,e){super(t,"not-in",e)}matches(t){if(Eo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Eo(this.value.arrayValue,e)}}class ca extends Wo{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Oo(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>Eo(this.value.arrayValue,t))}}class ha{constructor(t,e="asc"){this.field=t,this.dir=e}}function da(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class pa{constructor(t,e){this.comparator=t,this.root=e||ma.EMPTY}insert(t,e){return new pa(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ma.BLACK,null,null))}remove(t){return new pa(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ma.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new fa(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new fa(this.root,t,this.comparator,!1)}getReverseIterator(){return new fa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new fa(this.root,t,this.comparator,!0)}}class fa{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ma{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:ma.RED,this.left=null!=i?i:ma.EMPTY,this.right=null!=r?r:ma.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new ma(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ma.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return ma.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ma.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ma.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw as();const t=this.left.check();if(t!==this.right.check())throw as();return t+(this.isRed()?0:1)}}ma.EMPTY=null,ma.RED=!0,ma.BLACK=!1,ma.EMPTY=new class{constructor(){this.size=0}get key(){throw as()}get value(){throw as()}get color(){throw as()}get left(){throw as()}get right(){throw as()}copy(t,e,n,i,r){return this}insert(t,e,n){return new ma(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ga{constructor(t){this.comparator=t,this.data=new pa(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new ya(this.data.getIterator())}getIteratorFrom(t){return new ya(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof ga)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new ga(this.comparator);return e.data=t,e}}class ya{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function _a(t){return t.hasNext()?t.getNext():void 0}class va{constructor(t){this.fields=t,t.sort(Ns.comparator)}static empty(){return new va([])}unionWith(t){let e=new ga(Ns.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new va(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ss(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class wa{constructor(t){this.value=t}static empty(){return new wa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Mo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Fo(e)}setAll(t){let e=Ns.emptyPath(),n={},i=[];t.forEach((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Fo(t):i.push(r.lastSegment())});const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Mo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Co(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Mo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){lo(e,(e,n)=>t[e]=n);for(const i of n)delete t[i]}clone(){return new wa(Fo(this.value))}}function ba(t){const e=[];return lo(t.fields,(t,n)=>{const i=new Ns([t]);if(Mo(n)){const t=ba(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)}),new va(e)}class Ta{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new Ta(t,0,xs.min(),xs.min(),xs.min(),wa.empty(),0)}static newFoundDocument(t,e,n,i){return new Ta(t,1,e,xs.min(),n,i,0)}static newNoDocument(t,e){return new Ta(t,2,e,xs.min(),xs.min(),wa.empty(),0)}static newUnknownDocument(t,e){return new Ta(t,3,e,xs.min(),xs.min(),wa.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(xs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=wa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=wa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xs.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ta&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ta(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ia{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ft=null}}function Sa(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Ia(t,e,n,i,r,s,o)}function Ca(t){const e=us(t);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>Xo(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>{return(e=t).field.canonicalString()+e.dir;var e}).join(","),co(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(t=>Ao(t)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(t=>Ao(t)).join(",")),e.ft=t}return e.ft}function Ea(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!da(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ta(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ho(t.startAt,e.startAt)&&Ho(t.endAt,e.endAt)}function xa(t){return Ds.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function ka(t,e){return t.filters.filter(t=>t instanceof Wo&&t.field.isEqual(e))}function Aa(t,e,n){let i=Io,r=!0;for(const s of ka(t,e)){let t=Io,e=!0;switch(s.op){case"<":case"<=":t=Uo(s.value);break;case"==":case"in":case">=":t=s.value;break;case">":t=s.value,e=!1;break;case"!=":case"not-in":t=Io}qo({value:i,inclusive:r},{value:t,inclusive:e})<0&&(i=t,r=e)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const t=n.position[s];qo({value:i,inclusive:r},{value:t,inclusive:n.inclusive})<0&&(i=t,r=n.inclusive);break}return{value:i,inclusive:r}}function Pa(t,e,n){let i=To,r=!0;for(const s of ka(t,e)){let t=To,e=!0;switch(s.op){case">=":case">":t=jo(s.value),e=!1;break;case"==":case"in":case"<=":t=s.value;break;case"<":t=s.value,e=!1;break;case"!=":case"not-in":t=To}zo({value:i,inclusive:r},{value:t,inclusive:e})>0&&(i=t,r=e)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const t=n.position[s];zo({value:i,inclusive:r},{value:t,inclusive:n.inclusive})>0&&(i=t,r=n.inclusive);break}return{value:i,inclusive:r}}class Na{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.dt=null,this._t=null}}function Da(t,e,n,i,r,s,o,a){return new Na(t,e,n,i,r,s,o,a)}function Oa(t){return new Na(t)}function Ra(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function La(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ma(t){for(const e of t.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function Fa(t){return null!==t.collectionGroup}function Va(t){const e=us(t);if(null===e.dt){e.dt=[];const t=Ma(e),n=La(e);if(null!==t&&null===n)t.isKeyField()||e.dt.push(new ha(t)),e.dt.push(new ha(Ns.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.dt.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new ha(Ns.keyField(),t))}}}return e.dt}function Ua(t){const e=us(t);if(!e._t)if("F"===e.limitType)e._t=Sa(e.path,e.collectionGroup,Va(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const r of Va(e))t.push(new ha(r.field,"desc"===r.dir?"asc":"desc"));const n=e.endAt?new Bo(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Bo(e.startAt.position,e.startAt.inclusive):null;e._t=Sa(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function ja(t,e){e.getFirstInequalityField(),Ma(t);const n=t.filters.concat([e]);return new Na(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qa(t,e,n){return new Na(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function za(t,e){return Ea(Ua(t),Ua(e))&&t.limitType===e.limitType}function Ba(t){return`${Ca(Ua(t))}|lt:${t.limitType}`}function Za(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(t=>na(t)).join(", ")}]`),co(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(t=>{return`${(e=t).field.canonicalString()} (${e.dir})`;var e}).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(t=>Ao(t)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(t=>Ao(t)).join(",")),`Target(${e})`}(Ua(t))}; limitType=${t.limitType})`}function Ha(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ds.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Va(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&(i=e,!((n=t).startAt&&!function(t,e,n){const i=Zo(t,e,n);return t.inclusive?i<=0:i<0}(n.startAt,Va(n),i)||n.endAt&&!function(t,e,n){const i=Zo(t,e,n);return t.inclusive?i>=0:i>0}(n.endAt,Va(n),i)));var n,i}function $a(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Wa(t){return(e,n)=>{let i=!1;for(const r of Va(t)){const t=Ga(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function Ga(t,e,n){const i=t.field.isKeyField()?Ds.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?xo(i,r):as()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return as()}}function Ka(t,e){if(t.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ho(e)?"-0":e}}function Qa(t){return{integerValue:""+t}}function Ya(t,e){return po(e)?Qa(e):Ka(t,e)}class Ja{constructor(){this._=void 0}}function Xa(t,e,n){return t instanceof nl?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof il?rl(t,e):t instanceof sl?ol(t,e):function(t,e){const n=el(t,e),i=ll(n)+ll(t.gt);return Do(n)&&Do(t.gt)?Qa(i):Ka(t.yt,i)}(t,e)}function tl(t,e,n){return t instanceof il?rl(t,e):t instanceof sl?ol(t,e):n}function el(t,e){return t instanceof al?Do(i=e)||(n=i)&&"doubleValue"in n?e:{integerValue:0}:null;var n,i}class nl extends Ja{}class il extends Ja{constructor(t){super(),this.elements=t}}function rl(t,e){const n=ul(e);for(const i of t.elements)n.some(t=>Co(t,i))||n.push(i);return{arrayValue:{values:n}}}class sl extends Ja{constructor(t){super(),this.elements=t}}function ol(t,e){let n=ul(e);for(const i of t.elements)n=n.filter(t=>!Co(t,i));return{arrayValue:{values:n}}}class al extends Ja{constructor(t,e){super(),this.yt=t,this.gt=e}}function ll(t){return yo(t.integerValue||t.doubleValue)}function ul(t){return Oo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class cl{constructor(t,e){this.field=t,this.transform=e}}class hl{constructor(t,e){this.version=t,this.transformResults=e}}class dl{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new dl}static exists(t){return new dl(void 0,t)}static updateTime(t){return new dl(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function pl(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class fl{}function ml(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Cl(t.key,dl.none()):new wl(t.key,t.data,dl.none());{const n=t.data,i=wa.empty();let r=new ga(Ns.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new bl(t.key,i,new va(r.toArray()),dl.none())}}function gl(t,e,n){t instanceof wl?function(t,e,n){const i=t.value.clone(),r=Il(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof bl?function(t,e,n){if(!pl(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Il(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Tl(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function yl(t,e,n,i){return t instanceof wl?function(t,e,n,i){if(!pl(t.precondition,e))return n;const r=t.value.clone(),s=Sl(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof bl?function(t,e,n,i){if(!pl(t.precondition,e))return n;const r=Sl(t.fieldTransforms,i,e),s=e.data;return s.setAll(Tl(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(t=>t.field))}(t,e,n,i):(s=n,pl(t.precondition,r=e)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):s);var r,s}function _l(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=el(i.transform,t||null);null!=r&&(null===n&&(n=wa.empty()),n.set(i.field,r))}return n||null}function vl(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(n=t.fieldTransforms)&&void 0===i||n&&i&&Ss(n,i,(t,e)=>function(t,e){return t.field.isEqual(e.field)&&(i=e.transform,(n=t.transform)instanceof il&&i instanceof il||n instanceof sl&&i instanceof sl?Ss(n.elements,i.elements,Co):n instanceof al&&i instanceof al?Co(n.gt,i.gt):n instanceof nl&&i instanceof nl);var n,i}(t,e))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,i}class wl extends fl{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bl extends fl{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Tl(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function Il(t,e,n){const i=new Map;ls(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,tl(o,a,n[r]))}return i}function Sl(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Xa(t,s,e))}return i}class Cl extends fl{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class El extends fl{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class xl{constructor(t){this.count=t}}var kl,Al;function Pl(t){switch(t){default:return as();case cs.CANCELLED:case cs.UNKNOWN:case cs.DEADLINE_EXCEEDED:case cs.RESOURCE_EXHAUSTED:case cs.INTERNAL:case cs.UNAVAILABLE:case cs.UNAUTHENTICATED:return!1;case cs.INVALID_ARGUMENT:case cs.NOT_FOUND:case cs.ALREADY_EXISTS:case cs.PERMISSION_DENIED:case cs.FAILED_PRECONDITION:case cs.ABORTED:case cs.OUT_OF_RANGE:case cs.UNIMPLEMENTED:case cs.DATA_LOSS:return!0}}function Nl(t){if(void 0===t)return rs("GRPC error has no .code"),cs.UNKNOWN;switch(t){case kl.OK:return cs.OK;case kl.CANCELLED:return cs.CANCELLED;case kl.UNKNOWN:return cs.UNKNOWN;case kl.DEADLINE_EXCEEDED:return cs.DEADLINE_EXCEEDED;case kl.RESOURCE_EXHAUSTED:return cs.RESOURCE_EXHAUSTED;case kl.INTERNAL:return cs.INTERNAL;case kl.UNAVAILABLE:return cs.UNAVAILABLE;case kl.UNAUTHENTICATED:return cs.UNAUTHENTICATED;case kl.INVALID_ARGUMENT:return cs.INVALID_ARGUMENT;case kl.NOT_FOUND:return cs.NOT_FOUND;case kl.ALREADY_EXISTS:return cs.ALREADY_EXISTS;case kl.PERMISSION_DENIED:return cs.PERMISSION_DENIED;case kl.FAILED_PRECONDITION:return cs.FAILED_PRECONDITION;case kl.ABORTED:return cs.ABORTED;case kl.OUT_OF_RANGE:return cs.OUT_OF_RANGE;case kl.UNIMPLEMENTED:return cs.UNIMPLEMENTED;case kl.DATA_LOSS:return cs.DATA_LOSS;default:return as()}}(Al=kl||(kl={}))[Al.OK=0]="OK",Al[Al.CANCELLED=1]="CANCELLED",Al[Al.UNKNOWN=2]="UNKNOWN",Al[Al.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Al[Al.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Al[Al.NOT_FOUND=5]="NOT_FOUND",Al[Al.ALREADY_EXISTS=6]="ALREADY_EXISTS",Al[Al.PERMISSION_DENIED=7]="PERMISSION_DENIED",Al[Al.UNAUTHENTICATED=16]="UNAUTHENTICATED",Al[Al.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Al[Al.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Al[Al.ABORTED=10]="ABORTED",Al[Al.OUT_OF_RANGE=11]="OUT_OF_RANGE",Al[Al.UNIMPLEMENTED=12]="UNIMPLEMENTED",Al[Al.INTERNAL=13]="INTERNAL",Al[Al.UNAVAILABLE=14]="UNAVAILABLE",Al[Al.DATA_LOSS=15]="DATA_LOSS";class Dl{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){lo(this.inner,(e,n)=>{for(const[i,r]of n)t(i,r)})}isEmpty(){return uo(this.inner)}size(){return this.innerSize}}const Ol=new pa(Ds.comparator);function Rl(){return Ol}const Ll=new pa(Ds.comparator);function Ml(...t){let e=Ll;for(const n of t)e=e.insert(n.key,n);return e}function Fl(t){let e=Ll;return t.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Vl(){return jl()}function Ul(){return jl()}function jl(){return new Dl(t=>t.toString(),(t,e)=>t.isEqual(e))}const ql=new pa(Ds.comparator),zl=new ga(Ds.comparator);function Bl(...t){let e=zl;for(const n of t)e=e.add(n);return e}const Zl=new ga(Is);function Hl(){return Zl}class $l{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Wl.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new $l(xs.min(),i,Hl(),Rl(),Bl())}}class Wl{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Wl(n,e,Bl(),Bl(),Bl())}}class Gl{constructor(t,e,n,i){this.It=t,this.removedTargetIds=e,this.key=n,this.Tt=i}}class Kl{constructor(t,e){this.targetId=t,this.Et=e}}class Ql{constructor(t,e,n=fo.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Yl{constructor(){this.At=0,this.Rt=tu(),this.bt=fo.EMPTY_BYTE_STRING,this.Pt=!1,this.vt=!0}get current(){return this.Pt}get resumeToken(){return this.bt}get Vt(){return 0!==this.At}get St(){return this.vt}Dt(t){t.approximateByteSize()>0&&(this.vt=!0,this.bt=t)}Ct(){let t=Bl(),e=Bl(),n=Bl();return this.Rt.forEach((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:as()}}),new Wl(this.bt,this.Pt,t,e,n)}xt(){this.vt=!1,this.Rt=tu()}Nt(t,e){this.vt=!0,this.Rt=this.Rt.insert(t,e)}kt(t){this.vt=!0,this.Rt=this.Rt.remove(t)}Ot(){this.At+=1}Mt(){this.At-=1}Ft(){this.vt=!0,this.Pt=!0}}class Jl{constructor(t){this.$t=t,this.Bt=new Map,this.Lt=Rl(),this.qt=Xl(),this.Ut=new ga(Is)}Kt(t){for(const e of t.It)t.Tt&&t.Tt.isFoundDocument()?this.Gt(e,t.Tt):this.Qt(e,t.key,t.Tt);for(const e of t.removedTargetIds)this.Qt(e,t.key,t.Tt)}jt(t){this.forEachTarget(t,e=>{const n=this.Wt(e);switch(t.state){case 0:this.zt(e)&&n.Dt(t.resumeToken);break;case 1:n.Mt(),n.Vt||n.xt(),n.Dt(t.resumeToken);break;case 2:n.Mt(),n.Vt||this.removeTarget(e);break;case 3:this.zt(e)&&(n.Ft(),n.Dt(t.resumeToken));break;case 4:this.zt(e)&&(this.Ht(e),n.Dt(t.resumeToken));break;default:as()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Bt.forEach((t,n)=>{this.zt(n)&&e(n)})}Jt(t){const e=t.targetId,n=t.Et.count,i=this.Yt(e);if(i){const t=i.target;if(xa(t))if(0===n){const n=new Ds(t.path);this.Qt(e,n,Ta.newNoDocument(n,xs.min()))}else ls(1===n);else this.Xt(e)!==n&&(this.Ht(e),this.Ut=this.Ut.add(e))}}Zt(t){const e=new Map;this.Bt.forEach((n,i)=>{const r=this.Yt(i);if(r){if(n.current&&xa(r.target)){const e=new Ds(r.target.path);null!==this.Lt.get(e)||this.te(i,e)||this.Qt(i,e,Ta.newNoDocument(e,t))}n.St&&(e.set(i,n.Ct()),n.xt())}});let n=Bl();this.qt.forEach((t,e)=>{let i=!0;e.forEachWhile(t=>{const e=this.Yt(t);return!e||2===e.purpose||(i=!1,!1)}),i&&(n=n.add(t))}),this.Lt.forEach((e,n)=>n.setReadTime(t));const i=new $l(t,e,this.Ut,this.Lt,n);return this.Lt=Rl(),this.qt=Xl(),this.Ut=new ga(Is),i}Gt(t,e){if(!this.zt(t))return;const n=this.te(t,e.key)?2:0;this.Wt(t).Nt(e.key,n),this.Lt=this.Lt.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ee(e.key).add(t))}Qt(t,e,n){if(!this.zt(t))return;const i=this.Wt(t);this.te(t,e)?i.Nt(e,1):i.kt(e),this.qt=this.qt.insert(e,this.ee(e).delete(t)),n&&(this.Lt=this.Lt.insert(e,n))}removeTarget(t){this.Bt.delete(t)}Xt(t){const e=this.Wt(t).Ct();return this.$t.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ot(t){this.Wt(t).Ot()}Wt(t){let e=this.Bt.get(t);return e||(e=new Yl,this.Bt.set(t,e)),e}ee(t){let e=this.qt.get(t);return e||(e=new ga(Is),this.qt=this.qt.insert(t,e)),e}zt(t){const e=null!==this.Yt(t);return e||is("WatchChangeAggregator","Detected inactive target",t),e}Yt(t){const e=this.Bt.get(t);return e&&e.Vt?null:this.$t.ne(t)}Ht(t){this.Bt.set(t,new Yl),this.$t.getRemoteKeysForTarget(t).forEach(e=>{this.Qt(t,e,null)})}te(t,e){return this.$t.getRemoteKeysForTarget(t).has(e)}}function Xl(){return new pa(Ds.comparator)}function tu(){return new pa(Ds.comparator)}const eu={asc:"ASCENDING",desc:"DESCENDING"},nu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iu={and:"AND",or:"OR"};class ru{constructor(t,e){this.databaseId=t,this.wt=e}}function su(t,e){return t.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ou(t,e){return t.wt?e.toBase64():e.toUint8Array()}function au(t,e){return su(t,e.toTimestamp())}function lu(t){return ls(!!t),xs.fromTimestamp(function(t){const e=go(t);return new Es(e.seconds,e.nanos)}(t))}function uu(t,e){return(n=t,new As(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function cu(t){const e=As.fromString(t);return ls(Du(e)),e}function hu(t,e){return uu(t.databaseId,e.path)}function du(t,e){const n=cu(e);if(n.get(1)!==t.databaseId.projectId)throw new hs(cs.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new hs(cs.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ds(gu(n))}function pu(t,e){return uu(t.databaseId,e)}function fu(t){const e=cu(t);return 4===e.length?As.emptyPath():gu(e)}function mu(t){return new As(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gu(t){return ls(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function yu(t,e,n){return{name:hu(t,e),fields:n.value.mapValue.fields}}function _u(t,e,n){const i=du(t,e.name),r=lu(e.updateTime),s=e.createTime?lu(e.createTime):xs.min(),o=new wa({mapValue:{fields:e.fields}}),a=Ta.newFoundDocument(i,r,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function vu(t,e){let n;if(e instanceof wl)n={update:yu(t,e.key,e.value)};else if(e instanceof Cl)n={delete:hu(t,e.key)};else if(e instanceof bl)n={update:yu(t,e.key,e.data),updateMask:Nu(e.fieldMask)};else{if(!(e instanceof El))return as();n={verify:hu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(t=>function(t,e){const n=e.transform;if(n instanceof nl)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof il)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof sl)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof al)return{fieldPath:e.field.canonicalString(),increment:n.gt};throw as()}(0,t))),e.precondition.isNone||(n.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:au(t,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:as()),n;var i}function wu(t,e){const n=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?dl.updateTime(lu(r.updateTime)):void 0!==r.exists?dl.exists(r.exists):dl.none():dl.none(),i=e.updateTransforms?e.updateTransforms.map(e=>function(t,e){let n=null;"setToServerValue"in e?(ls("REQUEST_TIME"===e.setToServerValue),n=new nl):"appendMissingElements"in e?n=new il(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new sl(e.removeAllFromArray.values||[]):"increment"in e?n=new al(t,e.increment):as();const i=Ns.fromServerFormat(e.fieldPath);return new cl(i,n)}(t,e)):[];var r;if(e.update){const r=du(t,e.update.name),s=new wa({mapValue:{fields:e.update.fields}});if(e.updateMask){const t=new va((e.updateMask.fieldPaths||[]).map(t=>Ns.fromServerFormat(t)));return new bl(r,s,t,n,i)}return new wl(r,s,n,i)}if(e.delete){const i=du(t,e.delete);return new Cl(i,n)}if(e.verify){const i=du(t,e.verify);return new El(i,n)}return as()}function bu(t,e){return{documents:[pu(t,e.path)]}}function Tu(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=pu(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=pu(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(t){if(0!==t.length)return Pu(Go.create(t,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const s=function(t){if(0!==t.length)return t.map(t=>{return{field:ku((e=t).field),direction:Cu(e.dir)};var e})}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=(a=e.limit,t.wt||co(a)?a:{value:a});var a,l,u;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(l=e.startAt).inclusive,values:l.position}),e.endAt&&(n.structuredQuery.endAt={before:!(u=e.endAt).inclusive,values:u.position}),n}function Iu(t){let e=fu(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ls(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=Su(t);return e instanceof Go&&Yo(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(t=>{return new ha(Au((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e}));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,co(e)?null:e}(n.limit));let l=null;var u;n.startAt&&(l=new Bo((u=n.startAt).values||[],!!u.before));let c=null;return n.endAt&&(c=function(t){return new Bo(t.values||[],!t.before)}(n.endAt)),Da(e,r,o,s,a,"F",l,c)}function Su(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Au(t.unaryFilter.field);return Wo.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Au(t.unaryFilter.field);return Wo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Au(t.unaryFilter.field);return Wo.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Au(t.unaryFilter.field);return Wo.create(r,"!=",{nullValue:"NULL_VALUE"});default:return as()}}(t):void 0!==t.fieldFilter?Wo.create(Au((e=t).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return as()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==t.compositeFilter?function(t){return Go.create(t.compositeFilter.filters.map(t=>Su(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return as()}}(t.compositeFilter.op))}(t):as();var e}function Cu(t){return eu[t]}function Eu(t){return nu[t]}function xu(t){return iu[t]}function ku(t){return{fieldPath:t.canonicalString()}}function Au(t){return Ns.fromServerFormat(t.fieldPath)}function Pu(t){return t instanceof Wo?function(t){if("=="===t.op){if(Lo(t.value))return{unaryFilter:{field:ku(t.field),op:"IS_NAN"}};if(Ro(t.value))return{unaryFilter:{field:ku(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Lo(t.value))return{unaryFilter:{field:ku(t.field),op:"IS_NOT_NAN"}};if(Ro(t.value))return{unaryFilter:{field:ku(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ku(t.field),op:Eu(t.op),value:t.value}}}(t):t instanceof Go?function(t){const e=t.getFilters().map(t=>Pu(t));return 1===e.length?e[0]:{compositeFilter:{op:xu(t.op),filters:e}}}(t):as()}function Nu(t){const e=[];return t.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Du(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ou(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Lu(e)),e=Ru(t.get(n),e);return Lu(e)}function Ru(t,e){let n=e;const i=t.length;for(let r=0;r<i;r++){const e=t.charAt(r);switch(e){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=e}}return n}function Lu(t){return t+"\x01\x01"}function Mu(t){const e=t.length;if(ls(e>=2),2===e)return ls("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),As.emptyPath();const n=e-2,i=[];let r="";for(let s=0;s<e;){const e=t.indexOf("\x01",s);switch((e<0||e>n)&&as(),t.charAt(e+1)){case"\x01":const n=t.substring(s,e);let o;0===r.length?o=n:(r+=n,o=r,r=""),i.push(o);break;case"\x10":r+=t.substring(s,e),r+="\0";break;case"\x11":r+=t.substring(s,e+1);break;default:as()}s=e+2}return new As(i)}const Fu=["userId","batchId"];function Vu(t,e){return[t,Ou(e)]}function Uu(t,e,n){return[t,Ou(e),n]}const ju={},qu=["prefixPath","collectionGroup","readTime","documentId"],zu=["prefixPath","collectionGroup","documentId"],Bu=["collectionGroup","readTime","prefixPath","documentId"],Zu=["canonicalId","targetId"],Hu=["targetId","path"],$u=["path","targetId"],Wu=["collectionId","parent"],Gu=["indexId","uid"],Ku=["uid","sequenceNumber"],Qu=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Yu=["indexId","uid","orderedDocumentKey"],Ju=["userId","collectionPath","documentId"],Xu=["userId","collectionPath","largestBatchId"],tc=["userId","collectionGroup","largestBatchId"],ec=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],nc=[...ec,"documentOverlays"],ic=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],rc=ic,sc=[...rc,"indexConfiguration","indexState","indexEntries"];class oc extends Bs{constructor(t,e){super(),this.se=t,this.currentSequenceNumber=e}}function ac(t,e){const n=us(t);return Gs.M(n.se,e)}class lc{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const e=this.mutations[i];e.key.isEqual(t.key)&&gl(e,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=yl(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=yl(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Ul();return this.mutations.forEach(i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=ml(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(xs.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Bl())}isEqual(t){return this.batchId===t.batchId&&Ss(this.mutations,t.mutations,(t,e)=>vl(t,e))&&Ss(this.baseMutations,t.baseMutations,(t,e)=>vl(t,e))}}class uc{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){ls(t.mutations.length===n.length);let i=ql;const r=t.mutations;for(let s=0;s<r.length;s++)i=i.insert(r[s].key,n[s].version);return new uc(t,e,n,i)}}class cc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class hc{constructor(t,e,n,i,r=xs.min(),s=xs.min(),o=fo.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(t){return new hc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new hc(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new hc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class dc{constructor(t){this.ie=t}}function pc(t,e){const n=e.key,i={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:fc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document={name:hu(r=t.ie,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:su(r,s.version.toTimestamp()),createTime:su(r,s.createTime.toTimestamp())};else if(e.isNoDocument())i.noDocument={path:n.path.toArray(),readTime:mc(e.version)};else{if(!e.isUnknownDocument())return as();i.unknownDocument={path:n.path.toArray(),version:mc(e.version)}}var r,s;return i}function fc(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function gc(t){const e=new Es(t.seconds,t.nanoseconds);return xs.fromTimestamp(e)}function yc(t,e){const n=(e.baseMutations||[]).map(e=>wu(t.ie,e));for(let s=0;s<e.mutations.length-1;++s){const t=e.mutations[s];s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(t.updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s)}const i=e.mutations.map(e=>wu(t.ie,e)),r=Es.fromMillis(e.localWriteTimeMs);return new lc(e.batchId,r,n,i)}function _c(t){const e=gc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?gc(t.lastLimboFreeSnapshotVersion):xs.min();let i;var r;return void 0!==t.query.documents?(ls(1===(r=t.query).documents.length),i=Ua(Oa(fu(r.documents[0])))):i=Ua(Iu(t.query)),new hc(i,t.targetId,0,t.lastListenSequenceNumber,e,n,fo.fromBase64String(t.resumeToken))}function vc(t,e){const n=mc(e.snapshotVersion),i=mc(e.lastLimboFreeSnapshotVersion);let r;r=xa(e.target)?bu(t.ie,e.target):Tu(t.ie,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ca(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function wc(t){const e=Iu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?qa(e,e.limit,"L"):e}function bc(t,e){return new cc(e.largestBatchId,wu(t.ie,e.overlayMutation))}function Tc(t,e){const n=e.path.lastSegment();return[t,Ou(e.path.popLast()),n]}function Ic(t,e,n,i){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:mc(i.readTime),documentKey:Ou(i.documentKey.path),largestBatchId:i.largestBatchId}}class Sc{getBundleMetadata(t,e){return Cc(t).get(e).next(t=>{if(t)return{id:(e=t).bundleId,createTime:gc(e.createTime),version:e.version};var e})}saveBundleMetadata(t,e){return Cc(t).put({bundleId:(n=e).id,createTime:mc(lu(n.createTime)),version:n.version});var n}getNamedQuery(t,e){return Ec(t).get(e).next(t=>{if(t)return{name:(e=t).name,query:wc(e.bundledQuery),readTime:gc(e.readTime)};var e})}saveNamedQuery(t,e){return Ec(t).put({name:(n=e).name,readTime:mc(lu(n.readTime)),bundledQuery:n.bundledQuery});var n}}function Cc(t){return ac(t,"bundles")}function Ec(t){return ac(t,"namedQueries")}class xc{constructor(t,e){this.yt=t,this.userId=e}static re(t,e){return new xc(t,e.uid||"")}getOverlay(t,e){return kc(t).get(Tc(this.userId,e)).next(t=>t?bc(this.yt,t):null)}getOverlays(t,e){const n=Vl();return $s.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){const i=[];return n.forEach((n,r)=>{const s=new cc(e,r);i.push(this.oe(t,s))}),$s.waitFor(i)}removeOverlaysForBatchId(t,e,n){const i=new Set;e.forEach(t=>i.add(Ou(t.getCollectionPath())));const r=[];return i.forEach(e=>{const i=IDBKeyRange.bound([this.userId,e,n],[this.userId,e,n+1],!1,!0);r.push(kc(t).Y("collectionPathOverlayIndex",i))}),$s.waitFor(r)}getOverlaysForCollection(t,e,n){const i=Vl(),r=Ou(e),s=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return kc(t).W("collectionPathOverlayIndex",s).next(t=>{for(const e of t){const t=bc(this.yt,e);i.set(t.getKey(),t)}return i})}getOverlaysForCollectionGroup(t,e,n,i){const r=Vl();let s;const o=IDBKeyRange.bound([this.userId,e,n],[this.userId,e,Number.POSITIVE_INFINITY],!0);return kc(t).Z({index:"collectionGroupOverlayIndex",range:o},(t,e,n)=>{const o=bc(this.yt,e);r.size()<i||o.largestBatchId===s?(r.set(o.getKey(),o),s=o.largestBatchId):n.done()}).next(()=>r)}oe(t,e){return kc(t).put(function(t,e,n){const[i,r,s]=Tc(e,n.mutation.key);return{userId:e,collectionPath:r,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:vu(t.ie,n.mutation)}}(this.yt,this.userId,e))}}function kc(t){return ac(t,"documentOverlays")}class Ac{constructor(){}ue(t,e){this.ce(t,e),e.ae()}ce(t,e){if("nullValue"in t)this.he(e,5);else if("booleanValue"in t)this.he(e,10),e.le(t.booleanValue?1:0);else if("integerValue"in t)this.he(e,15),e.le(yo(t.integerValue));else if("doubleValue"in t){const n=yo(t.doubleValue);isNaN(n)?this.he(e,13):(this.he(e,15),ho(n)?e.le(0):e.le(n))}else if("timestampValue"in t){const n=t.timestampValue;this.he(e,20),"string"==typeof n?e.fe(n):(e.fe(`${n.seconds||""}`),e.le(n.nanos||0))}else if("stringValue"in t)this.de(t.stringValue,e),this._e(e);else if("bytesValue"in t)this.he(e,30),e.we(_o(t.bytesValue)),this._e(e);else if("referenceValue"in t)this.me(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.he(e,45),e.le(n.latitude||0),e.le(n.longitude||0)}else"mapValue"in t?Vo(t)?this.he(e,Number.MAX_SAFE_INTEGER):(this.ge(t.mapValue,e),this._e(e)):"arrayValue"in t?(this.ye(t.arrayValue,e),this._e(e)):as()}de(t,e){this.he(e,25),this.pe(t,e)}pe(t,e){e.fe(t)}ge(t,e){const n=t.fields||{};this.he(e,55);for(const i of Object.keys(n))this.de(i,e),this.ce(n[i],e)}ye(t,e){const n=t.values||[];this.he(e,50);for(const i of n)this.ce(i,e)}me(t,e){this.he(e,37),Ds.fromName(t).path.forEach(t=>{this.he(e,60),this.pe(t,e)})}he(t,e){t.le(e)}_e(t){t.le(2)}}function Pc(t){if(0===t)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function Nc(t){const e=64-function(t){let e=0;for(let n=0;n<8;++n){const i=Pc(255&t[n]);if(e+=i,8!==i)break}return e}(t);return Math.ceil(e/8)}Ac.Ie=new Ac;class Dc{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Te(t){const e=t[Symbol.iterator]();let n=e.next();for(;!n.done;)this.Ee(n.value),n=e.next();this.Ae()}Re(t){const e=t[Symbol.iterator]();let n=e.next();for(;!n.done;)this.be(n.value),n=e.next();this.Pe()}ve(t){for(const e of t){const t=e.charCodeAt(0);if(t<128)this.Ee(t);else if(t<2048)this.Ee(960|t>>>6),this.Ee(128|63&t);else if(e<"\ud800"||"\udbff"<e)this.Ee(480|t>>>12),this.Ee(128|63&t>>>6),this.Ee(128|63&t);else{const t=e.codePointAt(0);this.Ee(240|t>>>18),this.Ee(128|63&t>>>12),this.Ee(128|63&t>>>6),this.Ee(128|63&t)}}this.Ae()}Ve(t){for(const e of t){const t=e.charCodeAt(0);if(t<128)this.be(t);else if(t<2048)this.be(960|t>>>6),this.be(128|63&t);else if(e<"\ud800"||"\udbff"<e)this.be(480|t>>>12),this.be(128|63&t>>>6),this.be(128|63&t);else{const t=e.codePointAt(0);this.be(240|t>>>18),this.be(128|63&t>>>12),this.be(128|63&t>>>6),this.be(128|63&t)}}this.Pe()}Se(t){const e=this.De(t),n=Nc(e);this.Ce(1+n),this.buffer[this.position++]=255&n;for(let i=e.length-n;i<e.length;++i)this.buffer[this.position++]=255&e[i]}xe(t){const e=this.De(t),n=Nc(e);this.Ce(1+n),this.buffer[this.position++]=~(255&n);for(let i=e.length-n;i<e.length;++i)this.buffer[this.position++]=~(255&e[i])}Ne(){this.ke(255),this.ke(255)}Oe(){this.Me(255),this.Me(255)}reset(){this.position=0}seed(t){this.Ce(t.length),this.buffer.set(t,this.position),this.position+=t.length}Fe(){return this.buffer.slice(0,this.position)}De(t){const e=function(t){const e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,t,!1),new Uint8Array(e.buffer)}(t),n=0!=(128&e[0]);e[0]^=n?255:128;for(let i=1;i<e.length;++i)e[i]^=n?255:0;return e}Ee(t){const e=255&t;0===e?(this.ke(0),this.ke(255)):255===e?(this.ke(255),this.ke(0)):this.ke(e)}be(t){const e=255&t;0===e?(this.Me(0),this.Me(255)):255===e?(this.Me(255),this.Me(0)):this.Me(t)}Ae(){this.ke(0),this.ke(1)}Pe(){this.Me(0),this.Me(1)}ke(t){this.Ce(1),this.buffer[this.position++]=t}Me(t){this.Ce(1),this.buffer[this.position++]=~t}Ce(t){const e=t+this.position;if(e<=this.buffer.length)return;let n=2*this.buffer.length;n<e&&(n=e);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class Oc{constructor(t){this.$e=t}we(t){this.$e.Te(t)}fe(t){this.$e.ve(t)}le(t){this.$e.Se(t)}ae(){this.$e.Ne()}}class Rc{constructor(t){this.$e=t}we(t){this.$e.Re(t)}fe(t){this.$e.Ve(t)}le(t){this.$e.xe(t)}ae(){this.$e.Oe()}}class Lc{constructor(){this.$e=new Dc,this.Be=new Oc(this.$e),this.Le=new Rc(this.$e)}seed(t){this.$e.seed(t)}qe(t){return 0===t?this.Be:this.Le}Fe(){return this.$e.Fe()}reset(){this.$e.reset()}}class Mc{constructor(t,e,n,i){this.indexId=t,this.documentKey=e,this.arrayValue=n,this.directionalValue=i}Ue(){const t=this.directionalValue.length,e=0===t||255===this.directionalValue[t-1]?t+1:t,n=new Uint8Array(e);return n.set(this.directionalValue,0),e!==t?n.set([0],this.directionalValue.length):++n[n.length-1],new Mc(this.indexId,this.documentKey,this.arrayValue,n)}}function Fc(t,e){let n=t.indexId-e.indexId;return 0!==n?n:(n=Vc(t.arrayValue,e.arrayValue),0!==n?n:(n=Vc(t.directionalValue,e.directionalValue),0!==n?n:Ds.comparator(t.documentKey,e.documentKey)))}function Vc(t,e){for(let n=0;n<t.length&&n<e.length;++n){const i=t[n]-e[n];if(0!==i)return i}return t.length-e.length}class Uc{constructor(t){this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ke=t.orderBy,this.Ge=[];for(const e of t.filters){const t=e;t.isInequality()?this.Qe=t:this.Ge.push(t)}}je(t){ls(t.collectionGroup===this.collectionId);const e=Rs(t);if(void 0!==e&&!this.We(e))return!1;const n=Ls(t);let i=0,r=0;for(;i<n.length&&this.We(n[i]);++i);if(i===n.length)return!0;if(void 0!==this.Qe){const t=n[i];if(!this.ze(this.Qe,t)||!this.He(this.Ke[r++],t))return!1;++i}for(;i<n.length;++i){const t=n[i];if(r>=this.Ke.length||!this.He(this.Ke[r++],t))return!1}return!0}We(t){for(const e of this.Ge)if(this.ze(e,t))return!0;return!1}ze(t,e){return!(void 0===t||!t.field.isEqual(e.fieldPath))&&2===e.kind==("array-contains"===t.op||"array-contains-any"===t.op)}He(t,e){return!!t.field.isEqual(e.fieldPath)&&(0===e.kind&&"asc"===t.dir||1===e.kind&&"desc"===t.dir)}}function jc(t){var e,n;if(ls(t instanceof Wo||t instanceof Go),t instanceof Wo){if(t instanceof la){const i=(null===(n=null===(e=t.value.arrayValue)||void 0===e?void 0:e.values)||void 0===n?void 0:n.map(e=>Wo.create(t.field,"==",e)))||[];return Go.create(i,"or")}return t}const i=t.filters.map(t=>jc(t));return Go.create(i,t.op)}function qc(t){if(0===t.getFilters().length)return[];const e=Hc(jc(t));return ls(Zc(e)),zc(e)||Bc(e)?[e]:e.getFilters()}function zc(t){return t instanceof Wo}function Bc(t){return t instanceof Go&&Yo(t)}function Zc(t){return zc(t)||Bc(t)||function(t){if(t instanceof Go&&Qo(t)){for(const e of t.getFilters())if(!zc(e)&&!Bc(e))return!1;return!0}return!1}(t)}function Hc(t){if(ls(t instanceof Wo||t instanceof Go),t instanceof Wo)return t;if(1===t.filters.length)return Hc(t.filters[0]);const e=t.filters.map(t=>Hc(t));let n=Go.create(e,t.op);return n=Gc(n),Zc(n)?n:(ls(n instanceof Go),ls(Ko(n)),ls(n.filters.length>1),n.filters.reduce((t,e)=>$c(t,e)))}function $c(t,e){let n;return ls(t instanceof Wo||t instanceof Go),ls(e instanceof Wo||e instanceof Go),n=t instanceof Wo?e instanceof Wo?Go.create([t,e],"and"):Wc(t,e):e instanceof Wo?Wc(e,t):function(t,e){if(ls(t.filters.length>0&&e.filters.length>0),Ko(t)&&Ko(e))return ea(t,e.getFilters());const n=Qo(t)?t:e,i=Qo(t)?e:t,r=n.filters.map(t=>$c(t,i));return Go.create(r,"or")}(t,e),Gc(n)}function Wc(t,e){if(Ko(e))return ea(e,t.getFilters());{const n=e.filters.map(e=>$c(t,e));return Go.create(n,"or")}}function Gc(t){if(ls(t instanceof Wo||t instanceof Go),t instanceof Wo)return t;const e=t.getFilters();if(1===e.length)return Gc(e[0]);if(Jo(t))return t;const n=e.map(t=>Gc(t)),i=[];return n.forEach(e=>{e instanceof Wo?i.push(e):e instanceof Go&&(e.op===t.op?i.push(...e.filters):i.push(e))}),1===i.length?i[0]:Go.create(i,t.op)}class Kc{constructor(){this.Je=new Qc}addToCollectionParentIndex(t,e){return this.Je.add(e),$s.resolve()}getCollectionParents(t,e){return $s.resolve(this.Je.getEntries(e))}addFieldIndex(t,e){return $s.resolve()}deleteFieldIndex(t,e){return $s.resolve()}getDocumentsMatchingTarget(t,e){return $s.resolve(null)}getIndexType(t,e){return $s.resolve(0)}getFieldIndexes(t,e){return $s.resolve([])}getNextCollectionGroupToUpdate(t){return $s.resolve(null)}getMinOffset(t,e){return $s.resolve(js.min())}getMinOffsetFromCollectionGroup(t,e){return $s.resolve(js.min())}updateCollectionGroup(t,e,n){return $s.resolve()}updateIndexEntries(t,e){return $s.resolve()}}class Qc{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new ga(As.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new ga(As.comparator)).toArray()}}const Yc=new Uint8Array(0);class Jc{constructor(t,e){this.user=t,this.databaseId=e,this.Ye=new Qc,this.Xe=new Dl(t=>Ca(t),(t,e)=>Ea(t,e)),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.Ye.has(e)){const n=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(()=>{this.Ye.add(e)});const r={collectionId:n,parent:Ou(i)};return Xc(t).put(r)}return $s.resolve()}getCollectionParents(t,e){const n=[],i=IDBKeyRange.bound([e,""],[Cs(e),""],!1,!0);return Xc(t).W(i).next(t=>{for(const i of t){if(i.collectionId!==e)break;n.push(Mu(i.parent))}return n})}addFieldIndex(t,e){const n=eh(t),i={indexId:(r=e).indexId,collectionGroup:r.collectionGroup,fields:r.fields.map(t=>[t.fieldPath.canonicalString(),t.kind])};var r;delete i.indexId;const s=n.add(i);if(e.indexState){const n=nh(t);return s.next(t=>{n.put(Ic(t,this.user,e.indexState.sequenceNumber,e.indexState.offset))})}return s.next()}deleteFieldIndex(t,e){const n=eh(t),i=nh(t),r=th(t);return n.delete(e.indexId).next(()=>i.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))).next(()=>r.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))}getDocumentsMatchingTarget(t,e){const n=th(t);let i=!0;const r=new Map;return $s.forEach(this.Ze(e),e=>this.tn(t,e).next(t=>{i&&(i=!!t),r.set(e,t)})).next(()=>{if(i){let t=Bl();const i=[];return $s.forEach(r,(r,s)=>{var o;is("IndexedDbIndexManager",`Using index ${o=r,`id=${o.indexId}|cg=${o.collectionGroup}|f=${o.fields.map(t=>`${t.fieldPath}:${t.kind}`).join(",")}`} to execute ${Ca(e)}`);const a=function(t,e){const n=Rs(e);if(void 0===n)return null;for(const i of ka(t,n.fieldPath))switch(i.op){case"array-contains-any":return i.value.arrayValue.values||[];case"array-contains":return[i.value]}return null}(s,r),l=function(t,e){const n=new Map;for(const i of Ls(e))for(const e of ka(t,i.fieldPath))switch(e.op){case"==":case"in":n.set(i.fieldPath.canonicalString(),e.value);break;case"not-in":case"!=":return n.set(i.fieldPath.canonicalString(),e.value),Array.from(n.values())}return null}(s,r),u=function(t,e){const n=[];let i=!0;for(const r of Ls(e)){const e=0===r.kind?Aa(t,r.fieldPath,t.startAt):Pa(t,r.fieldPath,t.startAt);n.push(e.value),i&&(i=e.inclusive)}return new Bo(n,i)}(s,r),c=function(t,e){const n=[];let i=!0;for(const r of Ls(e)){const e=0===r.kind?Pa(t,r.fieldPath,t.endAt):Aa(t,r.fieldPath,t.endAt);n.push(e.value),i&&(i=e.inclusive)}return new Bo(n,i)}(s,r),h=this.en(r,s,u),d=this.en(r,s,c),p=this.nn(r,s,l),f=this.sn(r.indexId,a,h,u.inclusive,d,c.inclusive,p);return $s.forEach(f,r=>n.J(r,e.limit).next(e=>{e.forEach(e=>{const n=Ds.fromSegments(e.documentKey);t.has(n)||(t=t.add(n),i.push(n))})}))}).next(()=>i)}return $s.resolve(null)})}Ze(t){let e=this.Xe.get(t);return e||(e=0===t.filters.length?[t]:qc(Go.create(t.filters,"and")).map(e=>Sa(t.path,t.collectionGroup,t.orderBy,e.getFilters(),t.limit,t.startAt,t.endAt)),this.Xe.set(t,e),e)}sn(t,e,n,i,r,s,o){const a=(null!=e?e.length:1)*Math.max(n.length,r.length),l=a/(null!=e?e.length:1),u=[];for(let c=0;c<a;++c){const a=e?this.rn(e[c/l]):Yc,h=this.on(t,a,n[c%l],i),d=this.un(t,a,r[c%l],s),p=o.map(e=>this.on(t,a,e,!0));u.push(...this.createRange(h,d,p))}return u}on(t,e,n,i){const r=new Mc(t,Ds.empty(),e,n);return i?r:r.Ue()}un(t,e,n,i){const r=new Mc(t,Ds.empty(),e,n);return i?r.Ue():r}tn(t,e){const n=new Uc(e),i=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,i).next(t=>{let e=null;for(const i of t)n.je(i)&&(!e||i.fields.length>e.fields.length)&&(e=i);return e})}getIndexType(t,e){let n=2;const i=this.Ze(e);return $s.forEach(i,e=>this.tn(t,e).next(t=>{t?0!==n&&t.fields.length<function(t){let e=new ga(Ns.comparator),n=!1;for(const i of t.filters)for(const t of i.getFlattenedFilters())t.field.isKeyField()||("array-contains"===t.op||"array-contains-any"===t.op?n=!0:e=e.add(t.field));for(const i of t.orderBy)i.field.isKeyField()||(e=e.add(i.field));return e.size+(n?1:0)}(e)&&(n=1):n=0})).next(()=>null!==e.limit&&i.length>1&&2===n?1:n)}cn(t,e){const n=new Lc;for(const i of Ls(t)){const t=e.data.field(i.fieldPath);if(null==t)return null;const r=n.qe(i.kind);Ac.Ie.ue(t,r)}return n.Fe()}rn(t){const e=new Lc;return Ac.Ie.ue(t,e.qe(0)),e.Fe()}an(t,e){const n=new Lc;return Ac.Ie.ue(No(this.databaseId,e),n.qe(function(t){const e=Ls(t);return 0===e.length?0:e[e.length-1].kind}(t))),n.Fe()}nn(t,e,n){if(null===n)return[];let i=[];i.push(new Lc);let r=0;for(const s of Ls(t)){const t=n[r++];for(const n of i)if(this.hn(e,s.fieldPath)&&Oo(t))i=this.ln(i,s,t);else{const e=n.qe(s.kind);Ac.Ie.ue(t,e)}}return this.fn(i)}en(t,e,n){return this.nn(t,e,n.position)}fn(t){const e=[];for(let n=0;n<t.length;++n)e[n]=t[n].Fe();return e}ln(t,e,n){const i=[...t],r=[];for(const s of n.arrayValue.values||[])for(const t of i){const n=new Lc;n.seed(t.Fe()),Ac.Ie.ue(s,n.qe(e.kind)),r.push(n)}return r}hn(t,e){return!!t.filters.find(t=>t instanceof Wo&&t.field.isEqual(e)&&("in"===t.op||"not-in"===t.op))}getFieldIndexes(t,e){const n=eh(t),i=nh(t);return(e?n.W("collectionGroupIndex",IDBKeyRange.bound(e,e)):n.W()).next(t=>{const e=[];return $s.forEach(t,t=>i.get([t.indexId,this.uid]).next(n=>{e.push(function(t,e){const n=e?new Fs(e.sequenceNumber,new js(gc(e.readTime),new Ds(Mu(e.documentKey)),e.largestBatchId)):Fs.empty(),i=t.fields.map(([t,e])=>new Ms(Ns.fromServerFormat(t),e));return new Os(t.indexId,t.collectionGroup,i,n)}(t,n))})).next(()=>e)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(t=>0===t.length?null:(t.sort((t,e)=>{const n=t.indexState.sequenceNumber-e.indexState.sequenceNumber;return 0!==n?n:Is(t.collectionGroup,e.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(t,e,n){const i=eh(t),r=nh(t);return this.dn(t).next(t=>i.W("collectionGroupIndex",IDBKeyRange.bound(e,e)).next(e=>$s.forEach(e,e=>r.put(Ic(e.indexId,this.user,t,n)))))}updateIndexEntries(t,e){const n=new Map;return $s.forEach(e,(e,i)=>{const r=n.get(e.collectionGroup);return(r?$s.resolve(r):this.getFieldIndexes(t,e.collectionGroup)).next(r=>(n.set(e.collectionGroup,r),$s.forEach(r,n=>this._n(t,e,n).next(e=>{const r=this.wn(i,n);return e.isEqual(r)?$s.resolve():this.mn(t,i,n,e,r)}))))})}gn(t,e,n,i){return th(t).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.an(n,e.key),documentKey:e.key.path.toArray()})}yn(t,e,n,i){return th(t).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.an(n,e.key),e.key.path.toArray()])}_n(t,e,n){const i=th(t);let r=new ga(Fc);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.an(n,e)])},(t,i)=>{r=r.add(new Mc(n.indexId,e,i.arrayValue,i.directionalValue))}).next(()=>r)}wn(t,e){let n=new ga(Fc);const i=this.cn(e,t);if(null==i)return n;const r=Rs(e);if(null!=r){const s=t.data.field(r.fieldPath);if(Oo(s))for(const r of s.arrayValue.values||[])n=n.add(new Mc(e.indexId,t.key,this.rn(r),i))}else n=n.add(new Mc(e.indexId,t.key,Yc,i));return n}mn(t,e,n,i,r){is("IndexedDbIndexManager","Updating index entries for document '%s'",e.key);const s=[];return function(t,e,n,i,r){const s=t.getIterator(),o=e.getIterator();let a=_a(s),l=_a(o);for(;a||l;){let t=!1,e=!1;if(a&&l){const i=n(a,l);i<0?e=!0:i>0&&(t=!0)}else null!=a?e=!0:t=!0;t?(i(l),l=_a(o)):e?(r(a),a=_a(s)):(a=_a(s),l=_a(o))}}(i,r,Fc,i=>{s.push(this.gn(t,e,n,i))},i=>{s.push(this.yn(t,e,n,i))}),$s.waitFor(s)}dn(t){let e=1;return nh(t).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(t,n,i)=>{i.done(),e=n.sequenceNumber+1}).next(()=>e)}createRange(t,e,n){n=n.sort((t,e)=>Fc(t,e)).filter((t,e,n)=>!e||0!==Fc(t,n[e-1]));const i=[];i.push(t);for(const s of n){const n=Fc(s,t),r=Fc(s,e);if(0===n)i[0]=t.Ue();else if(n>0&&r<0)i.push(s),i.push(s.Ue());else if(r>0)break}i.push(e);const r=[];for(let s=0;s<i.length;s+=2){if(this.pn(i[s],i[s+1]))return[];r.push(IDBKeyRange.bound([i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Yc,[]],[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Yc,[]]))}return r}pn(t,e){return Fc(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(ih)}getMinOffset(t,e){return $s.mapArray(this.Ze(e),e=>this.tn(t,e).next(t=>t||as())).next(ih)}}function Xc(t){return ac(t,"collectionParents")}function th(t){return ac(t,"indexEntries")}function eh(t){return ac(t,"indexConfiguration")}function nh(t){return ac(t,"indexState")}function ih(t){ls(0!==t.length);let e=t[0].indexState.offset,n=e.largestBatchId;for(let i=1;i<t.length;i++){const r=t[i].indexState.offset;qs(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new js(e.readTime,e.documentKey,n)}const rh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class sh{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new sh(t,sh.DEFAULT_COLLECTION_PERCENTILE,sh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function oh(t,e,n){const i=t.store("mutations"),r=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=i.Z({range:o},(t,e,n)=>(a++,n.delete()));s.push(l.next(()=>{ls(1===a)}));const u=[];for(const c of n.mutations){const t=Uu(e,c.key.path,n.batchId);s.push(r.delete(t)),u.push(c.key)}return $s.waitFor(s).next(()=>u)}function ah(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw as();e=t.noDocument}return JSON.stringify(e).length}sh.DEFAULT_COLLECTION_PERCENTILE=10,sh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sh.DEFAULT=new sh(41943040,sh.DEFAULT_COLLECTION_PERCENTILE,sh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sh.DISABLED=new sh(-1,0,0);class lh{constructor(t,e,n,i){this.userId=t,this.yt=e,this.indexManager=n,this.referenceDelegate=i,this.In={}}static re(t,e,n,i){ls(""!==t.uid);const r=t.isAuthenticated()?t.uid:"";return new lh(r,e,n,i)}checkEmpty(t){let e=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ch(t).Z({index:"userMutationsIndex",range:n},(t,n,i)=>{e=!1,i.done()}).next(()=>e)}addMutationBatch(t,e,n,i){const r=hh(t),s=ch(t);return s.add({}).next(o=>{ls("number"==typeof o);const a=new lc(o,e,n,i),l=function(t,e,n){const i=n.baseMutations.map(e=>vu(t.ie,e)),r=n.mutations.map(e=>vu(t.ie,e));return{userId:e,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:i,mutations:r}}(this.yt,this.userId,a),u=[];let c=new ga((t,e)=>Is(t.canonicalString(),e.canonicalString()));for(const t of i){const e=Uu(this.userId,t.key.path,o);c=c.add(t.key.path.popLast()),u.push(s.put(l)),u.push(r.put(e,ju))}return c.forEach(e=>{u.push(this.indexManager.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(()=>{this.In[o]=a.keys()}),$s.waitFor(u).next(()=>a)})}lookupMutationBatch(t,e){return ch(t).get(e).next(t=>t?(ls(t.userId===this.userId),yc(this.yt,t)):null)}Tn(t,e){return this.In[e]?$s.resolve(this.In[e]):this.lookupMutationBatch(t,e).next(t=>{if(t){const n=t.keys();return this.In[e]=n,n}return null})}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=IDBKeyRange.lowerBound([this.userId,n]);let r=null;return ch(t).Z({index:"userMutationsIndex",range:i},(t,e,i)=>{e.userId===this.userId&&(ls(e.batchId>=n),r=yc(this.yt,e)),i.done()}).next(()=>r)}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return ch(t).Z({index:"userMutationsIndex",range:e,reverse:!0},(t,e,i)=>{n=e.batchId,i.done()}).next(()=>n)}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ch(t).W("userMutationsIndex",e).next(t=>t.map(t=>yc(this.yt,t)))}getAllMutationBatchesAffectingDocumentKey(t,e){const n=Vu(this.userId,e.path),i=IDBKeyRange.lowerBound(n),r=[];return hh(t).Z({range:i},(n,i,s)=>{const[o,a,l]=n,u=Mu(a);if(o===this.userId&&e.path.isEqual(u))return ch(t).get(l).next(t=>{if(!t)throw as();ls(t.userId===this.userId),r.push(yc(this.yt,t))});s.done()}).next(()=>r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ga(Is);const i=[];return e.forEach(e=>{const r=Vu(this.userId,e.path),s=IDBKeyRange.lowerBound(r),o=hh(t).Z({range:s},(t,i,r)=>{const[s,o,a]=t,l=Mu(o);s===this.userId&&e.path.isEqual(l)?n=n.add(a):r.done()});i.push(o)}),$s.waitFor(i).next(()=>this.En(t,n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1,r=Vu(this.userId,n),s=IDBKeyRange.lowerBound(r);let o=new ga(Is);return hh(t).Z({range:s},(t,e,r)=>{const[s,a,l]=t,u=Mu(a);s===this.userId&&n.isPrefixOf(u)?u.length===i&&(o=o.add(l)):r.done()}).next(()=>this.En(t,o))}En(t,e){const n=[],i=[];return e.forEach(e=>{i.push(ch(t).get(e).next(t=>{if(null===t)throw as();ls(t.userId===this.userId),n.push(yc(this.yt,t))}))}),$s.waitFor(i).next(()=>n)}removeMutationBatch(t,e){return oh(t.se,this.userId,e).next(n=>(t.addOnCommittedListener(()=>{this.An(e.batchId)}),$s.forEach(n,e=>this.referenceDelegate.markPotentiallyOrphaned(t,e))))}An(t){delete this.In[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(e=>{if(!e)return $s.resolve();const n=IDBKeyRange.lowerBound([this.userId]),i=[];return hh(t).Z({range:n},(t,e,n)=>{if(t[0]===this.userId){const e=Mu(t[1]);i.push(e)}else n.done()}).next(()=>{ls(0===i.length)})})}containsKey(t,e){return uh(t,this.userId,e)}Rn(t){return dh(t).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function uh(t,e,n){const i=Vu(e,n.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return hh(t).Z({range:s,X:!0},(t,n,i)=>{const[s,a,l]=t;s===e&&a===r&&(o=!0),i.done()}).next(()=>o)}function ch(t){return ac(t,"mutations")}function hh(t){return ac(t,"documentMutations")}function dh(t){return ac(t,"mutationQueues")}class ph{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new ph(0)}static vn(){return new ph(-1)}}class fh{constructor(t,e){this.referenceDelegate=t,this.yt=e}allocateTargetId(t){return this.Vn(t).next(e=>{const n=new ph(e.highestTargetId);return e.highestTargetId=n.next(),this.Sn(t,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.Vn(t).next(t=>xs.fromTimestamp(new Es(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.Vn(t).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(t,e,n){return this.Vn(t).next(i=>(i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),this.Sn(t,i)))}addTargetData(t,e){return this.Dn(t,e).next(()=>this.Vn(t).next(n=>(n.targetCount+=1,this.Cn(e,n),this.Sn(t,n))))}updateTargetData(t,e){return this.Dn(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>mh(t).delete(e.targetId)).next(()=>this.Vn(t)).next(e=>(ls(e.targetCount>0),e.targetCount-=1,this.Sn(t,e)))}removeTargets(t,e,n){let i=0;const r=[];return mh(t).Z((s,o)=>{const a=_c(o);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,r.push(this.removeTargetData(t,a)))}).next(()=>$s.waitFor(r)).next(()=>i)}forEachTarget(t,e){return mh(t).Z((t,n)=>{const i=_c(n);e(i)})}Vn(t){return gh(t).get("targetGlobalKey").next(t=>(ls(null!==t),t))}Sn(t,e){return gh(t).put("targetGlobalKey",e)}Dn(t,e){return mh(t).put(vc(this.yt,e))}Cn(t,e){let n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n}getTargetCount(t){return this.Vn(t).next(t=>t.targetCount)}getTargetData(t,e){const n=Ca(e),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let r=null;return mh(t).Z({range:i,index:"queryTargetsIndex"},(t,n,i)=>{const s=_c(n);Ea(e,s.target)&&(r=s,i.done())}).next(()=>r)}addMatchingKeys(t,e,n){const i=[],r=yh(t);return e.forEach(e=>{const s=Ou(e.path);i.push(r.put({targetId:n,path:s})),i.push(this.referenceDelegate.addReference(t,n,e))}),$s.waitFor(i)}removeMatchingKeys(t,e,n){const i=yh(t);return $s.forEach(e,e=>{const r=Ou(e.path);return $s.waitFor([i.delete([n,r]),this.referenceDelegate.removeReference(t,n,e)])})}removeMatchingKeysForTargetId(t,e){const n=yh(t),i=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(t,e){const n=IDBKeyRange.bound([e],[e+1],!1,!0),i=yh(t);let r=Bl();return i.Z({range:n,X:!0},(t,e,n)=>{const i=Mu(t[1]),s=new Ds(i);r=r.add(s)}).next(()=>r)}containsKey(t,e){const n=Ou(e.path),i=IDBKeyRange.bound([n],[Cs(n)],!1,!0);let r=0;return yh(t).Z({index:"documentTargetsIndex",X:!0,range:i},([t,e],n,i)=>{0!==t&&(r++,i.done())}).next(()=>r>0)}ne(t,e){return mh(t).get(e).next(t=>t?_c(t):null)}}function mh(t){return ac(t,"targets")}function gh(t){return ac(t,"targetGlobal")}function yh(t){return ac(t,"targetDocuments")}function _h([t,e],[n,i]){const r=Is(t,n);return 0===r?Is(e,i):r}class vh{constructor(t){this.xn=t,this.buffer=new ga(_h),this.Nn=0}kn(){return++this.Nn}On(t){const e=[t,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();_h(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class wh{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Mn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return null!==this.Mn}Fn(t){var e=this;is("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(0,Gt.Z)(function*(){e.Mn=null;try{yield e.localStore.collectGarbage(e.garbageCollector)}catch(t){Ys(t)?is("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Zs(t)}yield e.Fn(3e5)}))}}class bh{constructor(t,e){this.$n=t,this.params=e}calculateTargetCount(t,e){return this.$n.Bn(t).next(t=>Math.floor(e/100*t))}nthSequenceNumber(t,e){if(0===e)return $s.resolve(ro.at);const n=new vh(e);return this.$n.forEachTarget(t,t=>n.On(t.sequenceNumber)).next(()=>this.$n.Ln(t,t=>n.On(t))).next(()=>n.maxValue)}removeTargets(t,e,n){return this.$n.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.$n.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(is("LruGarbageCollector","Garbage collection skipped; disabled"),$s.resolve(rh)):this.getCacheSize(t).next(n=>n<this.params.cacheSizeCollectionThreshold?(is("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rh):this.qn(t,e))}getCacheSize(t){return this.$n.getCacheSize(t)}qn(t,e){let n,i,r,s,o,a,l;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(e=>(e>this.params.maximumSequenceNumbersToCollect?(is("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${e}`),i=this.params.maximumSequenceNumbersToCollect):i=e,s=Date.now(),this.nthSequenceNumber(t,i))).next(i=>(n=i,o=Date.now(),this.removeTargets(t,n,e))).next(e=>(r=e,a=Date.now(),this.removeOrphanedDocuments(t,n))).next(t=>(l=Date.now(),ns()<=Yt.in.DEBUG&&is("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${i} in `+(o-s)+`ms\n\tRemoved ${r} targets in `+(a-o)+`ms\n\tRemoved ${t} documents in `+(l-a)+`ms\nTotal Duration: ${l-u}ms`),$s.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:t})))}}class Th{constructor(t,e){this.db=t,this.garbageCollector=new bh(this,e)}Bn(t){const e=this.Un(t);return this.db.getTargetCache().getTargetCount(t).next(t=>e.next(e=>t+e))}Un(t){let e=0;return this.Ln(t,t=>{e++}).next(()=>e)}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}Ln(t,e){return this.Kn(t,(t,n)=>e(n))}addReference(t,e,n){return Ih(t,n)}removeReference(t,e,n){return Ih(t,n)}removeTargets(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)}markPotentiallyOrphaned(t,e){return Ih(t,e)}Gn(t,e){return function(t,e){let n=!1;return dh(t).tt(i=>uh(t,i,e).next(t=>(t&&(n=!0),$s.resolve(!t)))).next(()=>n)}(t,e)}removeOrphanedDocuments(t,e){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let r=0;return this.Kn(t,(s,o)=>{if(o<=e){const e=this.Gn(t,s).next(e=>{if(!e)return r++,n.getEntry(t,s).next(()=>(n.removeEntry(s,xs.min()),yh(t).delete([0,Ou(s.path)])))});i.push(e)}}).next(()=>$s.waitFor(i)).next(()=>n.apply(t)).next(()=>r)}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)}updateLimboDocument(t,e){return Ih(t,e)}Kn(t,e){const n=yh(t);let i,r=ro.at;return n.Z({index:"documentTargetsIndex"},([t,n],{path:s,sequenceNumber:o})=>{0===t?(r!==ro.at&&e(new Ds(Mu(i)),r),r=o,i=s):r=ro.at}).next(()=>{r!==ro.at&&e(new Ds(Mu(i)),r)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function Ih(t,e){return yh(t).put((n=t.currentSequenceNumber,{targetId:0,path:Ou(e.path),sequenceNumber:n}));var n}class Sh{constructor(){this.changes=new Dl(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ta.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?$s.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Ch{constructor(t){this.yt=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,n){return Ah(t).put(n)}removeEntry(t,e,n){return Ah(t).delete(function(t,e){const n=t.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],fc(e),n[n.length-1]]}(e,n))}updateMetadata(t,e){return this.getMetadata(t).next(n=>(n.byteSize+=e,this.Qn(t,n)))}getEntry(t,e){let n=Ta.newInvalidDocument(e);return Ah(t).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Ph(e))},(t,i)=>{n=this.jn(e,i)}).next(()=>n)}Wn(t,e){let n={size:0,document:Ta.newInvalidDocument(e)};return Ah(t).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Ph(e))},(t,i)=>{n={document:this.jn(e,i),size:ah(i)}}).next(()=>n)}getEntries(t,e){let n=Rl();return this.zn(t,e,(t,e)=>{const i=this.jn(t,e);n=n.insert(t,i)}).next(()=>n)}Hn(t,e){let n=Rl(),i=new pa(Ds.comparator);return this.zn(t,e,(t,e)=>{const r=this.jn(t,e);n=n.insert(t,r),i=i.insert(t,ah(e))}).next(()=>({documents:n,Jn:i}))}zn(t,e,n){if(e.isEmpty())return $s.resolve();let i=new ga(Dh);e.forEach(t=>i=i.add(t));const r=IDBKeyRange.bound(Ph(i.first()),Ph(i.last())),s=i.getIterator();let o=s.getNext();return Ah(t).Z({index:"documentKeyIndex",range:r},(t,e,i)=>{const r=Ds.fromSegments([...e.prefixPath,e.collectionGroup,e.documentId]);for(;o&&Dh(o,r)<0;)n(o,null),o=s.getNext();o&&o.isEqual(r)&&(n(o,e),o=s.hasNext()?s.getNext():null),o?i.j(Ph(o)):i.done()}).next(()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null})}getAllFromCollection(t,e,n){const i=[e.popLast().toArray(),e.lastSegment(),fc(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],r=[e.popLast().toArray(),e.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ah(t).W(IDBKeyRange.bound(i,r,!0)).next(t=>{let e=Rl();for(const n of t){const t=this.jn(Ds.fromSegments(n.prefixPath.concat(n.collectionGroup,n.documentId)),n);e=e.insert(t.key,t)}return e})}getAllFromCollectionGroup(t,e,n,i){let r=Rl();const s=Nh(e,n),o=Nh(e,js.max());return Ah(t).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},(t,e,n)=>{const s=this.jn(Ds.fromSegments(e.prefixPath.concat(e.collectionGroup,e.documentId)),e);r=r.insert(s.key,s),r.size===i&&n.done()}).next(()=>r)}newChangeBuffer(t){return new xh(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(t=>t.byteSize)}getMetadata(t){return kh(t).get("remoteDocumentGlobalKey").next(t=>(ls(!!t),t))}Qn(t,e){return kh(t).put("remoteDocumentGlobalKey",e)}jn(t,e){if(e){const t=function(t,e){let n;if(e.document)n=_u(t.ie,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const t=Ds.fromSegments(e.noDocument.path),i=gc(e.noDocument.readTime);n=Ta.newNoDocument(t,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return as();{const t=Ds.fromSegments(e.unknownDocument.path),i=gc(e.unknownDocument.version);n=Ta.newUnknownDocument(t,i)}}return e.readTime&&n.setReadTime(function(t){const e=new Es(t[0],t[1]);return xs.fromTimestamp(e)}(e.readTime)),n}(this.yt,e);if(!t.isNoDocument()||!t.version.isEqual(xs.min()))return t}return Ta.newInvalidDocument(t)}}function Eh(t){return new Ch(t)}class xh extends Sh{constructor(t,e){super(),this.Yn=t,this.trackRemovals=e,this.Xn=new Dl(t=>t.toString(),(t,e)=>t.isEqual(e))}applyChanges(t){const e=[];let n=0,i=new ga((t,e)=>Is(t.canonicalString(),e.canonicalString()));return this.changes.forEach((r,s)=>{const o=this.Xn.get(r);if(e.push(this.Yn.removeEntry(t,r,o.readTime)),s.isValidDocument()){const a=pc(this.Yn.yt,s);i=i.add(r.path.popLast()),n+=ah(a)-o.size,e.push(this.Yn.addEntry(t,r,a))}else if(n-=o.size,this.trackRemovals){const n=pc(this.Yn.yt,s.convertToNoDocument(xs.min()));e.push(this.Yn.addEntry(t,r,n))}}),i.forEach(n=>{e.push(this.Yn.indexManager.addToCollectionParentIndex(t,n))}),e.push(this.Yn.updateMetadata(t,n)),$s.waitFor(e)}getFromCache(t,e){return this.Yn.Wn(t,e).next(t=>(this.Xn.set(e,{size:t.size,readTime:t.document.readTime}),t.document))}getAllFromCache(t,e){return this.Yn.Hn(t,e).next(({documents:t,Jn:e})=>(e.forEach((e,n)=>{this.Xn.set(e,{size:n,readTime:t.get(e).readTime})}),t))}}function kh(t){return ac(t,"remoteDocumentGlobal")}function Ah(t){return ac(t,"remoteDocumentsV14")}function Ph(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Nh(t,e){const n=e.documentKey.path.toArray();return[t,fc(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Dh(t,e){const n=t.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<n.length-2&&s<i.length-2;++s)if(r=Is(n[s],i[s]),r)return r;return r=Is(n.length,i.length),r||(r=Is(n[n.length-2],i[i.length-2]),r||Is(n[n.length-1],i[i.length-1]))}class Oh{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Rh{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,e))).next(t=>(null!==n&&yl(n.mutation,t,va.empty(),Es.now()),t))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,Bl()).next(()=>e))}getLocalViewOfDocuments(t,e,n=Bl()){const i=Vl();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,n).next(t=>{let e=Ml();return t.forEach((t,n)=>{e=e.insert(t,n.overlayedDocument)}),e}))}getOverlayedDocuments(t,e){const n=Vl();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,Bl()))}populateOverlays(t,e,n){const i=[];return n.forEach(t=>{e.has(t)||i.push(t)}),this.documentOverlayCache.getOverlays(t,i).next(t=>{t.forEach((t,n)=>{e.set(t,n)})})}computeViews(t,e,n,i){let r=Rl();const s=jl(),o=jl();return e.forEach((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof bl)?r=r.insert(e.key,e):void 0!==o&&(s.set(e.key,o.mutation.getFieldMask()),yl(o.mutation,e,o.mutation.getFieldMask(),Es.now()))}),this.recalculateAndSaveOverlays(t,r).next(t=>(t.forEach((t,e)=>s.set(t,e)),e.forEach((t,e)=>{var n;return o.set(t,new Oh(e,null!==(n=s.get(t))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(t,e){const n=jl();let i=new pa((t,e)=>t-e),r=Bl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(t=>{for(const r of t)r.keys().forEach(t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||va.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||Bl()).add(t);i=i.insert(r.batchId,a)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,l=i.value,u=Ul();l.forEach(t=>{if(!r.has(t)){const i=ml(e.get(t),n.get(t));null!==i&&u.set(t,i),r=r.add(t)}}),s.push(this.documentOverlayCache.saveOverlays(t,a,u))}return $s.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(t,e,n){return Ds.isDocumentKey((i=e).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):Fa(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n);var i}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next(r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):$s.resolve(Vl());let o=-1,a=r;return s.next(e=>$s.forEach(e,(e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?$s.resolve():this.remoteDocumentCache.getEntry(t,e).next(t=>{a=a.insert(e,t)}))).next(()=>this.populateOverlays(t,e,r)).next(()=>this.computeViews(t,a,e,Bl())).next(t=>({batchId:o,changes:Fl(t)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ds(e)).next(t=>{let e=Ml();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let r=Ml();return this.indexManager.getCollectionParents(t,i).next(s=>$s.forEach(s,s=>{const o=(a=e,l=s.child(i),new Na(l,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));var a,l;return this.getDocumentsMatchingCollectionQuery(t,o,n).next(t=>{t.forEach((t,e)=>{r=r.insert(t,e)})})}).next(()=>r))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.remoteDocumentCache.getAllFromCollection(t,e.path,n).next(r=>(i=r,this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId))).next(t=>{t.forEach((t,e)=>{const n=e.getKey();null===i.get(n)&&(i=i.insert(n,Ta.newInvalidDocument(n)))});let n=Ml();return i.forEach((i,r)=>{const s=t.get(i);void 0!==s&&yl(s.mutation,r,va.empty(),Es.now()),Ha(e,r)&&(n=n.insert(i,r))}),n})}}class Lh{constructor(t){this.yt=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return $s.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var n;return this.Zn.set(e.id,{id:(n=e).id,version:n.version,createTime:lu(n.createTime)}),$s.resolve()}getNamedQuery(t,e){return $s.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(n=e).name,query:wc(n.bundledQuery),readTime:lu(n.readTime)}),$s.resolve();var n}}class Mh{constructor(){this.overlays=new pa(Ds.comparator),this.es=new Map}getOverlay(t,e){return $s.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Vl();return $s.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((n,i)=>{this.oe(t,e,i)}),$s.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.es.get(n);return void 0!==i&&(i.forEach(t=>this.overlays=this.overlays.remove(t)),this.es.delete(n)),$s.resolve()}getOverlaysForCollection(t,e,n){const i=Vl(),r=e.length+1,s=new Ds(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return $s.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new pa((t,e)=>t-e);const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=Vl(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Vl(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((t,e)=>o.set(t,e)),!(o.size()>=i)););return $s.resolve(o)}oe(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.es.get(i.largestBatchId).delete(n.key);this.es.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new cc(e,n));let r=this.es.get(e);void 0===r&&(r=Bl(),this.es.set(e,r)),this.es.set(e,r.add(n.key))}}class Fh{constructor(){this.ns=new ga(Vh.ss),this.rs=new ga(Vh.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const n=new Vh(t,e);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(t,e){t.forEach(t=>this.addReference(t,e))}removeReference(t,e){this.cs(new Vh(t,e))}hs(t,e){t.forEach(t=>this.removeReference(t,e))}ls(t){const e=new Ds(new As([])),n=new Vh(e,t),i=new Vh(e,t+1),r=[];return this.rs.forEachInRange([n,i],t=>{this.cs(t),r.push(t.key)}),r}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new Ds(new As([])),n=new Vh(e,t),i=new Vh(e,t+1);let r=Bl();return this.rs.forEachInRange([n,i],t=>{r=r.add(t.key)}),r}containsKey(t){const e=new Vh(t,0),n=this.ns.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Vh{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return Ds.comparator(t.key,e.key)||Is(t._s,e._s)}static os(t,e){return Is(t._s,e._s)||Ds.comparator(t.key,e.key)}}class Uh{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new ga(Vh.ss)}checkEmpty(t){return $s.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.ws;this.ws++;const s=new lc(r,e,n,i);this.mutationQueue.push(s);for(const o of i)this.gs=this.gs.add(new Vh(o.key,r)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return $s.resolve(s)}lookupMutationBatch(t,e){return $s.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const n=this.ps(e+1),i=n<0?0:n;return $s.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $s.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return $s.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Vh(e,0),i=new Vh(e,Number.POSITIVE_INFINITY),r=[];return this.gs.forEachInRange([n,i],t=>{const e=this.ys(t._s);r.push(e)}),$s.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ga(Is);return e.forEach(t=>{const e=new Vh(t,0),i=new Vh(t,Number.POSITIVE_INFINITY);this.gs.forEachInRange([e,i],t=>{n=n.add(t._s)})}),$s.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Ds.isDocumentKey(r)||(r=r.child(""));const s=new Vh(new Ds(r),0);let o=new ga(Is);return this.gs.forEachWhile(t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t._s)),!0)},s),$s.resolve(this.Is(o))}Is(t){const e=[];return t.forEach(t=>{const n=this.ys(t);null!==n&&e.push(n)}),e}removeMutationBatch(t,e){ls(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return $s.forEach(e.mutations,i=>{const r=new Vh(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.gs=n})}An(t){}containsKey(t,e){const n=new Vh(e,0),i=this.gs.firstAfterOrEqual(n);return $s.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return $s.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class jh{constructor(t){this.Es=t,this.docs=new pa(Ds.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.Es(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return $s.resolve(n?n.document.mutableCopy():Ta.newInvalidDocument(e))}getEntries(t,e){let n=Rl();return e.forEach(t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ta.newInvalidDocument(t))}),$s.resolve(n)}getAllFromCollection(t,e,n){let i=Rl();const r=new Ds(e.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r}}=s.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||qs(Us(r),n)<=0||(i=i.insert(r.key,r.mutableCopy()))}return $s.resolve(i)}getAllFromCollectionGroup(t,e,n,i){as()}As(t,e){return $s.forEach(this.docs,t=>e(t))}newChangeBuffer(t){return new qh(this)}getSize(t){return $s.resolve(this.size)}}class qh extends Sh{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?e.push(this.Yn.addEntry(t,i)):this.Yn.removeEntry(n)}),$s.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class zh{constructor(t){this.persistence=t,this.Rs=new Dl(t=>Ca(t),Ea),this.lastRemoteSnapshotVersion=xs.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Fh,this.targetCount=0,this.vs=ph.Pn()}forEachTarget(t,e){return this.Rs.forEach((t,n)=>e(n)),$s.resolve()}getLastRemoteSnapshotVersion(t){return $s.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return $s.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),$s.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.bs&&(this.bs=e),$s.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new ph(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,$s.resolve()}updateTargetData(t,e){return this.Dn(e),$s.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,$s.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Rs.forEach((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Rs.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)}),$s.waitFor(r).next(()=>i)}getTargetCount(t){return $s.resolve(this.targetCount)}getTargetData(t,e){const n=this.Rs.get(e)||null;return $s.resolve(n)}addMatchingKeys(t,e,n){return this.Ps.us(e,n),$s.resolve()}removeMatchingKeys(t,e,n){this.Ps.hs(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach(e=>{r.push(i.markPotentiallyOrphaned(t,e))}),$s.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),$s.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Ps.ds(e);return $s.resolve(n)}containsKey(t,e){return $s.resolve(this.Ps.containsKey(e))}}class Bh{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new ro(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new zh(this),this.indexManager=new Kc,this.remoteDocumentCache=new jh(t=>this.referenceDelegate.xs(t)),this.yt=new dc(e),this.Ns=new Lh(this.yt)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Mh,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Vs[t.toKey()];return n||(n=new Uh(e,this.referenceDelegate),this.Vs[t.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,n){is("MemoryPersistence","Starting transaction:",t);const i=new Zh(this.Ss.next());return this.referenceDelegate.ks(),n(i).next(t=>this.referenceDelegate.Os(i).next(()=>t)).toPromise().then(t=>(i.raiseOnCommittedEvent(),t))}Ms(t,e){return $s.or(Object.values(this.Vs).map(n=>()=>n.containsKey(t,e)))}}class Zh extends Bs{constructor(t){super(),this.currentSequenceNumber=t}}class Hh{constructor(t){this.persistence=t,this.Fs=new Fh,this.$s=null}static Bs(t){return new Hh(t)}get Ls(){if(this.$s)return this.$s;throw as()}addReference(t,e,n){return this.Fs.addReference(n,e),this.Ls.delete(n.toString()),$s.resolve()}removeReference(t,e,n){return this.Fs.removeReference(n,e),this.Ls.add(n.toString()),$s.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),$s.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(t=>this.Ls.add(t.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(t=>{t.forEach(t=>this.Ls.add(t.toString()))}).next(()=>n.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $s.forEach(this.Ls,n=>{const i=Ds.fromPath(n);return this.qs(t,i).next(t=>{t||e.removeEntry(i,xs.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.qs(t,e).next(t=>{t?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}qs(t,e){return $s.or([()=>$s.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class $h{constructor(t){this.yt=t}$(t,e,n,i){const r=new Ws("createOrUpgrade",e);var s;n<1&&i>=1&&(t.createObjectStore("owner"),(s=t).createObjectStore("mutationQueues",{keyPath:"userId"}),s.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Fu,{unique:!0}),s.createObjectStore("documentMutations"),Wh(t),function(t){t.createObjectStore("remoteDocuments")}(t));let o=$s.resolve();return n<3&&i>=3&&(0!==n&&(function(t){t.deleteObjectStore("targetDocuments"),t.deleteObjectStore("targets"),t.deleteObjectStore("targetGlobal")}(t),Wh(t)),o=o.next(()=>function(t){const e=t.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:xs.min().toTimestamp(),targetCount:0};return e.put("targetGlobalKey",n)}(r))),n<4&&i>=4&&(0!==n&&(o=o.next(()=>function(t,e){return e.store("mutations").W().next(n=>{t.deleteObjectStore("mutations"),t.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Fu,{unique:!0});const i=e.store("mutations"),r=n.map(t=>i.put(t));return $s.waitFor(r)})}(t,r))),o=o.next(()=>{!function(t){t.createObjectStore("clientMetadata",{keyPath:"clientId"})}(t)})),n<5&&i>=5&&(o=o.next(()=>this.Us(r))),n<6&&i>=6&&(o=o.next(()=>(function(t){t.createObjectStore("remoteDocumentGlobal")}(t),this.Ks(r)))),n<7&&i>=7&&(o=o.next(()=>this.Gs(r))),n<8&&i>=8&&(o=o.next(()=>this.Qs(t,r))),n<9&&i>=9&&(o=o.next(()=>{!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t)})),n<10&&i>=10&&(o=o.next(()=>this.js(r))),n<11&&i>=11&&(o=o.next(()=>{(function(t){t.createObjectStore("bundles",{keyPath:"bundleId"})})(t),function(t){t.createObjectStore("namedQueries",{keyPath:"name"})}(t)})),n<12&&i>=12&&(o=o.next(()=>{!function(t){const e=t.createObjectStore("documentOverlays",{keyPath:Ju});e.createIndex("collectionPathOverlayIndex",Xu,{unique:!1}),e.createIndex("collectionGroupOverlayIndex",tc,{unique:!1})}(t)})),n<13&&i>=13&&(o=o.next(()=>function(t){const e=t.createObjectStore("remoteDocumentsV14",{keyPath:qu});e.createIndex("documentKeyIndex",zu),e.createIndex("collectionGroupIndex",Bu)}(t)).next(()=>this.Ws(t,r)).next(()=>t.deleteObjectStore("remoteDocuments"))),n<14&&i>=14&&(o=o.next(()=>this.zs(t,r))),n<15&&i>=15&&(o=o.next(()=>function(t){t.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),t.createObjectStore("indexState",{keyPath:Gu}).createIndex("sequenceNumberIndex",Ku,{unique:!1}),t.createObjectStore("indexEntries",{keyPath:Qu}).createIndex("documentKeyIndex",Yu,{unique:!1})}(t))),o}Ks(t){let e=0;return t.store("remoteDocuments").Z((t,n)=>{e+=ah(n)}).next(()=>{const n={byteSize:e};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Us(t){const e=t.store("mutationQueues"),n=t.store("mutations");return e.W().next(e=>$s.forEach(e,e=>{const i=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return n.W("userMutationsIndex",i).next(n=>$s.forEach(n,n=>{ls(n.userId===e.userId);const i=yc(this.yt,n);return oh(t,e.userId,i).next(()=>{})}))}))}Gs(t){const e=t.store("targetDocuments"),n=t.store("remoteDocuments");return t.store("targetGlobal").get("targetGlobalKey").next(t=>{const i=[];return n.Z((n,r)=>{const s=new As(n),o=[0,Ou(s)];i.push(e.get(o).next(n=>n?$s.resolve():e.put({targetId:0,path:Ou(s),sequenceNumber:t.highestListenSequenceNumber})))}).next(()=>$s.waitFor(i))})}Qs(t,e){t.createObjectStore("collectionParents",{keyPath:Wu});const n=e.store("collectionParents"),i=new Qc,r=t=>{if(i.add(t)){const e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Ou(i)})}};return e.store("remoteDocuments").Z({X:!0},(t,e)=>{const n=new As(t);return r(n.popLast())}).next(()=>e.store("documentMutations").Z({X:!0},([t,e,n],i)=>{const s=Mu(e);return r(s.popLast())}))}js(t){const e=t.store("targets");return e.Z((t,n)=>{const i=_c(n),r=vc(this.yt,i);return e.put(r)})}Ws(t,e){const n=e.store("remoteDocuments"),i=[];return n.Z((t,n)=>{const r=e.store("remoteDocumentsV14"),s=(o=n,o.document?new Ds(As.fromString(o.document.name).popFirst(5)):o.noDocument?Ds.fromSegments(o.noDocument.path):o.unknownDocument?Ds.fromSegments(o.unknownDocument.path):as()).path.toArray();var o;const a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};i.push(r.put(a))}).next(()=>$s.waitFor(i))}zs(t,e){const n=e.store("mutations"),i=Eh(this.yt),r=new Bh(Hh.Bs,this.yt.ie);return n.W().next(t=>{const n=new Map;return t.forEach(t=>{var e;let i=null!==(e=n.get(t.userId))&&void 0!==e?e:Bl();yc(this.yt,t).keys().forEach(t=>i=i.add(t)),n.set(t.userId,i)}),$s.forEach(n,(t,n)=>{const s=new Xr(n),o=xc.re(this.yt,s),a=r.getIndexManager(s),l=lh.re(s,this.yt,a,r.referenceDelegate);return new Rh(i,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new oc(e,ro.at),t).next()})})}}function Wh(t){t.createObjectStore("targetDocuments",{keyPath:Hu}).createIndex("documentTargetsIndex",$u,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Zu,{unique:!0}),t.createObjectStore("targetGlobal")}const Gh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Kh{constructor(t,e,n,i,r,s,o,a,l,u,c=15){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Hs=r,this.window=s,this.document=o,this.Js=l,this.Ys=u,this.Xs=c,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=t=>Promise.resolve(),!Kh.C())throw new hs(cs.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Th(this,i),this.ii=e+"main",this.yt=new dc(a),this.ri=new Gs(this.ii,this.Xs,new $h(this.yt)),this.Cs=new fh(this.referenceDelegate,this.yt),this.remoteDocumentCache=Eh(this.yt),this.Ns=new Sc,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===u&&rs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new hs(cs.FAILED_PRECONDITION,Gh);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Cs.getHighestSequenceNumber(t))}).then(t=>{this.Ss=new ro(t,this.Js)}).then(()=>{this.Ds=!0}).catch(t=>(this.ri&&this.ri.close(),Promise.reject(t)))}li(t){var e=this;return this.si=function(){var n=(0,Gt.Z)(function*(n){if(e.started)return t(n)});return function(t){return n.apply(this,arguments)}}(),t(this.isPrimary)}setDatabaseDeletedListener(t){this.ri.L(function(){var e=(0,Gt.Z)(function*(e){null===e.newVersion&&(yield t())});return function(t){return e.apply(this,arguments)}}())}setNetworkEnabled(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Hs.enqueueAndForget((0,Gt.Z)(function*(){e.started&&(yield e.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>Yh(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(t).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(t)).next(e=>this.isPrimary&&!e?this._i(t).next(()=>!1):!!e&&this.wi(t).next(()=>!0))).catch(t=>{if(Ys(t))return is("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return is("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.Hs.enqueueRetryable(()=>this.si(t)),this.isPrimary=t})}fi(t){return Qh(t).get("owner").next(t=>$s.resolve(this.mi(t)))}gi(t){return Yh(t).delete(this.clientId)}yi(){var t=this;return(0,Gt.Z)(function*(){if(t.isPrimary&&!t.pi(t.ni,18e5)){t.ni=Date.now();const e=yield t.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const n=ac(e,"clientMetadata");return n.W().next(e=>{const i=t.Ii(e,18e5),r=e.filter(t=>-1===i.indexOf(t));return $s.forEach(r,t=>n.delete(t.clientId)).next(()=>r)})}).catch(()=>[]);if(t.oi)for(const n of e)t.oi.removeItem(t.Ti(n.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(t){return!!t&&t.ownerId===this.clientId}di(t){return this.Ys?$s.resolve(!0):Qh(t).get("owner").next(e=>{if(null!==e&&this.pi(e.leaseTimestampMs,5e3)&&!this.Ei(e.ownerId)){if(this.mi(e)&&this.networkEnabled)return!0;if(!this.mi(e)){if(!e.allowTabSynchronization)throw new hs(cs.FAILED_PRECONDITION,Gh);return!1}}return!(!this.networkEnabled||!this.inForeground)||Yh(t).W().next(t=>void 0===this.Ii(t,5e3).find(t=>{if(this.clientId!==t.clientId){const e=!this.inForeground&&t.inForeground,n=this.networkEnabled===t.networkEnabled;if(!this.networkEnabled&&t.networkEnabled||e&&n)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&is("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var t=this;return(0,Gt.Z)(function*(){t.Ds=!1,t.Ai(),t.ei&&(t.ei.cancel(),t.ei=null),t.Ri(),t.bi(),yield t.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new oc(e,ro.at);return t._i(n).next(()=>t.gi(n))}),t.ri.close(),t.Pi()})()}Ii(t,e){return t.filter(t=>this.pi(t.updateTimeMs,e)&&!this.Ei(t.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",t=>Yh(t).W().next(t=>this.Ii(t,18e5).map(t=>t.clientId)))}get started(){return this.Ds}getMutationQueue(t,e){return lh.re(t,this.yt,e,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new Jc(t,this.yt.ie.databaseId)}getDocumentOverlayCache(t){return xc.re(this.yt,t)}getBundleCache(){return this.Ns}runTransaction(t,e,n){is("IndexedDbPersistence","Starting transaction:",t);const i="readonly"===e?"readonly":"readwrite",r=15===(s=this.Xs)?sc:14===s?rc:13===s?ic:12===s?nc:11===s?ec:void as();var s;let o;return this.ri.runTransaction(t,i,r,i=>(o=new oc(i,this.Ss?this.Ss.next():ro.at),"readwrite-primary"===e?this.fi(o).next(t=>!!t||this.di(o)).next(e=>{if(!e)throw rs(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new hs(cs.FAILED_PRECONDITION,zs);return n(o)}).next(t=>this.wi(o).next(()=>t)):this.Vi(o).next(()=>n(o)))).then(t=>(o.raiseOnCommittedEvent(),t))}Vi(t){return Qh(t).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new hs(cs.FAILED_PRECONDITION,Gh)})}wi(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qh(t).put("owner",e)}static C(){return Gs.C()}_i(t){const e=Qh(t);return e.get("owner").next(t=>this.mi(t)?(is("IndexedDbPersistence","Releasing primary lease."),e.delete("owner")):$s.resolve())}pi(t,e){const n=Date.now();return!(t<n-e||t>n&&(rs(`Detected an update time that is in the future: ${t} > ${n}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var t;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,Jt.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(t){var e;try{const n=null!==(null===(e=this.oi)||void 0===e?void 0:e.getItem(this.Ti(t)));return is("IndexedDbPersistence",`Client '${t}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return rs("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(t){rs("Failed to set zombie client id.",t)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(t){}}Ti(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function Qh(t){return ac(t,"owner")}function Yh(t){return ac(t,"clientMetadata")}function Jh(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class Xh{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Si=n,this.Di=i}static Ci(t,e){let n=Bl(),i=Bl();for(const r of e.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Xh(t,e.fromCache,n,i)}}class td{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,n,i){return this.ki(t,e).next(r=>r||this.Oi(t,e,i,n)).next(n=>n||this.Mi(t,e))}ki(t,e){if(Ra(e))return $s.resolve(null);let n=Ua(e);return this.indexManager.getIndexType(t,n).next(i=>0===i?null:(null!==e.limit&&1===i&&(e=qa(e,null,"F"),n=Ua(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(i=>{const r=Bl(...i);return this.Ni.getDocuments(t,r).next(i=>this.indexManager.getMinOffset(t,n).next(n=>{const s=this.Fi(e,i);return this.$i(e,s,r,n.readTime)?this.ki(t,qa(e,null,"F")):this.Bi(t,s,e,n)}))})))}Oi(t,e,n,i){return Ra(e)||i.isEqual(xs.min())?this.Mi(t,e):this.Ni.getDocuments(t,n).next(r=>{const s=this.Fi(e,r);return this.$i(e,s,n,i)?this.Mi(t,e):(ns()<=Yt.in.DEBUG&&is("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Za(e)),this.Bi(t,s,e,Vs(i,-1)))})}Fi(t,e){let n=new ga(Wa(t));return e.forEach((e,i)=>{Ha(t,i)&&(n=n.add(i))}),n}$i(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Mi(t,e){return ns()<=Yt.in.DEBUG&&is("QueryEngine","Using full collection scan to execute query:",Za(e)),this.Ni.getDocumentsMatchingQuery(t,e,js.min())}Bi(t,e,n,i){return this.Ni.getDocumentsMatchingQuery(t,n,i).next(t=>(e.forEach(e=>{t=t.insert(e.key,e)}),t))}}class ed{constructor(t,e,n,i){this.persistence=t,this.Li=e,this.yt=i,this.qi=new pa(Is),this.Ui=new Dl(t=>Ca(t),Ea),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(n)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Rh(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.qi))}}function nd(t,e,n,i){return new ed(t,e,n,i)}function id(t,e){return rd.apply(this,arguments)}function rd(){return rd=(0,Gt.Z)(function*(t,e){const n=us(t);return yield n.persistence.runTransaction("Handle user change","readonly",t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next(r=>(i=r,n.Qi(e),n.mutationQueue.getAllMutationBatches(t))).next(e=>{const r=[],s=[];let o=Bl();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next(t=>({ji:t,removedBatchIds:r,addedBatchIds:s}))})})}),rd.apply(this,arguments)}function sd(t,e){const n=us(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",t=>{const i=e.batch.keys(),r=n.Gi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=$s.resolve();return s.forEach(t=>{o=o.next(()=>i.getEntry(e,t)).next(e=>{const s=n.docVersions.get(t);ls(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))})}),o.next(()=>t.mutationQueue.removeMutationBatch(e,r))}(n,t,e,r).next(()=>r.apply(t)).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Bl();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e))).next(()=>n.localDocuments.getDocuments(t,i))})}function od(t){const e=us(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function ad(t,e){const n=us(t),i=e.snapshotVersion;let r=n.qi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",t=>{const s=n.Gi.newChangeBuffer({trackRemovals:!0});r=n.qi;const o=[];e.targetChanges.forEach((s,a)=>{const l=r.get(a);if(!l)return;o.push(n.Cs.removeMatchingKeys(t,s.removedDocuments,a).next(()=>n.Cs.addMatchingKeys(t,s.addedDocuments,a)));let u=l.withSequenceNumber(t.currentSequenceNumber);var c,h,d;e.targetMismatches.has(a)?u=u.withResumeToken(fo.EMPTY_BYTE_STRING,xs.min()).withLastLimboFreeSnapshotVersion(xs.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,i)),r=r.insert(a,u),h=u,d=s,(0===(c=l).resumeToken.approximateByteSize()||h.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&o.push(n.Cs.updateTargetData(t,u))});let a=Rl(),l=Bl();if(e.documentUpdates.forEach(i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))}),o.push(ld(t,s,e.documentUpdates).next(t=>{a=t.Wi,l=t.zi})),!i.isEqual(xs.min())){const e=n.Cs.getLastRemoteSnapshotVersion(t).next(e=>n.Cs.setTargetsMetadata(t,t.currentSequenceNumber,i));o.push(e)}return $s.waitFor(o).next(()=>s.apply(t)).next(()=>n.localDocuments.getLocalViewOfDocuments(t,a,l)).next(()=>a)}).then(t=>(n.qi=r,t))}function ld(t,e,n){let i=Bl(),r=Bl();return n.forEach(t=>i=i.add(t)),e.getEntries(t,i).next(t=>{let i=Rl();return n.forEach((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(xs.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):is("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Wi:i,zi:r}})}function ud(t,e){const n=us(t);return n.persistence.runTransaction("Get next mutation batch","readonly",t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e)))}function cd(t,e){const n=us(t);return n.persistence.runTransaction("Allocate target","readwrite",t=>{let i;return n.Cs.getTargetData(t,e).next(r=>r?(i=r,$s.resolve(i)):n.Cs.allocateTargetId(t).next(r=>(i=new hc(e,r,0,t.currentSequenceNumber),n.Cs.addTargetData(t,i).next(()=>i))))}).then(t=>{const i=n.qi.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.qi=n.qi.insert(t.targetId,t),n.Ui.set(e,t.targetId)),t})}function hd(t,e,n){return dd.apply(this,arguments)}function dd(){return dd=(0,Gt.Z)(function*(t,e,n){const i=us(t),r=i.qi.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield i.persistence.runTransaction("Release target",s,t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(o){if(!Ys(o))throw o;is("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.qi=i.qi.remove(e),i.Ui.delete(r.target)}),dd.apply(this,arguments)}function pd(t,e,n){const i=us(t);let r=xs.min(),s=Bl();return i.persistence.runTransaction("Execute query","readonly",t=>function(t,e,n){const i=us(t),r=i.Ui.get(n);return void 0!==r?$s.resolve(i.qi.get(r)):i.Cs.getTargetData(e,n)}(i,t,Ua(e)).next(e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(t,e.targetId).next(t=>{s=t})}).next(()=>i.Li.getDocumentsMatchingQuery(t,e,n?r:xs.min(),n?s:Bl())).next(t=>(gd(i,$a(e),t),{documents:t,Hi:s})))}function fd(t,e){const n=us(t),i=us(n.Cs),r=n.qi.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",t=>i.ne(t,e).next(t=>t?t.target:null))}function md(t,e){const n=us(t),i=n.Ki.get(e)||xs.min();return n.persistence.runTransaction("Get new document changes","readonly",t=>n.Gi.getAllFromCollectionGroup(t,e,Vs(i,-1),Number.MAX_SAFE_INTEGER)).then(t=>(gd(n,e,t),t))}function gd(t,e,n){let i=t.Ki.get(e)||xs.min();n.forEach((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)}),t.Ki.set(e,i)}function yd(){return yd=(0,Gt.Z)(function*(t,e,n,i){const r=us(t);let s=Bl(),o=Rl();for(const c of n){const t=e.Ji(c.metadata.name);c.document&&(s=s.add(t));const n=e.Yi(c);n.setReadTime(e.Xi(c.metadata.readTime)),o=o.insert(t,n)}const a=r.Gi.newChangeBuffer({trackRemovals:!0}),l=yield cd(r,(u=i,Ua(Oa(As.fromString(`__bundle__/docs/${u}`)))));var u;return r.persistence.runTransaction("Apply bundle documents","readwrite",t=>ld(t,a,o).next(e=>(a.apply(t),e)).next(e=>r.Cs.removeMatchingKeysForTargetId(t,l.targetId).next(()=>r.Cs.addMatchingKeys(t,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(t,e.Wi,e.zi)).next(()=>e.Wi)))}),yd.apply(this,arguments)}function _d(t,e){return vd.apply(this,arguments)}function vd(){return vd=(0,Gt.Z)(function*(t,e,n=Bl()){const i=yield cd(t,Ua(wc(e.bundledQuery))),r=us(t);return r.persistence.runTransaction("Save named query","readwrite",t=>{const s=lu(e.readTime);if(i.snapshotVersion.compareTo(s)>=0)return r.Ns.saveNamedQuery(t,e);const o=i.withResumeToken(fo.EMPTY_BYTE_STRING,s);return r.qi=r.qi.insert(o.targetId,o),r.Cs.updateTargetData(t,o).next(()=>r.Cs.removeMatchingKeysForTargetId(t,i.targetId)).next(()=>r.Cs.addMatchingKeys(t,n,i.targetId)).next(()=>r.Ns.saveNamedQuery(t,e))})}),vd.apply(this,arguments)}function wd(t,e){return`firestore_clients_${t}_${e}`}function bd(t,e,n){let i=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function Td(t,e){return`firestore_targets_${t}_${e}`}class Id{constructor(t,e,n,i){this.user=t,this.batchId=e,this.state=n,this.error=i}static Zi(t,e,n){const i=JSON.parse(n);let r,s="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new hs(i.error.code,i.error.message))),s?new Id(t,e,i.state,r):(rs("SharedClientState",`Failed to parse mutation state for ID '${e}': ${n}`),null)}tr(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Sd{constructor(t,e,n){this.targetId=t,this.state=e,this.error=n}static Zi(t,e){const n=JSON.parse(e);let i,r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code,r&&(i=new hs(n.error.code,n.error.message))),r?new Sd(t,n.state,i):(rs("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}tr(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Cd{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Zi(t,e){const n=JSON.parse(e);let i="object"==typeof n&&n.activeTargetIds instanceof Array,r=Hl();for(let s=0;i&&s<n.activeTargetIds.length;++s)i=po(n.activeTargetIds[s]),r=r.add(n.activeTargetIds[s]);return i?new Cd(t,r):(rs("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}}class Ed{constructor(t,e){this.clientId=t,this.onlineState=e}static Zi(t){const e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Ed(e.clientId,e.onlineState):(rs("SharedClientState",`Failed to parse online state: ${t}`),null)}}class xd{constructor(){this.activeTargetIds=Hl()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class kd{constructor(t,e,n,i,r){this.window=t,this.Hs=e,this.persistenceKey=n,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new pa(Is),this.started=!1,this.cr=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=r,this.ar=wd(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new xd),this.lr=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(t){return`firestore_bundle_loaded_v2_${t}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(t){return!(!t||!t.localStorage)}start(){var t=this;return(0,Gt.Z)(function*(){const e=yield t.syncEngine.vi();for(const i of e){if(i===t.sr)continue;const e=t.getItem(wd(t.persistenceKey,i));if(e){const n=Cd.Zi(i,e);n&&(t.ur=t.ur.insert(n.clientId,n))}}t.gr();const n=t.storage.getItem(t.wr);if(n){const e=t.yr(n);e&&t.pr(e)}for(const i of t.cr)t.rr(i);t.cr=[],t.window.addEventListener("pagehide",()=>t.shutdown()),t.started=!0})()}writeSequenceNumber(t){this.setItem(this.hr,JSON.stringify(t))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(t){let e=!1;return this.ur.forEach((n,i)=>{i.activeTargetIds.has(t)&&(e=!0)}),e}addPendingMutation(t){this.Tr(t,"pending")}updateMutationState(t,e,n){this.Tr(t,e,n),this.Er(t)}addLocalQueryTarget(t){let e="not-current";if(this.isActiveQueryTarget(t)){const n=this.storage.getItem(Td(this.persistenceKey,t));if(n){const i=Sd.Zi(t,n);i&&(e=i.state)}}return this.Ar.er(t),this.gr(),e}removeLocalQueryTarget(t){this.Ar.nr(t),this.gr()}isLocalQueryTarget(t){return this.Ar.activeTargetIds.has(t)}clearQueryState(t){this.removeItem(Td(this.persistenceKey,t))}updateQueryState(t,e,n){this.Rr(t,e,n)}handleUserChange(t,e,n){e.forEach(t=>{this.Er(t)}),this.currentUser=t,n.forEach(t=>{this.addPendingMutation(t)})}setOnlineState(t){this.br(t)}notifyBundleLoaded(t){this.Pr(t)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(t){const e=this.storage.getItem(t);return is("SharedClientState","READ",t,e),e}setItem(t,e){is("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){is("SharedClientState","REMOVE",t),this.storage.removeItem(t)}rr(t){var e=this;const n=t;if(n.storageArea===this.storage){if(is("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ar)return void rs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,Gt.Z)(function*(){if(e.started){if(null!==n.key)if(e.lr.test(n.key)){if(null==n.newValue){const t=e.vr(n.key);return e.Vr(t,null)}{const t=e.Sr(n.key,n.newValue);if(t)return e.Vr(t.clientId,t)}}else if(e.dr.test(n.key)){if(null!==n.newValue){const t=e.Dr(n.key,n.newValue);if(t)return e.Cr(t)}}else if(e._r.test(n.key)){if(null!==n.newValue){const t=e.Nr(n.key,n.newValue);if(t)return e.kr(t)}}else if(n.key===e.wr){if(null!==n.newValue){const t=e.yr(n.newValue);if(t)return e.pr(t)}}else if(n.key===e.hr){const t=function(t){let e=ro.at;if(null!=t)try{const n=JSON.parse(t);ls("number"==typeof n),e=n}catch(n){rs("SharedClientState","Failed to read sequence number from WebStorage",n)}return e}(n.newValue);t!==ro.at&&e.sequenceNumberHandler(t)}else if(n.key===e.mr){const t=e.Or(n.newValue);yield Promise.all(t.map(t=>e.syncEngine.Mr(t)))}}else e.cr.push(n)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(t,e,n){const i=new Id(this.currentUser,t,e,n),r=bd(this.persistenceKey,this.currentUser,t);this.setItem(r,i.tr())}Er(t){const e=bd(this.persistenceKey,this.currentUser,t);this.removeItem(e)}br(t){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:t}))}Rr(t,e,n){const i=Td(this.persistenceKey,t),r=new Sd(t,e,n);this.setItem(i,r.tr())}Pr(t){const e=JSON.stringify(Array.from(t));this.setItem(this.mr,e)}vr(t){const e=this.lr.exec(t);return e?e[1]:null}Sr(t,e){const n=this.vr(t);return Cd.Zi(n,e)}Dr(t,e){const n=this.dr.exec(t),i=Number(n[1]);return Id.Zi(new Xr(void 0!==n[2]?n[2]:null),i,e)}Nr(t,e){const n=this._r.exec(t),i=Number(n[1]);return Sd.Zi(i,e)}yr(t){return Ed.Zi(t)}Or(t){return JSON.parse(t)}Cr(t){var e=this;return(0,Gt.Z)(function*(){if(t.user.uid===e.currentUser.uid)return e.syncEngine.Fr(t.batchId,t.state,t.error);is("SharedClientState",`Ignoring mutation for non-active user ${t.user.uid}`)})()}kr(t){return this.syncEngine.$r(t.targetId,t.state,t.error)}Vr(t,e){const n=e?this.ur.insert(t,e):this.ur.remove(t),i=this.Ir(this.ur),r=this.Ir(n),s=[],o=[];return r.forEach(t=>{i.has(t)||s.push(t)}),i.forEach(t=>{r.has(t)||o.push(t)}),this.syncEngine.Br(s,o).then(()=>{this.ur=n})}pr(t){this.ur.get(t.clientId)&&this.onlineStateHandler(t.onlineState)}Ir(t){let e=Hl();return t.forEach((t,n)=>{e=e.unionWith(n.activeTargetIds)}),e}}class Ad{constructor(){this.Lr=new xd,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Lr.er(t),this.qr[t]||"not-current"}updateQueryState(t,e,n){this.qr[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.qr[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new xd,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Pd{Ur(t){}shutdown(){}}class Nd{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}Ur(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){is("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){is("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Dd={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Od{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class Rd extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,n,i,r){const s=this.ho(t,e);is("RestConnection","Sending: ",s,n);const o={};return this.lo(o,i,r),this.fo(t,s,o,n).then(t=>(is("RestConnection","Received: ",t),t),e=>{throw ss("RestConnection",`${t} failed with error: `,e,"url: ",s,"request:",n),e})}_o(t,e,n,i,r,s){return this.ao(t,e,n,i,r)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ts,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,n)=>t[n]=e),n&&n.headers.forEach((e,n)=>t[n]=e)}ho(t,e){return`${this.oo}/v1/${e}:${Dd[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,i){return new Promise((r,s)=>{const o=new Yr;o.setWithCredentials(!0),o.listenOnce($r.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case Hr.NO_ERROR:const e=o.getResponseJson();is("Connection","XHR received:",JSON.stringify(e)),r(e);break;case Hr.TIMEOUT:is("Connection",'RPC "'+t+'" timed out'),s(new hs(cs.DEADLINE_EXCEEDED,"Request time out"));break;case Hr.HTTP_ERROR:const n=o.getStatus();if(is("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(cs).indexOf(e)>=0?e:cs.UNKNOWN}(e.status);s(new hs(t,e.message))}else s(new hs(cs.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new hs(cs.UNAVAILABLE,"Connection failed."));break;default:as()}}finally{is("Connection",'RPC "'+t+'" completed.')}});const a=JSON.stringify(i);o.send(e,"POST",a,n,15)})}wo(t,e,n){const i=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Br(),s=Zr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Kr({})),this.lo(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const a=i.join("");is("Connection","Creating WebChannel: "+a,o);const l=r.createWebChannel(a,o);let u=!1,c=!1;const h=new Od({Hr:t=>{c?is("Connection","Not sending because WebChannel is closed:",t):(u||(is("Connection","Opening WebChannel transport."),l.open(),u=!0),is("Connection","WebChannel sending:",t),l.send(t))},Jr:()=>l.close()}),d=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(e){setTimeout(()=>{throw e},0)}})};return d(l,Qr.EventType.OPEN,()=>{c||is("Connection","WebChannel transport opened.")}),d(l,Qr.EventType.CLOSE,()=>{c||(c=!0,is("Connection","WebChannel transport closed"),h.io())}),d(l,Qr.EventType.ERROR,t=>{c||(c=!0,ss("Connection","WebChannel transport errored:",t),h.io(new hs(cs.UNAVAILABLE,"The operation could not be completed")))}),d(l,Qr.EventType.MESSAGE,t=>{var e;if(!c){const n=t.data[0];ls(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){is("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=kl[t];if(void 0!==e)return Nl(e)}(t),n=r.message;void 0===e&&(e=cs.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),c=!0,h.io(new hs(e,n)),l.close()}else is("Connection","WebChannel received:",n),h.ro(n)}}),d(s,Wr.STAT_EVENT,t=>{t.stat===Gr.PROXY?is("Connection","Detected buffering proxy"):t.stat===Gr.NOPROXY&&is("Connection","Detected no buffering proxy")}),setTimeout(()=>{h.so()},0),h}}function Ld(){return"undefined"!=typeof window?window:null}function Md(){return"undefined"!=typeof document?document:null}function Fd(t){return new ru(t,!0)}class Vd{constructor(t,e,n=1e3,i=1.5,r=6e4){this.Hs=t,this.timerId=e,this.mo=n,this.yo=i,this.po=r,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),i=Math.max(0,e-n);i>0&&is("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Ud{constructor(t,e,n,i,r,s,o,a){this.Hs=t,this.vo=n,this.Vo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Vd(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return(0,Gt.Z)(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return(0,Gt.Z)(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}qo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var n=this;return(0,Gt.Z)(function*(){n.Lo(),n.qo(),n.xo.cancel(),n.So++,4!==t?n.xo.reset():e&&e.code===cs.RESOURCE_EXHAUSTED?(rs(e.toString()),rs("Using maximum backoff delay to prevent overloading the backend."),n.xo.Ao()):e&&e.code===cs.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Uo(),n.stream.close(),n.stream=null),n.state=t,yield n.listener.Zr(e)})()}Uo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([t,n])=>{this.So===e&&this.Go(t,n)},e=>{t(()=>{const t=new hs(cs.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Qo(t)})})}Go(t,e){const n=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{n(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(t=>{n(()=>this.Qo(t))}),this.stream.onMessage(t=>{n(()=>this.onMessage(t))})}Oo(){var t=this;this.state=5,this.xo.Ro((0,Gt.Z)(function*(){t.state=0,t.start()}))}Qo(t){return is("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(is("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class jd extends Ud{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.yt=r}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:as(),s=e.targetChange.targetIds||[],o=function(t,e){return t.wt?(ls(void 0===e||"string"==typeof e),fo.fromBase64String(e||"")):(ls(void 0===e||e instanceof Uint8Array),fo.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(t){const e=void 0===t.code?cs.UNKNOWN:Nl(t.code);return new hs(e,t.message||"")}(a);n=new Ql(r,s,o,l||null)}else if("documentChange"in e){const i=e.documentChange,r=du(t,i.document.name),s=lu(i.document.updateTime),o=i.document.createTime?lu(i.document.createTime):xs.min(),a=new wa({mapValue:{fields:i.document.fields}}),l=Ta.newFoundDocument(r,s,o,a);n=new Gl(i.targetIds||[],i.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){const i=e.documentDelete,r=du(t,i.document),s=i.readTime?lu(i.readTime):xs.min(),o=Ta.newNoDocument(r,s);n=new Gl([],i.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const i=e.documentRemove,r=du(t,i.document);n=new Gl([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return as();{const t=e.filter,i=new xl(t.count||0);n=new Kl(t.targetId,i)}}var i;return n}(this.yt,t),n=function(t){if(!("targetChange"in t))return xs.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?xs.min():e.readTime?lu(e.readTime):xs.min()}(t);return this.listener.Wo(e,n)}zo(t){const e={};e.database=mu(this.yt),e.addTarget=function(t,e){let n;const i=e.target;return n=xa(i)?{documents:bu(t,i)}:{query:Tu(t,i)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=ou(t,e.resumeToken):e.snapshotVersion.compareTo(xs.min())>0&&(n.readTime=su(t,e.snapshotVersion.toTimestamp())),n}(this.yt,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return as()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.Bo(e)}Ho(t){const e={};e.database=mu(this.yt),e.removeTarget=t,this.Bo(e)}}class qd extends Ud{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.yt=r,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}Uo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(ls(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function(t,e){return t&&t.length>0?(ls(void 0!==e),t.map(t=>function(t,e){let n=lu(t.updateTime?t.updateTime:e);return n.isEqual(xs.min())&&(n=lu(e)),new hl(n,t.transformResults||[])}(t,e))):[]}(t.writeResults,t.commitTime),n=lu(t.commitTime);return this.listener.Zo(n,e)}return ls(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=mu(this.yt),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(t=>vu(this.yt,t))};this.Bo(e)}}class zd extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.yt=i,this.nu=!1}su(){if(this.nu)throw new hs(cs.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,r])=>this.connection.ao(t,e,n,i,r)).catch(t=>{throw"FirebaseError"===t.name?(t.code===cs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new hs(cs.UNKNOWN,t.toString())})}_o(t,e,n,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection._o(t,e,n,r,s,i)).catch(t=>{throw"FirebaseError"===t.name?(t.code===cs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new hs(cs.UNKNOWN,t.toString())})}terminate(){this.nu=!0}}class Bd{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(rs(e),this.ou=!1):is("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class Zd{constructor(t,e,n,i,r){var s=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=r,this.mu.Ur(t=>{n.enqueueAndForget((0,Gt.Z)(function*(){var t;ep(s)&&(is("RemoteStore","Restarting streams for network reachability change."),yield(t=(0,Gt.Z)(function*(t){const e=us(t);e._u.add(4),yield Wd(e),e.gu.set("Unknown"),e._u.delete(4),yield Hd(e)}),function(e){return t.apply(this,arguments)})(s))}))}),this.gu=new Bd(n,i)}}function Hd(t){return $d.apply(this,arguments)}function $d(){return $d=(0,Gt.Z)(function*(t){if(ep(t))for(const e of t.wu)yield e(!0)}),$d.apply(this,arguments)}function Wd(t){return Gd.apply(this,arguments)}function Gd(){return Gd=(0,Gt.Z)(function*(t){for(const e of t.wu)yield e(!1)}),Gd.apply(this,arguments)}function Kd(t,e){const n=us(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),tp(n)?Xd(n):Pp(n).ko()&&Yd(n,e))}function Qd(t,e){const n=us(t),i=Pp(n);n.du.delete(e),i.ko()&&Jd(n,e),0===n.du.size&&(i.ko()?i.Fo():ep(n)&&n.gu.set("Unknown"))}function Yd(t,e){t.yu.Ot(e.targetId),Pp(t).zo(e)}function Jd(t,e){t.yu.Ot(e),Pp(t).Ho(e)}function Xd(t){t.yu=new Jl({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>t.du.get(e)||null}),Pp(t).start(),t.gu.uu()}function tp(t){return ep(t)&&!Pp(t).No()&&t.du.size>0}function ep(t){return 0===us(t)._u.size}function np(t){t.yu=void 0}function ip(t){return rp.apply(this,arguments)}function rp(){return rp=(0,Gt.Z)(function*(t){t.du.forEach((e,n)=>{Yd(t,e)})}),rp.apply(this,arguments)}function sp(t,e){return op.apply(this,arguments)}function op(){return op=(0,Gt.Z)(function*(t,e){np(t),tp(t)?(t.gu.hu(e),Xd(t)):t.gu.set("Unknown")}),op.apply(this,arguments)}function ap(t,e,n){return lp.apply(this,arguments)}function lp(){return lp=(0,Gt.Z)(function*(t,e,n){if(t.gu.set("Online"),e instanceof Ql&&2===e.state&&e.cause)try{yield(i=(0,Gt.Z)(function*(t,e){const n=e.cause;for(const i of e.targetIds)t.du.has(i)&&(yield t.remoteSyncer.rejectListen(i,n),t.du.delete(i),t.yu.removeTarget(i))}),function(t,e){return i.apply(this,arguments)})(t,e)}catch(i){is("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield up(t,i)}else if(e instanceof Gl?t.yu.Kt(e):e instanceof Kl?t.yu.Jt(e):t.yu.jt(e),!n.isEqual(xs.min()))try{const e=yield od(t.localStore);n.compareTo(e)>=0&&(yield function(t,e){const n=t.yu.Zt(e);return n.targetChanges.forEach((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.du.get(i);r&&t.du.set(i,r.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(e=>{const n=t.du.get(e);if(!n)return;t.du.set(e,n.withResumeToken(fo.EMPTY_BYTE_STRING,n.snapshotVersion)),Jd(t,e);const i=new hc(n.target,e,1,n.sequenceNumber);Yd(t,i)}),t.remoteSyncer.applyRemoteEvent(n)}(t,n))}catch(i){is("RemoteStore","Failed to raise snapshot:",i),yield up(t,i)}var i}),lp.apply(this,arguments)}function up(t,e,n){return cp.apply(this,arguments)}function cp(){return cp=(0,Gt.Z)(function*(t,e,n){if(!Ys(e))throw e;t._u.add(1),yield Wd(t),t.gu.set("Offline"),n||(n=()=>od(t.localStore)),t.asyncQueue.enqueueRetryable((0,Gt.Z)(function*(){is("RemoteStore","Retrying IndexedDB access"),yield n(),t._u.delete(1),yield Hd(t)}))}),cp.apply(this,arguments)}function hp(t,e){return e().catch(n=>up(t,n,e))}function dp(t){return pp.apply(this,arguments)}function pp(){return pp=(0,Gt.Z)(function*(t){const e=us(t),n=Np(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;fp(e);)try{const t=yield ud(e.localStore,i);if(null===t){0===e.fu.length&&n.Fo();break}i=t.batchId,mp(e,t)}catch(r){yield up(e,r)}gp(e)&&yp(e)}),pp.apply(this,arguments)}function fp(t){return ep(t)&&t.fu.length<10}function mp(t,e){t.fu.push(e);const n=Np(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function gp(t){return ep(t)&&!Np(t).No()&&t.fu.length>0}function yp(t){Np(t).start()}function _p(t){return vp.apply(this,arguments)}function vp(){return vp=(0,Gt.Z)(function*(t){Np(t).eu()}),vp.apply(this,arguments)}function wp(t){return bp.apply(this,arguments)}function bp(){return bp=(0,Gt.Z)(function*(t){const e=Np(t);for(const n of t.fu)e.Xo(n.mutations)}),bp.apply(this,arguments)}function Tp(t,e,n){return Ip.apply(this,arguments)}function Ip(){return Ip=(0,Gt.Z)(function*(t,e,n){const i=t.fu.shift(),r=uc.from(i,e,n);yield hp(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),yield dp(t)}),Ip.apply(this,arguments)}function Sp(t,e){return Cp.apply(this,arguments)}function Cp(){return Cp=(0,Gt.Z)(function*(t,e){var n;e&&Np(t).Yo&&(yield(n=(0,Gt.Z)(function*(t,e){if(Pl(n=e.code)&&n!==cs.ABORTED){const n=t.fu.shift();Np(t).Mo(),yield hp(t,()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e)),yield dp(t)}var n}),function(t,e){return n.apply(this,arguments)})(t,e)),gp(t)&&yp(t)}),Cp.apply(this,arguments)}function Ep(t,e){return xp.apply(this,arguments)}function xp(){return xp=(0,Gt.Z)(function*(t,e){const n=us(t);n.asyncQueue.verifyOperationInProgress(),is("RemoteStore","RemoteStore received new credentials");const i=ep(n);n._u.add(3),yield Wd(n),i&&n.gu.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),yield Hd(n)}),xp.apply(this,arguments)}function kp(t,e){return Ap.apply(this,arguments)}function Ap(){return Ap=(0,Gt.Z)(function*(t,e){const n=us(t);e?(n._u.delete(2),yield Hd(n)):e||(n._u.add(2),yield Wd(n),n.gu.set("Unknown"))}),Ap.apply(this,arguments)}function Pp(t){return t.pu||(t.pu=function(t,e,n){const i=us(t);return i.su(),new jd(e,i.connection,i.authCredentials,i.appCheckCredentials,i.yt,n)}(t.datastore,t.asyncQueue,{Yr:ip.bind(null,t),Zr:sp.bind(null,t),Wo:ap.bind(null,t)}),t.wu.push(function(){var e=(0,Gt.Z)(function*(e){e?(t.pu.Mo(),tp(t)?Xd(t):t.gu.set("Unknown")):(yield t.pu.stop(),np(t))});return function(t){return e.apply(this,arguments)}}())),t.pu}function Np(t){return t.Iu||(t.Iu=function(t,e,n){const i=us(t);return i.su(),new qd(e,i.connection,i.authCredentials,i.appCheckCredentials,i.yt,n)}(t.datastore,t.asyncQueue,{Yr:_p.bind(null,t),Zr:Sp.bind(null,t),tu:wp.bind(null,t),Zo:Tp.bind(null,t)}),t.wu.push(function(){var e=(0,Gt.Z)(function*(e){e?(t.Iu.Mo(),yield dp(t)):(yield t.Iu.stop(),t.fu.length>0&&(is("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))});return function(t){return e.apply(this,arguments)}}())),t.Iu}class Dp{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new ds,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(t=>{})}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new Dp(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new hs(cs.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Op(t,e){if(rs("AsyncQueue",`${e}: ${t}`),Ys(t))return new hs(cs.UNAVAILABLE,`${e}: ${t}`);throw t}class Rp{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Ds.comparator(e.key,n.key):(t,e)=>Ds.comparator(t.key,e.key),this.keyedMap=Ml(),this.sortedSet=new pa(this.comparator)}static emptySet(t){return new Rp(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Rp)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Rp;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Lp{constructor(){this.Tu=new pa(Ds.comparator)}track(t){const e=t.doc.key,n=this.Tu.get(e);n?0!==t.type&&3===n.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==n.type?this.Tu=this.Tu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Tu=this.Tu.remove(e):1===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):as():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,n)=>{t.push(n)}),t}}class Mp{constructor(t,e,n,i,r,s,o,a,l){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach(t=>{s.push({type:0,doc:t})}),new Mp(t,e,Rp.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&za(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}class Fp{constructor(){this.Au=void 0,this.listeners=[]}}class Vp{constructor(){this.queries=new Dl(t=>Ba(t),za),this.onlineState="Unknown",this.Ru=new Set}}function Up(t,e){return jp.apply(this,arguments)}function jp(){return jp=(0,Gt.Z)(function*(t,e){const n=us(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Fp),r)try{s.Au=yield n.onListen(i)}catch(o){const t=Op(o,`Initialization of query '${Za(e.query)}' failed`);return void e.onError(t)}n.queries.set(i,s),s.listeners.push(e),e.bu(n.onlineState),s.Au&&e.Pu(s.Au)&&Hp(n)}),jp.apply(this,arguments)}function qp(t,e){return zp.apply(this,arguments)}function zp(){return zp=(0,Gt.Z)(function*(t,e){const n=us(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}),zp.apply(this,arguments)}function Bp(t,e){const n=us(t);let i=!1;for(const r of e){const t=n.queries.get(r.query);if(t){for(const e of t.listeners)e.Pu(r)&&(i=!0);t.Au=r}}i&&Hp(n)}function Zp(t,e,n){const i=us(t),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(n);i.queries.delete(e)}function Hp(t){t.Ru.forEach(t=>{t.next()})}class $p{constructor(t,e,n){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Mp(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=Mp.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class Wp{constructor(t,e){this.ku=t,this.byteLength=e}Ou(){return"metadata"in this.ku}}class Gp{constructor(t){this.yt=t}Ji(t){return du(this.yt,t)}Yi(t){return t.metadata.exists?_u(this.yt,t.document,!1):Ta.newNoDocument(this.Ji(t.metadata.name),this.Xi(t.metadata.readTime))}Xi(t){return lu(t)}}class Kp{constructor(t,e,n){this.Mu=t,this.localStore=e,this.yt=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Qp(t)}Fu(t){this.progress.bytesLoaded+=t.byteLength;let e=this.progress.documentsLoaded;if(t.ku.namedQuery)this.queries.push(t.ku.namedQuery);else if(t.ku.documentMetadata){this.documents.push({metadata:t.ku.documentMetadata}),t.ku.documentMetadata.exists||++e;const n=As.fromString(t.ku.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else t.ku.document&&(this.documents[this.documents.length-1].document=t.ku.document,++e);return e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null}$u(t){const e=new Map,n=new Gp(this.yt);for(const i of t)if(i.metadata.queries){const t=n.Ji(i.metadata.name);for(const n of i.metadata.queries){const i=(e.get(n)||Bl()).add(t);e.set(n,i)}}return e}complete(){var t=this;return(0,Gt.Z)(function*(){const e=yield function(t,e,n,i){return yd.apply(this,arguments)}(t.localStore,new Gp(t.yt),t.documents,t.Mu.id),n=t.$u(t.documents);for(const i of t.queries)yield _d(t.localStore,i,n.get(i.name));return t.progress.taskState="Success",{progress:t.progress,Bu:t.collectionGroups,Lu:e}})()}}function Qp(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}class Yp{constructor(t){this.key=t}}class Jp{constructor(t){this.key=t}}class Xp{constructor(t,e){this.query=t,this.qu=e,this.Uu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Bl(),this.mutatedKeys=Bl(),this.Gu=Wa(t),this.Qu=new Rp(this.Gu)}get ju(){return this.qu}Wu(t,e){const n=e?e.zu:new Lp,i=e?e.Qu:this.Qu;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((t,e)=>{const u=i.get(t),c=Ha(this.query,e)?e:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let p=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),p=!0):this.Hu(u,c)||(n.track({type:2,doc:c}),p=!0,(a&&this.Gu(c,a)>0||l&&this.Gu(c,l)<0)&&(o=!0)):!u&&c?(n.track({type:0,doc:c}),p=!0):u&&!c&&(n.track({type:1,doc:u}),p=!0,(a||l)&&(o=!0)),p&&(c?(s=s.add(c),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{Qu:s,zu:n,$i:o,mutatedKeys:r}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const i=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const r=t.zu.Eu();r.sort((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return as()}};return n(t)-n(e)}(t.type,e.type)||this.Gu(t.doc,e.doc)),this.Ju(n);const s=e?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.Uu;return this.Uu=o,0!==r.length||a?{snapshot:new Mp(this.query,t.Qu,i,r,t.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:s}:{Xu:s}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Lp,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.qu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(t=>this.qu=this.qu.add(t)),t.modifiedDocuments.forEach(t=>{}),t.removedDocuments.forEach(t=>this.qu=this.qu.delete(t)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=Bl(),this.Qu.forEach(t=>{this.Zu(t.key)&&(this.Ku=this.Ku.add(t.key))});const e=[];return t.forEach(t=>{this.Ku.has(t)||e.push(new Jp(t))}),this.Ku.forEach(n=>{t.has(n)||e.push(new Yp(n))}),e}tc(t){this.qu=t.Hi,this.Ku=Bl();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Mp.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.Uu,this.hasCachedResults)}}class tf{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class ef{constructor(t){this.key=t,this.nc=!1}}class nf{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.sc={},this.ic=new Dl(t=>Ba(t),za),this.rc=new Map,this.oc=new Set,this.uc=new pa(Ds.comparator),this.cc=new Map,this.ac=new Fh,this.hc={},this.lc=new Map,this.fc=ph.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function rf(t,e){return sf.apply(this,arguments)}function sf(){return sf=(0,Gt.Z)(function*(t,e){const n=Gf(t);let i,r;const s=n.ic.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.ec();else{const t=yield cd(n.localStore,Ua(e));n.isPrimaryClient&&Kd(n.remoteStore,t);const s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=yield of(n,e,i,"current"===s,t.resumeToken)}return r}),sf.apply(this,arguments)}function of(t,e,n,i,r){return af.apply(this,arguments)}function af(){return af=(0,Gt.Z)(function*(t,e,n,i,r){t._c=(e,n,i)=>{return(r=(0,Gt.Z)(function*(t,e,n,i){let r=e.view.Wu(n);r.$i&&(r=yield pd(t.localStore,e.query,!1).then(({documents:t})=>e.view.Wu(t,r)));const s=i&&i.targetChanges.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,s);return Cf(t,e.targetId,o.Xu),o.snapshot}),function(t,e,n,i){return r.apply(this,arguments)})(t,e,n,i);var r};const s=yield pd(t.localStore,e,!0),o=new Xp(e,s.Hi),a=o.Wu(s.documents),l=Wl.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),u=o.applyChanges(a,t.isPrimaryClient,l);Cf(t,n,u.Xu);const c=new tf(e,n,o);return t.ic.set(e,c),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),u.snapshot}),af.apply(this,arguments)}function lf(t,e){return uf.apply(this,arguments)}function uf(){return uf=(0,Gt.Z)(function*(t,e){const n=us(t),i=n.ic.get(e),r=n.rc.get(i.targetId);if(r.length>1)return n.rc.set(i.targetId,r.filter(t=>!za(t,e))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||(yield hd(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),Qd(n.remoteStore,i.targetId),If(n,i.targetId)}).catch(Zs))):(If(n,i.targetId),yield hd(n.localStore,i.targetId,!0))}),uf.apply(this,arguments)}function cf(){return cf=(0,Gt.Z)(function*(t,e,n){const i=Kf(t);try{const t=yield function(t,e){const n=us(t),i=Es.now(),r=e.reduce((t,e)=>t.add(e.key),Bl());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",t=>{let a=Rl(),l=Bl();return n.Gi.getEntries(t,r).next(t=>{a=t,a.forEach((t,e)=>{e.isValidDocument()||(l=l.add(t))})}).next(()=>n.localDocuments.getOverlayedDocuments(t,a)).next(r=>{s=r;const o=[];for(const t of e){const e=_l(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new bl(t.key,e,ba(e.value.mapValue),dl.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)}).next(e=>{o=e;const i=e.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)})}).then(()=>({batchId:o.batchId,changes:Fl(s)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.hc[t.currentUser.toKey()];i||(i=new pa(Is)),i=i.insert(e,n),t.hc[t.currentUser.toKey()]=i}(i,t.batchId,n),yield kf(i,t.changes),yield dp(i.remoteStore)}catch(r){const t=Op(r,"Failed to persist write");n.reject(t)}}),cf.apply(this,arguments)}function hf(t,e){return df.apply(this,arguments)}function df(){return df=(0,Gt.Z)(function*(t,e){const n=us(t);try{const t=yield ad(n.localStore,e);e.targetChanges.forEach((t,e)=>{const i=n.cc.get(e);i&&(ls(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.nc=!0:t.modifiedDocuments.size>0?ls(i.nc):t.removedDocuments.size>0&&(ls(i.nc),i.nc=!1))}),yield kf(n,t,e)}catch(i){yield Zs(i)}}),df.apply(this,arguments)}function pf(t,e,n){const i=us(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ic.forEach((n,i)=>{const r=i.view.bu(e);r.snapshot&&t.push(r.snapshot)}),function(t,e){const n=us(t);n.onlineState=e;let i=!1;n.queries.forEach((t,n)=>{for(const r of n.listeners)r.bu(e)&&(i=!0)}),i&&Hp(n)}(i.eventManager,e),t.length&&i.sc.Wo(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function ff(t,e,n){return mf.apply(this,arguments)}function mf(){return mf=(0,Gt.Z)(function*(t,e,n){const i=us(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.cc.get(e),s=r&&r.key;if(s){let t=new pa(Ds.comparator);t=t.insert(s,Ta.newNoDocument(s,xs.min()));const n=Bl().add(s),r=new $l(xs.min(),new Map,new ga(Is),t,n);yield hf(i,r),i.uc=i.uc.remove(s),i.cc.delete(e),xf(i)}else yield hd(i.localStore,e,!1).then(()=>If(i,e,n)).catch(Zs)}),mf.apply(this,arguments)}function gf(t,e){return yf.apply(this,arguments)}function yf(){return yf=(0,Gt.Z)(function*(t,e){const n=us(t),i=e.batch.batchId;try{const t=yield sd(n.localStore,e);Tf(n,i,null),bf(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),yield kf(n,t)}catch(r){yield Zs(r)}}),yf.apply(this,arguments)}function _f(t,e,n){return vf.apply(this,arguments)}function vf(){return vf=(0,Gt.Z)(function*(t,e,n){const i=us(t);try{const t=yield function(t,e){const n=us(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next(e=>(ls(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e))).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i)).next(()=>n.localDocuments.getDocuments(t,i))})}(i.localStore,e);Tf(i,e,n),bf(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),yield kf(i,t)}catch(r){yield Zs(r)}}),vf.apply(this,arguments)}function wf(){return wf=(0,Gt.Z)(function*(t,e){const n=us(t);ep(n.remoteStore)||is("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const t=yield function(t){const e=us(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",t=>e.mutationQueue.getHighestUnacknowledgedBatchId(t))}(n.localStore);if(-1===t)return void e.resolve();const i=n.lc.get(t)||[];i.push(e),n.lc.set(t,i)}catch(i){const t=Op(i,"Initialization of waitForPendingWrites() operation failed");e.reject(t)}}),wf.apply(this,arguments)}function bf(t,e){(t.lc.get(e)||[]).forEach(t=>{t.resolve()}),t.lc.delete(e)}function Tf(t,e,n){const i=us(t);let r=i.hc[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.hc[i.currentUser.toKey()]=r}}function If(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.rc.get(e))t.ic.delete(i),n&&t.sc.wc(i,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach(e=>{t.ac.containsKey(e)||Sf(t,e)})}function Sf(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);null!==n&&(Qd(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),xf(t))}function Cf(t,e,n){for(const i of n)i instanceof Yp?(t.ac.addReference(i.key,e),Ef(t,i)):i instanceof Jp?(is("SyncEngine","Document no longer in limbo: "+i.key),t.ac.removeReference(i.key,e),t.ac.containsKey(i.key)||Sf(t,i.key)):as()}function Ef(t,e){const n=e.key,i=n.path.canonicalString();t.uc.get(n)||t.oc.has(i)||(is("SyncEngine","New document in limbo: "+n),t.oc.add(i),xf(t))}function xf(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new Ds(As.fromString(e)),i=t.fc.next();t.cc.set(i,new ef(n)),t.uc=t.uc.insert(n,i),Kd(t.remoteStore,new hc(Ua(Oa(n.path)),i,2,ro.at))}}function kf(t,e,n){return Af.apply(this,arguments)}function Af(){return Af=(0,Gt.Z)(function*(t,e,n){const i=us(t),r=[],s=[],o=[];var a;i.ic.isEmpty()||(i.ic.forEach((t,a)=>{o.push(i._c(a,e,n).then(t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=Xh.Ci(a.targetId,t);s.push(e)}}))}),yield Promise.all(o),i.sc.Wo(r),yield(a=(0,Gt.Z)(function*(t,e){const n=us(t);try{yield n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>$s.forEach(e,e=>$s.forEach(e.Si,i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i)).next(()=>$s.forEach(e.Di,i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))}catch(i){if(!Ys(i))throw i;is("LocalStore","Failed to update sequence numbers: "+i)}for(const r of e){const t=r.targetId;if(!r.fromCache){const e=n.qi.get(t),i=e.withLastLimboFreeSnapshotVersion(e.snapshotVersion);n.qi=n.qi.insert(t,i)}}}),function(t,e){return a.apply(this,arguments)})(i.localStore,s))}),Af.apply(this,arguments)}function Pf(t,e){return Nf.apply(this,arguments)}function Nf(){return Nf=(0,Gt.Z)(function*(t,e){const n=us(t);if(!n.currentUser.isEqual(e)){is("SyncEngine","User change. New user:",e.toKey());const t=yield id(n.localStore,e);n.currentUser=e,(i=n).lc.forEach(t=>{t.forEach(t=>{t.reject(new hs(cs.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.lc.clear(),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),yield kf(n,t.ji)}var i}),Nf.apply(this,arguments)}function Df(t,e){const n=us(t),i=n.cc.get(e);if(i&&i.nc)return Bl().add(i.key);{let t=Bl();const i=n.rc.get(e);if(!i)return t;for(const e of i){const i=n.ic.get(e);t=t.unionWith(i.view.ju)}return t}}function Of(t,e){return Rf.apply(this,arguments)}function Rf(){return Rf=(0,Gt.Z)(function*(t,e){const n=us(t),i=yield pd(n.localStore,e.query,!0),r=e.view.tc(i);return n.isPrimaryClient&&Cf(n,e.targetId,r.Xu),r}),Rf.apply(this,arguments)}function Lf(t,e){return Mf.apply(this,arguments)}function Mf(){return Mf=(0,Gt.Z)(function*(t,e){const n=us(t);return md(n.localStore,e).then(t=>kf(n,t))}),Mf.apply(this,arguments)}function Ff(t,e,n,i){return Vf.apply(this,arguments)}function Vf(){return Vf=(0,Gt.Z)(function*(t,e,n,i){const r=us(t),s=yield function(t,e){const n=us(t),i=us(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",t=>i.Tn(t,e).next(e=>e?n.localDocuments.getDocuments(t,e):$s.resolve(null)))}(r.localStore,e);var o;null!==s?("pending"===n?yield dp(r.remoteStore):"acknowledged"===n||"rejected"===n?(Tf(r,e,i||null),bf(r,e),o=e,us(us(r.localStore).mutationQueue).An(o)):as(),yield kf(r,s)):is("SyncEngine","Cannot apply mutation batch with id: "+e)}),Vf.apply(this,arguments)}function Uf(){return Uf=(0,Gt.Z)(function*(t,e){const n=us(t);if(Gf(n),Kf(n),!0===e&&!0!==n.dc){const t=n.sharedClientState.getAllActiveQueryTargets(),e=yield jf(n,t.toArray());n.dc=!0,yield kp(n.remoteStore,!0);for(const i of e)Kd(n.remoteStore,i)}else if(!1===e&&!1!==n.dc){const t=[];let e=Promise.resolve();n.rc.forEach((i,r)=>{n.sharedClientState.isLocalQueryTarget(r)?t.push(r):e=e.then(()=>(If(n,r),hd(n.localStore,r,!0))),Qd(n.remoteStore,r)}),yield e,yield jf(n,t),function(t){const e=us(t);e.cc.forEach((t,n)=>{Qd(e.remoteStore,n)}),e.ac.fs(),e.cc=new Map,e.uc=new pa(Ds.comparator)}(n),n.dc=!1,yield kp(n.remoteStore,!1)}}),Uf.apply(this,arguments)}function jf(t,e,n){return qf.apply(this,arguments)}function qf(){return qf=(0,Gt.Z)(function*(t,e,n){const i=us(t),r=[],s=[];for(const o of e){let t;const e=i.rc.get(o);if(e&&0!==e.length){t=yield cd(i.localStore,Ua(e[0]));for(const t of e){const e=i.ic.get(t),n=yield Of(i,e);n.snapshot&&s.push(n.snapshot)}}else{const e=yield fd(i.localStore,o);t=yield cd(i.localStore,e),yield of(i,zf(e),o,!1,t.resumeToken)}r.push(t)}return i.sc.Wo(s),r}),qf.apply(this,arguments)}function zf(t){return Da(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Bf(t){const e=us(t);return us(us(e.localStore).persistence).vi()}function Zf(t,e,n,i){return Hf.apply(this,arguments)}function Hf(){return Hf=(0,Gt.Z)(function*(t,e,n,i){const r=us(t);if(r.dc)return void is("SyncEngine","Ignoring unexpected query state notification.");const s=r.rc.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const t=yield md(r.localStore,$a(s[0])),i=$l.createSynthesizedRemoteEventForCurrentChange(e,"current"===n,fo.EMPTY_BYTE_STRING);yield kf(r,t,i);break}case"rejected":yield hd(r.localStore,e,!0),If(r,e,i);break;default:as()}}),Hf.apply(this,arguments)}function $f(t,e,n){return Wf.apply(this,arguments)}function Wf(){return Wf=(0,Gt.Z)(function*(t,e,n){const i=Gf(t);if(i.dc){for(const t of e){if(i.rc.has(t)){is("SyncEngine","Adding an already active target "+t);continue}const e=yield fd(i.localStore,t),n=yield cd(i.localStore,e);yield of(i,zf(e),n.targetId,!1,n.resumeToken),Kd(i.remoteStore,n)}for(const t of n)i.rc.has(t)&&(yield hd(i.localStore,t,!1).then(()=>{Qd(i.remoteStore,t),If(i,t)}).catch(Zs))}}),Wf.apply(this,arguments)}function Gf(t){const e=us(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=hf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Df.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ff.bind(null,e),e.sc.Wo=Bp.bind(null,e.eventManager),e.sc.wc=Zp.bind(null,e.eventManager),e}function Kf(t){const e=us(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_f.bind(null,e),e}class Qf{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return(0,Gt.Z)(function*(){e.yt=Fd(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return nd(this.persistence,new td,t.initialUser,this.yt)}yc(t){return new Bh(Hh.Bs,this.yt)}gc(t){return new Ad}terminate(){var t=this;return(0,Gt.Z)(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class Yf extends Qf{constructor(t,e,n){super(),this.Ac=t,this.cacheSizeBytes=e,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(t){var e=()=>super.initialize,n=this;return(0,Gt.Z)(function*(){yield e().call(n,t),yield n.Ac.initialize(n,t),yield Kf(n.Ac.syncEngine),yield dp(n.Ac.remoteStore),yield n.persistence.li(()=>(n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(),n.indexBackfillerScheduler&&!n.indexBackfillerScheduler.started&&n.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ic(t){return nd(this.persistence,new td,t.initialUser,this.yt)}Tc(t,e){return new wh(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue,e)}Ec(t,e){const n=new io(e,this.persistence);return new no(t.asyncQueue,n)}yc(t){const e=Jh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?sh.withCacheSize(this.cacheSizeBytes):sh.DEFAULT;return new Kh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Ld(),Md(),this.yt,this.sharedClientState,!!this.forceOwnership)}gc(t){return new Ad}}class Jf extends Yf{constructor(t,e){super(t,e,!1),this.Ac=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}initialize(t){var e=()=>super.initialize,n=this;return(0,Gt.Z)(function*(){yield e().call(n,t);const i=n.Ac.syncEngine;n.sharedClientState instanceof kd&&(n.sharedClientState.syncEngine={Fr:Ff.bind(null,i),$r:Zf.bind(null,i),Br:$f.bind(null,i),vi:Bf.bind(null,i),Mr:Lf.bind(null,i)},yield n.sharedClientState.start()),yield n.persistence.li(function(){var t=(0,Gt.Z)(function*(t){yield function(t,e){return Uf.apply(this,arguments)}(n.Ac.syncEngine,t),n.gcScheduler&&(t&&!n.gcScheduler.started?n.gcScheduler.start():t||n.gcScheduler.stop()),n.indexBackfillerScheduler&&(t&&!n.indexBackfillerScheduler.started?n.indexBackfillerScheduler.start():t||n.indexBackfillerScheduler.stop())});return function(e){return t.apply(this,arguments)}}())})()}gc(t){const e=Ld();if(!kd.C(e))throw new hs(cs.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Jh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new kd(e,t.asyncQueue,n,t.clientId,t.initialUser)}}class Xf{initialize(t,e){var n=this;return(0,Gt.Z)(function*(){n.localStore||(n.localStore=t.localStore,n.sharedClientState=t.sharedClientState,n.datastore=n.createDatastore(e),n.remoteStore=n.createRemoteStore(e),n.eventManager=n.createEventManager(e),n.syncEngine=n.createSyncEngine(e,!t.synchronizeTabs),n.sharedClientState.onlineStateHandler=t=>pf(n.syncEngine,t,1),n.remoteStore.remoteSyncer.handleCredentialChange=Pf.bind(null,n.syncEngine),yield kp(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(t){return new Vp}createDatastore(t){const e=Fd(t.databaseInfo.databaseId),n=new Rd(t.databaseInfo);return new zd(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>pf(this.syncEngine,t,0),s=Nd.C()?new Nd:new Pd,new Zd(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new nf(t,e,n,i,r,s);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=(0,Gt.Z)(function*(t){const e=us(t);is("RemoteStore","RemoteStore shutting down."),e._u.add(5),yield Wd(e),e.mu.shutdown(),e.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function tm(t,e,n){if(!n)throw new hs(cs.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function em(t,e,n,i){if(!0===e&&!0===i)throw new hs(cs.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nm(t){if(!Ds.isDocumentKey(t))throw new hs(cs.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function im(t){if(Ds.isDocumentKey(t))throw new hs(cs.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rm(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const n=(e=t).constructor?e.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var e;return"function"==typeof t?"a function":as()}function sm(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new hs(cs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rm(t);throw new hs(cs.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function om(t,e){if(e<=0)throw new hs(cs.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}const am=new Map;class lm{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new hs(cs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new hs(cs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,em("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class um{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new hs(cs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new hs(cs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lm(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new fs;switch(t.type){case"gapi":return new _s(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new hs(cs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=am.get(t);e&&(is("ComponentProvider","Removing Datastore"),am.delete(t),e.terminate())}(this),Promise.resolve()}}class cm{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dm(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new cm(this.firestore,t,this._key)}}class hm{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new hm(this.firestore,t,this._query)}}class dm extends hm{constructor(t,e,n){super(t,e,Oa(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new cm(this.firestore,null,new Ds(t))}withConverter(t){return new dm(this.firestore,t,this._path)}}function pm(t,e,...n){if(t=(0,Jt.m9)(t),tm("collection","path",e),t instanceof um){const i=As.fromString(e,...n);return im(i),new dm(t,null,i)}{if(!(t instanceof cm||t instanceof dm))throw new hs(cs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(As.fromString(e,...n));return im(i),new dm(t.firestore,null,i)}}function fm(t,e,...n){if(t=(0,Jt.m9)(t),1===arguments.length&&(e=Ts.R()),tm("doc","path",e),t instanceof um){const i=As.fromString(e,...n);return nm(i),new cm(t,null,new Ds(i))}{if(!(t instanceof cm||t instanceof dm))throw new hs(cs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(As.fromString(e,...n));return nm(i),new cm(t.firestore,t instanceof dm?t.converter:null,new Ds(i))}}function mm(t,e){return t=(0,Jt.m9)(t),e=(0,Jt.m9)(e),(t instanceof cm||t instanceof dm)&&(e instanceof cm||e instanceof dm)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function gm(t,e){return t=(0,Jt.m9)(t),e=(0,Jt.m9)(e),t instanceof hm&&e instanceof hm&&t.firestore===e.firestore&&za(t._query,e._query)&&t.converter===e.converter}function ym(t,e=10240){let n=0;return{read:()=>(0,Gt.Z)(function*(){if(n<t.byteLength){const i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})(),cancel:()=>(0,Gt.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class _m{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):rs("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class vm{constructor(t,e){this.Pc=t,this.yt=e,this.metadata=new ds,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(t=>{t&&t.Ou()?this.metadata.resolve(t.ku.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==t?void 0:t.ku)}`))},t=>this.metadata.reject(t))}close(){return this.Pc.cancel()}getMetadata(){var t=this;return(0,Gt.Z)(function*(){return t.metadata.promise})()}mc(){var t=this;return(0,Gt.Z)(function*(){return yield t.getMetadata(),t.Vc()})()}Vc(){var t=this;return(0,Gt.Z)(function*(){const e=yield t.Sc();if(null===e)return null;const n=t.vc.decode(e),i=Number(n);isNaN(i)&&t.Dc(`length string (${n}) is not valid number`);const r=yield t.Cc(i);return new Wp(JSON.parse(r),e.length+i)})()}xc(){return this.buffer.findIndex(t=>t==="{".charCodeAt(0))}Sc(){var t=this;return(0,Gt.Z)(function*(){for(;t.xc()<0&&!(yield t.Nc()););if(0===t.buffer.length)return null;const e=t.xc();e<0&&t.Dc("Reached the end of bundle when a length string is expected.");const n=t.buffer.slice(0,e);return t.buffer=t.buffer.slice(e),n})()}Cc(t){var e=this;return(0,Gt.Z)(function*(){for(;e.buffer.length<t;)(yield e.Nc())&&e.Dc("Reached the end of bundle when more is expected.");const n=e.vc.decode(e.buffer.slice(0,t));return e.buffer=e.buffer.slice(t),n})()}Dc(t){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${t}`)}Nc(){var t=this;return(0,Gt.Z)(function*(){const e=yield t.Pc.read();if(!e.done){const n=new Uint8Array(t.buffer.length+e.value.length);n.set(t.buffer),n.set(e.value,t.buffer.length),t.buffer=n}return e.done})()}}class wm{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(t){var e=this;return(0,Gt.Z)(function*(){if(e.ensureCommitNotCalled(),e.mutations.length>0)throw new hs(cs.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=yield(i=(0,Gt.Z)(function*(t,e){const n=us(t),i=mu(n.yt)+"/documents",r={documents:e.map(t=>hu(n.yt,t))},s=yield n._o("BatchGetDocuments",i,r,e.length),o=new Map;s.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){ls(!!e.found);const n=du(t,e.found.name),i=lu(e.found.updateTime),r=e.found.createTime?lu(e.found.createTime):xs.min(),s=new wa({mapValue:{fields:e.found.fields}});return Ta.newFoundDocument(n,i,r,s)}(t,e):"missing"in e?function(t,e){ls(!!e.missing),ls(!!e.readTime);const n=du(t,e.missing),i=lu(e.readTime);return Ta.newNoDocument(n,i)}(t,e):as()}(n.yt,t);o.set(e.key.toString(),e)});const a=[];return e.forEach(t=>{const e=o.get(t.toString());ls(!!e),a.push(e)}),a}),function(t,e){return i.apply(this,arguments)})(e.datastore,t);var i;return n.forEach(t=>e.recordVersion(t)),n})()}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t.toString())}delete(t){this.write(new Cl(t,this.precondition(t))),this.writtenDocs.add(t.toString())}commit(){var t=this;return(0,Gt.Z)(function*(){if(t.ensureCommitNotCalled(),t.lastWriteError)throw t.lastWriteError;const e=t.readVersions;var n;t.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,n)=>{const i=Ds.fromPath(n);t.mutations.push(new El(i,t.precondition(i)))}),yield(n=(0,Gt.Z)(function*(t,e){const n=us(t),i=mu(n.yt)+"/documents",r={writes:e.map(t=>vu(n.yt,t))};yield n.ao("Commit",i,r)}),function(t,e){return n.apply(this,arguments)})(t.datastore,t.mutations),t.committed=!0})()}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw as();e=xs.min()}const n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new hs(cs.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(xs.min())?dl.exists(!1):dl.updateTime(e):dl.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(xs.min()))throw new hs(cs.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dl.updateTime(e)}return dl.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}class bm{constructor(t,e,n,i,r){this.asyncQueue=t,this.datastore=e,this.options=n,this.updateFunction=i,this.deferred=r,this.kc=n.maxAttempts,this.xo=new Vd(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){var t=this;this.xo.Ro((0,Gt.Z)(function*(){const e=new wm(t.datastore),n=t.Mc(e);n&&n.then(n=>{t.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{t.deferred.resolve(n)}).catch(e=>{t.Fc(e)}))}).catch(e=>{t.Fc(e)})}))}Mc(t){try{const e=this.updateFunction(t);return!co(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Fc(t){this.kc>0&&this.$c(t)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(t)}$c(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||"already-exists"===e||!Pl(e)}return!1}}class Tm{constructor(t,e,n,i){var r=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=Xr.UNAUTHENTICATED,this.clientId=Ts.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var t=(0,Gt.Z)(function*(t){is("FirestoreClient","Received user=",t.uid),yield r.authCredentialListener(t),r.user=t});return function(e){return t.apply(this,arguments)}}()),this.appCheckCredentials.start(n,t=>(is("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user)))}getConfiguration(){var t=this;return(0,Gt.Z)(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new hs(cs.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new ds;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Gt.Z)(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(n){const t=Op(n,"Failed to shutdown persistence");e.reject(t)}})),e.promise}}function Im(t,e){return Sm.apply(this,arguments)}function Sm(){return Sm=(0,Gt.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress(),is("FirestoreClient","Initializing OfflineComponentProvider");const n=yield t.getConfiguration();yield e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(function(){var t=(0,Gt.Z)(function*(t){i.isEqual(t)||(yield id(e.localStore,t),i=t)});return function(e){return t.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}),Sm.apply(this,arguments)}function Cm(t,e){return Em.apply(this,arguments)}function Em(){return Em=(0,Gt.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield xm(t);is("FirestoreClient","Initializing OnlineComponentProvider");const i=yield t.getConfiguration();yield e.initialize(n,i),t.setCredentialChangeListener(t=>Ep(e.remoteStore,t)),t.setAppCheckTokenChangeListener((t,n)=>Ep(e.remoteStore,n)),t.onlineComponents=e}),Em.apply(this,arguments)}function xm(t){return km.apply(this,arguments)}function km(){return km=(0,Gt.Z)(function*(t){return t.offlineComponents||(is("FirestoreClient","Using default OfflineComponentProvider"),yield Im(t,new Qf)),t.offlineComponents}),km.apply(this,arguments)}function Am(t){return Pm.apply(this,arguments)}function Pm(){return Pm=(0,Gt.Z)(function*(t){return t.onlineComponents||(is("FirestoreClient","Using default OnlineComponentProvider"),yield Cm(t,new Xf)),t.onlineComponents}),Pm.apply(this,arguments)}function Nm(t){return xm(t).then(t=>t.persistence)}function Dm(t){return xm(t).then(t=>t.localStore)}function Om(t){return Am(t).then(t=>t.remoteStore)}function Rm(t){return Am(t).then(t=>t.syncEngine)}function Lm(t){return Mm.apply(this,arguments)}function Mm(){return Mm=(0,Gt.Z)(function*(t){const e=yield Am(t),n=e.eventManager;return n.onListen=rf.bind(null,e.syncEngine),n.onUnlisten=lf.bind(null,e.syncEngine),n}),Mm.apply(this,arguments)}function Fm(t,e,n={}){const i=new ds;return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return function(t,e,n,i,r){const s=new _m({next:s=>{e.enqueueAndForget(()=>qp(t,o));const a=s.docs.has(n);!a&&s.fromCache?r.reject(new hs(cs.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&i&&"server"===i.source?r.reject(new hs(cs.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:t=>r.reject(t)}),o=new $p(Oa(n.path),s,{includeMetadataChanges:!0,Nu:!0});return Up(t,o)}(yield Lm(t),t.asyncQueue,e,n,i)})),i.promise}function Vm(t,e,n={}){const i=new ds;return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return function(t,e,n,i,r){const s=new _m({next:n=>{e.enqueueAndForget(()=>qp(t,o)),n.fromCache&&"server"===i.source?r.reject(new hs(cs.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:t=>r.reject(t)}),o=new $p(n,s,{includeMetadataChanges:!0,Nu:!0});return Up(t,o)}(yield Lm(t),t.asyncQueue,e,n,i)})),i.promise}class Um{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.qc=!1,this.Uc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Vd(this,"async_queue_retry"),this.Wc=()=>{const t=Md();t&&is("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const t=Md();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.qc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.qc){this.qc=!0,this.Qc=t||!1;const e=Md();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.qc)return new Promise(()=>{});const e=new ds;return this.Hc(()=>this.qc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return(0,Gt.Z)(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!Ys(e))throw e;is("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(t=>{throw this.Kc=t,this.Gc=!1,rs("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.Gc=!1,t))));return this.Bc=e,e}enqueueAfterDelay(t,e,n){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const i=Dp.createAndSchedule(this,t,e,n,t=>this.Yc(t));return this.Uc.push(i),i}zc(){this.Kc&&as()}verifyOperationInProgress(){}Xc(){var t=this;return(0,Gt.Z)(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.Uc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.Uc.sort((t,e)=>t.targetTimeMs-e.targetTimeMs);for(const e of this.Uc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.Uc.indexOf(t);this.Uc.splice(e,1)}}function jm(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(t)}class qm{constructor(){this._progressObserver={},this._taskCompletionResolver=new ds,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(t,e,n){this._progressObserver={next:t,error:e,complete:n}}catch(t){return this._taskCompletionResolver.promise.catch(t)}then(t,e){return this._taskCompletionResolver.promise.then(t,e)}_completeWith(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)}_failWith(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)}_updateProgress(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}class zm extends um{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Um,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Zm(this),this._firestoreClient.terminate()}}function Bm(t){return t._firestoreClient||Zm(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Zm(t){var e;const n=t._freezeSettings(),i=(r=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new so(t._databaseId,r,t._persistenceKey,(s=n).host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams));var r,s;t._firestoreClient=new Tm(t._authCredentials,t._appCheckCredentials,t._queue,i)}function Hm(t,e,n){const i=new ds;return t.asyncQueue.enqueue((0,Gt.Z)(function*(){try{yield Im(t,n),yield Cm(t,e),i.resolve()}catch(s){const t=s;if(!("FirebaseError"===(r=t).name?r.code===cs.FAILED_PRECONDITION||r.code===cs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code))throw t;ss("Error enabling offline persistence. Falling back to persistence disabled: "+t),i.reject(t)}var r})).then(()=>i.promise)}function $m(t){if(t._initialized||t._terminated)throw new hs(cs.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Wm{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Wm(fo.fromBase64String(t))}catch(e){throw new hs(cs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Wm(fo.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Gm{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new hs(cs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ns(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Km{constructor(t){this._methodName=t}}class Qm{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new hs(cs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new hs(cs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Is(this._lat,t._lat)||Is(this._long,t._long)}}const Ym=/^__.*__$/;class Jm{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new bl(t,this.data,this.fieldMask,e,this.fieldTransforms):new wl(t,this.data,e,this.fieldTransforms)}}class Xm{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new bl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function tg(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw as()}}class eg{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.yt=n,this.ignoreUndefinedProperties=i,void 0===r&&this.na(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new eg(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.yt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.ua(t),i}ca(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.ia({path:n,oa:!1});return i.na(),i}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return bg(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(tg(this.sa)&&Ym.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class ng{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.yt=n||Fd(t)}da(t,e,n,i=!1){return new eg({sa:t,methodName:e,fa:n,path:Ns.emptyPath(),oa:!1,la:i},this.databaseId,this.yt,this.ignoreUndefinedProperties)}}function ig(t){const e=t._freezeSettings(),n=Fd(t._databaseId);return new ng(t._databaseId,!!e.ignoreUndefinedProperties,n)}function rg(t,e,n,i,r,s={}){const o=t.da(s.merge||s.mergeFields?2:0,e,n,r);yg("Data must be an object, but it was:",o,i);const a=mg(i,o);let l,u;if(s.merge)l=new va(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=_g(e,i,n);if(!o.contains(r))throw new hs(cs.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Tg(t,r)||t.push(r)}l=new va(t),u=o.fieldTransforms.filter(t=>l.covers(t.field))}else l=null,u=o.fieldTransforms;return new Jm(new wa(a),l,u)}class sg extends Km{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof sg}}function og(t,e,n){return new eg({sa:3,fa:e.settings.fa,methodName:t._methodName,oa:n},e.databaseId,e.yt,e.ignoreUndefinedProperties)}class ag extends Km{_toFieldTransform(t){return new cl(t.path,new nl)}isEqual(t){return t instanceof ag}}class lg extends Km{constructor(t,e){super(t),this._a=e}_toFieldTransform(t){const e=og(this,t,!0),n=this._a.map(t=>fg(t,e)),i=new il(n);return new cl(t.path,i)}isEqual(t){return this===t}}class ug extends Km{constructor(t,e){super(t),this._a=e}_toFieldTransform(t){const e=og(this,t,!0),n=this._a.map(t=>fg(t,e)),i=new sl(n);return new cl(t.path,i)}isEqual(t){return this===t}}class cg extends Km{constructor(t,e){super(t),this.wa=e}_toFieldTransform(t){const e=new al(t.yt,Ya(t.yt,this.wa));return new cl(t.path,e)}isEqual(t){return this===t}}function hg(t,e,n,i){const r=t.da(1,e,n);yg("Data must be an object, but it was:",r,i);const s=[],o=wa.empty();lo(i,(t,i)=>{const a=wg(e,t,n);i=(0,Jt.m9)(i);const l=r.ca(a);if(i instanceof sg)s.push(a);else{const t=fg(i,l);null!=t&&(s.push(a),o.set(a,t))}});const a=new va(s);return new Xm(o,a,r.fieldTransforms)}function dg(t,e,n,i,r,s){const o=t.da(1,e,n),a=[_g(e,i,n)],l=[r];if(s.length%2!=0)throw new hs(cs.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(_g(e,s[d])),l.push(s[d+1]);const u=[],c=wa.empty();for(let d=a.length-1;d>=0;--d)if(!Tg(u,a[d])){const t=a[d];let e=l[d];e=(0,Jt.m9)(e);const n=o.ca(t);if(e instanceof sg)u.push(t);else{const i=fg(e,n);null!=i&&(u.push(t),c.set(t,i))}}const h=new va(u);return new Xm(c,h,o.fieldTransforms)}function pg(t,e,n,i=!1){return fg(n,t.da(i?4:3,e))}function fg(t,e){if(gg(t=(0,Jt.m9)(t)))return yg("Unsupported field value:",e,t),mg(t,e);if(t instanceof Km)return function(t,e){if(!tg(e.sa))throw e.ha(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ha(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=fg(r,e.aa(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,Jt.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ya(e.yt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Es.fromDate(t);return{timestampValue:su(e.yt,n)}}if(t instanceof Es){const n=new Es(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:su(e.yt,n)}}if(t instanceof Qm)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wm)return{bytesValue:ou(e.yt,t._byteString)};if(t instanceof cm){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:uu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ha(`Unsupported field value: ${rm(t)}`)}(t,e)}function mg(t,e){const n={};return uo(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,(t,i)=>{const r=fg(i,e.ra(t));null!=r&&(n[t]=r)}),{mapValue:{fields:n}}}function gg(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Es||t instanceof Qm||t instanceof Wm||t instanceof cm||t instanceof Km)}function yg(t,e,n){if(!gg(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=rm(n);throw e.ha("an object"===i?t+" a custom object":t+" "+i)}var i}function _g(t,e,n){if((e=(0,Jt.m9)(e))instanceof Gm)return e._internalPath;if("string"==typeof e)return wg(t,e);throw bg("Field path arguments must be of type string or ",t,!1,void 0,n)}const vg=new RegExp("[~\\*/\\[\\]]");function wg(t,e,n){if(e.search(vg)>=0)throw bg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gm(...e.split("."))._internalPath}catch(i){throw bg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function bg(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new hs(cs.INVALID_ARGUMENT,a+t+l)}function Tg(t,e){return t.some(t=>t.isEqual(e))}class Ig{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new cm(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Sg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Cg("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Sg extends Ig{data(){return super.data()}}function Cg(t,e){return"string"==typeof e?wg(t,e):e instanceof Gm?e._internalPath:e._delegate._internalPath}function Eg(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new hs(cs.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xg{}class kg extends xg{}function Ag(t,e,...n){let i=[];e instanceof xg&&i.push(e),i=i.concat(n),function(t){const e=t.filter(t=>t instanceof Ng).length,n=t.filter(t=>t instanceof Pg).length;if(e>1||e>0&&n>0)throw new hs(cs.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)t=r._apply(t);return t}class Pg extends kg{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new Pg(t,e,n)}_apply(t){const e=this._parse(t);return Ug(t._query,e),new hm(t.firestore,t.converter,ja(t._query,e))}_parse(t){const e=ig(t.firestore);return function(t,e,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new hs(cs.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Vg(o,s);const e=[];for(const n of o)e.push(Fg(i,t,n));a={arrayValue:{values:e}}}else a=Fg(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Vg(o,s),a=pg(n,"where",o,"in"===s||"not-in"===s);return Wo.create(r,s,a)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value)}}class Ng extends xg{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Ng(t,e)}_parse(t){const e=this._queryConstraints.map(e=>e._parse(t)).filter(t=>t.getFilters().length>0);return 1===e.length?e[0]:Go.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const i=e.getFlattenedFilters();for(const r of i)Ug(n,r),n=ja(n,r)}(t._query,e),new hm(t.firestore,t.converter,ja(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Dg extends kg{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new Dg(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new hs(cs.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new hs(cs.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const i=new ha(e,n);return function(t,e){if(null===La(t)){const n=Ma(t);null!==n&&jg(0,n,e.field)}}(t,i),i}(t._query,this._field,this._direction);return new hm(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new Na(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}class Og extends kg{constructor(t,e,n){super(),this.type=t,this._limit=e,this._limitType=n}static _create(t,e,n){return new Og(t,e,n)}_apply(t){return new hm(t.firestore,t.converter,qa(t._query,this._limit,this._limitType))}}class Rg extends kg{constructor(t,e,n){super(),this.type=t,this._docOrFields=e,this._inclusive=n}static _create(t,e,n){return new Rg(t,e,n)}_apply(t){const e=Mg(t,this.type,this._docOrFields,this._inclusive);return new hm(t.firestore,t.converter,(i=e,new Na((n=t._query).path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,i,n.endAt)));var n,i}}class Lg extends kg{constructor(t,e,n){super(),this.type=t,this._docOrFields=e,this._inclusive=n}static _create(t,e,n){return new Lg(t,e,n)}_apply(t){const e=Mg(t,this.type,this._docOrFields,this._inclusive);return new hm(t.firestore,t.converter,(i=e,new Na((n=t._query).path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,i)));var n,i}}function Mg(t,e,n,i){if(n[0]=(0,Jt.m9)(n[0]),n[0]instanceof Ig)return function(t,e,n,i,r){if(!i)throw new hs(cs.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const o of Va(t))if(o.field.isKeyField())s.push(No(e,i.key));else{const t=i.data.field(o.field);if(vo(t))throw new hs(cs.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=o.field.canonicalString();throw new hs(cs.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}s.push(t)}return new Bo(s,r)}(t._query,t.firestore._databaseId,e,n[0]._document,i);{const r=ig(t.firestore);return function(t,e,n,i,r,s){const o=t.explicitOrderBy;if(r.length>o.length)throw new hs(cs.INVALID_ARGUMENT,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let l=0;l<r.length;l++){const s=r[l];if(o[l].field.isKeyField()){if("string"!=typeof s)throw new hs(cs.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof s}`);if(!Fa(t)&&-1!==s.indexOf("/"))throw new hs(cs.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${s}' contains a slash.`);const n=t.path.child(As.fromString(s));if(!Ds.isDocumentKey(n))throw new hs(cs.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const r=new Ds(n);a.push(No(e,r))}else{const t=pg(n,i,s);a.push(t)}}return new Bo(a,s)}(t._query,t.firestore._databaseId,r,e,n,i)}}function Fg(t,e,n){if("string"==typeof(n=(0,Jt.m9)(n))){if(""===n)throw new hs(cs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fa(e)&&-1!==n.indexOf("/"))throw new hs(cs.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(As.fromString(n));if(!Ds.isDocumentKey(i))throw new hs(cs.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return No(t,new Ds(i))}if(n instanceof cm)return No(t,n._key);throw new hs(cs.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rm(n)}.`)}function Vg(t,e){if(!Array.isArray(t)||0===t.length)throw new hs(cs.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new hs(cs.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Ug(t,e){if(e.isInequality()){const n=Ma(t),i=e.field;if(null!==n&&!n.isEqual(i))throw new hs(cs.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const r=La(t);null!==r&&jg(0,i,r)}const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw new hs(cs.INVALID_ARGUMENT,n===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function jg(t,e,n){if(!n.isEqual(e))throw new hs(cs.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class qg{convertValue(t,e="none"){switch(So(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yo(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_o(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw as()}}convertObject(t,e){const n={};return lo(t.fields,(t,i)=>{n[t]=this.convertValue(i,e)}),n}convertGeoPoint(t){return new Qm(yo(t.latitude),yo(t.longitude))}convertArray(t,e){return(t.values||[]).map(t=>this.convertValue(t,e))}convertServerTimestamp(t,e){switch(e){case"previous":const n=wo(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(bo(t));default:return null}}convertTimestamp(t){const e=go(t);return new Es(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=As.fromString(t);ls(Du(n));const i=new oo(n.get(1),n.get(3)),r=new Ds(n.popFirst(5));return i.isEqual(e)||rs(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function zg(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Bg extends qg{constructor(t){super(),this.firestore=t}convertBytes(t){return new Wm(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new cm(this.firestore,null,e)}}class Zg{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Hg extends Ig{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new $g(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Cg("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class $g extends Hg{data(t={}){return super.data(t)}}class Wg{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Zg(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(n=>{t.call(e,new $g(this._firestore,this._userDataWriter,n.key,n,new Zg(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new hs(cs.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map(n=>({type:"added",doc:new $g(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Zg(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:e++}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(t=>e||3!==t.type).map(e=>{const i=new $g(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Zg(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:Gg(e.type),doc:i,oldIndex:r,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Gg(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return as()}}function Kg(t,e){return t instanceof Hg&&e instanceof Hg?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Wg&&e instanceof Wg&&t._firestore===e._firestore&&gm(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}class Qg extends qg{constructor(t){super(),this.firestore=t}convertBytes(t){return new Wm(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new cm(this.firestore,null,e)}}function Yg(t,e,n){t=sm(t,cm);const i=sm(t.firestore,zm),r=zg(t.converter,e,n);return ty(i,[rg(ig(i),"setDoc",t._key,r,null!==t.converter,n).toMutation(t._key,dl.none())])}function Jg(t,e,n,...i){t=sm(t,cm);const r=sm(t.firestore,zm),s=ig(r);let o;return o="string"==typeof(e=(0,Jt.m9)(e))||e instanceof Gm?dg(s,"updateDoc",t._key,e,n,i):hg(s,"updateDoc",t._key,e),ty(r,[o.toMutation(t._key,dl.exists(!0))])}function Xg(t,...e){var n,i,r;t=(0,Jt.m9)(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||jm(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(jm(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[o+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let l,u,c;if(t instanceof cm)u=sm(t.firestore,zm),c=Oa(t._key.path),l={next:n=>{e[o]&&e[o](ey(u,t,n))},error:e[o+1],complete:e[o+2]};else{const n=sm(t,hm);u=sm(n.firestore,zm),c=n._query;const i=new Qg(u);l={next:t=>{e[o]&&e[o](new Wg(u,i,n,t))},error:e[o+1],complete:e[o+2]},Eg(t._query)}return function(t,e,n,i){const r=new _m(i),s=new $p(e,r,n);return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return Up(yield Lm(t),s)})),()=>{r.bc(),t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return qp(yield Lm(t),s)}))}}(Bm(u),c,a,l)}function ty(t,e){return function(t,e){const n=new ds;return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return function(t,e,n){return cf.apply(this,arguments)}(yield Rm(t),e,n)})),n.promise}(Bm(t),e)}function ey(t,e,n){const i=n.docs.get(e._key),r=new Qg(t);return new Hg(t,r,e._key,i,new Zg(n.hasPendingWrites,n.fromCache),e.converter)}const ny={maxAttempts:5};class iy{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=ig(t)}set(t,e,n){this._verifyNotCommitted();const i=ry(t,this._firestore),r=zg(i.converter,e,n),s=rg(this._dataReader,"WriteBatch.set",i._key,r,null!==i.converter,n);return this._mutations.push(s.toMutation(i._key,dl.none())),this}update(t,e,n,...i){this._verifyNotCommitted();const r=ry(t,this._firestore);let s;return s="string"==typeof(e=(0,Jt.m9)(e))||e instanceof Gm?dg(this._dataReader,"WriteBatch.update",r._key,e,n,i):hg(this._dataReader,"WriteBatch.update",r._key,e),this._mutations.push(s.toMutation(r._key,dl.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=ry(t,this._firestore);return this._mutations=this._mutations.concat(new Cl(e._key,dl.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new hs(cs.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ry(t,e){if((t=(0,Jt.m9)(t)).firestore!==e)throw new hs(cs.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class sy extends class{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=ig(t)}get(t){const e=ry(t,this._firestore),n=new Bg(this._firestore);return this._transaction.lookup([e._key]).then(t=>{if(!t||1!==t.length)return as();const i=t[0];if(i.isFoundDocument())return new Ig(this._firestore,n,i.key,i,e.converter);if(i.isNoDocument())return new Ig(this._firestore,n,e._key,null,e.converter);throw as()})}set(t,e,n){const i=ry(t,this._firestore),r=zg(i.converter,e,n),s=rg(this._dataReader,"Transaction.set",i._key,r,null!==i.converter,n);return this._transaction.set(i._key,s),this}update(t,e,n,...i){const r=ry(t,this._firestore);let s;return s="string"==typeof(e=(0,Jt.m9)(e))||e instanceof Gm?dg(this._dataReader,"Transaction.update",r._key,e,n,i):hg(this._dataReader,"Transaction.update",r._key,e),this._transaction.update(r._key,s),this}delete(t){const e=ry(t,this._firestore);return this._transaction.delete(e._key),this}}{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=ry(t,this._firestore),n=new Qg(this._firestore);return super.get(t).then(t=>new Hg(this._firestore,n,e._key,t._document,new Zg(!1,!1),e.converter))}}function oy(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new hs("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function ay(){if("undefined"==typeof Uint8Array)throw new hs("unimplemented","Uint8Arrays are not available in this environment.")}function ly(){if("undefined"==typeof atob)throw new hs("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(t,e=!0){ts=Kt.SDK_VERSION,(0,Kt._registerComponent)(new Qt.wA("firestore",(t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new zm(new gs(t.getProvider("auth-internal")),new ws(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new hs(cs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),(0,Kt.registerVersion)(Jr,"3.8.0",t),(0,Kt.registerVersion)(Jr,"3.8.0","esm2017")}();class uy{constructor(t){this._delegate=t}static fromBase64String(t){return ly(),new uy(Wm.fromBase64String(t))}static fromUint8Array(t){return ay(),new uy(Wm.fromUint8Array(t))}toBase64(){return ly(),this._delegate.toBase64()}toUint8Array(){return ay(),this._delegate.toUint8Array()}isEqual(t){return this._delegate.isEqual(t._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function cy(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(t)}class hy{enableIndexedDbPersistence(t,e){return function(t,e){$m(t=sm(t,zm));const n=Bm(t),i=t._freezeSettings(),r=new Xf;return Hm(n,r,new Yf(r,i.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})}enableMultiTabIndexedDbPersistence(t){return function(t){$m(t=sm(t,zm));const e=Bm(t),n=t._freezeSettings(),i=new Xf;return Hm(e,i,new Jf(i,n.cacheSizeBytes))}(t._delegate)}clearIndexedDbPersistence(t){return function(t){if(t._initialized&&!t._terminated)throw new hs(cs.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ds;return t._queue.enqueueAndForgetEvenWhileRestricted((0,Gt.Z)(function*(){try{yield(n=(0,Gt.Z)(function*(t){if(!Gs.C())return Promise.resolve();const e=t+"main";yield Gs.delete(e)}),function(t){return n.apply(this,arguments)})(Jh(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(t._delegate)}}class dy{constructor(t,e,n){this._delegate=e,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},t instanceof oo||(this._appCompat=t)}get _databaseId(){return this._delegate._databaseId}settings(t){const e=this._delegate._getSettings();!t.merge&&e.host!==t.host&&ss("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)}useEmulator(t,e,n={}){!function(t,e,n,i={}){var r;const s=(t=sm(t,um))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&ss("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${n}`,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=Xr.MOCK_USER;else{e=(0,Jt.Sg)(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new hs(cs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Xr(s)}t._authCredentials=new ms(new ps(e,n))}}(this._delegate,t,e,n)}enableNetwork(){return function(t){return function(t){return t.asyncQueue.enqueue((0,Gt.Z)(function*(){const e=yield Nm(t),n=yield Om(t);return e.setNetworkEnabled(!0),function(t){const e=us(t);return e._u.delete(0),Hd(e)}(n)}))}(Bm(t=sm(t,zm)))}(this._delegate)}disableNetwork(){return function(t){return function(t){return t.asyncQueue.enqueue((0,Gt.Z)(function*(){const e=yield Nm(t),n=yield Om(t);return e.setNetworkEnabled(!1),(i=(0,Gt.Z)(function*(t){const e=us(t);e._u.add(0),yield Wd(e),e.gu.set("Offline")}),function(t){return i.apply(this,arguments)})(n);var i}))}(Bm(t=sm(t,zm)))}(this._delegate)}enablePersistence(t){let e=!1,n=!1;return t&&(e=!!t.synchronizeTabs,n=!!t.experimentalForceOwningTab,em("synchronizeTabs",e,"experimentalForceOwningTab",n)),e?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function(t){return function(t){const e=new ds;return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return function(t,e){return wf.apply(this,arguments)}(yield Rm(t),e)})),e.promise}(Bm(t=sm(t,zm)))}(this._delegate)}onSnapshotsInSync(t){return function(t,e){return function(t,e){const n=new _m(e);return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return e=yield Lm(t),i=n,us(e).Ru.add(i),void i.next();var e,i})),()=>{n.bc(),t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return e=yield Lm(t),i=n,void us(e).Ru.delete(i);var e,i}))}}(Bm(t=sm(t,zm)),jm(e)?e:{next:e})}(this._delegate,t)}get app(){if(!this._appCompat)throw new hs("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(t){try{return new Ey(this,pm(this._delegate,t))}catch(e){throw _y(e,"collection()","Firestore.collection()")}}doc(t){try{return new yy(this,fm(this._delegate,t))}catch(e){throw _y(e,"doc()","Firestore.doc()")}}collectionGroup(t){try{return new Iy(this,function(t,e){if(t=sm(t,um),tm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new hs(cs.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new hm(t,null,(n=e,new Na(As.emptyPath(),n)));var n}(this._delegate,t))}catch(e){throw _y(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return function(t,e,n){t=sm(t,zm);const i=Object.assign(Object.assign({},ny),void 0);return function(t){if(t.maxAttempts<1)throw new hs(cs.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(t,e,n){const i=new ds;return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){const r=yield function(t){return Am(t).then(t=>t.datastore)}(t);new bm(t.asyncQueue,r,n,e,i).run()})),i.promise}(Bm(t),n=>e(new sy(t,n)),i)}(this._delegate,e=>t(new fy(this,e)))}batch(){return Bm(this._delegate),new my(new iy(this._delegate,t=>ty(this._delegate,t)))}loadBundle(t){return function(t,e){const n=Bm(t=sm(t,zm)),i=new qm;return function(t,e,n,i){const r=function(t,e){let n;return n="string"==typeof t?(new TextEncoder).encode(t):t,i=function(t,e){if(t instanceof Uint8Array)return ym(t,e);if(t instanceof ArrayBuffer)return ym(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),new vm(i,e);var i}(n,Fd(e));t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){!function(t,e,n){const i=us(t);var r;(r=(0,Gt.Z)(function*(t,e,n){try{const r=yield e.getMetadata();if(yield function(t,e){const n=us(t),i=lu(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",t=>n.Ns.getBundleMetadata(t,e.id)).then(t=>!!t&&t.createTime.compareTo(i)>=0)}(t.localStore,r))return yield e.close(),n._completeWith({taskState:"Success",documentsLoaded:(i=r).totalDocuments,bytesLoaded:i.totalBytes,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}),Promise.resolve(new Set);n._updateProgress(Qp(r));const s=new Kp(r,t.localStore,e.yt);let o=yield e.mc();for(;o;){const t=yield s.Fu(o);t&&n._updateProgress(t),o=yield e.mc()}const a=yield s.complete();return yield kf(t,a.Lu,void 0),yield function(t,e){const n=us(t);return n.persistence.runTransaction("Save bundle","readwrite",t=>n.Ns.saveBundleMetadata(t,e))}(t.localStore,r),n._completeWith(a.progress),Promise.resolve(a.Bu)}catch(r){return ss("SyncEngine",`Loading bundle failed with ${r}`),n._failWith(r),Promise.resolve(new Set)}var i}),function(t,e,n){return r.apply(this,arguments)})(i,e,n).then(t=>{i.sharedClientState.notifyBundleLoaded(t)})}(yield Rm(t),r,i)}))}(n,t._databaseId,e,i),i}(this._delegate,t)}namedQuery(t){return function(t,e){return function(t,e){return t.asyncQueue.enqueue((0,Gt.Z)(function*(){return function(t,e){const n=us(t);return n.persistence.runTransaction("Get named query","readonly",t=>n.Ns.getNamedQuery(t,e))}(yield Dm(t),e)}))}(Bm(t=sm(t,zm)),e).then(e=>e?new hm(t,null,e.query):null)}(this._delegate,t).then(t=>t?new Iy(this,t):null)}}class py extends qg{constructor(t){super(),this.firestore=t}convertBytes(t){return new uy(new Wm(t))}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return yy.forKey(e,this.firestore,null)}}class fy{constructor(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new py(t)}get(t){const e=xy(t);return this._delegate.get(e).then(t=>new by(this._firestore,new Hg(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,e.converter)))}set(t,e,n){const i=xy(t);return n?(oy("Transaction.set",n),this._delegate.set(i,e,n)):this._delegate.set(i,e),this}update(t,e,n,...i){const r=xy(t);return 2===arguments.length?this._delegate.update(r,e):this._delegate.update(r,e,n,...i),this}delete(t){const e=xy(t);return this._delegate.delete(e),this}}class my{constructor(t){this._delegate=t}set(t,e,n){const i=xy(t);return n?(oy("WriteBatch.set",n),this._delegate.set(i,e,n)):this._delegate.set(i,e),this}update(t,e,n,...i){const r=xy(t);return 2===arguments.length?this._delegate.update(r,e):this._delegate.update(r,e,n,...i),this}delete(t){const e=xy(t);return this._delegate.delete(e),this}commit(){return this._delegate.commit()}}class gy{constructor(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}fromFirestore(t,e){const n=new $g(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Ty(this._firestore,n),null!=e?e:{})}toFirestore(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)}static getInstance(t,e){const n=gy.INSTANCES;let i=n.get(t);i||(i=new WeakMap,n.set(t,i));let r=i.get(e);return r||(r=new gy(t,new py(t),e),i.set(e,r)),r}}gy.INSTANCES=new WeakMap;class yy{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new py(t)}static forPath(t,e,n){if(t.length%2!=0)throw new hs("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${t.canonicalString()} has ${t.length}`);return new yy(e,new cm(e._delegate,n,new Ds(t)))}static forKey(t,e,n){return new yy(e,new cm(e._delegate,n,t))}get id(){return this._delegate.id}get parent(){return new Ey(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(t){try{return new Ey(this.firestore,pm(this._delegate,t))}catch(e){throw _y(e,"collection()","DocumentReference.collection()")}}isEqual(t){return(t=(0,Jt.m9)(t))instanceof cm&&mm(this._delegate,t)}set(t,e){e=oy("DocumentReference.set",e);try{return e?Yg(this._delegate,t,e):Yg(this._delegate,t)}catch(n){throw _y(n,"setDoc()","DocumentReference.set()")}}update(t,e,...n){try{return 1===arguments.length?Jg(this._delegate,t):Jg(this._delegate,t,e,...n)}catch(i){throw _y(i,"updateDoc()","DocumentReference.update()")}}delete(){return function(t){return ty(sm(t.firestore,zm),[new Cl(t._key,dl.none())])}(this._delegate)}onSnapshot(...t){const e=vy(t),n=wy(t,t=>new by(this.firestore,new Hg(this.firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,this._delegate.converter)));return Xg(this._delegate,e,n)}get(t){let e;return e="cache"===(null==t?void 0:t.source)?function(t){t=sm(t,cm);const e=sm(t.firestore,zm),n=Bm(e),i=new Qg(e);return function(t,e){const n=new ds;return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return(i=(0,Gt.Z)(function*(t,e,n){try{const i=yield function(t,e){const n=us(t);return n.persistence.runTransaction("read document","readonly",t=>n.localDocuments.getDocument(t,e))}(t,e);i.isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new hs(cs.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(i){const t=Op(i,`Failed to get document '${e} from cache`);n.reject(t)}}),function(t,e,n){return i.apply(this,arguments)})(yield Dm(t),e,n);var i})),n.promise}(n,t._key).then(n=>new Hg(e,i,t._key,n,new Zg(null!==n&&n.hasLocalMutations,!0),t.converter))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=sm(t,cm);const e=sm(t.firestore,zm);return Fm(Bm(e),t._key,{source:"server"}).then(n=>ey(e,t,n))}(this._delegate):function(t){t=sm(t,cm);const e=sm(t.firestore,zm);return Fm(Bm(e),t._key).then(n=>ey(e,t,n))}(this._delegate),e.then(t=>new by(this.firestore,new Hg(this.firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,this._delegate.converter)))}withConverter(t){return new yy(this.firestore,this._delegate.withConverter(t?gy.getInstance(this.firestore,t):null))}}function _y(t,e,n){return t.message=t.message.replace(e,n),t}function vy(t){for(const e of t)if("object"==typeof e&&!cy(e))return e;return{}}function wy(t,e){var n,i;let r;return r=cy(t[0])?t[0]:cy(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]},{next:t=>{r.next&&r.next(e(t))},error:null===(n=r.error)||void 0===n?void 0:n.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class by{constructor(t,e){this._firestore=t,this._delegate=e}get ref(){return new yy(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(t){return this._delegate.data(t)}get(t,e){return this._delegate.get(t,e)}isEqual(t){return Kg(this._delegate,t._delegate)}}class Ty extends by{data(t){const e=this._delegate.data(t);return function(t,e){t||as()}(void 0!==e),e}}class Iy{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new py(t)}where(t,e,n){try{return new Iy(this.firestore,Ag(this._delegate,function(t,e,n){const i=e,r=Cg("where",t);return Pg._create(r,i,n)}(t,e,n)))}catch(i){throw _y(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(t,e){try{return new Iy(this.firestore,Ag(this._delegate,function(t,e="asc"){const n=e,i=Cg("orderBy",t);return Dg._create(i,n)}(t,e)))}catch(n){throw _y(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(t){try{return new Iy(this.firestore,Ag(this._delegate,function(t){return om("limit",t),Og._create("limit",t,"F")}(t)))}catch(e){throw _y(e,"limit()","Query.limit()")}}limitToLast(t){try{return new Iy(this.firestore,Ag(this._delegate,function(t){return om("limitToLast",t),Og._create("limitToLast",t,"L")}(t)))}catch(e){throw _y(e,"limitToLast()","Query.limitToLast()")}}startAt(...t){try{return new Iy(this.firestore,Ag(this._delegate,function(...t){return Rg._create("startAt",t,!0)}(...t)))}catch(e){throw _y(e,"startAt()","Query.startAt()")}}startAfter(...t){try{return new Iy(this.firestore,Ag(this._delegate,function(...t){return Rg._create("startAfter",t,!1)}(...t)))}catch(e){throw _y(e,"startAfter()","Query.startAfter()")}}endBefore(...t){try{return new Iy(this.firestore,Ag(this._delegate,function(...t){return Lg._create("endBefore",t,!1)}(...t)))}catch(e){throw _y(e,"endBefore()","Query.endBefore()")}}endAt(...t){try{return new Iy(this.firestore,Ag(this._delegate,function(...t){return Lg._create("endAt",t,!0)}(...t)))}catch(e){throw _y(e,"endAt()","Query.endAt()")}}isEqual(t){return gm(this._delegate,t._delegate)}get(t){let e;return e="cache"===(null==t?void 0:t.source)?function(t){t=sm(t,hm);const e=sm(t.firestore,zm),n=Bm(e),i=new Qg(e);return function(t,e){const n=new ds;return t.asyncQueue.enqueueAndForget((0,Gt.Z)(function*(){return(i=(0,Gt.Z)(function*(t,e,n){try{const i=yield pd(t,e,!0),r=new Xp(e,i.Hi),s=r.Wu(i.documents),o=r.applyChanges(s,!1);n.resolve(o.snapshot)}catch(i){const t=Op(i,`Failed to execute query '${e} against cache`);n.reject(t)}}),function(t,e,n){return i.apply(this,arguments)})(yield Dm(t),e,n);var i})),n.promise}(n,t._query).then(n=>new Wg(e,i,t,n))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=sm(t,hm);const e=sm(t.firestore,zm),n=Bm(e),i=new Qg(e);return Vm(n,t._query,{source:"server"}).then(n=>new Wg(e,i,t,n))}(this._delegate):function(t){t=sm(t,hm);const e=sm(t.firestore,zm),n=Bm(e),i=new Qg(e);return Eg(t._query),Vm(n,t._query).then(n=>new Wg(e,i,t,n))}(this._delegate),e.then(t=>new Cy(this.firestore,new Wg(this.firestore._delegate,this._userDataWriter,this._delegate,t._snapshot)))}onSnapshot(...t){const e=vy(t),n=wy(t,t=>new Cy(this.firestore,new Wg(this.firestore._delegate,this._userDataWriter,this._delegate,t._snapshot)));return Xg(this._delegate,e,n)}withConverter(t){return new Iy(this.firestore,this._delegate.withConverter(t?gy.getInstance(this.firestore,t):null))}}class Sy{constructor(t,e){this._firestore=t,this._delegate=e}get type(){return this._delegate.type}get doc(){return new Ty(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Cy{constructor(t,e){this._firestore=t,this._delegate=e}get query(){return new Iy(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(t=>new Ty(this._firestore,t))}docChanges(t){return this._delegate.docChanges(t).map(t=>new Sy(this._firestore,t))}forEach(t,e){this._delegate.forEach(n=>{t.call(e,new Ty(this._firestore,n))})}isEqual(t){return Kg(this._delegate,t._delegate)}}class Ey extends Iy{constructor(t,e){super(t,e),this.firestore=t,this._delegate=e}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const t=this._delegate.parent;return t?new yy(this.firestore,t):null}doc(t){try{return new yy(this.firestore,void 0===t?fm(this._delegate):fm(this._delegate,t))}catch(e){throw _y(e,"doc()","CollectionReference.doc()")}}add(t){return function(t,e){const n=sm(t.firestore,zm),i=fm(t),r=zg(t.converter,e);return ty(n,[rg(ig(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,dl.exists(!1))]).then(()=>i)}(this._delegate,t).then(t=>new yy(this.firestore,t))}isEqual(t){return mm(this._delegate,t._delegate)}withConverter(t){return new Ey(this.firestore,this._delegate.withConverter(t?gy.getInstance(this.firestore,t):null))}}function xy(t){return sm(t,cm)}class ky{constructor(...t){this._delegate=new Gm(...t)}static documentId(){return new ky(Ns.keyField().canonicalString())}isEqual(t){return(t=(0,Jt.m9)(t))instanceof Gm&&this._delegate._internalPath.isEqual(t._internalPath)}}class Ay{constructor(t){this._delegate=t}static serverTimestamp(){const t=new ag("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Ay(t)}static delete(){const t=new sg("deleteField");return t._methodName="FieldValue.delete",new Ay(t)}static arrayUnion(...t){const e=function(...t){return new lg("arrayUnion",t)}(...t);return e._methodName="FieldValue.arrayUnion",new Ay(e)}static arrayRemove(...t){const e=function(...t){return new ug("arrayRemove",t)}(...t);return e._methodName="FieldValue.arrayRemove",new Ay(e)}static increment(t){const e=function(t){return new cg("increment",t)}(t);return e._methodName="FieldValue.increment",new Ay(e)}isEqual(t){return this._delegate.isEqual(t._delegate)}}const Py={Firestore:dy,GeoPoint:Qm,Timestamp:Es,Blob:uy,Transaction:fy,WriteBatch:my,DocumentReference:yy,DocumentSnapshot:by,Query:Iy,QueryDocumentSnapshot:Ty,QuerySnapshot:Cy,CollectionReference:Ey,FieldPath:ky,FieldValue:Ay,setLogLevel:function(t){!function(t){es.setLogLevel(t)}(t)},CACHE_SIZE_UNLIMITED:-1};!function(t){(function(t,e){t.INTERNAL.registerComponent(new Qt.wA("firestore-compat",t=>((t,e)=>new dy(t,e,new hy))(t.getProvider("app-compat").getImmediate(),t.getProvider("firestore").getImmediate()),"PUBLIC").setServiceProps(Object.assign({},Py)))})(t),t.registerVersion("@firebase/firestore-compat","0.3.0")}(Wt.Z);var Ny=n(9765),Dy=n(6682),Oy=n(309),Ry=n(5345);function Ly(t,e){return"function"==typeof e?n=>n.pipe(Ly((n,i)=>(0,Ct.D)(t(n,i)).pipe((0,Mt.U)((t,r)=>e(n,t,i,r))))):e=>e.lift(new My(t))}class My{constructor(t){this.project=t}call(t,e){return e.subscribe(new Fy(t,this.project))}}class Fy extends Ry.Ds{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new Ry.IY(this),i=this.destination;i.add(n),this.innerSubscription=(0,Ry.ft)(t,n),this.innerSubscription!==n&&i.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;(!t||t.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}var Vy=n(7771),Uy=n(5319),jy=n(7971),qy=n(8858);class zy extends Ny.xQ{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new By(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,n=e?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,r=n.length;let s;if(this.closed)throw new jy.N;if(this.isStopped||this.hasError?s=Uy.w.EMPTY:(this.observers.push(t),s=new qy.W(this,t)),i&&t.add(t=new Oy.ht(t,i)),e)for(let o=0;o<r&&!t.closed;o++)t.next(n[o]);else for(let o=0;o<r&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),s}_getNow(){return(this.scheduler||Vy.c).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,n=this._windowTime,i=this._events,r=i.length;let s=0;for(;s<r&&!(t-i[s].time<n);)s++;return r>e&&(s=Math.max(s,r-e)),s>0&&i.splice(0,s),i}}class By{constructor(t,e){this.time=t,this.value=e}}function Zy(t,e,n){let i;return i=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},t=>t.lift(function({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:n,scheduler:i}){let r,s,o=0,a=!1,l=!1;return function(u){let c;o++,!r||a?(a=!1,r=new zy(t,e,i),c=r.subscribe(this),s=u.subscribe({next(t){r.next(t)},error(t){a=!0,r.error(t)},complete(){l=!0,s=void 0,r.complete()}}),l&&(s=void 0)):c=r.subscribe(this),this.add(()=>{o--,c.unsubscribe(),c=void 0,s&&!l&&n&&0===o&&(s.unsubscribe(),s=void 0,r=void 0)})}}(i))}const Hy=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})(),$y=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();var Wy=n(9193);function Gy(t){return e=>0===t?(0,Wy.c)():e.lift(new Ky(t))}class Ky{constructor(t){if(this.total=t,this.total<0)throw new $y}call(t,e){return e.subscribe(new Qy(t,this.total))}}class Qy extends Dt.L{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function Yy(t=null){return e=>e.lift(new Jy(t))}class Jy{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Xy(t,this.defaultValue))}}class Xy extends Dt.L{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function t_(t=i_){return e=>e.lift(new e_(t))}class e_{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new n_(t,this.errorFactory))}}class n_ extends Dt.L{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function i_(){return new Hy}var r_=n(4487);function s_(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Bt((e,n)=>t(e,n,i)):r_.y,Gy(1),n?Yy(e):t_(()=>new Hy))}function o_(t,e){return e?Ly(()=>t,e):Ly(()=>t)}var a_=n(3101);n(8213);const l_=new Map,u_={activated:!1,tokenObservers:[]},c_={initialized:!1,enabled:!1};function h_(t){return l_.get(t)||Object.assign({},u_)}function d_(){return c_}class p_{constructor(t,e,n,i,r){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=r,this.pending=null,this.nextErrorWaitInterval=i,i>r)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return(0,Gt.Z)(function*(){e.stop();try{e.pending=new Jt.BH,yield function(t){return new Promise(e=>{setTimeout(e,t)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new Jt.BH,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(n){e.retryPolicy(n)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const f_=new Jt.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function m_(t){if(!h_(t).activated)throw f_.create("use-before-activation",{appName:t.name})}function g_(t,e){return y_.apply(this,arguments)}function y_(){return y_=(0,Gt.Z)(function*({url:t,body:e},n){const i={"Content-Type":"application/json"},r=n.getImmediate({optional:!0});if(r){const t=yield r.getHeartbeatsHeader();t&&(i["X-Firebase-Client"]=t)}const s={method:"POST",body:JSON.stringify(e),headers:i};let o,a;try{o=yield fetch(t,s)}catch(h){throw f_.create("fetch-network-error",{originalErrorMessage:null==h?void 0:h.message})}if(200!==o.status)throw f_.create("fetch-status-error",{httpStatus:o.status});try{a=yield o.json()}catch(h){throw f_.create("fetch-parse-error",{originalErrorMessage:null==h?void 0:h.message})}const l=a.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw f_.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const u=1e3*Number(l[1]),c=Date.now();return{token:a.token,expireTimeMillis:c+u,issuedAtTimeMillis:c}}),y_.apply(this,arguments)}function __(t,e){const{projectId:n,appId:i,apiKey:r}=t.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${n}/apps/${i}:exchangeDebugToken?key=${r}`,body:{debug_token:e}}}const v_="firebase-app-check-store";let w_=null;function b_(){return w_||(w_=new Promise((t,e)=>{try{const n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=e=>{t(e.target.result)},n.onerror=t=>{var n;e(f_.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=t=>{0===t.oldVersion&&t.target.result.createObjectStore(v_,{keyPath:"compositeKey"})}}catch(n){e(f_.create("storage-open",{originalErrorMessage:null==n?void 0:n.message}))}}),w_)}function T_(){return T_=(0,Gt.Z)(function*(t,e){const n=(yield b_()).transaction(v_,"readwrite"),i=n.objectStore(v_).put({compositeKey:t,value:e});return new Promise((t,e)=>{i.onsuccess=e=>{t()},n.onerror=t=>{var n;e(f_.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}})}),T_.apply(this,arguments)}const I_=new Yt.Yd("@firebase/app-check");function S_(t,e){return(0,Jt.hl)()?function(t,e){return function(t,e){return T_.apply(this,arguments)}(function(t){return`${t.options.appId}-${t.name}`}(t),e)}(t,e).catch(t=>{I_.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function C_(){return d_().enabled}function E_(){return x_.apply(this,arguments)}function x_(){return x_=(0,Gt.Z)(function*(){const t=d_();if(t.enabled&&t.token)return t.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),x_.apply(this,arguments)}const k_={error:"UNKNOWN_ERROR"};function A_(t){return Jt.US.encodeString(JSON.stringify(t),!1)}function P_(t){return N_.apply(this,arguments)}function N_(){return N_=(0,Gt.Z)(function*(t,e=!1){const n=t.app;m_(n);const i=h_(n);let r,s=i.token;if(s&&!L_(s)&&(i.token=void 0,s=void 0),!s){const t=yield i.cachedTokenPromise;t&&(L_(t)?s=t:yield S_(n,void 0))}if(!e&&s&&L_(s))return{token:s.token};let o,a=!1;if(C_()){i.exchangeTokenPromise||(i.exchangeTokenPromise=g_(__(n,yield E_()),t.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);const e=yield i.exchangeTokenPromise;return yield S_(n,e),i.token=e,{token:e.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),s=yield h_(n).exchangeTokenPromise}catch(l){"appCheck/throttled"===l.code?I_.warn(l.message):I_.error(l),r=l}return s?r?o=L_(s)?{token:s.token,internalError:r}:M_(r):(o={token:s.token},i.token=s,yield S_(n,s)):o=M_(r),a&&R_(n,o),o}),N_.apply(this,arguments)}function D_(t,e){const n=h_(t),i=n.tokenObservers.filter(t=>t.next!==e);0===i.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=i}function O_(t){const{app:e}=t,n=h_(e);let i=n.tokenRefresher;i||(i=function(t){const{app:e}=t;return new p_((0,Gt.Z)(function*(){let n;if(n=h_(e).token?yield P_(t,!0):yield P_(t),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=h_(e);if(t.token){let e=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return e=Math.min(e,t.token.expireTimeMillis-3e5),Math.max(0,e-Date.now())}return 0},3e4,96e4)}(t),n.tokenRefresher=i),!i.isRunning()&&n.isTokenAutoRefreshEnabled&&i.start()}function R_(t,e){const n=h_(t).tokenObservers;for(const r of n)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch(i){}}function L_(t){return t.expireTimeMillis-Date.now()>0}function M_(t){return{token:A_(k_),error:t}}class F_{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=h_(this.app);for(const e of t)D_(this.app,e.next);return Promise.resolve()}}const V_="app-check-internal";(0,Kt._registerComponent)(new Qt.wA("app-check",t=>function(t,e){return new F_(t,e)}(t.getProvider("app").getImmediate(),t.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(V_).initialize()})),(0,Kt._registerComponent)(new Qt.wA(V_,t=>function(t){return{getToken:e=>P_(t,e),addTokenListener:e=>function(t,e,n,i){const{app:r}=t,s=h_(r);if(s.tokenObservers=[...s.tokenObservers,{next:n,error:i,type:e}],s.token&&L_(s.token)){const e=s.token;Promise.resolve().then(()=>{n({token:e.token}),O_(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>O_(t))}(t,"INTERNAL",e),removeTokenListener:e=>D_(t.app,e)}}(t.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Kt.registerVersion)("@firebase/app-check","0.6.0");class U_{constructor(){return(0,xt.vb)("app-check")}}"undefined"!=typeof window&&window;var j_=n(2533);const q_=new i.OlP("angularfire2.auth.use-emulator"),z_=new i.OlP("angularfire2.auth.settings"),B_=new i.OlP("angularfire2.auth.tenant-id"),Z_=new i.OlP("angularfire2.auth.langugage-code"),H_=new i.OlP("angularfire2.auth.use-device-language"),$_=new i.OlP("angularfire.auth.persistence"),W_=(t,e,n,i,r,s,o,a)=>(0,Tt.cc)(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{const l=e.runOutsideAngular(()=>t.auth());if(n&&l.useEmulator(...n),i&&(l.tenantId=i),l.languageCode=r,s&&l.useDeviceLanguage(),o)for(const[t,e]of Object.entries(o))l.settings[t]=e;return a&&l.setPersistence(a),l},[n,i,r,s,o,a]);let G_=(()=>{class t{constructor(t,e,i,r,s,o,a,l,u,c,h,d){const p=new Ny.xQ,f=(0,Et.of)(void 0).pipe((0,Oy.QV)(s.outsideAngular),Ly(()=>r.runOutsideAngular(()=>Promise.resolve().then(n.bind(n,3474)))),(0,Mt.U)(()=>(0,Tt.on)(t,r,e)),(0,Mt.U)(t=>W_(t,r,o,l,u,c,a,h)),Zy({bufferSize:1,refCount:!1}));if(q(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,Et.of)(null);else{f.pipe(s_()).subscribe();const t=f.pipe(Ly(t=>t.getRedirectResult().then(t=>t,()=>null)),xt.iC,Zy({bufferSize:1,refCount:!1})),e=f.pipe(Ly(t=>new St.y(e=>({unsubscribe:r.runOutsideAngular(()=>t.onAuthStateChanged(t=>e.next(t),t=>e.error(t),()=>e.complete()))})))),n=f.pipe(Ly(t=>new St.y(e=>({unsubscribe:r.runOutsideAngular(()=>t.onIdTokenChanged(t=>e.next(t),t=>e.error(t),()=>e.complete()))}))));this.authState=t.pipe(o_(e),(0,a_.R)(s.outsideAngular),(0,Oy.QV)(s.insideAngular)),this.user=t.pipe(o_(n),(0,a_.R)(s.outsideAngular),(0,Oy.QV)(s.insideAngular)),this.idToken=this.user.pipe(Ly(t=>t?(0,Ct.D)(t.getIdToken()):(0,Et.of)(null))),this.idTokenResult=this.user.pipe(Ly(t=>t?(0,Ct.D)(t.getIdTokenResult()):(0,Et.of)(null))),this.credential=(0,Dy.T)(t,p,this.authState.pipe(Bt(t=>!t))).pipe((0,Mt.U)(t=>(null==t?void 0:t.user)?t:null),(0,a_.R)(s.outsideAngular),(0,Oy.QV)(s.insideAngular))}return(0,Tt.pX)(this,f,r,{spy:{apply:(t,e,n)=>{(t.startsWith("signIn")||t.startsWith("createUser"))&&n.then(t=>p.next(t))}}})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Tt.Dh),i.LFG(Tt.xv,8),i.LFG(i.Lbi),i.LFG(i.R0b),i.LFG(xt.HU),i.LFG(q_,8),i.LFG(z_,8),i.LFG(B_,8),i.LFG(Z_,8),i.LFG(H_,8),i.LFG($_,8),i.LFG(U_,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"any"}),t})();function K_(t,e){return function(t,e=It.z){return new St.y(n=>{let i;return null!=e?e.schedule(()=>{i=t.onSnapshot({includeMetadataChanges:!0},n)}):i=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=i&&i()}})}(t,e)}function Q_(t,e){return K_(t,e).pipe((0,Mt.U)(t=>({payload:t,type:"query"})))}function Y_(t,e){return Q_(t,e).pipe(Nt(void 0),Ot(),(0,Mt.U)(([t,e])=>{const n=e.payload.docChanges(),i=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,r)=>{const s=n.find(t=>t.doc.ref.isEqual(e.ref)),o=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));s&&JSON.stringify(s.doc.metadata)===JSON.stringify(e.metadata)||!s&&o&&JSON.stringify(o.metadata)===JSON.stringify(e.metadata)||i.push({type:"modified",payload:{oldIndex:r,newIndex:r,type:"modified",doc:e}})}),i}))}function J_(t,e,n){return Y_(t,n).pipe(Ft((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return X_(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return X_(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return X_(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),jt(),(0,Mt.U)(t=>t.map(t=>({type:t.type,payload:t}))))}function X_(t,e,n,...i){const r=t.slice();return r.splice(e,n,...i),r}function tv(t){return(!t||0===t.length)&&(t=["added","removed","modified"]),t}class ev{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=Y_(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe((0,Mt.U)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Nt(void 0),Ot(),Bt(([t,e])=>e.length>0||!t),(0,Mt.U)(([t,e])=>e),xt.iC)}auditTrail(t){return this.stateChanges(t).pipe(Ft((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=tv(t);return J_(this.query,e,this.afs.schedulers.outsideAngular).pipe(xt.iC)}valueChanges(t={}){return Q_(this.query,this.afs.schedulers.outsideAngular).pipe((0,Mt.U)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),xt.iC)}get(t){return(0,Ct.D)(this.query.get(t)).pipe(xt.iC)}add(t){return this.ref.add(t)}doc(t){return new nv(this.ref.doc(t),this.afs)}}class nv{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:i,query:r}=lv(n,e);return new ev(i,r,this.afs)}snapshotChanges(){return function(t,e){return K_(t,e).pipe(Nt(void 0),Ot(),(0,Mt.U)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(xt.iC)}valueChanges(t={}){return this.snapshotChanges().pipe((0,Mt.U)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return(0,Ct.D)(this.ref.get(t)).pipe(xt.iC)}}class iv{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Y_(this.query,this.afs.schedulers.outsideAngular).pipe((0,Mt.U)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Bt(t=>t.length>0),xt.iC):Y_(this.query,this.afs.schedulers.outsideAngular).pipe(xt.iC)}auditTrail(t){return this.stateChanges(t).pipe(Ft((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=tv(t);return J_(this.query,e,this.afs.schedulers.outsideAngular).pipe(xt.iC)}valueChanges(t={}){return Q_(this.query,this.afs.schedulers.outsideAngular).pipe((0,Mt.U)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),xt.iC)}get(t){return(0,Ct.D)(this.query.get(t)).pipe(xt.iC)}}const rv=new i.OlP("angularfire2.enableFirestorePersistence"),sv=new i.OlP("angularfire2.firestore.persistenceSettings"),ov=new i.OlP("angularfire2.firestore.settings"),av=new i.OlP("angularfire2.firestore.use-emulator");function lv(t,e=(t=>t)){return{query:e(t),ref:t}}let uv=(()=>{class t{constructor(t,e,n,i,r,s,o,a,l,u,c,h,d,p,f,m,g){this.schedulers=o;const y=(0,Tt.on)(t,s,e),_=l;u&&W_(y,s,c,d,p,f,h,m),[this.firestore,this.persistenceEnabled$]=(0,Tt.cc)(`${y.name}.firestore`,"AngularFirestore",y.name,()=>{const t=s.runOutsideAngular(()=>y.firestore());if(i&&t.settings(i),_&&t.useEmulator(..._),n&&!q(r)){const e=()=>{try{return(0,Ct.D)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(e){return"undefined"!=typeof console&&console.warn(e),(0,Et.of)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,(0,Et.of)(!1)]},[i,_,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:i,query:r}=lv(n,e),s=this.schedulers.ngZone.run(()=>i);return new ev(s,r,this)}collectionGroup(t,e){const n=e||(t=>t),i=this.firestore.collectionGroup(t);return new iv(n(i),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new nv(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Tt.Dh),i.LFG(Tt.xv,8),i.LFG(rv,8),i.LFG(ov,8),i.LFG(i.Lbi),i.LFG(i.R0b),i.LFG(xt.HU),i.LFG(sv,8),i.LFG(av,8),i.LFG(G_,8),i.LFG(q_,8),i.LFG(z_,8),i.LFG(B_,8),i.LFG(Z_,8),i.LFG(H_,8),i.LFG($_,8),i.LFG(U_,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"any"}),t})(),cv=(()=>{class t{constructor(){j_.Z.registerVersion("angularfire",xt.q4.full,"fst-compat")}static enablePersistence(e){return{ngModule:t,providers:[{provide:rv,useValue:!0},{provide:sv,useValue:e}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[uv]}),t})();var hv=n(9773);function dv(t,e){return(0,hv.zg)(t,e,1)}class pv{}class fv{}class mv{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),i=n.toLowerCase(),r=t.slice(e+1).trim();this.maybeSetNormalizedName(n,i),this.headers.has(i)?this.headers.get(i).push(r):this.headers.set(i,[r])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const i=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(i,n),this.maybeSetNormalizedName(e,i))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof mv?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new mv;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof mv?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const i=("a"===t.op?this.headers.get(e):void 0)||[];i.push(...n),this.headers.set(e,i);break;case"d":const r=t.value;if(r){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===r.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class gv{encodeKey(t){return vv(t)}encodeValue(t){return vv(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const yv=/%(\d[a-f0-9])/gi,_v={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function vv(t){return encodeURIComponent(t).replace(yv,(t,e)=>{var n;return null!==(n=_v[e])&&void 0!==n?n:t})}function wv(t){return`${t}`}class bv{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new gv,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(t=>{const i=t.indexOf("="),[r,s]=-1==i?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,i)),e.decodeValue(t.slice(i+1))],o=n.get(r)||[];o.push(s),n.set(r,o)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const i=t[n];Array.isArray(i)?i.forEach(t=>{e.push({param:n,value:t,op:"a"})}):e.push({param:n,value:i,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new bv({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(wv(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(wv(t.value));-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Tv{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}keys(){return this.map.keys()}}function Iv(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function Sv(t){return"undefined"!=typeof Blob&&t instanceof Blob}function Cv(t){return"undefined"!=typeof FormData&&t instanceof FormData}class Ev{constructor(t,e,n,i){let r;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,r=i):r=n,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.context&&(this.context=r.context),r.params&&(this.params=r.params)),this.headers||(this.headers=new mv),this.context||(this.context=new Tv),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new bv,this.urlWithParams=e}serializeBody(){return null===this.body?null:Iv(this.body)||Sv(this.body)||Cv(this.body)||function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof bv?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Cv(this.body)?null:Sv(this.body)?this.body.type||null:Iv(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof bv?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var e;const n=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let l=t.headers||this.headers,u=t.params||this.params;const c=null!==(e=t.context)&&void 0!==e?e:this.context;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),l)),t.setParams&&(u=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),u)),new Ev(n,i,s,{params:u,headers:l,context:c,reportProgress:a,responseType:r,withCredentials:o})}}var xv=(()=>((xv=xv||{})[xv.Sent=0]="Sent",xv[xv.UploadProgress=1]="UploadProgress",xv[xv.ResponseHeader=2]="ResponseHeader",xv[xv.DownloadProgress=3]="DownloadProgress",xv[xv.Response=4]="Response",xv[xv.User=5]="User",xv))();class kv{constructor(t,e=200,n="OK"){this.headers=t.headers||new mv,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class Av extends kv{constructor(t={}){super(t),this.type=xv.ResponseHeader}clone(t={}){return new Av({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Pv extends kv{constructor(t={}){super(t),this.type=xv.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Pv({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Nv extends kv{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function Dv(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Ov=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let i;if(t instanceof Ev)i=t;else{let r,s;r=n.headers instanceof mv?n.headers:new mv(n.headers),n.params&&(s=n.params instanceof bv?n.params:new bv({fromObject:n.params})),i=new Ev(t,e,void 0!==n.body?n.body:null,{headers:r,context:n.context,params:s,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const r=(0,Et.of)(i).pipe(dv(t=>this.handler.handle(t)));if(t instanceof Ev||"events"===n.observe)return r;const s=r.pipe(Bt(t=>t instanceof Pv));switch(n.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return s.pipe((0,Mt.U)(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return s.pipe((0,Mt.U)(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return s.pipe((0,Mt.U)(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));default:return s.pipe((0,Mt.U)(t=>t.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new bv).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,Dv(n,e))}post(t,e,n={}){return this.request("POST",t,Dv(n,e))}put(t,e,n={}){return this.request("PUT",t,Dv(n,e))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(pv))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class Rv{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const Lv=new i.OlP("HTTP_INTERCEPTORS");let Mv=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Fv=/^\)\]\}',?\n/;let Vv=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new St.y(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const i=t.serializeBody();let r=null;const s=()=>{if(null!==r)return r;const e=1223===n.status?204:n.status,i=n.statusText||"OK",s=new mv(n.getAllResponseHeaders()),o=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return r=new Av({headers:s,status:e,statusText:i,url:o}),r},o=()=>{let{headers:i,status:r,statusText:o,url:a}=s(),l=null;204!==r&&(l=void 0===n.response?n.responseText:n.response),0===r&&(r=l?200:0);let u=r>=200&&r<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(Fv,"");try{l=""!==l?JSON.parse(l):null}catch(c){l=t,u&&(u=!1,l={error:c,text:l})}}u?(e.next(new Pv({body:l,headers:i,status:r,statusText:o,url:a||void 0})),e.complete()):e.error(new Nv({error:l,headers:i,status:r,statusText:o,url:a||void 0}))},a=t=>{const{url:i}=s(),r=new Nv({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:i||void 0});e.error(r)};let l=!1;const u=i=>{l||(e.next(s()),l=!0);let r={type:xv.DownloadProgress,loaded:i.loaded};i.lengthComputable&&(r.total=i.total),"text"===t.responseType&&!!n.responseText&&(r.partialText=n.responseText),e.next(r)},c=t=>{let n={type:xv.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",o),n.addEventListener("error",a),n.addEventListener("timeout",a),n.addEventListener("abort",a),t.reportProgress&&(n.addEventListener("progress",u),null!==i&&n.upload&&n.upload.addEventListener("progress",c)),n.send(i),e.next({type:xv.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("abort",a),n.removeEventListener("load",o),n.removeEventListener("timeout",a),t.reportProgress&&(n.removeEventListener("progress",u),null!==i&&n.upload&&n.upload.removeEventListener("progress",c)),n.readyState!==n.DONE&&n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(H))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Uv=new i.OlP("XSRF_COOKIE_NAME"),jv=new i.OlP("XSRF_HEADER_NAME");class qv{}let zv=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=k(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o),i.LFG(i.Lbi),i.LFG(Uv))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Bv=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const i=this.tokenService.getToken();return null!==i&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,i)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(qv),i.LFG(jv))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Zv=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(Lv,[]);this.chain=t.reduceRight((t,e)=>new Rv(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(fv),i.LFG(i.zs3))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Hv=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:Bv,useClass:Mv}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:Uv,useValue:e.cookieName}:[],e.headerName?{provide:jv,useValue:e.headerName}:[]]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[Bv,{provide:Lv,useExisting:Bv,multi:!0},{provide:qv,useClass:zv},{provide:Uv,useValue:"XSRF-TOKEN"},{provide:jv,useValue:"X-XSRF-TOKEN"}]}),t})(),$v=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[Ov,{provide:pv,useClass:Zv},Vv,{provide:fv,useExisting:Vv}],imports:[[Hv.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})(),Wv=(()=>{class t{constructor(t){this.http=t,this.DATA_URL="assets/data.json",this.PAGE_SIZE=10}getAllData(){return this.http.get(this.DATA_URL)}getAllDataCount(){return this.getAllData().pipe((0,Mt.U)(t=>t.length))}getDataById(t){return this.getAllData().pipe((0,Mt.U)(e=>e.find(e=>e.id===t)))}getDataByTagCount(t){return this.getAllData().pipe((0,Mt.U)(e=>e.filter(e=>t?e.tags.includes(t):e).length))}getViewItems(t,e){const n=e*this.PAGE_SIZE;return(t?this._getDataByTag(t):this.getAllData()).pipe((0,Mt.U)(t=>t.slice(n,n+this.PAGE_SIZE)))}_getDataByTag(t){return this.getAllData().pipe((0,Mt.U)(e=>e.filter(e=>t?e.tags.includes(t):e)))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Ov))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Gv extends Ny.xQ{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new jy.N;return this._value}next(t){super.next(this._value=t)}}var Kv=n(9796);class Qv extends Dt.L{notifyNext(t,e,n,i,r){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class Yv extends Dt.L{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var Jv=n(7444);function Xv(t,e,n,i,r=new Yv(t,n,i)){if(!r.closed)return e instanceof St.y?e.subscribe(r):(0,Jv.s)(e)(r)}var tw=n(6693);const ew={};class nw{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new iw(t,this.resultSelector))}}class iw extends Qv{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(ew),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++)this.add(Xv(this,t[n],void 0,n))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n){const i=this.values,r=this.toRespond?i[n]===ew?--this.toRespond:this.toRespond:0;i[n]=e,0===r&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function rw(t){return new St.y(e=>{let n;try{n=t()}catch(i){return void e.error(i)}return(n?(0,Ct.D)(n):(0,Wy.c)()).subscribe(e)})}var sw=n(2441);function ow(t){return function(e){const n=new aw(t),i=e.lift(n);return n.caught=i}}class aw{constructor(t){this.selector=t}call(t,e){return e.subscribe(new lw(t,this.selector,this.caught))}}class lw extends Ry.Ds{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const i=new Ry.IY(this);this.add(i);const r=(0,Ry.ft)(n,i);r!==i&&this.add(r)}}}function uw(t){return function(e){return 0===t?(0,Wy.c)():e.lift(new cw(t))}}class cw{constructor(t){if(this.total=t,this.total<0)throw new $y}call(t,e){return e.subscribe(new hw(t,this.total))}}class hw extends Dt.L{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,i=this.count++;e.length<n?e.push(t):e[i%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,i=this.ring;for(let r=0;r<n;r++){const r=e++%n;t.next(i[r])}}t.complete()}}var dw=n(3342),pw=n(1307);class fw{constructor(t){this.callback=t}call(t,e){return e.subscribe(new mw(t,this.callback))}}class mw extends Dt.L{constructor(t,e){super(t),this.add(new Uy.w(e))}}class gw{constructor(t,e){this.id=t,this.url=e}}class yw extends gw{constructor(t,e,n="imperative",i=null){super(t,e),this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class _w extends gw{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class vw extends gw{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ww extends gw{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class bw extends gw{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Tw extends gw{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Iw extends gw{constructor(t,e,n,i,r){super(t,e),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Sw extends gw{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cw extends gw{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ew{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class xw{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class kw{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Aw{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pw{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Nw{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Dw{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Ow="primary";class Rw{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Lw(t){return new Rw(t)}const Mw="ngNavigationCancelingError";function Fw(t){const e=Error("NavigationCancelingError: "+t);return e[Mw]=!0,e}function Vw(t,e,n){const i=n.path.split("/");if(i.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||i.length<t.length))return null;const r={};for(let s=0;s<i.length;s++){const e=i[s],n=t[s];if(e.startsWith(":"))r[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function Uw(t,e){const n=t?Object.keys(t):void 0,i=e?Object.keys(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!jw(t[r],e[r]))return!1;return!0}function jw(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),i=[...e].sort();return n.every((t,e)=>i[e]===t)}return t===e}function qw(t){return Array.prototype.concat.apply([],t)}function zw(t){return t.length>0?t[t.length-1]:null}function Bw(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Zw(t){return(0,i.CqO)(t)?t:(0,i.QGY)(t)?(0,Ct.D)(Promise.resolve(t)):(0,Et.of)(t)}const Hw={exact:function t(e,n,i){if(!tb(e.segments,n.segments)||!Qw(e.segments,n.segments,i)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!e.children[r]||!t(e.children[r],n.children[r],i))return!1;return!0},subset:Gw},$w={exact:function(t,e){return Uw(t,e)},subset:function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>jw(t[n],e[n]))},ignored:()=>!0};function Ww(t,e,n){return Hw[n.paths](t.root,e.root,n.matrixParams)&&$w[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function Gw(t,e,n){return Kw(t,e,e.segments,n)}function Kw(t,e,n,i){if(t.segments.length>n.length){const r=t.segments.slice(0,n.length);return!(!tb(r,n)||e.hasChildren()||!Qw(r,n,i))}if(t.segments.length===n.length){if(!tb(t.segments,n)||!Qw(t.segments,n,i))return!1;for(const n in e.children)if(!t.children[n]||!Gw(t.children[n],e.children[n],i))return!1;return!0}{const r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(tb(t.segments,r)&&Qw(t.segments,r,i)&&t.children[Ow])&&Kw(t.children[Ow],e,s,i)}}function Qw(t,e,n){return e.every((e,i)=>$w[n](t[i].parameters,e.parameters))}class Yw{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lw(this.queryParams)),this._queryParamMap}toString(){return ib.serialize(this)}}class Jw{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Bw(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return rb(this)}}class Xw{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Lw(this.parameters)),this._parameterMap}toString(){return hb(this)}}function tb(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}class eb{}class nb{parse(t){const e=new gb(t);return new Yw(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${sb(t.root,!0)}`,n=function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${ab(e)}=${ab(t)}`).join("&"):`${ab(e)}=${ab(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(t.queryParams),i="string"==typeof t.fragment?`#${function(t){return encodeURI(t)}(t.fragment)}`:"";return`${e}${n}${i}`}}const ib=new nb;function rb(t){return t.segments.map(t=>hb(t)).join("/")}function sb(t,e){if(!t.hasChildren())return rb(t);if(e){const e=t.children[Ow]?sb(t.children[Ow],!1):"",n=[];return Bw(t.children,(t,e)=>{e!==Ow&&n.push(`${e}:${sb(t,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function(t,e){let n=[];return Bw(t.children,(t,i)=>{i===Ow&&(n=n.concat(e(t,i)))}),Bw(t.children,(t,i)=>{i!==Ow&&(n=n.concat(e(t,i)))}),n}(t,(e,n)=>n===Ow?[sb(t.children[Ow],!1)]:[`${n}:${sb(e,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Ow]?`${rb(t)}/${e[0]}`:`${rb(t)}/(${e.join("//")})`}}function ob(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ab(t){return ob(t).replace(/%3B/gi,";")}function lb(t){return ob(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ub(t){return decodeURIComponent(t)}function cb(t){return ub(t.replace(/\+/g,"%20"))}function hb(t){return`${lb(t.path)}${function(t){return Object.keys(t).map(e=>`;${lb(e)}=${lb(t[e])}`).join("")}(t.parameters)}`}const db=/^[^\/()?;=#]+/;function pb(t){const e=t.match(db);return e?e[0]:""}const fb=/^[^=?&#]+/,mb=/^[^?&#]+/;class gb{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Jw([],{}):new Jw([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[Ow]=new Jw(t,e)),n}parseSegment(){const t=pb(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Xw(ub(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=pb(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=pb(this.remaining);t&&(n=t,this.capture(n))}t[ub(e)]=ub(n)}parseQueryParam(t){const e=function(t){const e=t.match(fb);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(mb);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const i=cb(e),r=cb(n);if(t.hasOwnProperty(i)){let e=t[i];Array.isArray(e)||(e=[e],t[i]=e),e.push(r)}else t[i]=r}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=pb(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let r;n.indexOf(":")>-1?(r=n.substr(0,n.indexOf(":")),this.capture(r),this.capture(":")):t&&(r=Ow);const s=this.parseChildren();e[r]=1===Object.keys(s).length?s[Ow]:new Jw([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class yb{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=_b(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=_b(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=vb(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return vb(t,this._root).map(t=>t.value)}}function _b(t,e){if(t===e.value)return e;for(const n of e.children){const e=_b(t,n);if(e)return e}return null}function vb(t,e){if(t===e.value)return[e];for(const n of e.children){const i=vb(t,n);if(i.length)return i.unshift(e),i}return[]}class wb{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function bb(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Tb extends yb{constructor(t,e){super(t),this.snapshot=e,kb(this,t)}toString(){return this.snapshot.toString()}}function Ib(t,e){const n=function(t,e){const n=new Eb([],{},{},"",{},Ow,e,null,t.root,-1,{});return new xb("",new wb(n,[]))}(t,e),i=new Gv([new Xw("",{})]),r=new Gv({}),s=new Gv({}),o=new Gv({}),a=new Gv(""),l=new Sb(i,r,o,a,s,Ow,e,n.root);return l.snapshot=n.root,new Tb(new wb(l,[]),n)}class Sb{constructor(t,e,n,i,r,s,o,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Mt.U)(t=>Lw(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Mt.U)(t=>Lw(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Cb(t,e="emptyOnly"){const n=t.pathFromRoot;let i=0;if("always"!==e)for(i=n.length-1;i>=1;){const t=n[i],e=n[i-1];if(t.routeConfig&&""===t.routeConfig.path)i--;else{if(e.component)break;i--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class Eb{constructor(t,e,n,i,r,s,o,a,l,u,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Lw(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Lw(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class xb extends yb{constructor(t,e){super(e),this.url=t,kb(this,e)}toString(){return Ab(this._root)}}function kb(t,e){e.value._routerState=t,e.children.forEach(e=>kb(t,e))}function Ab(t){const e=t.children.length>0?` { ${t.children.map(Ab).join(", ")} } `:"";return`${t.value}${e}`}function Pb(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Uw(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),Uw(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Uw(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),Uw(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Nb(t,e){const n=Uw(t.params,e.params)&&function(t,e){return tb(t,e)&&t.every((t,n)=>Uw(t.parameters,e[n].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||Nb(t.parent,e.parent))}function Db(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=e.value;const r=function(t,e,n){return e.children.map(e=>{for(const i of n.children)if(t.shouldReuseRoute(e.value,i.value.snapshot))return Db(t,e,i);return Db(t,e)})}(t,e,n);return new wb(i,r)}{if(t.shouldAttach(e.value)){const n=t.retrieve(e.value);if(null!==n){const t=n.route;return Ob(e,t),t}}const n=function(t){return new Sb(new Gv(t.url),new Gv(t.params),new Gv(t.queryParams),new Gv(t.fragment),new Gv(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(e=>Db(t,e));return new wb(n,i)}}function Ob(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)Ob(t.children[n],e.children[n])}function Rb(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Lb(t){return"object"==typeof t&&null!=t&&t.outlets}function Mb(t,e,n,i,r){let s={};return i&&Bw(i,(t,e)=>{s[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new Yw(n.root===t?e:Fb(n.root,t,e),s,r)}function Fb(t,e,n){const i={};return Bw(t.children,(t,r)=>{i[r]=t===e?n:Fb(t,e,n)}),new Jw(t.segments,i)}class Vb{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&Rb(n[0]))throw new Error("Root segment cannot have matrix parameters");const i=n.find(Lb);if(i&&i!==zw(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Ub{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function jb(t,e,n){if(t||(t=new Jw([],{})),0===t.segments.length&&t.hasChildren())return qb(t,e,n);const i=function(t,e,n){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;const e=t.segments[r],o=n[i];if(Lb(o))break;const a=`${o}`,l=i<n.length-1?n[i+1]:null;if(r>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!Hb(a,l,e))return s;i+=2}else{if(!Hb(a,{},e))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const e=new Jw(t.segments.slice(0,i.pathIndex),{});return e.children[Ow]=new Jw(t.segments.slice(i.pathIndex),t.children),qb(e,0,r)}return i.match&&0===r.length?new Jw(t.segments,{}):i.match&&!t.hasChildren()?zb(t,e,n):i.match?qb(t,0,r):zb(t,e,n)}function qb(t,e,n){if(0===n.length)return new Jw(t.segments,{});{const i=function(t){return Lb(t[0])?t[0].outlets:{[Ow]:t}}(n),r={};return Bw(i,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(r[i]=jb(t.children[i],e,n))}),Bw(t.children,(t,e)=>{void 0===i[e]&&(r[e]=t)}),new Jw(t.segments,r)}}function zb(t,e,n){const i=t.segments.slice(0,e);let r=0;for(;r<n.length;){const s=n[r];if(Lb(s)){const t=Bb(s.outlets);return new Jw(i,t)}if(0===r&&Rb(n[0])){i.push(new Xw(t.segments[e].path,Zb(n[0]))),r++;continue}const o=Lb(s)?s.outlets[Ow]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&Rb(a)?(i.push(new Xw(o,Zb(a))),r+=2):(i.push(new Xw(o,{})),r++)}return new Jw(i,{})}function Bb(t){const e={};return Bw(t,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=zb(new Jw([],{}),0,t))}),e}function Zb(t){const e={};return Bw(t,(t,n)=>e[n]=`${t}`),e}function Hb(t,e,n){return t==n.path&&Uw(e,n.parameters)}class $b{constructor(t,e,n,i){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=i}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),Pb(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const i=bb(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,i[e],n),delete i[e]}),Bw(i,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(i===r)if(i.component){const r=n.getContext(i.outlet);r&&this.deactivateChildRoutes(t,e,r.children)}else this.deactivateChildRoutes(t,e,n);else r&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:i})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),i=n&&t.value.component?n.children:e,r=bb(t);for(const s of Object.keys(r))this.deactivateRouteAndItsChildren(r[s],i);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(t,e,n){const i=bb(e);t.children.forEach(t=>{this.activateRoutes(t,i[t.value.outlet],n),this.forwardEvent(new Nw(t.value.snapshot))}),t.children.length&&this.forwardEvent(new Aw(t.value.snapshot))}activateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(Pb(i),i===r)if(i.component){const r=n.getOrCreateContext(i.outlet);this.activateChildRoutes(t,e,r.children)}else this.activateChildRoutes(t,e,n);else if(i.component){const e=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const t=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Wb(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),r=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=i,e.resolver=r,e.outlet&&e.outlet.activateWith(i,r),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function Wb(t){Pb(t.value),t.children.forEach(Wb)}class Gb{constructor(t,e){this.routes=t,this.module=e}}function Kb(t){return"function"==typeof t}function Qb(t){return t instanceof Yw}const Yb=Symbol("INITIAL_VALUE");function Jb(){return Ly(t=>function(...t){let e,n;return(0,Pt.K)(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&(0,Kv.k)(t[0])&&(t=t[0]),(0,tw.n)(t,n).lift(new nw(e))}(t.map(t=>t.pipe(Gy(1),Nt(Yb)))).pipe(Ft((t,e)=>{let n=!1;return e.reduce((t,i,r)=>t!==Yb?t:(i===Yb&&(n=!0),n||!1!==i&&r!==e.length-1&&!Qb(i)?t:i),t)},Yb),Bt(t=>t!==Yb),(0,Mt.U)(t=>Qb(t)?t:!0===t),Gy(1)))}let Xb=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&i._UZ(0,"router-outlet")},directives:function(){return[QT]},encapsulation:2}),t})();function tT(t,e=""){for(let n=0;n<t.length;n++){const i=t[n];eT(i,nT(e,i))}}function eT(t,e){t.children&&tT(t.children,e)}function nT(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function iT(t){const e=t.children&&t.children.map(iT),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Ow&&(n.component=Xb),n}function rT(t){return t.outlet||Ow}function sT(t,e){const n=t.filter(t=>rT(t)===e);return n.push(...t.filter(t=>rT(t)!==e)),n}const oT={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function aT(t,e,n){var i;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},oT):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Vw)(n,t,e);if(!r)return Object.assign({},oT);const s={};Bw(r.posParams,(t,e)=>{s[e]=t.path});const o=r.consumed.length>0?Object.assign(Object.assign({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o,positionalParamSegments:null!==(i=r.posParams)&&void 0!==i?i:{}}}function lT(t,e,n,i,r="corrected"){if(n.length>0&&function(t,e,n){return n.some(n=>uT(t,e,n)&&rT(n)!==Ow)}(t,n,i)){const r=new Jw(e,function(t,e,n,i){const r={};r[Ow]=i,i._sourceSegment=t,i._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&rT(s)!==Ow){const n=new Jw([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,r[rT(s)]=n}return r}(t,e,i,new Jw(n,t.children)));return r._sourceSegment=t,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>uT(t,e,n))}(t,n,i)){const s=new Jw(t.segments,function(t,e,n,i,r,s){const o={};for(const a of i)if(uT(t,n,a)&&!r[rT(a)]){const n=new Jw([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===s?t.segments.length:e.length,o[rT(a)]=n}return Object.assign(Object.assign({},r),o)}(t,e,n,i,t.children,r));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}const s=new Jw(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function uT(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function cT(t,e,n,i){return!!(rT(t)===i||i!==Ow&&uT(e,n,t))&&("**"===t.path||aT(e,t,n).matched)}function hT(t,e,n){return 0===e.length&&!t.children[n]}class dT{constructor(t){this.segmentGroup=t||null}}class pT{constructor(t){this.urlTree=t}}function fT(t){return new St.y(e=>e.error(new dT(t)))}function mT(t){return new St.y(e=>e.error(new pT(t)))}function gT(t){return new St.y(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class yT{constructor(t,e,n,r,s){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(i.h0i)}apply(){const t=lT(this.urlTree.root,[],[],this.config).segmentGroup,e=new Jw(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,Ow).pipe((0,Mt.U)(t=>this.createUrlTree(_T(t),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ow(t=>{if(t instanceof pT)return this.allowRedirects=!1,this.match(t.urlTree);throw t instanceof dT?this.noMatchError(t):t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Ow).pipe((0,Mt.U)(e=>this.createUrlTree(_T(e),t.queryParams,t.fragment))).pipe(ow(t=>{throw t instanceof dT?this.noMatchError(t):t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const i=t.segments.length>0?new Jw([],{[Ow]:t}):t;return new Yw(i,e,n)}expandSegmentGroup(t,e,n,i){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe((0,Mt.U)(t=>new Jw([],t))):this.expandSegment(t,n,e,n.segments,i,!0)}expandChildren(t,e,n){const i=[];for(const r of Object.keys(n.children))"primary"===r?i.unshift(r):i.push(r);return(0,Ct.D)(i).pipe(dv(i=>{const r=n.children[i],s=sT(e,i);return this.expandSegmentGroup(t,s,r,i).pipe((0,Mt.U)(t=>({segment:t,outlet:i})))}),Ft((t,e)=>(t[e.outlet]=e.segment,t),{}),function(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Bt((e,n)=>t(e,n,i)):r_.y,uw(1),n?Yy(e):t_(()=>new Hy))}())}expandSegment(t,e,n,i,r,s){return(0,Ct.D)(n).pipe(dv(o=>this.expandSegmentAgainstRoute(t,e,n,o,i,r,s).pipe(ow(t=>{if(t instanceof dT)return(0,Et.of)(null);throw t}))),s_(t=>!!t),ow((t,n)=>{if(t instanceof Hy||"EmptyError"===t.name){if(hT(e,i,r))return(0,Et.of)(new Jw([],{}));throw new dT(e)}throw t}))}expandSegmentAgainstRoute(t,e,n,i,r,s,o){return cT(i,e,r,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,e,i,r,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s):fT(e):fT(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,i){const r=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?mT(r):this.lineralizeSegments(n,r).pipe((0,hv.zg)(n=>{const r=new Jw(n,{});return this.expandSegment(t,r,e,n,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:u}=aT(e,i,r);if(!o)return fT(e);const c=this.applyRedirectCommands(a,i.redirectTo,u);return i.redirectTo.startsWith("/")?mT(c):this.lineralizeSegments(i,c).pipe((0,hv.zg)(i=>this.expandSegment(t,e,n,i.concat(r.slice(l)),s,!1)))}matchSegmentAgainstRoute(t,e,n,i,r){if("**"===n.path)return n.loadChildren?(n._loadedConfig?(0,Et.of)(n._loadedConfig):this.configLoader.load(t.injector,n)).pipe((0,Mt.U)(t=>(n._loadedConfig=t,new Jw(i,{})))):(0,Et.of)(new Jw(i,{}));const{matched:s,consumedSegments:o,lastChild:a}=aT(e,n,i);if(!s)return fT(e);const l=i.slice(a);return this.getChildConfig(t,n,i).pipe((0,hv.zg)(t=>{const i=t.module,s=t.routes,{segmentGroup:a,slicedSegments:u}=lT(e,o,l,s),c=new Jw(a.segments,a.children);if(0===u.length&&c.hasChildren())return this.expandChildren(i,s,c).pipe((0,Mt.U)(t=>new Jw(o,t)));if(0===s.length&&0===u.length)return(0,Et.of)(new Jw(o,{}));const h=rT(n)===r;return this.expandSegment(i,c,s,u,h?Ow:r,!0).pipe((0,Mt.U)(t=>new Jw(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?(0,Et.of)(new Gb(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?(0,Et.of)(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe((0,hv.zg)(n=>n?this.configLoader.load(t.injector,e).pipe((0,Mt.U)(t=>(e._loadedConfig=t,t))):function(t){return new St.y(e=>e.error(Fw(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):(0,Et.of)(new Gb([],t))}runCanLoadGuards(t,e,n){const i=e.canLoad;if(!i||0===i.length)return(0,Et.of)(!0);const r=i.map(i=>{const r=t.get(i);let s;if(function(t){return t&&Kb(t.canLoad)}(r))s=r.canLoad(e,n);else{if(!Kb(r))throw new Error("Invalid CanLoad guard");s=r(e,n)}return Zw(s)});return(0,Et.of)(r).pipe(Jb(),(0,dw.b)(t=>{if(!Qb(t))return;const e=Fw(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),(0,Mt.U)(t=>!0===t))}lineralizeSegments(t,e){let n=[],i=e.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return(0,Et.of)(n);if(i.numberOfChildren>1||!i.children[Ow])return gT(t.redirectTo);i=i.children[Ow]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,i){const r=this.createSegmentGroup(t,e.root,n,i);return new Yw(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Bw(t,(t,i)=>{if("string"==typeof t&&t.startsWith(":")){const r=t.substring(1);n[i]=e[r]}else n[i]=t}),n}createSegmentGroup(t,e,n,i){const r=this.createSegments(t,e.segments,n,i);let s={};return Bw(e.children,(e,r)=>{s[r]=this.createSegmentGroup(t,e,n,i)}),new Jw(r,s)}createSegments(t,e,n,i){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,i):this.findOrReturn(e,n))}findPosParam(t,e,n){const i=n[e.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return i}findOrReturn(t,e){let n=0;for(const i of e){if(i.path===t.path)return e.splice(n),i;n++}return t}}function _T(t){const e={};for(const n of Object.keys(t.children)){const i=_T(t.children[n]);(i.segments.length>0||i.hasChildren())&&(e[n]=i)}return function(t){if(1===t.numberOfChildren&&t.children[Ow]){const e=t.children[Ow];return new Jw(t.segments.concat(e.segments),e.children)}return t}(new Jw(t.segments,e))}class vT{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class wT{constructor(t,e){this.component=t,this.route=e}}function bT(t,e,n){const i=t._root;return IT(i,e?e._root:null,n,[i.value])}function TT(t,e,n){const i=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:n).get(t)}function IT(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=bb(e);return t.children.forEach(t=>{(function(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!tb(t.url,e.url);case"pathParamsOrQueryParamsChange":return!tb(t.url,e.url)||!Uw(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Nb(t,e)||!Uw(t.queryParams,e.queryParams);default:return!Nb(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new vT(i)):(s.data=o.data,s._resolvedData=o._resolvedData),IT(t,e,s.component?a?a.children:null:n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new wT(a.outlet.component,o))}else o&&ST(e,a,r),r.canActivateChecks.push(new vT(i)),IT(t,null,s.component?a?a.children:null:n,i,r)})(t,s[t.value.outlet],n,i.concat([t.value]),r),delete s[t.value.outlet]}),Bw(s,(t,e)=>ST(t,n.getContext(e),r)),r}function ST(t,e,n){const i=bb(t),r=t.value;Bw(i,(t,i)=>{ST(t,r.component?e?e.children.getContext(i):null:e,n)}),n.canDeactivateChecks.push(new wT(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class CT{}function ET(t){return new St.y(e=>e.error(t))}class xT{constructor(t,e,n,i,r,s){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=i,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=s}recognize(){const t=lT(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,Ow);if(null===e)return null;const n=new Eb([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ow,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new wb(n,e),r=new xb(this.url,i);return this.inheritParamsAndData(r._root),r}inheritParamsAndData(t){const e=t.value,n=Cb(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=[];for(const r of Object.keys(e.children)){const i=e.children[r],s=sT(t,r),o=this.processSegmentGroup(s,i,r);if(null===o)return null;n.push(...o)}const i=AT(n);return function(t){t.sort((t,e)=>t.value.outlet===Ow?-1:e.value.outlet===Ow?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}processSegment(t,e,n,i){for(const r of t){const t=this.processSegmentAgainstRoute(r,e,n,i);if(null!==t)return t}return hT(e,n,i)?[]:null}processSegmentAgainstRoute(t,e,n,i){if(t.redirectTo||!cT(t,e,n,i))return null;let r,s=[],o=[];if("**"===t.path){const i=n.length>0?zw(n).parameters:{};r=new Eb(n,i,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DT(t),rT(t),t.component,t,PT(e),NT(e)+n.length,OT(t))}else{const i=aT(e,t,n);if(!i.matched)return null;s=i.consumedSegments,o=n.slice(i.lastChild),r=new Eb(s,i.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DT(t),rT(t),t.component,t,PT(e),NT(e)+s.length,OT(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:u}=lT(e,s,o,a.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution);if(0===u.length&&l.hasChildren()){const t=this.processChildren(a,l);return null===t?null:[new wb(r,t)]}if(0===a.length&&0===u.length)return[new wb(r,[])];const c=rT(t)===i,h=this.processSegment(a,l,u,c?Ow:i);return null===h?null:[new wb(r,h)]}}function kT(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function AT(t){const e=[],n=new Set;for(const i of t){if(!kT(i)){e.push(i);continue}const t=e.find(t=>i.value.routeConfig===t.value.routeConfig);void 0!==t?(t.children.push(...i.children),n.add(t)):e.push(i)}for(const i of n){const t=AT(i.children);e.push(new wb(i.value,t))}return e.filter(t=>!n.has(t))}function PT(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function NT(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function DT(t){return t.data||{}}function OT(t){return t.resolve||{}}function RT(t){return Ly(e=>{const n=t(e);return n?(0,Ct.D)(n).pipe((0,Mt.U)(()=>e)):(0,Et.of)(e)})}class LT extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const MT=new i.OlP("ROUTES");class FT{constructor(t,e,n,i){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=i}load(t,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const n=this.loadModuleFactory(e.loadChildren).pipe((0,Mt.U)(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new Gb(qw(r.injector.get(MT,void 0,i.XFs.Self|i.XFs.Optional)).map(iT),r)}),ow(t=>{throw e._loader$=void 0,t}));return e._loader$=new sw.c(n,()=>new Ny.xQ).pipe((0,pw.x)()),e._loader$}loadModuleFactory(t){return"string"==typeof t?(0,Ct.D)(this.loader.load(t)):Zw(t()).pipe((0,hv.zg)(t=>t instanceof i.YKP?(0,Et.of)(t):(0,Ct.D)(this.compiler.compileModuleAsync(t))))}}class VT{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new UT,this.attachRef=null}}class UT{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null,e.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new VT,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class jT{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function qT(t){throw t}function zT(t,e,n){return e.parse("/")}function BT(t,e){return(0,Et.of)(null)}const ZT={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},HT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let $T=(()=>{class t{constructor(t,e,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ny.xQ,this.errorHandler=qT,this.malformedUriErrorHandler=zT,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:BT,afterPreactivation:BT},this.urlHandlingStrategy=new jT,this.routeReuseStrategy=new LT,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=s.get(i.h0i),this.console=s.get(i.c2e);const u=s.get(i.R0b);this.isNgZoneEnabled=u instanceof i.R0b&&i.R0b.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=new Yw(new Jw([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new FT(o,a,t=>this.triggerEvent(new Ew(t)),t=>this.triggerEvent(new xw(t))),this.routerState=Ib(this.currentUrlTree,this.rootComponentType),this.transitions=new Gv({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const e=this.events;return t.pipe(Bt(t=>0!==t.id),(0,Mt.U)(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),Ly(t=>{let n=!1,i=!1;return(0,Et.of)(t).pipe((0,dw.b)(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ly(t=>{const n=this.browserUrlTree.toString(),r=!this.navigated||t.extractedUrl.toString()!==n||n!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||r)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return WT(t.source)&&(this.browserUrlTree=t.extractedUrl),(0,Et.of)(t).pipe(Ly(t=>{const n=this.transitions.getValue();return e.next(new yw(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?Wy.E:Promise.resolve(t)}),function(t,e,n,i){return Ly(r=>function(t,e,n,i,r){return new yT(t,e,n,i,r).apply()}(t,e,n,r.extractedUrl,i).pipe((0,Mt.U)(t=>Object.assign(Object.assign({},r),{urlAfterRedirects:t}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,dw.b)(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,s){return(0,hv.zg)(o=>function(t,e,n,r,s="emptyOnly",o="legacy"){try{const i=new xT(t,e,n,r,s,o).recognize();return null===i?ET(new CT):(0,Et.of)(i)}catch(i){return ET(i)}}(t,e,o.urlAfterRedirects,n(o.urlAfterRedirects),r,s).pipe((0,Mt.U)(t=>Object.assign(Object.assign({},o),{targetSnapshot:t}))))}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,dw.b)(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,t),this.browserUrlTree=t.urlAfterRedirects);const n=new bw(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));if(r&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:i,source:r,restoredState:s,extras:o}=t,a=new yw(n,this.serializeUrl(i),r,s);e.next(a);const l=Ib(i,this.rootComponentType).snapshot;return(0,Et.of)(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:i,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),Wy.E}),RT(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),(0,dw.b)(t=>{const e=new Tw(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),(0,Mt.U)(t=>Object.assign(Object.assign({},t),{guards:bT(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return(0,hv.zg)(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?(0,Et.of)(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,i){return(0,Ct.D)(t).pipe((0,hv.zg)(t=>function(t,e,n,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||0===s.length)return(0,Et.of)(!0);const o=s.map(s=>{const o=TT(s,e,r);let a;if(function(t){return t&&Kb(t.canDeactivate)}(o))a=Zw(o.canDeactivate(t,e,n,i));else{if(!Kb(o))throw new Error("Invalid CanDeactivate guard");a=Zw(o(t,e,n,i))}return a.pipe(s_())});return(0,Et.of)(o).pipe(Jb())}(t.component,t.route,n,e,i)),s_(t=>!0!==t,!0))}(o,i,r,t).pipe((0,hv.zg)(n=>n&&function(t){return"boolean"==typeof t}(n)?function(t,e,n,i){return(0,Ct.D)(e).pipe(dv(e=>At(function(t,e){return null!==t&&e&&e(new kw(t)),(0,Et.of)(!0)}(e.route.parent,i),function(t,e){return null!==t&&e&&e(new Pw(t)),(0,Et.of)(!0)}(e.route,i),function(t,e,n){const i=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>rw(()=>{const r=e.guards.map(r=>{const s=TT(r,e.node,n);let o;if(function(t){return t&&Kb(t.canActivateChild)}(s))o=Zw(s.canActivateChild(i,t));else{if(!Kb(s))throw new Error("Invalid CanActivateChild guard");o=Zw(s(i,t))}return o.pipe(s_())});return(0,Et.of)(r).pipe(Jb())}));return(0,Et.of)(r).pipe(Jb())}(t,e.path,n),function(t,e,n){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return(0,Et.of)(!0);const r=i.map(i=>rw(()=>{const r=TT(i,e,n);let s;if(function(t){return t&&Kb(t.canActivate)}(r))s=Zw(r.canActivate(e,t));else{if(!Kb(r))throw new Error("Invalid CanActivate guard");s=Zw(r(e,t))}return s.pipe(s_())}));return(0,Et.of)(r).pipe(Jb())}(t,e.route,n))),s_(t=>!0!==t,!0))}(i,s,t,e):(0,Et.of)(n)),(0,Mt.U)(t=>Object.assign(Object.assign({},n),{guardsResult:t})))})}(this.ngModule.injector,t=>this.triggerEvent(t)),(0,dw.b)(t=>{if(Qb(t.guardsResult)){const e=Fw(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}const e=new Iw(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),Bt(t=>!!t.guardsResult||(this.restoreHistory(t),this.cancelNavigationTransition(t,""),!1)),RT(t=>{if(t.guards.canActivateChecks.length)return(0,Et.of)(t).pipe((0,dw.b)(t=>{const e=new Sw(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),Ly(t=>{let e=!1;return(0,Et.of)(t).pipe(function(t,e){return(0,hv.zg)(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return(0,Et.of)(n);let s=0;return(0,Ct.D)(r).pipe(dv(n=>function(t,e,n,i){return function(t,e,n,i){const r=Object.keys(t);if(0===r.length)return(0,Et.of)({});const s={};return(0,Ct.D)(r).pipe((0,hv.zg)(r=>function(t,e,n,i){const r=TT(t,e,i);return Zw(r.resolve?r.resolve(e,n):r(e,n))}(t[r],e,n,i).pipe((0,dw.b)(t=>{s[r]=t}))),uw(1),(0,hv.zg)(()=>Object.keys(s).length===r.length?(0,Et.of)(s):Wy.E))}(t._resolve,t,e,i).pipe((0,Mt.U)(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Cb(t,n).resolve),null)))}(n.route,i,t,e)),(0,dw.b)(()=>s++),uw(1),(0,hv.zg)(t=>s===r.length?(0,Et.of)(n):Wy.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,dw.b)({next:()=>e=!0,complete:()=>{e||(this.restoreHistory(t),this.cancelNavigationTransition(t,"At least one route resolver didn't emit any value."))}}))}),(0,dw.b)(t=>{const e=new Cw(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),RT(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),(0,Mt.U)(t=>{const e=function(t,e,n){const i=Db(t,e._root,n?n._root:void 0);return new Tb(i,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),(0,dw.b)(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(t.urlAfterRedirects,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,t),this.browserUrlTree=t.urlAfterRedirects)}),((t,e,n)=>(0,Mt.U)(i=>(new $b(e,i.targetRouterState,i.currentRouterState,n).activate(t),i)))(this.rootContexts,this.routeReuseStrategy,t=>this.triggerEvent(t)),(0,dw.b)({next(){n=!0},complete(){n=!0}}),function(t){return e=>e.lift(new fw(t))}(()=>{var e;if(!n&&!i){const e=`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(t),this.cancelNavigationTransition(t,e)):this.cancelNavigationTransition(t,e)}(null===(e=this.currentNavigation)||void 0===e?void 0:e.id)===t.id&&(this.currentNavigation=null)}),ow(n=>{if(i=!0,function(t){return t&&t[Mw]}(n)){const i=Qb(n.url);i||(this.navigated=!0,this.restoreHistory(t,!0));const r=new vw(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(r),i?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree),i={skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||WT(t.source)};this.scheduleNavigation(e,"imperative",null,i,{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.restoreHistory(t,!0);const i=new ww(t.id,this.serializeUrl(t.extractedUrl),n);e.next(i);try{t.resolve(this.errorHandler(n))}catch(r){t.reject(r)}}return Wy.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:n,urlTree:i}=e,r={replaceUrl:!0};if(n){const t=Object.assign({},n);delete t.navigationId,delete t.\u0275routerPageId,0!==Object.keys(t).length&&(r.state=t)}this.scheduleNavigation(i,t,n,r)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const n=e.urlTree.toString()===t.urlTree.toString();return e.transitionId!==t.transitionId||!n||!("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){tT(t),this.config=t.map(iT),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,e={}){const{relativeTo:n,queryParams:i,fragment:r,queryParamsHandling:s,preserveFragment:o}=e,a=n||this.routerState.root,l=o?this.currentUrlTree.fragment:r;let u=null;switch(s){case"merge":u=Object.assign(Object.assign({},this.currentUrlTree.queryParams),i);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=i||null}return null!==u&&(u=this.removeEmptyProps(u)),function(t,e,n,i,r){if(0===n.length)return Mb(e.root,e.root,e,i,r);const s=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new Vb(!0,0,t);let e=0,n=!1;const i=t.reduce((t,i,r)=>{if("object"==typeof i&&null!=i){if(i.outlets){const e={};return Bw(i.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(i.segmentPath)return[...t,i.segmentPath]}return"string"!=typeof i?[...t,i]:0===r?(i.split("/").forEach((i,r)=>{0==r&&"."===i||(0==r&&""===i?n=!0:".."===i?e++:""!=i&&t.push(i))}),t):[...t,i]},[]);return new Vb(n,e,i)}(n);if(s.toRoot())return Mb(e.root,new Jw([],{}),e,i,r);const o=function(t,e,n){if(t.isAbsolute)return new Ub(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new Ub(t,t===e.root,0)}const i=Rb(t.commands[0])?0:1;return function(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new Ub(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(s,e,t),a=o.processChildren?qb(o.segmentGroup,o.index,s.commands):jb(o.segmentGroup,o.index,s.commands);return Mb(o.segmentGroup,a,e,i,r)}(a,this.currentUrlTree,t,u,null!=l?l:null)}navigateByUrl(t,e={skipLocationChange:!1}){const n=Qb(t)?t:this.parseUrl(t),i=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){let n;if(n=!0===e?Object.assign({},ZT):!1===e?Object.assign({},HT):e,Qb(t))return Ww(this.currentUrlTree,t,n);const i=this.parseUrl(t);return Ww(this.currentUrlTree,i,n)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return null!=i&&(e[n]=i),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new _w(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,e,n,i,r){var s,o;if(this.disposed)return Promise.resolve(!1);const a=this.getTransition(),l=WT(e)&&a&&!WT(a.source),u=(this.lastSuccessfulId===a.id||this.currentNavigation?a.rawUrl:a.urlAfterRedirects).toString()===t.toString();if(l&&u)return Promise.resolve(!0);let c,h,d;r?(c=r.resolve,h=r.reject,d=r.promise):d=new Promise((t,e)=>{c=t,h=e});const p=++this.navigationId;let f;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),f=n&&n.\u0275routerPageId?n.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?null!==(s=this.browserPageId)&&void 0!==s?s:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):f=0,this.setTransition({id:p,targetPageId:f,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:i,resolve:c,reject:h,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(t=>Promise.reject(t))}setBrowserUrl(t,e){const n=this.urlSerializer.serialize(t),i=Object.assign(Object.assign({},e.extras.state),this.generateNgRouterState(e.id,e.targetPageId));this.location.isCurrentPathEqualTo(n)||e.extras.replaceUrl?this.location.replaceState(n,"",i):this.location.go(n,"",i)}restoreHistory(t,e=!1){var n,i;if("computed"===this.canceledNavigationResolution){const e=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)||0===e?this.currentUrlTree===(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)&&0===e&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(e)}else"replace"===this.canceledNavigationResolution&&(e&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,e){const n=new vw(t.id,this.serializeUrl(t.extractedUrl),e);this.triggerEvent(n),t.resolve(!1)}generateNgRouterState(t,e){return"computed"===this.canceledNavigationResolution?{navigationId:t,"\u0275routerPageId":e}:{navigationId:t}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.DyG),i.LFG(eb),i.LFG(UT),i.LFG(b),i.LFG(i.zs3),i.LFG(i.v3s),i.LFG(i.Sil),i.LFG(void 0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function WT(t){return"imperative"!==t}let GT=(()=>{class t{constructor(t,e,n){this.router=t,this.route=e,this.locationStrategy=n,this.commands=[],this.onChanges=new Ny.xQ,this.subscription=t.events.subscribe(t=>{t instanceof _w&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,n,i,r){if(0!==t||e||n||i||r||"string"==typeof this.target&&"_self"!=this.target)return!0;const s={skipLocationChange:KT(this.skipLocationChange),replaceUrl:KT(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,s),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:KT(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36($T),i.Y36(Sb),i.Y36(g))},t.\u0275dir=i.lG2({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&i.NdJ("click",function(t){return e.onClick(t.button,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)}),2&t&&(i.Ikx("href",e.href,i.LSH),i.uIk("target",e.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[i.TTD]}),t})();function KT(t){return""===t||!!t}let QT=(()=>{class t{constructor(t,e,n,r,s){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new i.vpe,this.deactivateEvents=new i.vpe,this.name=r||Ow,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),i=this.parentContexts.getOrCreateContext(this.name).children,r=new YT(t,i,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(UT),i.Y36(i.s_b),i.Y36(i._Vd),i.$8M("name"),i.Y36(i.sBO))},t.\u0275dir=i.lG2({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class YT{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Sb?this.route:t===UT?this.childContexts:this.parent.get(t,e)}}class JT{}class XT{preload(t,e){return(0,Et.of)(null)}}let tI=(()=>{class t{constructor(t,e,n,i,r){this.router=t,this.injector=i,this.preloadingStrategy=r,this.loader=new FT(e,n,e=>t.triggerEvent(new Ew(e)),e=>t.triggerEvent(new xw(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(Bt(t=>t instanceof _w),dv(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(i.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const i of e)if(i.loadChildren&&!i.canLoad&&i._loadedConfig){const t=i._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else i.loadChildren&&!i.canLoad?n.push(this.preloadConfig(t,i)):i.children&&n.push(this.processRoutes(t,i.children));return(0,Ct.D)(n).pipe((0,kt.J)(),(0,Mt.U)(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>(e._loadedConfig?(0,Et.of)(e._loadedConfig):this.loader.load(t.injector,e)).pipe((0,hv.zg)(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG($T),i.LFG(i.v3s),i.LFG(i.Sil),i.LFG(i.zs3),i.LFG(JT))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),eI=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof yw?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof _w&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Dw&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new Dw(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG($T),i.LFG(z),i.LFG(void 0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const nI=new i.OlP("ROUTER_CONFIGURATION"),iI=new i.OlP("ROUTER_FORROOT_GUARD"),rI=[b,{provide:eb,useClass:nb},{provide:$T,useFactory:function(t,e,n,i,r,s,o,a={},l,u){const c=new $T(null,t,e,n,i,r,s,qw(o));return l&&(c.urlHandlingStrategy=l),u&&(c.routeReuseStrategy=u),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(a,c),a.enableTracing&&c.events.subscribe(t=>{var e,n;null===(e=console.group)||void 0===e||e.call(console,`Router Event: ${t.constructor.name}`),console.log(t.toString()),console.log(t),null===(n=console.groupEnd)||void 0===n||n.call(console)}),c},deps:[eb,UT,b,i.zs3,i.v3s,i.Sil,MT,nI,[class{},new i.FiY],[class{},new i.FiY]]},UT,{provide:Sb,useFactory:function(t){return t.routerState.root},deps:[$T]},{provide:i.v3s,useClass:i.EAV},tI,XT,class{preload(t,e){return e().pipe(ow(()=>(0,Et.of)(null)))}},{provide:nI,useValue:{enableTracing:!1}}];function sI(){return new i.PXZ("Router",$T)}let oI=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[rI,cI(e),{provide:iI,useFactory:uI,deps:[[$T,new i.FiY,new i.tp0]]},{provide:nI,useValue:n||{}},{provide:g,useFactory:lI,deps:[a,[new i.tBr(_),new i.FiY],nI]},{provide:eI,useFactory:aI,deps:[$T,z,nI]},{provide:JT,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:XT},{provide:i.PXZ,multi:!0,useFactory:sI},[hI,{provide:i.ip1,multi:!0,useFactory:dI,deps:[hI]},{provide:fI,useFactory:pI,deps:[hI]},{provide:i.tb,multi:!0,useExisting:fI}]]}}static forChild(e){return{ngModule:t,providers:[cI(e)]}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(iI,8),i.LFG($T,8))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();function aI(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new eI(t,e,n)}function lI(t,e,n={}){return n.useHash?new w(t,e):new v(t,e)}function uI(t){return"guarded"}function cI(t){return[{provide:i.deG,multi:!0,useValue:t},{provide:MT,multi:!0,useValue:t}]}let hI=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Ny.xQ}appInitializer(){return this.injector.get(u,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let t=null;const e=new Promise(e=>t=e),n=this.injector.get($T),i=this.injector.get(nI);return"disabled"===i.initialNavigation?(n.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?(0,Et.of)(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()):t(!0),e})}bootstrapListener(t){const e=this.injector.get(nI),n=this.injector.get(tI),r=this.injector.get(eI),s=this.injector.get($T),o=this.injector.get(i.z2F);t===o.components[0]&&(("enabledNonBlocking"===e.initialNavigation||void 0===e.initialNavigation)&&s.initialNavigation(),n.setUpPreloading(),r.init(),s.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.zs3))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function dI(t){return t.appInitializer.bind(t)}function pI(t){return t.bootstrapListener.bind(t)}const fI=new i.OlP("Router Initializer"),mI=function(){return["/"]},gI=function(){return["/map"]},yI=function(){return["/about"]};let _I=(()=>{class t{constructor(t,e){this._dataService=t,this._router=e,this.entriesCount=0,this._dataService.getAllDataCount().subscribe(t=>{this.entriesCount=t})}navigateToRandom(){const t=Math.ceil(Math.random()*this.entriesCount).toString();this._router.routeReuseStrategy.shouldReuseRoute=()=>!1,this._router.onSameUrlNavigation="reload",this._router.navigate([`/wpis/${t}`])}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Wv),i.Y36($T))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-header"]],decls:17,vars:6,consts:[[1,"container","py-3"],[1,"d-flex","align-items-center","justify-content-between"],[3,"routerLink"],[1,"d-flex","flex-column","flex-sm-row"],[1,"d-none","d-sm-flex","mx-2"],[3,"click"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"a",2),i.TgZ(3,"div",3),i.TgZ(4,"span"),i._uU(5,"POZNA\u0143"),i.qZA(),i.TgZ(6,"span",4),i._uU(7,"|"),i.qZA(),i.TgZ(8,"span"),i._uU(9,"dawniej & dzi\u015b"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(10,"nav"),i.TgZ(11,"a",2),i._uU(12,"MAPA"),i.qZA(),i.TgZ(13,"a",5),i.NdJ("click",function(){return e.navigateToRandom()}),i._uU(14,"LOSUJ"),i.qZA(),i.TgZ(15,"a",2),i._uU(16,"O BLOGU"),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.Q6J("routerLink",i.DdM(3,mI)),i.xp6(9),i.Q6J("routerLink",i.DdM(4,gI)),i.xp6(4),i.Q6J("routerLink",i.DdM(5,yI)))},directives:[GT],styles:["a[_ngcontent-%COMP%]{color:#fff!important;cursor:pointer;text-decoration:none}a[_ngcontent-%COMP%]:not(:last-child){margin-right:1rem}"]}),t})();var vI=n(1555);function wI(t,e){return new St.y(n=>{const i=t.length;if(0===i)return void n.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=(0,Ct.D)(t[a]);let u=!1;n.add(l.subscribe({next:t=>{u||(u=!0,o++),r[a]=t},error:t=>n.error(t),complete:()=>{s++,(s===i||!u)&&(o===i&&n.next(e?e.reduce((t,e,n)=>(t[e]=r[n],t),{}):r),n.complete())}}))}})}let bI=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}setProperty(t,e){this._renderer.setProperty(this._elementRef.nativeElement,t,e)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.Qsj),i.Y36(i.SBq))},t.\u0275dir=i.lG2({type:t}),t})(),TI=(()=>{class t extends bI{}return t.\u0275fac=function(){let e;return function(n){return(e||(e=i.n5z(t)))(n||t)}}(),t.\u0275dir=i.lG2({type:t,features:[i.qOj]}),t})();const II=new i.OlP("NgValueAccessor"),SI={provide:II,useExisting:(0,i.Gpc)(()=>EI),multi:!0},CI=new i.OlP("CompositionEventMode");let EI=(()=>{class t extends bI{constructor(t,e,n){super(t,e),this._compositionMode=n,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=s()?s().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.Qsj),i.Y36(i.SBq),i.Y36(CI,8))},t.\u0275dir=i.lG2({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&i.NdJ("input",function(t){return e._handleInput(t.target.value)})("blur",function(){return e.onTouched()})("compositionstart",function(){return e._compositionStart()})("compositionend",function(t){return e._compositionEnd(t.target.value)})},features:[i._Bn([SI]),i.qOj]}),t})();const xI=new i.OlP("NgValidators"),kI=new i.OlP("NgAsyncValidators");function AI(t){return null!=t}function PI(t){const e=(0,i.QGY)(t)?(0,Ct.D)(t):t;return(0,i.CqO)(e),e}function NI(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function DI(t,e){return e.map(e=>e(t))}function OI(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}function RI(t){return null!=t?function(t){if(!t)return null;const e=t.filter(AI);return 0==e.length?null:function(t){return NI(DI(t,e))}}(OI(t)):null}function LI(t){return null!=t?function(t){if(!t)return null;const e=t.filter(AI);return 0==e.length?null:function(t){return function(...t){if(1===t.length){const e=t[0];if((0,Kv.k)(e))return wI(e,null);if((0,vI.K)(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return wI(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return wI(t=1===t.length&&(0,Kv.k)(t[0])?t[0]:t,null).pipe((0,Mt.U)(t=>e(...t)))}return wI(t,null)}(DI(t,e).map(PI)).pipe((0,Mt.U)(NI))}}(OI(t)):null}function MI(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function FI(t){return t._rawValidators}function VI(t){return t._rawAsyncValidators}function UI(t){return t?Array.isArray(t)?t:[t]:[]}function jI(t,e){return Array.isArray(t)?t.includes(e):t===e}function qI(t,e){const n=UI(e);return UI(t).forEach(t=>{jI(n,t)||n.push(t)}),n}function zI(t,e){return UI(e).filter(e=>!jI(t,e))}let BI=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=RI(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=LI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t}),t})(),ZI=(()=>{class t extends BI{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=i.n5z(t)))(n||t)}}(),t.\u0275dir=i.lG2({type:t,features:[i.qOj]}),t})();class HI extends BI{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class $I{constructor(t){this._cd=t}is(t){var e,n,i;return"submitted"===t?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(i=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===i?void 0:i[t])}}let WI=(()=>{class t extends $I{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(HI,2))},t.\u0275dir=i.lG2({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&i.ekj("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))},features:[i.qOj]}),t})(),GI=(()=>{class t extends $I{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(ZI,10))},t.\u0275dir=i.lG2({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,e){2&t&&i.ekj("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))("ng-submitted",e.is("submitted"))},features:[i.qOj]}),t})();function KI(t,e){(function(t,e){const n=FI(t);null!==e.validator?t.setValidators(MI(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const i=VI(t);null!==e.asyncValidator?t.setAsyncValidators(MI(i,e.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();YI(e._rawValidators,r),YI(e._rawAsyncValidators,r)})(t,e),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&JI(t,e)})}(t,e),function(t,e){const n=(t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&JI(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function(t,e){if(e.valueAccessor.setDisabledState){const n=t=>{e.valueAccessor.setDisabledState(t)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function QI(t,e,n=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),function(t,e){let n=!1;if(null!==t){if(null!==e.validator){const i=FI(t);if(Array.isArray(i)&&i.length>0){const r=i.filter(t=>t!==e.validator);r.length!==i.length&&(n=!0,t.setValidators(r))}}if(null!==e.asyncValidator){const i=VI(t);if(Array.isArray(i)&&i.length>0){const r=i.filter(t=>t!==e.asyncValidator);r.length!==i.length&&(n=!0,t.setAsyncValidators(r))}}}const i=()=>{};YI(e._rawValidators,i),YI(e._rawAsyncValidators,i)}(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function YI(t,e){t.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function JI(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function XI(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const tS="VALID",eS="INVALID",nS="PENDING",iS="DISABLED";function rS(t){return(lS(t)?t.validators:t)||null}function sS(t){return Array.isArray(t)?RI(t):t||null}function oS(t,e){return(lS(e)?e.asyncValidators:t)||null}function aS(t){return Array.isArray(t)?LI(t):t||null}function lS(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class uS{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=sS(this._rawValidators),this._composedAsyncValidatorFn=aS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===tS}get invalid(){return this.status===eS}get pending(){return this.status==nS}get disabled(){return this.status===iS}get enabled(){return this.status!==iS}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=sS(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=aS(t)}addValidators(t){this.setValidators(qI(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(qI(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(zI(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(zI(t,this._rawAsyncValidators))}hasValidator(t){return jI(this._rawValidators,t)}hasAsyncValidator(t){return jI(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=nS,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=iS,this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=tS,this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===tS||this.status===nS)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?iS:tS}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=nS,this._hasOwnPendingAsyncValidator=!0;const e=PI(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e||(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length))return null;let i=t;return e.forEach(t=>{i=i instanceof hS?i.controls.hasOwnProperty(t)?i.controls[t]:null:i instanceof dS&&i.at(t)||null}),i}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new i.vpe,this.statusChanges=new i.vpe}_calculateStatus(){return this._allControlsDisabled()?iS:this.errors?eS:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(nS)?nS:this._anyControlsHaveStatus(eS)?eS:tS}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){lS(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class cS extends uS{constructor(t=null,e,n){super(rS(e),oS(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){XI(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){XI(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class hS extends uS{constructor(t,e,n){super(rS(e),oS(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof cS?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,i)=>{n=e(n,t,i)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class dS extends uS{constructor(t,e,n){super(rS(e),oS(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof cS?t.value:t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}let pS=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})(),fS=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();const mS=new i.OlP("NgModelWithFormControlWarning"),gS={provide:HI,useExisting:(0,i.Gpc)(()=>yS)};let yS=(()=>{class t extends HI{constructor(t,e,n,r){super(),this._ngModelWarningConfig=r,this.update=new i.vpe,this._ngModelWarningSent=!1,this._setValidators(t),this._setAsyncValidators(e),this.valueAccessor=function(t,e){if(!e)return null;let n,i,r;return Array.isArray(e),e.forEach(t=>{t.constructor===EI?n=t:function(t){return Object.getPrototypeOf(t.constructor)===TI}(t)?i=t:r=t}),r||i||n||null}(0,n)}set isDisabled(t){}ngOnChanges(t){if(this._isControlChanged(t)){const e=t.form.previousValue;e&&QI(e,this,!1),KI(this.form,this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this.form.updateValueAndValidity({emitEvent:!1})}(function(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)})(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&QI(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(xI,10),i.Y36(kI,10),i.Y36(II,10),i.Y36(mS,8))},t.\u0275dir=i.lG2({type:t,selectors:[["","formControl",""]],inputs:{isDisabled:["disabled","isDisabled"],form:["formControl","form"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[i._Bn([gS]),i.qOj,i.TTD]}),t._ngModelWarningSentOnce=!1,t})(),_S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[fS]]}),t})(),vS=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:mS,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[_S]}),t})();var wS=n(8819);class bS{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new TS(t,this.observables,this.project))}}class TS extends Qv{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const i=e.length;this.values=new Array(i);for(let r=0;r<i;r++)this.toRespond.push(r);for(let r=0;r<i;r++)this.add(Xv(this,e[r],void 0,r))}notifyNext(t,e,n){this.values[n]=e;const i=this.toRespond;if(i.length>0){const t=i.indexOf(n);-1!==t&&i.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}class IS{constructor(t){this.predicate=t}call(t,e){return e.subscribe(new SS(t,this.predicate))}}class SS extends Dt.L{constructor(t,e){super(t),this.predicate=e,this.skipping=!0,this.index=0}_next(t){const e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)}tryCallPredicate(t){try{const e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(e){this.destination.error(e)}}}const CS="@firebase/database";let ES="";function xS(t){ES=t}class kS{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,Jt.Wl)(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,Jt.cI)(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class AS{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return(0,Jt.r3)(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const PS=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new kS(e)}}catch(e){}return new AS},NS=PS("localStorage"),DS=PS("sessionStorage"),OS=new Yt.Yd("@firebase/database"),RS=function(){let t=1;return function(){return t++}}(),LS=function(t){const e=(0,Jt.dS)(t),n=new Jt.gQ;n.update(e);const i=n.digest();return Jt.US.encodeByteArray(i)},MS=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=MS.apply(null,i):e+="object"==typeof i?(0,Jt.Wl)(i):i,e+=" "}return e};let FS=null,VS=!0;const US=function(t,e){(0,Jt.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(OS.logLevel=Yt.in.VERBOSE,FS=OS.log.bind(OS),e&&DS.set("logging_enabled",!0)):"function"==typeof t?FS=t:(FS=null,DS.remove("logging_enabled"))},jS=function(...t){if(!0===VS&&(VS=!1,null===FS&&!0===DS.get("logging_enabled")&&US(!0)),FS){const e=MS.apply(null,t);FS(e)}},qS=function(t){return function(...e){jS(t,...e)}},zS=function(...t){const e="FIREBASE INTERNAL ERROR: "+MS(...t);OS.error(e)},BS=function(...t){const e=`FIREBASE FATAL ERROR: ${MS(...t)}`;throw OS.error(e),new Error(e)},ZS=function(...t){const e="FIREBASE WARNING: "+MS(...t);OS.warn(e)},HS=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},$S="[MIN_NAME]",WS="[MAX_NAME]",GS=function(t,e){if(t===e)return 0;if(t===$S||e===WS)return-1;if(e===$S||t===WS)return 1;{const n=nC(t),i=nC(e);return null!==n?null!==i?n-i==0?t.length-e.length:n-i:-1:null!==i?1:t<e?-1:1}},KS=function(t,e){return t===e?0:t<e?-1:1},QS=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,Jt.Wl)(e))},YS=function(t){if("object"!=typeof t||null===t)return(0,Jt.Wl)(t);const e=[];for(const i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)0!==i&&(n+=","),n+=(0,Jt.Wl)(e[i]),n+=":",n+=YS(t[e[i]]);return n+="}",n},JS=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let r=0;r<n;r+=e)i.push(t.substring(r,r+e>n?n:r+e));return i};function XS(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const tC=function(t){(0,Jt.hu)(!HS(t),"Invalid JSON number");const e=1023;let n,i,r,s,o;0===t?(i=0,r=0,n=1/t==-1/0?1:0):(n=t<0,(t=Math.abs(t))>=Math.pow(2,1-e)?(s=Math.min(Math.floor(Math.log(t)/Math.LN2),e),i=s+e,r=Math.round(t*Math.pow(2,52-s)-Math.pow(2,52))):(i=0,r=Math.round(t/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);a.push(n?1:0),a.reverse();const l=a.join("");let u="";for(o=0;o<64;o+=8){let t=parseInt(l.substr(o,8),2).toString(16);1===t.length&&(t="0"+t),u+=t}return u.toLowerCase()},eC=new RegExp("^-?(0*)\\d{1,10}$"),nC=function(t){if(eC.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},iC=function(t){try{t()}catch(e){setTimeout(()=>{throw ZS("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},rC=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class sC{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then(t=>this.appCheck=t)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((e,n)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,n):e(null)},0)})}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(e=>e.addTokenListener(t))}notifyForInvalidToken(){ZS(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class oC{constructor(t,e,n){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(t=>this.auth_=t)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(t=>t&&"auth/token-not-initialized"===t.code?(jS("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((e,n)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,n):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ZS(t)}}let aC=(()=>{class t{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return t.OWNER="owner",t})();const lC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,uC="websocket",cC="long_polling";class hC{constructor(t,e,n,i,r=!1,s="",o=!1){this.secure=e,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=NS.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&NS.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function dC(t,e,n){let i;if((0,Jt.hu)("string"==typeof e,"typeof type must == string"),(0,Jt.hu)("object"==typeof n,"typeof params must == object"),e===uC)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==cC)throw new Error("Unknown connection type: "+e);i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const r=[];return XS(n,(t,e)=>{r.push(t+"="+e)}),i+r.join("&")}class pC{constructor(){this.counters_={}}incrementCounter(t,e=1){(0,Jt.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return(0,Jt.p$)(this.counters_)}}const fC={},mC={};function gC(t){const e=t.toString();return fC[e]||(fC[e]=new pC),fC[e]}class yC{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const t=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let e=0;e<t.length;++e)t[e]&&iC(()=>{this.onMessage_(t[e])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class _C{constructor(t,e,n,i,r,s,o){this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=qS(t),this.stats_=gC(e),this.urlFn=t=>(this.appCheckToken&&(t.ac=this.appCheckToken),dC(e,cC,t))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new yC(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if((0,Jt.Yr)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new vC((...t)=>{const[e,n,i,r,s]=t;if(this.incrementIncomingBytes_(t),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===e)this.id=n,this.password=i;else{if("close"!==e)throw new Error("Unrecognized command received: "+e);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,()=>{this.onClosed_()})):this.onClosed_()}},(...t)=>{const[e,n]=t;this.incrementIncomingBytes_(t),this.myPacketOrderer.handleResponse(e,n)},()=>{this.onClosed_()},this.urlFn);const t={start:"t"};t.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=this.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",this.transportSessionId&&(t.s=this.transportSessionId),this.lastSessionId&&(t.ls=this.lastSessionId),this.applicationId&&(t.p=this.applicationId),this.appCheckToken&&(t.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&lC.test(location.hostname)&&(t.r="f");const e=this.urlFn(t);this.log_("Connecting via long-poll to "+e),this.scriptTagHolder.addTag(e,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_C.forceAllow_=!0}static forceDisallow(){_C.forceDisallow_=!0}static isAvailable(){return!((0,Jt.Yr)()||!_C.forceAllow_&&(_C.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=(0,Jt.Wl)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=(0,Jt.h$)(e),i=JS(n,1840);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if((0,Jt.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=(0,Jt.Wl)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class vC{constructor(t,e,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,Jt.Yr)())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=RS(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=vC.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(r){jS("frame writing exception"),r.stack&&jS(r.stack),jS(r)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||jS("No IE domain setting required")}catch(e){const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const t=this.pendingSegs.shift();n=n+"&seg"+i+"="+t.seg+"&ts"+i+"="+t.ts+"&d"+i+"="+t.d,i++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const n=()=>{this.outstandingRequests.delete(e),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(t,()=>{clearTimeout(i),n()})}addTag(t,e){(0,Jt.Yr)()?this.doNodeLongPoll(t,e):setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const t=n.readyState;(!t||"loaded"===t||"complete"===t)&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),e())},n.onerror=()=>{jS("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}},Math.floor(1))}}let wC=null;"undefined"!=typeof MozWebSocket?wC=MozWebSocket:"undefined"!=typeof WebSocket&&(wC=WebSocket);let bC=(()=>{class t{constructor(e,n,i,r,s,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=qS(this.connId),this.stats_=gC(n),this.connURL=t.connectionURL_(n,o,a,r,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(t,e,n,i,r){const s={v:"5"};return!(0,Jt.Yr)()&&"undefined"!=typeof location&&location.hostname&&lC.test(location.hostname)&&(s.r="f"),e&&(s.s=e),n&&(s.ls=n),i&&(s.ac=i),r&&(s.p=r),dC(t,uC,s)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,NS.set("previous_websocket_failure",!0);try{let t;if((0,Jt.Yr)()){t={headers:{"User-Agent":`Firebase/5/${ES}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(t.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(t.headers["X-Firebase-AppCheck"]=this.appCheckToken);const e=process.env,n=0===this.connURL.indexOf("wss://")?e.HTTPS_PROXY||e.https_proxy:e.HTTP_PROXY||e.http_proxy;n&&(t.proxy={origin:n})}this.mySock=new wC(this.connURL,[],t)}catch(n){this.log_("Error instantiating WebSocket.");const t=n.message||n.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=t=>{this.handleIncomingFrame(t)},this.mySock.onerror=t=>{this.log_("WebSocket error.  Closing connection.");const e=t.message||t.data;e&&this.log_(e),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);t&&t.length>1&&parseFloat(t[1])<4.4&&(e=!0)}return!e&&null!==wC&&!t.forceDisallow_}static previouslyFailed(){return NS.isInMemoryStorage||!0===NS.get("previous_websocket_failure")}markConnectionHealthy(){NS.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const e=(0,Jt.cI)(t);this.onMessage(e)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,Jt.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{const t=this.extractFrameCount_(e);null!==t&&this.appendFrame_(t)}}send(t){this.resetKeepAlive();const e=(0,Jt.Wl)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=JS(e,16384);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),TC=(()=>{class t{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[_C,bC]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=bC&&bC.isAvailable();let i=n&&!bC.previouslyFailed();if(e.webSocketOnly&&(n||ZS("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[bC];else{const e=this.transports_=[];for(const n of t.ALL_TRANSPORTS)n&&n.isAvailable()&&e.push(n);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return t.globalTransportInitialized_=!1,t})();class IC{constructor(t,e,n,i,r,s,o,a,l,u){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=qS("c:"+this.id+":"),this.transportManager_=new TC(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,n)},Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=rC(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){this.sendData_({t:"d",d:t})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=QS("t",t),n=QS("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=QS("t",t),n=QS("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=QS("t",t);if("d"in t){const n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let t=0;t<this.pendingDataMessages.length;++t)this.onDataMessage_(this.pendingDataMessages[t]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?zS("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):zS("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&ZS("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,n),rC(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):rC(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(NS.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class SC{put(t,e,n,i){}merge(t,e,n,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,n){}onDisconnectMerge(t,e,n){}onDisconnectCancel(t,e){}reportStats(t){}}class CC{constructor(t){this.allowedEvents_=t,this.listeners_={},(0,Jt.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let t=0;t<n.length;t++)n[t].callback.apply(n[t].context,e)}}on(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});const i=this.getInitialEvent(t);i&&e.apply(n,i)}off(t,e,n){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let r=0;r<i.length;r++)if(i[r].callback===e&&(!n||n===i[r].context))return void i.splice(r,1)}validateEventType_(t){(0,Jt.hu)(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}class EC extends CC{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,Jt.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new EC}getInitialEvent(t){return(0,Jt.hu)("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class xC{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let e=0;for(let t=0;t<this.pieces_.length;t++)this.pieces_[t].length>0&&(this.pieces_[e]=this.pieces_[t],e++);this.pieces_.length=e,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function kC(){return new xC("")}function AC(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function PC(t){return t.pieces_.length-t.pieceNum_}function NC(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new xC(t.pieces_,e)}function DC(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function OC(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function RC(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new xC(e,0)}function LC(t,e){const n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof xC)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{const t=e.split("/");for(let e=0;e<t.length;e++)t[e].length>0&&n.push(t[e])}return new xC(n,0)}function MC(t){return t.pieceNum_>=t.pieces_.length}function FC(t,e){const n=AC(t),i=AC(e);if(null===n)return e;if(n===i)return FC(NC(t),NC(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function VC(t,e){const n=OC(t,0),i=OC(e,0);for(let r=0;r<n.length&&r<i.length;r++){const t=GS(n[r],i[r]);if(0!==t)return t}return n.length===i.length?0:n.length<i.length?-1:1}function UC(t,e){if(PC(t)!==PC(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function jC(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(PC(t)>PC(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class qC{constructor(t,e){this.errorPrefix_=e,this.parts_=OC(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,Jt.ug)(this.parts_[n]);zC(this)}}function zC(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+BC(t))}function BC(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class ZC extends CC{constructor(){let t,e;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const e=!document[t];e!==this.visible_&&(this.visible_=e,this.trigger("visible",e))},!1)}static getInstance(){return new ZC}getInitialEvent(t){return(0,Jt.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]}}const HC=1e3;let $C,WC=(()=>{class t extends SC{constructor(e,n,i,r,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=qS("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=HC,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,Jt.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ZC.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&EC.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,n){const i=++this.requestNumber_,r={r:i,a:t,b:e};this.log_((0,Jt.Wl)(r)),(0,Jt.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)}get(t){this.initConnection_();const e=new Jt.BH,n={p:t._path.toString(),q:t._queryObject};return this.outstandingGets_.push({action:"g",request:n,onComplete:t=>{const n=t.d;"ok"===t.s?e.resolve(n):e.reject(n)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),e.promise}listen(t,e,n,i){this.initConnection_();const r=t._queryIdentifier,s=t._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),(0,Jt.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,Jt.hu)(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:e,query:t,tag:n};this.listens.get(s).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(n)})}sendListen_(e){const n=e.query,i=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+i+" for "+r);const s={p:i};e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest("q",s,s=>{const o=s.d,a=s.s;t.warnOnListenWarnings_(o,n),(this.listens.get(i)&&this.listens.get(i).get(r))===e&&(this.log_("listen response",s),"ok"!==a&&this.removeListen_(i,r),e.onComplete&&e.onComplete(a,o))})}static warnOnListenWarnings_(t,e){if(t&&"object"==typeof t&&(0,Jt.r3)(t,"w")){const n=(0,Jt.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const t='".indexOn": "'+e._queryParams.getIndex().toString()+'"',n=e._path.toString();ZS(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${t} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,Jt.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=(0,Jt.w9)(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(e,n,e=>{const n=e.s,i=e.d||"error";this.authToken_===t&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const e=t.s,n=t.d||"error";"ok"===e?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,n)})}unlisten(t,e){const n=t._path.toString(),i=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),(0,Jt.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t._queryObject,e)}sendUnlisten_(t,e,n,i){this.log_("Unlisten on "+t+" for "+e);const r={p:t};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})}onDisconnectMerge(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,n,i){const r={p:e,d:n};this.log_("onDisconnect "+t,r),this.sendRequest(t,r,t=>{i&&setTimeout(()=>{i(t.s,t.d)},Math.floor(0))})}put(t,e,n,i){this.putInternal("p",t,e,n,i)}merge(t,e,n,i){this.putInternal("m",t,e,n,i)}putInternal(t,e,n,i,r){this.initConnection_();const s={p:e,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:t,request:s,onComplete:i}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,n,n=>{this.log_(e+" response",n),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)})}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,t=>{"ok"!==t.s&&this.log_("reportStats","Error sending stats: "+t.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,Jt.Wl)(t));const e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):zS("Unrecognized action received from server: "+(0,Jt.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,Jt.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=HC,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=HC,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=HC),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var e=this;return(0,Gt.Z)(function*(){if(e.shouldReconnect_()){e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null;const i=e.onDataMessage_.bind(e),r=e.onReady_.bind(e),s=e.onRealtimeDisconnect_.bind(e),o=e.id+":"+t.nextConnectionId_++,a=e.lastSessionId;let l=!1,u=null;const c=function(){u?u.close():(l=!0,s())};e.realtime_={close:c,sendRequest:function(t){(0,Jt.hu)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)}};const h=e.forceTokenRefresh_;e.forceTokenRefresh_=!1;try{const[t,n]=yield Promise.all([e.authTokenProvider_.getToken(h),e.appCheckTokenProvider_.getToken(h)]);l?jS("getToken() completed but was canceled"):(jS("getToken() completed. Creating connection."),e.authToken_=t&&t.accessToken,e.appCheckToken_=n&&n.token,u=new IC(o,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,i,r,s,t=>{ZS(t+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},a))}catch(n){e.log_("Failed to get token: "+n),l||(e.repoInfo_.nodeAdmin&&ZS(n),c())}}})()}interrupt(t){jS("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){jS("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,Jt.xb)(this.interruptReasons_)&&(this.reconnectDelay_=HC,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let n;n=e?e.map(t=>YS(t)).join("$"):"default";const i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(t,e){const n=new xC(t).toString();let i;if(this.listens.has(n)){const t=this.listens.get(n);i=t.get(e),t.delete(e),0===t.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(t,e){jS("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){jS("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";(0,Jt.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+ES.replace(/\./g,"-")]=1,(0,Jt.uI)()?t["framework.cordova"]=1:(0,Jt.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=EC.getInstance().currentlyOnline();return(0,Jt.xb)(this.interruptReasons_)&&t}}return t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t})();class GC{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new GC(t,e)}}class KC{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const n=new GC($S,t),i=new GC($S,e);return 0!==this.compare(n,i)}minPost(){return GC.MIN}}class QC extends KC{static get __EMPTY_NODE(){return $C}static set __EMPTY_NODE(t){$C=t}compare(t,e){return GS(t.name,e.name)}isDefinedOn(t){throw(0,Jt.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return GC.MIN}maxPost(){return new GC(WS,$C)}makePost(t,e){return(0,Jt.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new GC(t,$C)}toString(){return".key"}}const YC=new QC;class JC{constructor(t,e,n,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,i&&(s*=-1),s<0)t=this.isReverse_?t.left:t.right;else{if(0===s){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}let XC,tE=(()=>{class t{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=null!=i?i:t.RED,this.left=null!=r?r:eE.EMPTY_NODE,this.right=null!=s?s:eE.EMPTY_NODE}copy(e,n,i,r,s){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=i?i:this.color,null!=r?r:this.left,null!=s?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return eE.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let n,i;if(n=this,e(t,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return eE.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})();class eE{constructor(t,e=eE.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new eE(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,tE.BLACK,null,null))}remove(t){return new eE(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,tE.BLACK,null,null))}get(t){let e,n=this.root_;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null}getPredecessorKey(t){let e,n=this.root_,i=null;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new JC(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new JC(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new JC(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new JC(this.root_,null,this.comparator_,!0,t)}}function nE(t,e){return GS(t.name,e.name)}function iE(t,e){return GS(t,e)}eE.EMPTY_NODE=new class{copy(t,e,n,i,r){return this}insert(t,e,n){return new tE(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const rE=function(t){return"number"==typeof t?"number:"+tC(t):"string:"+t},sE=function(t){if(t.isLeafNode()){const e=t.val();(0,Jt.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,Jt.r3)(e,".sv"),"Priority must be a string or number.")}else(0,Jt.hu)(t===XC||t.isEmpty(),"priority of unexpected type.");(0,Jt.hu)(t===XC||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let oE,aE,lE,uE=(()=>{class t{constructor(e,n=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,Jt.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),sE(this.priorityNode_)}static set __childrenNodeConstructor(t){oE=t}static get __childrenNodeConstructor(){return oE}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new t(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return MC(e)?this:".priority"===AC(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const i=AC(e);return null===i?n:n.isEmpty()&&".priority"!==i?this:((0,Jt.hu)(".priority"!==i||1===PC(e),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(NC(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+rE(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",t+="number"===e?tC(this.value_):this.value_,this.lazyHash_=LS(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,Jt.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,i=typeof this.value_,r=t.VALUE_TYPE_ORDER.indexOf(n),s=t.VALUE_TYPE_ORDER.indexOf(i);return(0,Jt.hu)(r>=0,"Unknown leaf type: "+n),(0,Jt.hu)(s>=0,"Unknown leaf type: "+i),r===s?"object"===i?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1}}return t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t})();const cE=new class extends KC{compare(t,e){const n=t.node.getPriority(),i=e.node.getPriority(),r=n.compareTo(i);return 0===r?GS(t.name,e.name):r}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return GC.MIN}maxPost(){return new GC(WS,new uE("[PRIORITY-POST]",lE))}makePost(t,e){const n=aE(t);return new GC(e,new uE("[PRIORITY-POST]",n))}toString(){return".priority"}},hE=Math.log(2);class dE{constructor(t){this.count=parseInt(Math.log(t+1)/hE,10),this.current_=this.count-1;const e=(t=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=t+1&e}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const pE=function(t,e,n,i){t.sort(e);const r=function(e,i){const s=i-e;let o,a;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new tE(a,o.node,tE.BLACK,null,null);{const l=parseInt(s/2,10)+e,u=r(e,l),c=r(l+1,i);return o=t[l],a=n?n(o):o,new tE(a,o.node,tE.BLACK,u,c)}},s=function(e){let i=null,s=null,o=t.length;const a=function(e,i){const s=o-e,a=o;o-=e;const u=r(s+1,a),c=t[s],h=n?n(c):c;l(new tE(h,c.node,i,null,u))},l=function(t){i?(i.left=t,i=t):(s=t,i=t)};for(let t=0;t<e.count;++t){const n=e.nextBitIsOne(),i=Math.pow(2,e.count-(t+1));n?a(i,tE.BLACK):(a(i,tE.BLACK),a(i,tE.RED))}return s}(new dE(t.length));return new eE(i||e,s)};let fE;const mE={};class gE{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return(0,Jt.hu)(mE&&cE,"ChildrenNode.ts has not been loaded"),fE=fE||new gE({".priority":mE},{".priority":cE}),fE}get(t){const e=(0,Jt.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof eE?e:null}hasIndex(t){return(0,Jt.r3)(this.indexSet_,t.toString())}addIndex(t,e){(0,Jt.hu)(t!==YC,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const r=e.getIterator(GC.Wrap);let s,o=r.getNext();for(;o;)i=i||t.isDefinedOn(o.node),n.push(o),o=r.getNext();s=i?pE(n,t.getCompare()):mE;const a=t.toString(),l=Object.assign({},this.indexSet_);l[a]=t;const u=Object.assign({},this.indexes_);return u[a]=s,new gE(u,l)}addToIndexes(t,e){const n=(0,Jt.UI)(this.indexes_,(n,i)=>{const r=(0,Jt.DV)(this.indexSet_,i);if((0,Jt.hu)(r,"Missing index implementation for "+i),n===mE){if(r.isDefinedOn(t.node)){const n=[],i=e.getIterator(GC.Wrap);let s=i.getNext();for(;s;)s.name!==t.name&&n.push(s),s=i.getNext();return n.push(t),pE(n,r.getCompare())}return mE}{const i=e.get(t.name);let r=n;return i&&(r=r.remove(new GC(t.name,i))),r.insert(t,t.node)}});return new gE(n,this.indexSet_)}removeFromIndexes(t,e){const n=(0,Jt.UI)(this.indexes_,n=>{if(n===mE)return n;{const i=e.get(t.name);return i?n.remove(new GC(t.name,i)):n}});return new gE(n,this.indexSet_)}}let yE,_E=(()=>{class t{constructor(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&sE(this.priorityNode_),this.children_.isEmpty()&&(0,Jt.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return yE||(yE=new t(new eE(iE),null,gE.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||yE}updatePriority(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const e=this.children_.get(t);return null===e?yE:e}}getChild(t){const e=AC(t);return null===e?this:this.getImmediateChild(e).getChild(NC(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(e,n){if((0,Jt.hu)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);{const i=new GC(e,n);let r,s;n.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(i,this.children_));const o=r.isEmpty()?yE:this.priorityNode_;return new t(r,o,s)}}updateChild(t,e){const n=AC(t);if(null===n)return e;{(0,Jt.hu)(".priority"!==AC(t)||1===PC(t),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(NC(t),e);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let i=0,r=0,s=!0;if(this.forEachChild(cE,(o,a)=>{n[o]=a.val(e),i++,s&&t.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!e&&s&&r<2*i){const t=[];for(const e in n)t[e]=n[e];return t}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+rE(this.getPriority().val())+":"),this.forEachChild(cE,(e,n)=>{const i=n.hash();""!==i&&(t+=":"+e+":"+i)}),this.lazyHash_=""===t?"":LS(t)}return this.lazyHash_}getPredecessorChildName(t,e,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new GC(t,e));return n?n.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.minKey();return t&&t.name}return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new GC(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.maxKey();return t&&t.name}return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new GC(e,this.children_.get(e)):null}forEachChild(t,e){const n=this.resolveIndex_(t);return n?n.inorderTraversal(t=>e(t.name,t.node)):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,t=>t);{const n=this.children_.getIteratorFrom(t.name,GC.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,t=>t);{const n=this.children_.getReverseIteratorFrom(t.name,GC.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)>0;)n.getNext(),i=n.peek();return n}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===vE?-1:0}withIndex(e){if(e===YC||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)}}isIndexed(t){return t===YC||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){const t=this.getIterator(cE),n=e.getIterator(cE);let i=t.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=t.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(t){return t===YC?null:this.indexMap_.get(t.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})();const vE=new class extends _E{constructor(){super(new eE(iE),_E.EMPTY_NODE,gE.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return _E.EMPTY_NODE}isEmpty(){return!1}};function wE(t,e=null){if(null===t)return _E.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,Jt.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new uE(t,wE(e));if(t instanceof Array){let n=_E.EMPTY_NODE;return XS(t,(e,i)=>{if((0,Jt.r3)(t,e)&&"."!==e.substring(0,1)){const t=wE(i);(t.isLeafNode()||!t.isEmpty())&&(n=n.updateImmediateChild(e,t))}}),n.updatePriority(wE(e))}{const n=[];let i=!1;if(XS(t,(t,e)=>{if("."!==t.substring(0,1)){const r=wE(e);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new GC(t,r)))}}),0===n.length)return _E.EMPTY_NODE;const r=pE(n,nE,t=>t.name,iE);if(i){const t=pE(n,cE.getCompare());return new _E(r,wE(e),new gE({".priority":t},{".priority":cE}))}return new _E(r,wE(e),gE.Default)}}Object.defineProperties(GC,{MIN:{value:new GC($S,_E.EMPTY_NODE)},MAX:{value:new GC(WS,vE)}}),QC.__EMPTY_NODE=_E.EMPTY_NODE,uE.__childrenNodeConstructor=_E,function(t){XC=t}(vE),function(t){lE=t}(vE),function(t){aE=t}(wE);class bE extends KC{constructor(t){super(),this.indexPath_=t,(0,Jt.hu)(!MC(t)&&".priority"!==AC(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const n=this.extractChild(t.node),i=this.extractChild(e.node),r=n.compareTo(i);return 0===r?GS(t.name,e.name):r}makePost(t,e){const n=wE(t),i=_E.EMPTY_NODE.updateChild(this.indexPath_,n);return new GC(e,i)}maxPost(){const t=_E.EMPTY_NODE.updateChild(this.indexPath_,vE);return new GC(WS,t)}toString(){return OC(this.indexPath_,0).join("/")}}const TE=new class extends KC{compare(t,e){const n=t.node.compareTo(e.node);return 0===n?GS(t.name,e.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return GC.MIN}maxPost(){return GC.MAX}makePost(t,e){const n=wE(t);return new GC(e,n)}toString(){return".value"}};function IE(t){return{type:"value",snapshotNode:t}}function SE(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function CE(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function EE(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class xE{constructor(t){this.index_=t}updateChild(t,e,n,i,r,s){(0,Jt.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=t.getImmediateChild(e);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()||(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(CE(e,o)):(0,Jt.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(SE(e,n)):s.trackChildChange(EE(e,n,o))),t.isLeafNode()&&n.isEmpty())?t:t.updateImmediateChild(e,n).withIndex(this.index_)}updateFullNode(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(cE,(t,i)=>{e.hasChild(t)||n.trackChildChange(CE(t,i))}),e.isLeafNode()||e.forEachChild(cE,(e,i)=>{if(t.hasChild(e)){const r=t.getImmediateChild(e);r.equals(i)||n.trackChildChange(EE(e,i,r))}else n.trackChildChange(SE(e,i))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?_E.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class kE{constructor(t){this.indexedFilter_=new xE(t.getIndex()),this.index_=t.getIndex(),this.startPost_=kE.getStartPost_(t),this.endPost_=kE.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,n=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&n}updateChild(t,e,n,i,r,s){return this.matches(new GC(e,n))||(n=_E.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,i,r,s)}updateFullNode(t,e,n){e.isLeafNode()&&(e=_E.EMPTY_NODE);let i=e.withIndex(this.index_);i=i.updatePriority(_E.EMPTY_NODE);const r=this;return e.forEachChild(cE,(t,e)=>{r.matches(new GC(t,e))||(i=i.updateImmediateChild(t,_E.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,i,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class AE{constructor(t){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const e=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?e<=0:e<0},this.withinEndPost=t=>{const e=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?e<=0:e<0},this.rangedFilter_=new kE(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,n,i,r,s){return this.rangedFilter_.matches(new GC(e,n))||(n=_E.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,i,r,s):this.fullLimitUpdateChild_(t,e,n,r,s)}updateFullNode(t,e,n){let i;if(e.isLeafNode()||e.isEmpty())i=_E.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let t;i=_E.EMPTY_NODE.withIndex(this.index_),t=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;t.hasNext()&&n<this.limit_;){const e=t.getNext();if(this.withinDirectionalStart(e)){if(!this.withinDirectionalEnd(e))break;i=i.updateImmediateChild(e.name,e.node),n++}}}else{let t;i=e.withIndex(this.index_),i=i.updatePriority(_E.EMPTY_NODE),t=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let n=0;for(;t.hasNext();){const e=t.getNext();n<this.limit_&&this.withinDirectionalStart(e)&&this.withinDirectionalEnd(e)?n++:i=i.updateImmediateChild(e.name,_E.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,n,i,r){let s;if(this.reverse_){const t=this.index_.getCompare();s=(e,n)=>t(n,e)}else s=this.index_.getCompare();const o=t;(0,Jt.hu)(o.numChildren()===this.limit_,"");const a=new GC(e,n),l=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(o.hasChild(e)){const t=o.getImmediateChild(e);let c=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=c&&(c.name===e||o.hasChild(c.name));)c=i.getChildAfterChild(this.index_,c,this.reverse_);const h=null==c?1:s(c,a);if(u&&!n.isEmpty()&&h>=0)return null!=r&&r.trackChildChange(EE(e,n,t)),o.updateImmediateChild(e,n);{null!=r&&r.trackChildChange(CE(e,t));const n=o.updateImmediateChild(e,_E.EMPTY_NODE);return null!=c&&this.rangedFilter_.matches(c)?(null!=r&&r.trackChildChange(SE(c.name,c.node)),n.updateImmediateChild(c.name,c.node)):n}}return n.isEmpty()?t:u&&s(l,a)>=0?(null!=r&&(r.trackChildChange(CE(l.name,l.node)),r.trackChildChange(SE(e,n))),o.updateImmediateChild(e,n).updateImmediateChild(l.name,_E.EMPTY_NODE)):t}}class PE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=cE}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,Jt.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,Jt.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:$S}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,Jt.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,Jt.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:WS}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,Jt.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===cE}copy(){const t=new PE;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function NE(t,e,n){const i=t.copy();return i.startSet_=!0,void 0===e&&(e=null),i.indexStartValue_=e,null!=n?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function DE(t,e,n){const i=t.copy();return i.endSet_=!0,void 0===e&&(e=null),i.indexEndValue_=e,void 0!==n?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function OE(t,e){const n=t.copy();return n.index_=e,n}function RE(t){const e={};if(t.isDefault())return e;let n;if(t.index_===cE?n="$priority":t.index_===TE?n="$value":t.index_===YC?n="$key":((0,Jt.hu)(t.index_ instanceof bE,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,Jt.Wl)(n),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=(0,Jt.Wl)(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+(0,Jt.Wl)(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=(0,Jt.Wl)(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+(0,Jt.Wl)(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function LE(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==cE&&(e.i=t.index_.toString()),e}class ME extends SC{constructor(t,e,n,i){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=qS("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:((0,Jt.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,n,i){const r=t._path.toString();this.log_("Listen called for "+r+" "+t._queryIdentifier);const s=ME.getListenId_(t,n),o={};this.listens_[s]=o;const a=RE(t._queryParams);this.restRequest_(r+".json",a,(t,e)=>{let a=e;if(404===t&&(a=null,t=null),null===t&&this.onDataUpdate_(r,a,!1,n),(0,Jt.DV)(this.listens_,s)===o){let e;e=t?401===t?"permission_denied":"rest_error:"+t:"ok",i(e,null)}})}unlisten(t,e){const n=ME.getListenId_(t,e);delete this.listens_[n]}get(t){const e=RE(t._queryParams),n=t._path.toString(),i=new Jt.BH;return this.restRequest_(n+".json",e,(t,e)=>{let r=e;404===t&&(r=null,t=null),null===t?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))}),i.promise}refreshAuthToken(t){}restRequest_(t,e={},n){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(e.auth=i.accessToken),r&&r.token&&(e.ac=r.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+(0,Jt.xO)(e);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=(0,Jt.cI)(o.responseText)}catch(t){ZS("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&ZS("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()})}}class FE{constructor(){this.rootNode_=_E.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function VE(){return{value:null,children:new Map}}function UE(t,e,n){if(MC(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const i=AC(e);t.children.has(i)||t.children.set(i,VE()),UE(t.children.get(i),e=NC(e),n)}}function jE(t,e){if(MC(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(cE,(e,n)=>{UE(t,new xC(e),n)}),jE(t,e)}}if(t.children.size>0){const n=AC(e);return e=NC(e),t.children.has(n)&&jE(t.children.get(n),e)&&t.children.delete(n),0===t.children.size}return!0}function qE(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((t,n)=>{e(n,t)})}(t,(t,i)=>{qE(i,new xC(e.toString()+"/"+t),n)})}class zE{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&XS(this.last_,(t,n)=>{e[t]=e[t]-n}),this.last_=t,e}}class BE{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new zE(t);const n=1e4+2e4*Math.random();rC(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),e={};let n=!1;XS(t,(t,i)=>{i>0&&(0,Jt.r3)(this.statsToReport_,t)&&(e[t]=i,n=!0)}),n&&this.server_.reportStats(e),rC(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var ZE=(()=>(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(ZE||(ZE={})),ZE))();function HE(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class $E{constructor(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=ZE.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(MC(this.path)){if(null!=this.affectedTree.value)return(0,Jt.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new xC(t));return new $E(kC(),e,this.revert)}}return(0,Jt.hu)(AC(this.path)===t,"operationForChild called for unrelated child."),new $E(NC(this.path),this.affectedTree,this.revert)}}class WE{constructor(t,e){this.source=t,this.path=e,this.type=ZE.LISTEN_COMPLETE}operationForChild(t){return MC(this.path)?new WE(this.source,kC()):new WE(this.source,NC(this.path))}}class GE{constructor(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=ZE.OVERWRITE}operationForChild(t){return MC(this.path)?new GE(this.source,kC(),this.snap.getImmediateChild(t)):new GE(this.source,NC(this.path),this.snap)}}class KE{constructor(t,e,n){this.source=t,this.path=e,this.children=n,this.type=ZE.MERGE}operationForChild(t){if(MC(this.path)){const e=this.children.subtree(new xC(t));return e.isEmpty()?null:e.value?new GE(this.source,kC(),e.value):new KE(this.source,kC(),e)}return(0,Jt.hu)(AC(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new KE(this.source,NC(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class QE{constructor(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(MC(t))return this.isFullyInitialized()&&!this.filtered_;const e=AC(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class YE{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function JE(t,e,n,i,r,s){const o=i.filter(t=>t.type===n);o.sort((e,n)=>function(t,e,n){if(null==e.childName||null==n.childName)throw(0,Jt.g5)("Should only compare child_ events.");const i=new GC(e.childName,e.snapshotNode),r=new GC(n.childName,n.snapshotNode);return t.index_.compare(i,r)}(t,e,n)),o.forEach(n=>{const i=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,s);r.forEach(r=>{r.respondsTo(n.type)&&e.push(r.createEvent(i,t.query_))})})}function XE(t,e){return{eventCache:t,serverCache:e}}function tx(t,e,n,i){return XE(new QE(e,n,i),t.serverCache)}function ex(t,e,n,i){return XE(t.eventCache,new QE(e,n,i))}function nx(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ix(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let rx;class sx{constructor(t,e=(()=>(rx||(rx=new eE(KS)),rx))()){this.value=t,this.children=e}static fromObject(t){let e=new sx(null);return XS(t,(t,n)=>{e=e.set(new xC(t),n)}),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:kC(),value:this.value};if(MC(t))return null;{const n=AC(t),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(NC(t),e);return null!=r?{path:LC(new xC(n),r.path),value:r.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(MC(t))return this;{const e=AC(t),n=this.children.get(e);return null!==n?n.subtree(NC(t)):new sx(null)}}set(t,e){if(MC(t))return new sx(e,this.children);{const n=AC(t),i=(this.children.get(n)||new sx(null)).set(NC(t),e),r=this.children.insert(n,i);return new sx(this.value,r)}}remove(t){if(MC(t))return this.children.isEmpty()?new sx(null):new sx(null,this.children);{const e=AC(t),n=this.children.get(e);if(n){const i=n.remove(NC(t));let r;return r=i.isEmpty()?this.children.remove(e):this.children.insert(e,i),null===this.value&&r.isEmpty()?new sx(null):new sx(this.value,r)}return this}}get(t){if(MC(t))return this.value;{const e=AC(t),n=this.children.get(e);return n?n.get(NC(t)):null}}setTree(t,e){if(MC(t))return e;{const n=AC(t),i=(this.children.get(n)||new sx(null)).setTree(NC(t),e);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new sx(this.value,r)}}fold(t){return this.fold_(kC(),t)}fold_(t,e){const n={};return this.children.inorderTraversal((i,r)=>{n[i]=r.fold_(LC(t,i),e)}),e(t,this.value,n)}findOnPath(t,e){return this.findOnPath_(t,kC(),e)}findOnPath_(t,e,n){const i=!!this.value&&n(e,this.value);if(i)return i;if(MC(t))return null;{const i=AC(t),r=this.children.get(i);return r?r.findOnPath_(NC(t),LC(e,i),n):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,kC(),e)}foreachOnPath_(t,e,n){if(MC(t))return this;{this.value&&n(e,this.value);const i=AC(t),r=this.children.get(i);return r?r.foreachOnPath_(NC(t),LC(e,i),n):new sx(null)}}foreach(t){this.foreach_(kC(),t)}foreach_(t,e){this.children.inorderTraversal((n,i)=>{i.foreach_(LC(t,n),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,n)=>{n.value&&t(e,n.value)})}}class ox{constructor(t){this.writeTree_=t}static empty(){return new ox(new sx(null))}}function ax(t,e,n){if(MC(e))return new ox(new sx(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(null!=i){const r=i.path;let s=i.value;const o=FC(r,e);return s=s.updateChild(o,n),new ox(t.writeTree_.set(r,s))}{const i=new sx(n),r=t.writeTree_.setTree(e,i);return new ox(r)}}}function lx(t,e,n){let i=t;return XS(n,(t,n)=>{i=ax(i,LC(e,t),n)}),i}function ux(t,e){if(MC(e))return ox.empty();{const n=t.writeTree_.setTree(e,new sx(null));return new ox(n)}}function cx(t,e){return null!=hx(t,e)}function hx(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(FC(n.path,e)):null}function dx(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(cE,(t,n)=>{e.push(new GC(t,n))}):t.writeTree_.children.inorderTraversal((t,n)=>{null!=n.value&&e.push(new GC(t,n.value))}),e}function px(t,e){if(MC(e))return t;{const n=hx(t,e);return new ox(null!=n?new sx(n):t.writeTree_.subtree(e))}}function fx(t){return t.writeTree_.isEmpty()}function mx(t,e){return gx(kC(),t.writeTree_,e)}function gx(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((e,r)=>{".priority"===e?((0,Jt.hu)(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=gx(LC(t,e),r,n)}),!n.getChild(t).isEmpty()&&null!==i&&(n=n.updateChild(LC(t,".priority"),i)),n}}function yx(t,e){return kx(e,t)}function _x(t,e){if(t.snap)return jC(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&jC(LC(t.path,n),e))return!0;return!1}function vx(t){return t.visible}function wx(t,e,n){let i=ox.empty();for(let r=0;r<t.length;++r){const s=t[r];if(e(s)){const t=s.path;let e;if(s.snap)jC(n,t)?(e=FC(n,t),i=ax(i,e,s.snap)):jC(t,n)&&(e=FC(t,n),i=ax(i,kC(),s.snap.getChild(e)));else{if(!s.children)throw(0,Jt.g5)("WriteRecord should have .snap or .children");if(jC(n,t))e=FC(n,t),i=lx(i,e,s.children);else if(jC(t,n))if(e=FC(t,n),MC(e))i=lx(i,kC(),s.children);else{const t=(0,Jt.DV)(s.children,AC(e));if(t){const n=t.getChild(NC(e));i=ax(i,kC(),n)}}}}}return i}function bx(t,e,n,i,r){if(i||r){const s=px(t.visibleWrites,e);return!r&&fx(s)?n:r||null!=n||cx(s,kC())?mx(wx(t.allWrites,function(t){return(t.visible||r)&&(!i||!~i.indexOf(t.writeId))&&(jC(t.path,e)||jC(e,t.path))},e),n||_E.EMPTY_NODE):null}{const i=hx(t.visibleWrites,e);if(null!=i)return i;{const i=px(t.visibleWrites,e);return fx(i)?n:null!=n||cx(i,kC())?mx(i,n||_E.EMPTY_NODE):null}}}function Tx(t,e,n,i){return bx(t.writeTree,t.treePath,e,n,i)}function Ix(t,e){return function(t,e,n){let i=_E.EMPTY_NODE;const r=hx(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(cE,(t,e)=>{i=i.updateImmediateChild(t,e)}),i;if(n){const r=px(t.visibleWrites,e);return n.forEachChild(cE,(t,e)=>{const n=mx(px(r,new xC(t)),e);i=i.updateImmediateChild(t,n)}),dx(r).forEach(t=>{i=i.updateImmediateChild(t.name,t.node)}),i}return dx(px(t.visibleWrites,e)).forEach(t=>{i=i.updateImmediateChild(t.name,t.node)}),i}(t.writeTree,t.treePath,e)}function Sx(t,e,n,i){return function(t,e,n,i,r){(0,Jt.hu)(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=LC(e,n);if(cx(t.visibleWrites,s))return null;{const e=px(t.visibleWrites,s);return fx(e)?r.getChild(n):mx(e,r.getChild(n))}}(t.writeTree,t.treePath,e,n,i)}function Cx(t,e){return function(t,e){return hx(t.visibleWrites,e)}(t.writeTree,LC(t.treePath,e))}function Ex(t,e,n){return function(t,e,n,i){const r=LC(e,n),s=hx(t.visibleWrites,r);return null!=s?s:i.isCompleteForChild(n)?mx(px(t.visibleWrites,r),i.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function xx(t,e){return kx(LC(t.treePath,e),t.writeTree)}function kx(t,e){return{treePath:t,writeTree:e}}class Ax{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,n=t.childName;(0,Jt.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,Jt.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const r=i.type;if("child_added"===e&&"child_removed"===r)this.changeMap.set(n,EE(n,t.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===r)this.changeMap.set(n,CE(n,i.oldSnap));else if("child_changed"===e&&"child_added"===r)this.changeMap.set(n,SE(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==r)throw(0,Jt.g5)("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap.set(n,EE(n,t.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}const Px=new class{getCompleteChild(t){return null}getChildAfterChild(t,e,n){return null}};class Nx{constructor(t,e,n=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const e=null!=this.optCompleteServerCache_?new QE(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ex(this.writes_,t,e)}}getChildAfterChild(t,e,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ix(this.viewCache_),r=function(t,e,n,i,r,s){return function(t,e,n,i,r,s,o){let a;const l=px(t.visibleWrites,e),u=hx(l,kC());if(null!=u)a=u;else{if(null==n)return[];a=mx(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const t=[],e=o.getCompare(),n=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let l=n.getNext();for(;l&&t.length<r;)0!==e(l,i)&&t.push(l),l=n.getNext();return t}}(t.writeTree,t.treePath,e,n,i,r,s)}(this.writes_,i,e,1,n,t);return 0===r.length?null:r[0]}}function Dx(t,e,n,i,r,s){const o=e.eventCache;if(null!=Cx(i,n))return e;{let a,l;if(MC(n))if((0,Jt.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const n=ix(e),r=Ix(i,n instanceof _E?n:_E.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),r,s)}else{const n=Tx(i,ix(e));a=t.filter.updateFullNode(e.eventCache.getNode(),n,s)}else{const u=AC(n);if(".priority"===u){(0,Jt.hu)(1===PC(n),"Can't have a priority with additional path components");const r=o.getNode();l=e.serverCache.getNode();const s=Sx(i,n,r,l);a=null!=s?t.filter.updatePriority(r,s):o.getNode()}else{const c=NC(n);let h;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const t=Sx(i,n,o.getNode(),l);h=null!=t?o.getNode().getImmediateChild(u).updateChild(c,t):o.getNode().getImmediateChild(u)}else h=Ex(i,u,e.serverCache);a=null!=h?t.filter.updateChild(o.getNode(),u,h,c,r,s):o.getNode()}}return tx(e,a,o.isFullyInitialized()||MC(n),t.filter.filtersNodes())}}function Ox(t,e,n,i,r,s,o,a){const l=e.serverCache;let u;const c=o?t.filter:t.filter.getIndexedFilter();if(MC(n))u=c.updateFullNode(l.getNode(),i,null);else if(c.filtersNodes()&&!l.isFiltered()){const t=l.getNode().updateChild(n,i);u=c.updateFullNode(l.getNode(),t,null)}else{const t=AC(n);if(!l.isCompleteForPath(n)&&PC(n)>1)return e;const r=NC(n),s=l.getNode().getImmediateChild(t).updateChild(r,i);u=".priority"===t?c.updatePriority(l.getNode(),s):c.updateChild(l.getNode(),t,s,r,Px,null)}const h=ex(e,u,l.isFullyInitialized()||MC(n),c.filtersNodes());return Dx(t,h,n,r,new Nx(r,h,s),a)}function Rx(t,e,n,i,r,s,o){const a=e.eventCache;let l,u;const c=new Nx(r,e,s);if(MC(n))u=t.filter.updateFullNode(e.eventCache.getNode(),i,o),l=tx(e,u,!0,t.filter.filtersNodes());else{const r=AC(n);if(".priority"===r)u=t.filter.updatePriority(e.eventCache.getNode(),i),l=tx(e,u,a.isFullyInitialized(),a.isFiltered());else{const s=NC(n),u=a.getNode().getImmediateChild(r);let h;if(MC(s))h=i;else{const t=c.getCompleteChild(r);h=null!=t?".priority"===DC(s)&&t.getChild(RC(s)).isEmpty()?t:t.updateChild(s,i):_E.EMPTY_NODE}l=u.equals(h)?e:tx(e,t.filter.updateChild(a.getNode(),r,h,s,c,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return l}function Lx(t,e){return t.eventCache.isCompleteForChild(e)}function Mx(t,e,n){return n.foreach((t,n)=>{e=e.updateChild(t,n)}),e}function Fx(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l,u=e;l=MC(n)?i:new sx(null).setTree(n,i);const c=e.serverCache.getNode();return l.children.inorderTraversal((n,i)=>{if(c.hasChild(n)){const l=Mx(0,e.serverCache.getNode().getImmediateChild(n),i);u=Ox(t,u,new xC(n),l,r,s,o,a)}}),l.children.inorderTraversal((n,i)=>{const l=!e.serverCache.isCompleteForChild(n)&&null===i.value;if(!c.hasChild(n)&&!l){const l=Mx(0,e.serverCache.getNode().getImmediateChild(n),i);u=Ox(t,u,new xC(n),l,r,s,o,a)}}),u}class Vx{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new xE(n.getIndex()),r=function(t){return t.loadsAllData()?new xE(t.getIndex()):t.hasLimit()?new AE(t):new kE(t)}(n);this.processor_=function(t){return{filter:t}}(r);const s=e.serverCache,o=e.eventCache,a=i.updateFullNode(_E.EMPTY_NODE,s.getNode(),null),l=r.updateFullNode(_E.EMPTY_NODE,o.getNode(),null),u=new QE(a,s.isFullyInitialized(),i.filtersNodes()),c=new QE(l,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=XE(c,u),this.eventGenerator_=new YE(this.query_)}get query(){return this.query_}}function Ux(t,e){const n=ix(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!MC(e)&&!n.getImmediateChild(AC(e)).isEmpty())?n.getChild(e):null}function jx(t){return 0===t.eventRegistrations_.length}function qx(t,e,n){const i=[];if(n){(0,Jt.hu)(null==e,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(t=>{const e=t.createCancelEvent(n,r);e&&i.push(e)})}if(e){let n=[];for(let i=0;i<t.eventRegistrations_.length;++i){const r=t.eventRegistrations_[i];if(r.matches(e)){if(e.hasAnyCallback()){n=n.concat(t.eventRegistrations_.slice(i+1));break}}else n.push(r)}t.eventRegistrations_=n}else t.eventRegistrations_=[];return i}function zx(t,e,n,i){e.type===ZE.MERGE&&null!==e.source.queryId&&((0,Jt.hu)(ix(t.viewCache_),"We should always have a full cache before handling merges"),(0,Jt.hu)(nx(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,s=function(t,e,n,i,r){const s=new Ax;let o,a;if(n.type===ZE.OVERWRITE){const l=n;l.source.fromUser?o=Rx(t,e,l.path,l.snap,i,r,s):((0,Jt.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!MC(l.path),o=Ox(t,e,l.path,l.snap,i,r,a,s))}else if(n.type===ZE.MERGE){const l=n;l.source.fromUser?o=function(t,e,n,i,r,s,o){let a=e;return i.foreach((i,l)=>{const u=LC(n,i);Lx(e,AC(u))&&(a=Rx(t,a,u,l,r,s,o))}),i.foreach((i,l)=>{const u=LC(n,i);Lx(e,AC(u))||(a=Rx(t,a,u,l,r,s,o))}),a}(t,e,l.path,l.children,i,r,s):((0,Jt.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Fx(t,e,l.path,l.children,i,r,a,s))}else if(n.type===ZE.ACK_USER_WRITE){const a=n;o=a.revert?function(t,e,n,i,r,s){let o;if(null!=Cx(i,n))return e;{const a=new Nx(i,e,r),l=e.eventCache.getNode();let u;if(MC(n)||".priority"===AC(n)){let n;if(e.serverCache.isFullyInitialized())n=Tx(i,ix(e));else{const t=e.serverCache.getNode();(0,Jt.hu)(t instanceof _E,"serverChildren would be complete if leaf node"),n=Ix(i,t)}u=t.filter.updateFullNode(l,n,s)}else{const r=AC(n);let c=Ex(i,r,e.serverCache);null==c&&e.serverCache.isCompleteForChild(r)&&(c=l.getImmediateChild(r)),u=null!=c?t.filter.updateChild(l,r,c,NC(n),a,s):e.eventCache.getNode().hasChild(r)?t.filter.updateChild(l,r,_E.EMPTY_NODE,NC(n),a,s):l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Tx(i,ix(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=Cx(i,kC()),tx(e,u,o,t.filter.filtersNodes())}}(t,e,a.path,i,r,s):function(t,e,n,i,r,s,o){if(null!=Cx(r,n))return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=i.value){if(MC(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Ox(t,e,n,l.getNode().getChild(n),r,s,a,o);if(MC(n)){let i=new sx(null);return l.getNode().forEachChild(YC,(t,e)=>{i=i.set(new xC(t),e)}),Fx(t,e,n,i,r,s,a,o)}return e}{let u=new sx(null);return i.foreach((t,e)=>{const i=LC(n,t);l.isCompleteForPath(i)&&(u=u.set(t,l.getNode().getChild(i)))}),Fx(t,e,n,u,r,s,a,o)}}(t,e,a.path,a.affectedTree,i,r,s)}else{if(n.type!==ZE.LISTEN_COMPLETE)throw(0,Jt.g5)("Unknown operation type: "+n.type);o=function(t,e,n,i,r){const s=e.serverCache;return Dx(t,ex(e,s.getNode(),s.isFullyInitialized()||MC(n),s.isFiltered()),n,i,Px,r)}(t,e,n.path,i,s)}const l=s.getChanges();return function(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=nx(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(IE(nx(e)))}}(e,o,l),{viewCache:o,changes:l}}(t.processor_,r,e,n,i);return function(t,e){(0,Jt.hu)(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),(0,Jt.hu)(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}(t.processor_,s.viewCache),(0,Jt.hu)(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Bx(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Bx(t,e,n,i){return function(t,e,n,i){const r=[],s=[];return e.forEach(e=>{"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&s.push(function(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}(e.childName,e.snapshotNode))}),JE(t,r,"child_removed",e,i,n),JE(t,r,"child_added",e,i,n),JE(t,r,"child_moved",s,i,n),JE(t,r,"child_changed",e,i,n),JE(t,r,"value",e,i,n),r}(t.eventGenerator_,e,n,i?[i]:t.eventRegistrations_)}let Zx,Hx;class $x{constructor(){this.views=new Map}}function Wx(t,e,n,i){const r=e.source.queryId;if(null!==r){const s=t.views.get(r);return(0,Jt.hu)(null!=s,"SyncTree gave us an op for an invalid query."),zx(s,e,n,i)}{let r=[];for(const s of t.views.values())r=r.concat(zx(s,e,n,i));return r}}function Gx(t,e,n,i,r){const s=t.views.get(e._queryIdentifier);if(!s){let t=Tx(n,r?i:null),s=!1;t?s=!0:i instanceof _E?(t=Ix(n,i),s=!1):(t=_E.EMPTY_NODE,s=!1);const o=XE(new QE(t,s,!1),new QE(i,r,!1));return new Vx(e,o)}return s}function Kx(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Qx(t,e){let n=null;for(const i of t.views.values())n=n||Ux(i,e);return n}function Yx(t,e){return e._queryParams.loadsAllData()?tk(t):t.views.get(e._queryIdentifier)}function Jx(t,e){return null!=Yx(t,e)}function Xx(t){return null!=tk(t)}function tk(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let ek=1;class nk{constructor(t){this.listenProvider_=t,this.syncPointTree_=new sx(null),this.pendingWriteTree_={visibleWrites:ox.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ik(t,e,n,i,r){return function(t,e,n,i,r){(0,Jt.hu)(i>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=ax(t.visibleWrites,e,n)),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i,r),r?ck(t,new GE({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function rk(t,e,n=!1){const i=function(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}(t.pendingWriteTree_,e);if(function(t,e){const n=t.allWrites.findIndex(t=>t.writeId===e);(0,Jt.hu)(n>=0,"removeWrite called with nonexistent writeId.");const i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const e=t.allWrites[o];e.visible&&(o>=n&&_x(e,i.path)?r=!1:jC(i.path,e.path)&&(s=!0)),o--}return!!r&&(s?(function(t){t.visibleWrites=wx(t.allWrites,vx,kC()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(i.snap?t.visibleWrites=ux(t.visibleWrites,i.path):XS(i.children,e=>{t.visibleWrites=ux(t.visibleWrites,LC(i.path,e))}),!0))}(t.pendingWriteTree_,e)){let e=new sx(null);return null!=i.snap?e=e.set(kC(),!0):XS(i.children,t=>{e=e.set(new xC(t),!0)}),ck(t,new $E(i.path,e,n))}return[]}function sk(t,e,n){return ck(t,new GE({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function ok(t,e,n,i,r=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||Jx(o,e))){const l=function(t,e,n,i){const r=e._queryIdentifier,s=[];let o=[];const a=Xx(t);if("default"===r)for(const[l,u]of t.views.entries())o=o.concat(qx(u,n,i)),jx(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const e=t.views.get(r);e&&(o=o.concat(qx(e,n,i)),jx(e)&&(t.views.delete(r),e.query._queryParams.loadsAllData()||s.push(e.query)))}return a&&!Xx(t)&&s.push(new((0,Jt.hu)(Zx,"Reference.ts has not been loaded"),Zx)(e._repo,e._path)),{removed:s,events:o}}(o,e,n,i);(function(t){return 0===t.views.size})(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!r){const n=-1!==u.findIndex(t=>t._queryParams.loadsAllData()),r=t.syncPointTree_.findOnPath(s,(t,e)=>Xx(e));if(n&&!r){const e=t.syncPointTree_.subtree(s);if(!e.isEmpty()){const n=function(t){return t.fold((t,e,n)=>{if(e&&Xx(e))return[tk(e)];{let t=[];return e&&(t=Kx(e)),XS(n,(e,n)=>{t=t.concat(n)}),t}})}(e);for(let e=0;e<n.length;++e){const i=n[e],r=i.query,s=pk(t,i);t.listenProvider_.startListening(vk(r),fk(t,r),s.hashFn,s.onComplete)}}}if(!r&&u.length>0&&!i)if(n){const n=null;t.listenProvider_.stopListening(vk(e),n)}else u.forEach(e=>{const n=t.queryToTagMap.get(mk(e));t.listenProvider_.stopListening(vk(e),n)})}!function(t,e){for(let n=0;n<e.length;++n){const i=e[n];if(!i._queryParams.loadsAllData()){const e=mk(i),n=t.queryToTagMap.get(e);t.queryToTagMap.delete(e),t.tagToQueryMap.delete(n)}}}(t,u)}return a}function ak(t,e,n,i){const r=gk(t,i);if(null!=r){const i=yk(r),s=i.path,o=i.queryId,a=FC(s,e);return _k(t,s,new GE(HE(o),a,n))}return[]}function lk(t,e,n,i=!1){const r=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(r,(t,e)=>{const n=FC(t,r);s=s||Qx(e,n),o=o||Xx(e)});let a,l=t.syncPointTree_.get(r);l?(o=o||Xx(l),s=s||Qx(l,kC())):(l=new $x,t.syncPointTree_=t.syncPointTree_.set(r,l)),null!=s?a=!0:(a=!1,s=_E.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((t,e)=>{const n=Qx(e,kC());n&&(s=s.updateImmediateChild(t,n))}));const u=Jx(l,e);if(!u&&!e._queryParams.loadsAllData()){const n=mk(e);(0,Jt.hu)(!t.queryToTagMap.has(n),"View does not exist, but we have a tag");const i=ek++;t.queryToTagMap.set(n,i),t.tagToQueryMap.set(i,n)}let c=function(t,e,n,i,r,s){const o=Gx(t,e,i,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function(t,e){t.eventRegistrations_.push(e)}(o,n),function(t,e){const n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(cE,(t,e)=>{i.push(SE(t,e))}),n.isFullyInitialized()&&i.push(IE(n.getNode())),Bx(t,i,n.getNode(),e)}(o,n)}(l,e,n,yx(t.pendingWriteTree_,r),s,a);if(!u&&!o&&!i){const n=Yx(l,e);c=c.concat(function(t,e,n){const i=e._path,r=fk(t,e),s=pk(t,n),o=t.listenProvider_.startListening(vk(e),r,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(i);if(r)(0,Jt.hu)(!Xx(a.value),"If we're adding a query, it shouldn't be shadowed");else{const e=a.fold((t,e,n)=>{if(!MC(t)&&e&&Xx(e))return[tk(e).query];{let t=[];return e&&(t=t.concat(Kx(e).map(t=>t.query))),XS(n,(e,n)=>{t=t.concat(n)}),t}});for(let n=0;n<e.length;++n){const i=e[n];t.listenProvider_.stopListening(vk(i),fk(t,i))}}return o}(t,e,n))}return c}function uk(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(t,n)=>{const i=Qx(n,FC(t,e));if(i)return i});return bx(i,e,r,n,!0)}function ck(t,e){return hk(e,t.syncPointTree_,null,yx(t.pendingWriteTree_,kC()))}function hk(t,e,n,i){if(MC(t.path))return dk(t,e,n,i);{const r=e.get(kC());null==n&&null!=r&&(n=Qx(r,kC()));let s=[];const o=AC(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const t=n?n.getImmediateChild(o):null,e=xx(i,o);s=s.concat(hk(a,l,t,e))}return r&&(s=s.concat(Wx(r,t,i,n))),s}}function dk(t,e,n,i){const r=e.get(kC());null==n&&null!=r&&(n=Qx(r,kC()));let s=[];return e.children.inorderTraversal((e,r)=>{const o=n?n.getImmediateChild(e):null,a=xx(i,e),l=t.operationForChild(e);l&&(s=s.concat(dk(l,r,o,a)))}),r&&(s=s.concat(Wx(r,t,i,n))),s}function pk(t,e){const n=e.query,i=fk(t,n);return{hashFn:()=>(function(t){return t.viewCache_.serverCache.getNode()}(e)||_E.EMPTY_NODE).hash(),onComplete:e=>{if("ok"===e)return i?function(t,e,n){const i=gk(t,n);if(i){const n=yk(i),r=n.path,s=n.queryId,o=FC(r,e);return _k(t,r,new WE(HE(s),o))}return[]}(t,n._path,i):function(t,e){return ck(t,new WE({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const i=function(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}(e,n);return ok(t,n,null,i)}}}}function fk(t,e){const n=mk(e);return t.queryToTagMap.get(n)}function mk(t){return t._path.toString()+"$"+t._queryIdentifier}function gk(t,e){return t.tagToQueryMap.get(e)}function yk(t){const e=t.indexOf("$");return(0,Jt.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new xC(t.substr(0,e))}}function _k(t,e,n){const i=t.syncPointTree_.get(e);return(0,Jt.hu)(i,"Missing sync point for query tag that we're tracking"),Wx(i,n,yx(t.pendingWriteTree_,e),null)}function vk(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,Jt.hu)(Hx,"Reference.ts has not been loaded"),Hx)(t._repo,t._path):t}class wk{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new wk(e)}node(){return this.node_}}class bk{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=LC(this.path_,t);return new bk(this.syncTree_,e)}node(){return uk(this.syncTree_,this.path_)}}const Tk=function(t,e,n){return t&&"object"==typeof t?((0,Jt.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?Ik(t[".sv"],e,n):"object"==typeof t[".sv"]?Sk(t[".sv"],e):void(0,Jt.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Ik=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,Jt.hu)(!1,"Unexpected server value: "+t)},Sk=function(t,e,n){t.hasOwnProperty("increment")||(0,Jt.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const i=t.increment;"number"!=typeof i&&(0,Jt.hu)(!1,"Unexpected increment value: "+i);const r=e.node();if((0,Jt.hu)(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const s=r.getValue();return"number"!=typeof s?i:s+i},Ck=function(t,e,n,i){return xk(e,new bk(n,t),i)},Ek=function(t,e,n){return xk(t,new wk(e),n)};function xk(t,e,n){const i=t.getPriority().val(),r=Tk(i,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const i=t,s=Tk(i.getValue(),e,n);return s!==i.getValue()||r!==i.getPriority().val()?new uE(s,wE(r)):t}{const i=t;return s=i,r!==i.getPriority().val()&&(s=s.updatePriority(new uE(r))),i.forEachChild(cE,(t,i)=>{const r=xk(i,e.getImmediateChild(t),n);r!==i&&(s=s.updateImmediateChild(t,r))}),s}}class kk{constructor(t="",e=null,n={children:{},childCount:0}){this.name=t,this.parent=e,this.node=n}}function Ak(t,e){let n=e instanceof xC?e:new xC(e),i=t,r=AC(n);for(;null!==r;){const t=(0,Jt.DV)(i.node.children,r)||{children:{},childCount:0};i=new kk(r,i,t),n=NC(n),r=AC(n)}return i}function Pk(t){return t.node.value}function Nk(t,e){t.node.value=e,Mk(t)}function Dk(t){return t.node.childCount>0}function Ok(t,e){XS(t.node.children,(n,i)=>{e(new kk(n,t,i))})}function Rk(t,e,n,i){n&&!i&&e(t),Ok(t,t=>{Rk(t,e,!0,i)}),n&&i&&e(t)}function Lk(t){return new xC(null===t.parent?t.name:Lk(t.parent)+"/"+t.name)}function Mk(t){null!==t.parent&&function(t,e,n){const i=function(t){return void 0===Pk(t)&&!Dk(t)}(n),r=(0,Jt.r3)(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,Mk(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,Mk(t))}(t.parent,t.name,t)}const Fk=/[\[\].#$\/\u0000-\u001F\u007F]/,Vk=/[\[\].#$\u0000-\u001F\u007F]/,Uk=10485760,jk=function(t){return"string"==typeof t&&0!==t.length&&!Fk.test(t)},qk=function(t){return"string"==typeof t&&0!==t.length&&!Vk.test(t)},zk=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!HS(t)||t&&"object"==typeof t&&(0,Jt.r3)(t,".sv")},Bk=function(t,e,n,i){i&&void 0===e||Zk((0,Jt.gK)(t,"value"),e,n)},Zk=function(t,e,n){const i=n instanceof xC?new qC(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+BC(i));if("function"==typeof e)throw new Error(t+"contains a function "+BC(i)+" with contents = "+e.toString());if(HS(e))throw new Error(t+"contains "+e.toString()+" "+BC(i));if("string"==typeof e&&e.length>Uk/3&&(0,Jt.ug)(e)>Uk)throw new Error(t+"contains a string greater than "+Uk+" utf8 bytes "+BC(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let n=!1,r=!1;if(XS(e,(e,s)=>{if(".value"===e)n=!0;else if(".priority"!==e&&".sv"!==e&&(r=!0,!jk(e)))throw new Error(t+" contains an invalid key ("+e+") "+BC(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,Jt.ug)(e),zC(t)})(i,e),Zk(t,s,i),function(t){const e=t.parts_.pop();t.byteLength_-=(0,Jt.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(i)}),n&&r)throw new Error(t+' contains ".value" child '+BC(i)+" in addition to actual children.")}},Hk=function(t,e,n,i){if(i&&void 0===e)return;const r=(0,Jt.gK)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const s=[];XS(e,(t,e)=>{const i=new xC(t);if(Zk(r,e,LC(n,i)),".priority"===DC(i)&&!zk(e))throw new Error(r+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(i)}),function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];const r=OC(i);for(let e=0;e<r.length;e++)if((".priority"!==r[e]||e!==r.length-1)&&!jk(r[e]))throw new Error(t+"contains an invalid key ("+r[e]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(VC);let r=null;for(n=0;n<e.length;n++){if(i=e[n],null!==r&&jC(r,i))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}}(r,s)},$k=function(t,e,n){if(!n||void 0!==e){if(HS(e))throw new Error((0,Jt.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!zk(e))throw new Error((0,Jt.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Wk=function(t,e,n,i){if(!(i&&void 0===n||jk(n)))throw new Error((0,Jt.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Gk=function(t,e,n,i){if(!(i&&void 0===n||qk(n)))throw new Error((0,Jt.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Kk=function(t,e){if(".info"===AC(e))throw new Error(t+" failed = Can't modify data under /.info/")},Qk=function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!jk(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),qk(t)}(n))throw new Error((0,Jt.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Yk{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Jk(t,e){let n=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();null!==n&&!UC(s,n.path)&&(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function Xk(t,e,n){Jk(t,n),eA(t,t=>UC(t,e))}function tA(t,e,n){Jk(t,n),eA(t,t=>jC(t,e)||jC(e,t))}function eA(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const r=t.eventLists_[i];r&&(e(r.path)?(nA(t.eventLists_[i]),t.eventLists_[i]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function nA(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const i=n.getEventRunner();FS&&jS("event: "+n.toString()),iC(i)}}}const iA="repo_interrupt";class rA{constructor(t,e,n,i){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Yk,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=VE(),this.transactionQueueTree_=new kk,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function sA(t){const e=t.infoData_.getNode(new xC(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function oA(t){return function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t}({timestamp:sA(t)})}function aA(t,e,n,i,r){t.dataUpdateCount++;const s=new xC(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){const e=(0,Jt.UI)(n,t=>wE(t));o=function(t,e,n,i){const r=gk(t,i);if(r){const i=yk(r),s=i.path,o=i.queryId,a=FC(s,e),l=sx.fromObject(n);return _k(t,s,new KE(HE(o),a,l))}return[]}(t.serverSyncTree_,s,e,r)}else{const e=wE(n);o=ak(t.serverSyncTree_,s,e,r)}else if(i){const e=(0,Jt.UI)(n,t=>wE(t));o=function(t,e,n){const i=sx.fromObject(n);return ck(t,new KE({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,s,e)}else{const e=wE(n);o=sk(t.serverSyncTree_,s,e)}let a=s;o.length>0&&(a=wA(t,s)),tA(t.eventQueue_,a,o)}function lA(t,e){uA(t,"connected",e),!1===e&&function(t){gA(t,"onDisconnectEvents");const e=oA(t),n=VE();qE(t.onDisconnect_,kC(),(i,r)=>{const s=Ck(i,r,t.serverSyncTree_,e);UE(n,i,s)});let i=[];qE(n,kC(),(e,n)=>{i=i.concat(sk(t.serverSyncTree_,e,n));const r=CA(t,e);wA(t,r)}),t.onDisconnect_=VE(),tA(t.eventQueue_,kC(),i)}(t)}function uA(t,e,n){const i=new xC("/.info/"+e),r=wE(n);t.infoData_.updateSnapshot(i,r);const s=sk(t.infoSyncTree_,i,r);tA(t.eventQueue_,i,s)}function cA(t){return t.nextWriteId_++}function hA(t,e,n,i,r){gA(t,"set",{path:e.toString(),value:n,priority:i});const s=oA(t),o=wE(n,i),a=uk(t.serverSyncTree_,e),l=Ek(o,a,s),u=cA(t),c=ik(t.serverSyncTree_,e,l,u,!0);Jk(t.eventQueue_,c),t.server_.put(e.toString(),o.val(!0),(n,i)=>{const s="ok"===n;s||ZS("set at "+e+" failed: "+n);const o=rk(t.serverSyncTree_,u,!s);tA(t.eventQueue_,e,o),yA(0,r,n,i)});const h=CA(t,e);wA(t,h),tA(t.eventQueue_,h,[])}function dA(t,e,n){t.server_.onDisconnectCancel(e.toString(),(i,r)=>{"ok"===i&&jE(t.onDisconnect_,e),yA(0,n,i,r)})}function pA(t,e,n,i){const r=wE(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(n,s)=>{"ok"===n&&UE(t.onDisconnect_,e,r),yA(0,i,n,s)})}function fA(t,e,n){let i;i=".info"===AC(e._path)?ok(t.infoSyncTree_,e,n):ok(t.serverSyncTree_,e,n),Xk(t.eventQueue_,e._path,i)}function mA(t){t.persistentConnection_&&t.persistentConnection_.interrupt(iA)}function gA(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),jS(n,...e)}function yA(t,e,n,i){e&&iC(()=>{if("ok"===n)e(null);else{const t=(n||"error").toUpperCase();let r=t;i&&(r+=": "+i);const s=new Error(r);s.code=t,e(s)}})}function _A(t,e,n){return uk(t.serverSyncTree_,e,n)||_E.EMPTY_NODE}function vA(t,e=t.transactionQueueTree_){if(e||SA(t,e),Pk(e)){const n=TA(t,e);(0,Jt.hu)(n.length>0,"Sending zero length transaction queue"),n.every(t=>0===t.status)&&function(t,e,n){const i=n.map(t=>t.currentWriteId),r=_A(t,e,i);let s=r;const o=r.hash();for(let u=0;u<n.length;u++){const t=n[u];(0,Jt.hu)(0===t.status,"tryToSendTransactionQueue_: items in queue should all be run."),t.status=1,t.retryCount++;const i=FC(e,t.path);s=s.updateChild(i,t.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;t.server_.put(l.toString(),a,i=>{gA(t,"transaction put response",{path:l.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let e=0;e<n.length;e++)n[e].status=2,r=r.concat(rk(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&i.push(()=>n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)),n[e].unwatcher();SA(t,Ak(t.transactionQueueTree_,e)),vA(t,t.transactionQueueTree_),tA(t.eventQueue_,e,r);for(let t=0;t<i.length;t++)iC(i[t])}else{if("datastale"===i)for(let t=0;t<n.length;t++)n[t].status=3===n[t].status?4:0;else{ZS("transaction at "+l.toString()+" failed: "+i);for(let t=0;t<n.length;t++)n[t].status=4,n[t].abortReason=i}wA(t,e)}},o)}(t,Lk(e),n)}else Dk(e)&&Ok(e,e=>{vA(t,e)})}function wA(t,e){const n=bA(t,e),i=Lk(n);return function(t,e,n){if(0===e.length)return;const i=[];let r=[];const s=e.filter(t=>0===t.status).map(t=>t.currentWriteId);for(let o=0;o<e.length;o++){const a=e[o],l=FC(n,a.path);let u,c=!1;if((0,Jt.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===a.status)c=!0,u=a.abortReason,r=r.concat(rk(t.serverSyncTree_,a.currentWriteId,!0));else if(0===a.status)if(a.retryCount>=25)c=!0,u="maxretry",r=r.concat(rk(t.serverSyncTree_,a.currentWriteId,!0));else{const n=_A(t,a.path,s);a.currentInputSnapshot=n;const i=e[o].update(n.val());if(void 0!==i){Zk("transaction failed: Data returned ",i,a.path);let e=wE(i);"object"==typeof i&&null!=i&&(0,Jt.r3)(i,".priority")||(e=e.updatePriority(n.getPriority()));const o=a.currentWriteId,l=oA(t),u=Ek(e,n,l);a.currentOutputSnapshotRaw=e,a.currentOutputSnapshotResolved=u,a.currentWriteId=cA(t),s.splice(s.indexOf(o),1),r=r.concat(ik(t.serverSyncTree_,a.path,u,a.currentWriteId,a.applyLocally)),r=r.concat(rk(t.serverSyncTree_,o,!0))}else c=!0,u="nodata",r=r.concat(rk(t.serverSyncTree_,a.currentWriteId,!0))}tA(t.eventQueue_,n,r),r=[],c&&(e[o].status=2,setTimeout(e[o].unwatcher,Math.floor(0)),e[o].onComplete&&i.push("nodata"===u?()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot):()=>e[o].onComplete(new Error(u),!1,null)))}SA(t,t.transactionQueueTree_);for(let o=0;o<i.length;o++)iC(i[o]);vA(t,t.transactionQueueTree_)}(t,TA(t,n),i),i}function bA(t,e){let n,i=t.transactionQueueTree_;for(n=AC(e);null!==n&&void 0===Pk(i);)i=Ak(i,n),n=AC(e=NC(e));return i}function TA(t,e){const n=[];return IA(t,e,n),n.sort((t,e)=>t.order-e.order),n}function IA(t,e,n){const i=Pk(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);Ok(e,e=>{IA(t,e,n)})}function SA(t,e){const n=Pk(e);if(n){let t=0;for(let e=0;e<n.length;e++)2!==n[e].status&&(n[t]=n[e],t++);n.length=t,Nk(e,n.length>0?n:void 0)}Ok(e,e=>{SA(t,e)})}function CA(t,e){const n=Lk(bA(t,e)),i=Ak(t.transactionQueueTree_,e);return function(t,e,n){let i=t.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,e=>{EA(t,e)}),EA(t,i),Rk(i,e=>{EA(t,e)}),n}function EA(t,e){const n=Pk(e);if(n){const i=[];let r=[],s=-1;for(let e=0;e<n.length;e++)3===n[e].status||(1===n[e].status?((0,Jt.hu)(s===e-1,"All SENT items should be at beginning of queue."),s=e,n[e].status=3,n[e].abortReason="set"):((0,Jt.hu)(0===n[e].status,"Unexpected transaction status in abort"),n[e].unwatcher(),r=r.concat(rk(t.serverSyncTree_,n[e].currentWriteId,!0)),n[e].onComplete&&i.push(n[e].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Nk(e,void 0):n.length=s+1,tA(t.eventQueue_,Lk(e),r);for(let t=0;t<i.length;t++)iC(i[t])}}const xA=function(t,e){const n=kA(t),i=n.namespace;return"firebase.com"===n.domain&&BS(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==n.domain&&BS("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ZS("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new hC(n.host,n.secure,i,"ws"===n.scheme||"wss"===n.scheme,e,"",i!==n.subdomain),path:new xC(n.pathString)}},kA=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",l=443;if("string"==typeof t){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let c=t.indexOf("/");-1===c&&(c=t.length);let h=t.indexOf("?");-1===h&&(h=t.length),e=t.substring(0,Math.min(c,h)),c<h&&(r=function(t){let e="";const n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let t=n[i];try{t=decodeURIComponent(t.replace(/\+/g," "))}catch(s){}e+="/"+t}return e}(t.substring(c,h)));const d=function(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ZS(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(o="https"===a||"wss"===a,l=parseInt(e.substring(u+1),10)):u=e.length;const p=e.slice(0,u);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const t=e.indexOf(".");i=e.substring(0,t).toLowerCase(),n=e.substring(t+1),s=i}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}},AA="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",PA=function(){let t=0;const e=[];return function(n){const i=n===t;let r;t=n;const s=new Array(8);for(r=7;r>=0;r--)s[r]=AA.charAt(n%64),n=Math.floor(n/64);(0,Jt.hu)(0===n,"Cannot push at time == 0");let o=s.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=AA.charAt(e[r]);return(0,Jt.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class NA{constructor(t,e,n,i){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=i}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,Jt.Wl)(this.snapshot.exportVal())}}class DA{constructor(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class OA{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return(0,Jt.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class RA{constructor(t,e){this._repo=t,this._path=e}cancel(){const t=new Jt.BH;return dA(this._repo,this._path,t.wrapCallback(()=>{})),t.promise}remove(){Kk("OnDisconnect.remove",this._path);const t=new Jt.BH;return pA(this._repo,this._path,null,t.wrapCallback(()=>{})),t.promise}set(t){Kk("OnDisconnect.set",this._path),Bk("OnDisconnect.set",t,this._path,!1);const e=new Jt.BH;return pA(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}setWithPriority(t,e){Kk("OnDisconnect.setWithPriority",this._path),Bk("OnDisconnect.setWithPriority",t,this._path,!1),$k("OnDisconnect.setWithPriority",e,!1);const n=new Jt.BH;return function(t,e,n,i,r){const s=wE(n,i);t.server_.onDisconnectPut(e.toString(),s.val(!0),(n,i)=>{"ok"===n&&UE(t.onDisconnect_,e,s),yA(0,r,n,i)})}(this._repo,this._path,t,e,n.wrapCallback(()=>{})),n.promise}update(t){Kk("OnDisconnect.update",this._path),Hk("OnDisconnect.update",t,this._path,!1);const e=new Jt.BH;return function(t,e,n,i){if((0,Jt.xb)(n))return jS("onDisconnect().update() called with empty data.  Don't do anything."),void yA(0,i,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(r,s)=>{"ok"===r&&XS(n,(n,i)=>{const r=wE(i);UE(t.onDisconnect_,LC(e,n),r)}),yA(0,i,r,s)})}(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}}class LA{constructor(t,e,n,i){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=i}get key(){return MC(this._path)?null:DC(this._path)}get ref(){return new UA(this._repo,this._path)}get _queryIdentifier(){const t=LE(this._queryParams),e=YS(t);return"{}"===e?"default":e}get _queryObject(){return LE(this._queryParams)}isEqual(t){if(!((t=(0,Jt.m9)(t))instanceof LA))return!1;const e=this._repo===t._repo,n=UC(this._path,t._path);return e&&n&&this._queryIdentifier===t._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}function MA(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function FA(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===YC){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==$S)throw new Error(i);if("string"!=typeof e)throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==WS)throw new Error(i);if("string"!=typeof n)throw new Error(r)}}else if(t.getIndex()===cE){if(null!=e&&!zk(e)||null!=n&&!zk(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,Jt.hu)(t.getIndex()instanceof bE||t.getIndex()===TE,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function VA(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class UA extends LA{constructor(t,e){super(t,e,new PE,!1)}get parent(){const t=RC(this._path);return null===t?null:new UA(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class jA{constructor(t,e,n){this._node=t,this.ref=e,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new xC(t),n=BA(this.ref,t);return new jA(this._node.getChild(e),n,cE)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(e,n)=>t(new jA(n,BA(this.ref,e),cE)))}hasChild(t){const e=new xC(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function qA(t,e){return(t=(0,Jt.m9)(t))._checkNotDeleted("ref"),void 0!==e?BA(t._root,e):t._root}function zA(t,e){(t=(0,Jt.m9)(t))._checkNotDeleted("refFromURL");const n=xA(e,t._repo.repoInfo_.nodeAdmin);Qk("refFromURL",n);const i=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&i.host!==t._repo.repoInfo_.host&&BS("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+t._repo.repoInfo_.host+")"),qA(t,n.path.toString())}function BA(t,e){return null===AC((t=(0,Jt.m9)(t))._path)?(n=e,n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Gk("child","path",n,!1)):Gk("child","path",e,!1),new UA(t._repo,LC(t._path,e));var n}function ZA(t,e){t=(0,Jt.m9)(t),Kk("set",t._path),Bk("set",e,t._path,!1);const n=new Jt.BH;return hA(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function HA(t,e){Hk("update",e,t._path,!1);const n=new Jt.BH;return function(t,e,n,i){gA(t,"update",{path:e.toString(),value:n});let r=!0;const s=oA(t),o={};if(XS(n,(n,i)=>{r=!1,o[n]=Ck(LC(e,n),wE(i),t.serverSyncTree_,s)}),r)jS("update() called with empty data.  Don't do anything."),yA(0,i,"ok",void 0);else{const r=cA(t),s=function(t,e,n,i){!function(t,e,n,i){(0,Jt.hu)(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=lx(t.visibleWrites,e,n),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i);const r=sx.fromObject(n);return ck(t,new KE({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,e,o,r);Jk(t.eventQueue_,s),t.server_.merge(e.toString(),n,(n,s)=>{const o="ok"===n;o||ZS("update at "+e+" failed: "+n);const a=rk(t.serverSyncTree_,r,!o),l=a.length>0?wA(t,e):e;tA(t.eventQueue_,l,a),yA(0,i,n,s)}),XS(n,n=>{const i=CA(t,LC(e,n));wA(t,i)}),tA(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function $A(t){t=(0,Jt.m9)(t);const e=new OA(()=>{}),n=new WA(e);return function(t,e,n){const i=function(t,e){const n=e._path;let i=null;t.syncPointTree_.foreachOnPath(n,(t,e)=>{const r=FC(t,n);i=i||Qx(e,r)});let r=t.syncPointTree_.get(n);r?i=i||Qx(r,kC()):(r=new $x,t.syncPointTree_=t.syncPointTree_.set(n,r));const s=null!=i,o=s?new QE(i,!0,!1):null;return function(t){return nx(t.viewCache_)}(Gx(r,e,yx(t.pendingWriteTree_,e._path),s?o.getNode():_E.EMPTY_NODE,s))}(t.serverSyncTree_,e);return null!=i?Promise.resolve(i):t.server_.get(e).then(i=>{const r=wE(i).withIndex(e._queryParams.getIndex());let s;if(lk(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())s=sk(t.serverSyncTree_,e._path,r);else{const n=fk(t.serverSyncTree_,e);s=ak(t.serverSyncTree_,e._path,r,n)}return tA(t.eventQueue_,e._path,s),ok(t.serverSyncTree_,e,n,null,!0),r},n=>(gA(t,"get for query "+(0,Jt.Wl)(e)+" failed: "+n),Promise.reject(new Error(n))))}(t._repo,t,n).then(e=>new jA(e,new UA(t._repo,t._path),t._queryParams.getIndex()))}class WA{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const n=e._queryParams.getIndex();return new NA("value",this,new jA(t.snapshotNode,new UA(e._repo,e._path),n))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new DA(this,t,e):null}matches(t){return t instanceof WA&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class GA{constructor(t,e){this.eventType=t,this.callbackContext=e}respondsTo(t){let e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new DA(this,t,e):null}createEvent(t,e){(0,Jt.hu)(null!=t.childName,"Child events should have a childName.");const n=BA(new UA(e._repo,e._path),t.childName),i=e._queryParams.getIndex();return new NA(t.type,this,new jA(t.snapshotNode,n,i),t.prevName)}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof GA&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function KA(t,e,n,i,r){let s;if("object"==typeof i&&(s=void 0,r=i),"function"==typeof i&&(s=i),r&&r.onlyOnce){const e=n,i=(n,i)=>{fA(t._repo,t,a),e(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new OA(n,s||void 0),a="value"===e?new WA(o):new GA(e,o);return function(t,e,n){let i;i=".info"===AC(e._path)?lk(t.infoSyncTree_,e,n):lk(t.serverSyncTree_,e,n),Xk(t.eventQueue_,e._path,i)}(t._repo,t,a),()=>fA(t._repo,t,a)}function QA(t,e,n,i){return KA(t,"value",e,n,i)}function YA(t,e,n,i){return KA(t,"child_added",e,n,i)}function JA(t,e,n,i){return KA(t,"child_changed",e,n,i)}function XA(t,e,n,i){return KA(t,"child_moved",e,n,i)}function tP(t,e,n,i){return KA(t,"child_removed",e,n,i)}function eP(t,e,n){let i=null;const r=n?new OA(n):null;"value"===e?i=new WA(r):e&&(i=new GA(e,r)),fA(t._repo,t,i)}class nP{}class iP extends nP{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){Bk("endAt",this._value,t._path,!0);const e=DE(t._queryParams,this._value,this._key);if(VA(e),FA(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new LA(t._repo,t._path,e,t._orderByCalled)}}class rP extends nP{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){Bk("endBefore",this._value,t._path,!1);const e=function(t,e,n){let i;return i=DE(t,e,t.index_===YC||n?n:$S),i.endBeforeSet_=!0,i}(t._queryParams,this._value,this._key);if(VA(e),FA(e),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new LA(t._repo,t._path,e,t._orderByCalled)}}class sP extends nP{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){Bk("startAt",this._value,t._path,!0);const e=NE(t._queryParams,this._value,this._key);if(VA(e),FA(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new LA(t._repo,t._path,e,t._orderByCalled)}}class oP extends nP{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){Bk("startAfter",this._value,t._path,!1);const e=function(t,e,n){let i;return i=NE(t,e,t.index_===YC||n?n:WS),i.startAfterSet_=!0,i}(t._queryParams,this._value,this._key);if(VA(e),FA(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new LA(t._repo,t._path,e,t._orderByCalled)}}class aP extends nP{constructor(t){super(),this._limit=t}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new LA(t._repo,t._path,function(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(t._queryParams,this._limit),t._orderByCalled)}}class lP extends nP{constructor(t){super(),this._limit=t}_apply(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new LA(t._repo,t._path,function(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(t._queryParams,this._limit),t._orderByCalled)}}class uP extends nP{constructor(t){super(),this._path=t}_apply(t){MA(t,"orderByChild");const e=new xC(this._path);if(MC(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new bE(e),i=OE(t._queryParams,n);return FA(i),new LA(t._repo,t._path,i,!0)}}class cP extends nP{_apply(t){MA(t,"orderByKey");const e=OE(t._queryParams,YC);return FA(e),new LA(t._repo,t._path,e,!0)}}class hP extends nP{_apply(t){MA(t,"orderByPriority");const e=OE(t._queryParams,cE);return FA(e),new LA(t._repo,t._path,e,!0)}}class dP extends nP{_apply(t){MA(t,"orderByValue");const e=OE(t._queryParams,TE);return FA(e),new LA(t._repo,t._path,e,!0)}}class pP extends nP{constructor(t,e){super(),this._value=t,this._key=e}_apply(t){if(Bk("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new iP(this._value,this._key)._apply(new sP(this._value,this._key)._apply(t))}}function fP(t,...e){let n=(0,Jt.m9)(t);for(const i of e)n=i._apply(n);return n}(function(t){(0,Jt.hu)(!Zx,"__referenceConstructor has already been defined"),Zx=t})(UA),function(t){(0,Jt.hu)(!Hx,"__referenceConstructor has already been defined"),Hx=t}(UA);const mP={};function gP(t,e,n,i,r){let s=i||t.options.databaseURL;void 0===s&&(t.options.projectId||BS("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),jS("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o,a,l=xA(s,r),u=l.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${u.namespace}`,l=xA(s,r),u=l.repoInfo):o=!l.repoInfo.secure;const c=r&&o?new aC(aC.OWNER):new oC(t.name,t.options,e);Qk("Invalid Firebase Database URL",l),MC(l.path)||BS("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(t,e,n,i){let r=mP[e.name];r||(r={},mP[e.name]=r);let s=r[t.toURLString()];return s&&BS("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new rA(t,false,n,i),r[t.toURLString()]=s,s}(u,t,c,new sC(t.name,n));return new yP(h,t)}class yP{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function(t,e,n){if(t.stats_=gC(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new ME(t.repoInfo_,(e,n,i,r)=>{aA(t,e,n,i,r)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>lA(t,!0),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,Jt.Wl)(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new WC(t.repoInfo_,e,(e,n,i,r)=>{aA(t,e,n,i,r)},e=>{lA(t,e)},e=>{!function(t,e){XS(e,(e,n)=>{uA(t,e,n)})}(t,e)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(e=>{t.server_.refreshAuthToken(e)}),t.appCheckProvider_.addTokenChangeListener(e=>{t.server_.refreshAppCheckToken(e.token)}),t.statsReporter_=function(t,e){const n=t.toString();return mC[n]||(mC[n]=e()),mC[n]}(t.repoInfo_,()=>new BE(t.stats_,t.server_)),t.infoData_=new FE,t.infoSyncTree_=new nk({startListening:(e,n,i,r)=>{let s=[];const o=t.infoData_.getNode(e._path);return o.isEmpty()||(s=sk(t.infoSyncTree_,e._path,o),setTimeout(()=>{r("ok")},0)),s},stopListening:()=>{}}),uA(t,"connected",!1),t.serverSyncTree_=new nk({startListening:(e,n,i,r)=>(t.server_.listen(e,i,n,(n,i)=>{const s=r(n,i);tA(t.eventQueue_,e._path,s)}),[]),stopListening:(e,n)=>{t.server_.unlisten(e,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new UA(this._repo,kC())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(t,e){const n=mP[e];(!n||n[t.key]!==t)&&BS(`Database ${e}(${t.repoInfo_}) has already been deleted.`),mA(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&BS("Cannot call "+t+" on a deleted database.")}}function _P(){TC.IS_TRANSPORT_INITIALIZED&&ZS("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function vP(){_P(),_C.forceDisallow()}function wP(){_P(),bC.forceDisallow(),_C.forceAllow()}function bP(t,e){US(t,e)}class TP{constructor(t,e){this.committed=t,this.snapshot=e}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}WC.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},WC.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},xS(Kt.SDK_VERSION),(0,Kt._registerComponent)(new Qt.wA("database",(t,{instanceIdentifier:e})=>gP(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e),"PUBLIC").setMultipleInstances(!0)),(0,Kt.registerVersion)(CS,"0.14.0",void 0),(0,Kt.registerVersion)(CS,"0.14.0","esm2017");const IP=new Yt.Yd("@firebase/database-compat"),SP=function(t){IP.warn("FIREBASE WARNING: "+t)};class CP{constructor(t){this._delegate=t}cancel(t){(0,Jt.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,Jt.Wj)("OnDisconnect.cancel","onComplete",t,!0);const e=this._delegate.cancel();return t&&e.then(()=>t(null),e=>t(e)),e}remove(t){(0,Jt.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,Jt.Wj)("OnDisconnect.remove","onComplete",t,!0);const e=this._delegate.remove();return t&&e.then(()=>t(null),e=>t(e)),e}set(t,e){(0,Jt.Dv)("OnDisconnect.set",1,2,arguments.length),(0,Jt.Wj)("OnDisconnect.set","onComplete",e,!0);const n=this._delegate.set(t);return e&&n.then(()=>e(null),t=>e(t)),n}setWithPriority(t,e,n){(0,Jt.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,Jt.Wj)("OnDisconnect.setWithPriority","onComplete",n,!0);const i=this._delegate.setWithPriority(t,e);return n&&i.then(()=>n(null),t=>n(t)),i}update(t,e){if((0,Jt.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){const e={};for(let n=0;n<t.length;++n)e[""+n]=t[n];t=e,SP("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,Jt.Wj)("OnDisconnect.update","onComplete",e,!0);const n=this._delegate.update(t);return e&&n.then(()=>e(null),t=>e(t)),n}}class EP{constructor(t,e){this.committed=t,this.snapshot=e}toJSON(){return(0,Jt.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class xP{constructor(t,e){this._database=t,this._delegate=e}val(){return(0,Jt.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,Jt.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,Jt.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,Jt.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(t){return(0,Jt.Dv)("DataSnapshot.child",0,1,arguments.length),t=String(t),Gk("DataSnapshot.child","path",t,!1),new xP(this._database,this._delegate.child(t))}hasChild(t){return(0,Jt.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Gk("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)}getPriority(){return(0,Jt.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(t){return(0,Jt.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,Jt.Wj)("DataSnapshot.forEach","action",t,!1),this._delegate.forEach(e=>t(new xP(this._database,e)))}hasChildren(){return(0,Jt.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,Jt.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,Jt.Dv)("DataSnapshot.ref",0,0,arguments.length),new AP(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class kP{constructor(t,e){this.database=t,this._delegate=e}on(t,e,n,i){var r;(0,Jt.Dv)("Query.on",2,4,arguments.length),(0,Jt.Wj)("Query.on","callback",e,!1);const s=kP.getCancelAndContextArgs_("Query.on",n,i),o=(t,n)=>{e.call(s.context,new xP(this.database,t),n)};o.userCallback=e,o.context=s.context;const a=null===(r=s.cancel)||void 0===r?void 0:r.bind(s.context);switch(t){case"value":return QA(this._delegate,o,a),e;case"child_added":return YA(this._delegate,o,a),e;case"child_removed":return tP(this._delegate,o,a),e;case"child_changed":return JA(this._delegate,o,a),e;case"child_moved":return XA(this._delegate,o,a),e;default:throw new Error((0,Jt.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(t,e,n){if((0,Jt.Dv)("Query.off",0,3,arguments.length),function(t,e,n){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,Jt.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,t),(0,Jt.Wj)("Query.off","callback",e,!0),(0,Jt.lb)("Query.off","context",n,!0),e){const i=()=>{};i.userCallback=e,i.context=n,eP(this._delegate,t,i)}else eP(this._delegate,t)}get(){return $A(this._delegate).then(t=>new xP(this.database,t))}once(t,e,n,i){(0,Jt.Dv)("Query.once",1,4,arguments.length),(0,Jt.Wj)("Query.once","callback",e,!0);const r=kP.getCancelAndContextArgs_("Query.once",n,i),s=new Jt.BH,o=(t,n)=>{const i=new xP(this.database,t);e&&e.call(r.context,i,n),s.resolve(i)};o.userCallback=e,o.context=r.context;const a=t=>{r.cancel&&r.cancel.call(r.context,t),s.reject(t)};switch(t){case"value":QA(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":YA(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":tP(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":JA(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":XA(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error((0,Jt.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(t){return(0,Jt.Dv)("Query.limitToFirst",1,1,arguments.length),new kP(this.database,fP(this._delegate,function(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new aP(t)}(t)))}limitToLast(t){return(0,Jt.Dv)("Query.limitToLast",1,1,arguments.length),new kP(this.database,fP(this._delegate,function(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new lP(t)}(t)))}orderByChild(t){return(0,Jt.Dv)("Query.orderByChild",1,1,arguments.length),new kP(this.database,fP(this._delegate,function(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Gk("orderByChild","path",t,!1),new uP(t)}(t)))}orderByKey(){return(0,Jt.Dv)("Query.orderByKey",0,0,arguments.length),new kP(this.database,fP(this._delegate,new cP))}orderByPriority(){return(0,Jt.Dv)("Query.orderByPriority",0,0,arguments.length),new kP(this.database,fP(this._delegate,new hP))}orderByValue(){return(0,Jt.Dv)("Query.orderByValue",0,0,arguments.length),new kP(this.database,fP(this._delegate,new dP))}startAt(t=null,e){return(0,Jt.Dv)("Query.startAt",0,2,arguments.length),new kP(this.database,fP(this._delegate,function(t=null,e){return Wk("startAt","key",e,!0),new sP(t,e)}(t,e)))}startAfter(t=null,e){return(0,Jt.Dv)("Query.startAfter",0,2,arguments.length),new kP(this.database,fP(this._delegate,function(t,e){return Wk("startAfter","key",e,!0),new oP(t,e)}(t,e)))}endAt(t=null,e){return(0,Jt.Dv)("Query.endAt",0,2,arguments.length),new kP(this.database,fP(this._delegate,function(t,e){return Wk("endAt","key",e,!0),new iP(t,e)}(t,e)))}endBefore(t=null,e){return(0,Jt.Dv)("Query.endBefore",0,2,arguments.length),new kP(this.database,fP(this._delegate,function(t,e){return Wk("endBefore","key",e,!0),new rP(t,e)}(t,e)))}equalTo(t,e){return(0,Jt.Dv)("Query.equalTo",1,2,arguments.length),new kP(this.database,fP(this._delegate,function(t,e){return Wk("equalTo","key",e,!0),new pP(t,e)}(t,e)))}toString(){return(0,Jt.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,Jt.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(t){if((0,Jt.Dv)("Query.isEqual",1,1,arguments.length),!(t instanceof kP))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(t._delegate)}static getCancelAndContextArgs_(t,e,n){const i={cancel:void 0,context:void 0};if(e&&n)i.cancel=e,(0,Jt.Wj)(t,"cancel",i.cancel,!0),i.context=n,(0,Jt.lb)(t,"context",i.context,!0);else if(e)if("object"==typeof e&&null!==e)i.context=e;else{if("function"!=typeof e)throw new Error((0,Jt.gK)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=e}return i}get ref(){return new AP(this.database,new UA(this._delegate._repo,this._delegate._path))}}class AP extends kP{constructor(t,e){super(t,new LA(e._repo,e._path,new PE,!1)),this.database=t,this._delegate=e}getKey(){return(0,Jt.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(t){return(0,Jt.Dv)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new AP(this.database,BA(this._delegate,t))}getParent(){(0,Jt.Dv)("Reference.parent",0,0,arguments.length);const t=this._delegate.parent;return t?new AP(this.database,t):null}getRoot(){return(0,Jt.Dv)("Reference.root",0,0,arguments.length),new AP(this.database,this._delegate.root)}set(t,e){(0,Jt.Dv)("Reference.set",1,2,arguments.length),(0,Jt.Wj)("Reference.set","onComplete",e,!0);const n=ZA(this._delegate,t);return e&&n.then(()=>e(null),t=>e(t)),n}update(t,e){if((0,Jt.Dv)("Reference.update",1,2,arguments.length),Array.isArray(t)){const e={};for(let n=0;n<t.length;++n)e[""+n]=t[n];t=e,SP("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Kk("Reference.update",this._delegate._path),(0,Jt.Wj)("Reference.update","onComplete",e,!0);const n=HA(this._delegate,t);return e&&n.then(()=>e(null),t=>e(t)),n}setWithPriority(t,e,n){(0,Jt.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,Jt.Wj)("Reference.setWithPriority","onComplete",n,!0);const i=function(t,e,n){if(Kk("setWithPriority",t._path),Bk("setWithPriority",e,t._path,!1),$k("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";const i=new Jt.BH;return hA(t._repo,t._path,e,n,i.wrapCallback(()=>{})),i.promise}(this._delegate,t,e);return n&&i.then(()=>n(null),t=>n(t)),i}remove(t){(0,Jt.Dv)("Reference.remove",0,1,arguments.length),(0,Jt.Wj)("Reference.remove","onComplete",t,!0);const e=function(t){return Kk("remove",t._path),ZA(t,null)}(this._delegate);return t&&e.then(()=>t(null),e=>t(e)),e}transaction(t,e,n){(0,Jt.Dv)("Reference.transaction",1,3,arguments.length),(0,Jt.Wj)("Reference.transaction","transactionUpdate",t,!1),(0,Jt.Wj)("Reference.transaction","onComplete",e,!0),function(t,e,n,i){if(void 0!==n&&"boolean"!=typeof n)throw new Error((0,Jt.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,n);const i=function(t,e,n){var i;if(t=(0,Jt.m9)(t),Kk("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=null===(i=null==n?void 0:n.applyLocally)||void 0===i||i,s=new Jt.BH,o=QA(t,()=>{});return function(t,e,n,i,r,s){gA(t,"transaction on "+e);const o={path:e,update:n,onComplete:i,status:null,order:RS(),applyLocally:s,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=_A(t,e,void 0);o.currentInputSnapshot=a;const l=o.update(a.val());if(void 0===l)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Zk("transaction failed: Data returned ",l,o.path),o.status=0;const n=Ak(t.transactionQueueTree_,e),i=Pk(n)||[];let r;i.push(o),Nk(n,i),"object"==typeof l&&null!==l&&(0,Jt.r3)(l,".priority")?(r=(0,Jt.DV)(l,".priority"),(0,Jt.hu)(zk(r),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):r=(uk(t.serverSyncTree_,e)||_E.EMPTY_NODE).getPriority().val();const s=oA(t),u=wE(l,r),c=Ek(u,a,s);o.currentOutputSnapshotRaw=u,o.currentOutputSnapshotResolved=c,o.currentWriteId=cA(t);const h=ik(t.serverSyncTree_,e,c,o.currentWriteId,o.applyLocally);tA(t.eventQueue_,e,h),vA(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(e,n,i)=>{let r=null;e?s.reject(e):(r=new jA(i,new UA(t._repo,t._path),cE),s.resolve(new TP(n,r)))},o,r),s.promise}(this._delegate,t,{applyLocally:n}).then(t=>new EP(t.committed,new xP(this.database,t.snapshot)));return e&&i.then(t=>e(null,t.committed,t.snapshot),t=>e(t,!1,null)),i}setPriority(t,e){(0,Jt.Dv)("Reference.setPriority",1,2,arguments.length),(0,Jt.Wj)("Reference.setPriority","onComplete",e,!0);const n=function(t,e){t=(0,Jt.m9)(t),Kk("setPriority",t._path),$k("setPriority",e,!1);const n=new Jt.BH;return hA(t._repo,LC(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}(this._delegate,t);return e&&n.then(()=>e(null),t=>e(t)),n}push(t,e){(0,Jt.Dv)("Reference.push",0,2,arguments.length),(0,Jt.Wj)("Reference.push","onComplete",e,!0);const n=function(t,e){t=(0,Jt.m9)(t),Kk("push",t._path),Bk("push",e,t._path,!0);const n=sA(t._repo),i=PA(n),r=BA(t,i),s=BA(t,i);let o;return o=null!=e?ZA(s,e).then(()=>s):Promise.resolve(s),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}(this._delegate,t),i=n.then(t=>new AP(this.database,t));e&&i.then(()=>e(null),t=>e(t));const r=new AP(this.database,n);return r.then=i.then.bind(i),r.catch=i.catch.bind(i,void 0),r}onDisconnect(){return Kk("Reference.onDisconnect",this._delegate._path),new CP(new RA(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class PP{constructor(t,e){this._delegate=t,this.app=e,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:vP,forceLongPolling:wP}}useEmulator(t,e,n={}){!function(t,e,n,i={}){(t=(0,Jt.m9)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&BS("Cannot call useEmulator() after instance has already been initialized.");const r=t._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&BS('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new aC(aC.OWNER);else if(i.mockUserToken){const e="string"==typeof i.mockUserToken?i.mockUserToken:(0,Jt.Sg)(i.mockUserToken,t.app.options.projectId);s=new aC(e)}!function(t,e,n,i){t.repoInfo_=new hC(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),i&&(t.authTokenProvider_=i)}(r,e,n,s)}(this._delegate,t,e,n)}ref(t){if((0,Jt.Dv)("database.ref",0,1,arguments.length),t instanceof AP){const e=zA(this._delegate,t.toString());return new AP(this,e)}{const e=qA(this._delegate,t);return new AP(this,e)}}refFromURL(t){(0,Jt.Dv)("database.refFromURL",1,1,arguments.length);const e=zA(this._delegate,t);return new AP(this,e)}goOffline(){return(0,Jt.Dv)("database.goOffline",0,0,arguments.length),function(t){(t=(0,Jt.m9)(t))._checkNotDeleted("goOffline"),mA(t._repo)}(this._delegate)}goOnline(){return(0,Jt.Dv)("database.goOnline",0,0,arguments.length),function(t){(t=(0,Jt.m9)(t))._checkNotDeleted("goOnline"),function(t){t.persistentConnection_&&t.persistentConnection_.resume(iA)}(t._repo)}(this._delegate)}}PP.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:t=>function(t){return{".sv":{increment:t}}}(t)};var NP=Object.freeze({__proto__:null,initStandalone:function({app:t,url:e,version:n,customAuthImpl:i,namespace:r,nodeAdmin:s=!1}){xS(n);const o=new Qt.zt("auth-internal",new Qt.H0("database-standalone"));return o.setComponent(new Qt.wA("auth-internal",()=>i,"PRIVATE")),{instance:new PP(gP(t,o,void 0,e,s),t),namespace:r}}});const DP=PP.ServerValue;function OP(t){return null==t}function RP(t){return"function"==typeof t.set}function LP(t,e){return RP(e)?e:t.ref(e)}function MP(t,e){if(function(t){return"string"==typeof t}(t))return e.stringCase();if(RP(t))return e.firebaseCase();if(function(t){return"function"==typeof t.exportVal}(t))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof t)}function FP(t,e,n="on",i=It.z){return new St.y(r=>{let s=null;return s=t[n](e,(t,e)=>{i.schedule(()=>{r.next({snapshot:t,prevKey:e})}),"once"===n&&i.schedule(()=>r.complete())},t=>{i.schedule(()=>r.error(t))}),"on"===n?{unsubscribe(){null!=s&&t.off(e,s)}}:{unsubscribe(){}}}).pipe((0,Mt.U)(t=>{const{snapshot:n,prevKey:i}=t;let r=null;return n.exists()&&(r=n.key),{type:e,payload:n,prevKey:i,key:r}}),(0,wS.B)())}function VP(t,e){const n=t.length;for(let i=0;i<n;i++)if(t[i].payload.key===e)return i;return-1}function UP(t,e){const{payload:n,prevKey:i,key:r}=e,s=VP(t,r),o=function(t,e){if(OP(e))return 0;{const n=VP(t,e);return-1===n?t.length:n+1}}(t,i);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let n=null;e.payload.forEach(e=>{const i={payload:e,type:"value",prevKey:n,key:e.key};return n=e.key,t=[...t,i],!1})}return t;case"child_added":if(s>-1){const r=t[s-1];(r&&r.key||null)!==i&&(t=t.filter(t=>t.payload.key!==n.key)).splice(o,0,e)}else{if(null==i)return[e,...t];(t=t.slice()).splice(o,0,e)}return t;case"child_removed":return t.filter(t=>t.payload.key!==n.key);case"child_changed":return t.map(t=>t.payload.key===r?e:t);case"child_moved":if(s>-1){const e=t.splice(s,1)[0];return(t=t.slice()).splice(o,0,e),t}return t;default:return t}}function jP(t){return(OP(t)||0===t.length)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function qP(t,e,n){return function(t,e,n){return FP(t,"value","once",n).pipe(Ly(i=>{const r=[(0,Et.of)(i)];return e.forEach(e=>r.push(FP(t,e,"on",n))),(0,Dy.T)(...r).pipe(Ft(UP,[]))}),jt())}(t,e=jP(e),n)}function zP(t,e,n){const i=(e=jP(e)).map(e=>FP(t,e,"on",n));return(0,Dy.T)(...i)}function BP(t,e){return function(n,i){return MP(n,{stringCase:()=>t.child(n)[e](i),firebaseCase:()=>n[e](i),snapshotCase:()=>n.ref[e](i)})}}function ZP(t){return function(e){return e?MP(e,{stringCase:()=>t.child(e).remove(),firebaseCase:()=>e.remove(),snapshotCase:()=>e.ref.remove()}):t.remove()}}function HP(t,e){return function(){return FP(t,"value","on",e)}}!function(t){t.INTERNAL.registerComponent(new Qt.wA("database-compat",(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("database").getImmediate({identifier:e});return new PP(i,n)},"PUBLIC").setServiceProps({Reference:AP,Query:kP,Database:PP,DataSnapshot:xP,enableLogging:bP,INTERNAL:NP,ServerValue:DP}).setMultipleInstances(!0)),t.registerVersion("@firebase/database-compat","0.3.0")}(Wt.Z);const $P=new i.OlP("angularfire2.realtimeDatabaseURL"),WP=new i.OlP("angularfire2.database.use-emulator");let GP=(()=>{class t{constructor(t,e,n,i,r,s,o,a,l,u,c,h,d,p,f){this.schedulers=s;const m=o,g=(0,Tt.on)(t,r,e);a&&W_(g,r,l,c,h,d,u,p),this.database=(0,Tt.cc)(`${g.name}.database.${n}`,"AngularFireDatabase",g.name,()=>{const t=r.runOutsideAngular(()=>g.database(n||void 0));return m&&t.useEmulator(...m),t},[m])}list(t,e){const n=this.schedulers.ngZone.runOutsideAngular(()=>LP(this.database,t));let i=n;return e&&(i=e(n)),function(t,e){const n=e.schedulers.outsideAngular,i=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:BP(i,"update"),set:BP(i,"set"),push:t=>i.push(t),remove:ZP(i),snapshotChanges:e=>qP(t,e,n).pipe(xt.iC),stateChanges:e=>zP(t,e,n).pipe(xt.iC),auditTrail:e=>function(t,e,n){return function(t,e,n){return function(t,e){return FP(t,"value","on",e).pipe((0,Mt.U)(t=>{let e;return t.payload.forEach(t=>(e=t.key,!1)),{data:t,lastKeyToLoad:e}}))}(t,n).pipe(function(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new bS(t,n))}}(e),(0,Mt.U)(([t,e])=>{const n=t.lastKeyToLoad,i=e.map(t=>t.key);return{actions:e,lastKeyToLoad:n,loadedKeys:i}}),function(t){return e=>e.lift(new IS(t))}(t=>-1===t.loadedKeys.indexOf(t.lastKeyToLoad)),(0,Mt.U)(t=>t.actions))}(t,zP(t,e).pipe(Ft((t,e)=>[...t,e],[])),n)}(t,e,n).pipe(xt.iC),valueChanges:(e,i)=>qP(t,e,n).pipe((0,Mt.U)(t=>t.map(t=>i&&i.idField?Object.assign(Object.assign({},t.payload.val()),{[i.idField]:t.key}):t.payload.val())),xt.iC)}}(i,this)}object(t){return function(t,e){return{query:t,snapshotChanges:()=>HP(t,e.schedulers.outsideAngular)().pipe(xt.iC),update:e=>t.ref.update(e),set:e=>t.ref.set(e),remove:()=>t.ref.remove(),valueChanges:()=>HP(t,e.schedulers.outsideAngular)().pipe(xt.iC,(0,Mt.U)(t=>t.payload.exists()?t.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>LP(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Tt.Dh),i.LFG(Tt.xv,8),i.LFG($P,8),i.LFG(i.Lbi),i.LFG(i.R0b),i.LFG(xt.HU),i.LFG(WP,8),i.LFG(G_,8),i.LFG(q_,8),i.LFG(z_,8),i.LFG(B_,8),i.LFG(Z_,8),i.LFG(H_,8),i.LFG($_,8),i.LFG(U_,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"any"}),t})(),KP=(()=>{class t{constructor(t){this.afd=t}getReplies(){return this.afd.list("/replies").snapshotChanges().pipe((0,Mt.U)(t=>t.map(t=>this._mapper(t))))}getVotes(){return this.afd.list("/votes").snapshotChanges().pipe((0,Mt.U)(t=>t.map(t=>this._mapper(t))))}_mapper(t){return t.payload.val()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(GP))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),QP=(()=>{class t{constructor(t){this.firebaseService=t}addReply(t){alert(JSON.stringify(t))}getAllReplies(){return this.firebaseService.getReplies()}getAvatarColor(){const t=["2980B9","3498DB","D35400","27AE60","2ECC71","F39C12","F1C40F","16A085","1ABC9C","7F8C8D","95A5A6","2C3E50","34495E","BDC3C7","8E44AD","9B59B6","C0392B","E74C3C","A94136","B49255","9BA37E","F69785","D870AD","EC87BF"];return`#${t[Math.floor(t.length*Math.random())]}`}getRepliesById(t){return this.getAllReplies().pipe((0,Mt.U)(e=>e.filter(e=>e.id===t)))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(KP))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),YP=(()=>{class t{constructor(t){this._replyService=t,this.replyAuthor=new cS(""),this.replyContent=new cS("")}addReply(){this._replyService.addReply({id:this._replyService.activeId,col:this._replyService.getAvatarColor(),mail:`${this.replyAuthor.value}@gmail.com`.toLowerCase(),name:this.replyAuthor.value,text:this.replyContent.value,ts:Date.now().valueOf()}),this._clearForm()}_clearForm(){this.replyAuthor.setValue(""),this.replyContent.setValue("")}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(QP))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-modal"]],decls:23,vars:2,consts:[[1,"modal-dialog"],["id","replyModal","tabindex","-1","aria-labelledby","replyModalLabel","aria-hidden","true",1,"modal","fade",2,"margin-top","31vh"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"form-group","mb-3"],["for","replyAuthor",1,"form-label"],["id","replyAuthor","type","text",1,"form-control",3,"formControl"],[1,"form-group"],["for","replyContent",1,"form-label"],["id","replyContent","type","text","rows","3",1,"form-control",3,"formControl"],[1,"modal-footer","justify-content-between"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",2,"width","100px"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary",2,"width","100px",3,"click"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"div",0),i.TgZ(3,"div",2),i.TgZ(4,"div",3),i.TgZ(5,"h5",4),i._uU(6,"Dodaj komentarz..."),i.qZA(),i._UZ(7,"button",5),i.qZA(),i.TgZ(8,"div",6),i.TgZ(9,"form"),i.TgZ(10,"div",7),i.TgZ(11,"label",8),i._uU(12,"Autor:"),i.qZA(),i._UZ(13,"input",9),i.qZA(),i.TgZ(14,"div",10),i.TgZ(15,"label",11),i._uU(16,"Tre\u015b\u0107 komentarza: "),i.qZA(),i._UZ(17,"textarea",12),i.qZA(),i.qZA(),i.qZA(),i.TgZ(18,"div",13),i.TgZ(19,"button",14),i._uU(20," Odrzu\u0107 "),i.qZA(),i.TgZ(21,"button",15),i.NdJ("click",function(){return e.addReply()}),i._uU(22," Dodaj "),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(13),i.Q6J("formControl",e.replyAuthor),i.xp6(4),i.Q6J("formControl",e.replyContent))},directives:[pS,GI,EI,WI,yS],encapsulation:2}),t})(),JP=(()=>{class t{constructor(){this.currentYear=""}ngOnInit(){const t=(new Date).getFullYear();this.currentYear=t.toString()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-footer"]],decls:7,vars:1,consts:[[1,"container","d-flex","flex-column","flex-sm-row","align-items-center","justify-content-center","py-2"],[1,"d-flex","text-light"],[1,"d-flex","d-none","d-sm-flex","text-light"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._uU(2,"\xae Marcin Rochowski"),i.qZA(),i.TgZ(3,"div",2),i._uU(4,",\xa0"),i.qZA(),i.TgZ(5,"div",1),i._uU(6),i.qZA(),i.qZA()),2&t&&(i.xp6(6),i.hij("2016 - ",e.currentYear,""))},encapsulation:2}),t})(),XP=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-root"]],decls:8,vars:0,consts:[[1,"bg-dark"],[1,"container"]],template:function(t,e){1&t&&(i.TgZ(0,"nav",0),i._UZ(1,"app-header"),i.qZA(),i.TgZ(2,"div",1),i.TgZ(3,"main"),i._UZ(4,"router-outlet"),i.qZA(),i._UZ(5,"app-modal"),i.qZA(),i.TgZ(6,"footer",0),i._UZ(7,"app-footer"),i.qZA())},directives:[_I,QT,YP,JP],styles:["nav[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;z-index:9999}.container[_ngcontent-%COMP%]{min-height:calc(100vh - 8.5rem)}.container[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{margin-bottom:5rem;margin-top:6rem}"]}),t})(),tN=(()=>{class t{constructor(){}clearLocalStorage(){localStorage.removeItem("clientVotes")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:11,vars:0,consts:[["href","https://www.flickr.com/people/137860135@N05","target","_blank"],["href","https://github.com/mroch4","target","_blank"],[1,"btn","btn-danger",3,"click"]],template:function(t,e){1&t&&(i.TgZ(0,"p"),i._uU(1," Cze\u015b\u0107, nazywam si\u0119 Marcin Rochowski i witam na moim minimalistycznym blogu! Strona powsta\u0142a na skutek fuzji kilku moich hobby: pasji do fotografii, zawodowego zami\u0142owania do webdevelopmentu oraz zainteresowania histori\u0105. Wszystkie wsp\xf3\u0142cze\u015bne zdj\u0119cia s\u0105 mojego autorstwa, zdj\u0119cia z przesz\u0142o\u015bci pochodz\u0105 za\u015b z og\xf3lnodost\u0119pnych zasob\xf3w (internet). Je\u015bli masz jakie\u015b niesamowite zdj\u0119cia Poznania wykonane przed laty - koniecznie daj mi zna\u0107 :)\n"),i.qZA(),i.TgZ(2,"ul"),i.TgZ(3,"li"),i.TgZ(4,"a",0),i._uU(5,"Flickr"),i.qZA(),i.qZA(),i.TgZ(6,"li"),i.TgZ(7,"a",1),i._uU(8,"Github"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(9,"button",2),i.NdJ("click",function(){return e.clearLocalStorage()}),i._uU(10," Clear Client Votes\n"),i.qZA())},styles:["p[_ngcontent-%COMP%]{text-align:justify;text-indent:1em}"]}),t})();class eN{}const nN="*";function iN(t,e){return{type:7,name:t,definitions:e,options:{}}}function rN(t,e=null){return{type:4,styles:e,timings:t}}function sN(t,e=null){return{type:2,steps:t,options:e}}function oN(t){return{type:6,styles:t,offset:null}}function aN(t,e,n=null){return{type:1,expr:t,animation:e,options:n}}function lN(t){Promise.resolve(null).then(t)}class uN{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){lN(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class cN{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,i=0;const r=this.players.length;0==r?lN(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==r&&this._onFinish()}),t.onDestroy(()=>{++n==r&&this._onDestroy()}),t.onStart(()=>{++i==r&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){const t=this.players.reduce((t,e)=>null===t||e.totalTime>t.totalTime?e:t,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}let hN=(()=>{class t{constructor(t){this.firebaseService=t,this.clientVotes=this._getUserVotes()}canVote(t){return!this.clientVotes.includes(t)}getAllVotes(){return this.firebaseService.getVotes()}getVoteById(t){return this.getAllVotes().pipe((0,Mt.U)(e=>e.find(e=>e.id===t)))}setVotes(t,e){this._updateUserVotes(t)}_getUserVotes(){const t=localStorage.getItem("clientVotes");return t?JSON.parse(t):[]}_updateUserVotes(t){this.clientVotes=[...this.clientVotes.filter(e=>e!==t),t],localStorage.setItem("clientVotes",JSON.stringify(this.clientVotes))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(KP))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),dN=(()=>{class t{constructor(){this.createdAt=""}ngOnInit(){this.createdAt=new Date(this.reply.ts).toLocaleString("pl-PL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-reply"]],inputs:{reply:"reply"},decls:13,vars:7,consts:[[1,"d-flex","mb-3"],[1,"d-flex","align-items-center","justify-content-center","col-1","text-white","avatar"],[1,"d-flex","flex-column","w-100"],[1,"d-flex","flex-column","flex-sm-row"],[1,"d-flex","fw-bold"],[1,"d-flex","d-none","d-sm-flex","mx-1","text-muted"],[1,"d-flex","text-muted"]],template:function(t,e){1&t&&(i.TgZ(0,"section",0),i.TgZ(1,"section",1),i._uU(2),i.qZA(),i.TgZ(3,"section",2),i.TgZ(4,"section",3),i.TgZ(5,"span",4),i._uU(6),i.qZA(),i.TgZ(7,"span",5),i._uU(8,"|"),i.qZA(),i.TgZ(9,"span",6),i._uU(10),i.qZA(),i.qZA(),i.TgZ(11,"section"),i._uU(12),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(1),i.Jzz("background-color: ",e.reply.col,""),i.xp6(1),i.hij(" ",e.reply.name.charAt(0).toUpperCase()," "),i.xp6(4),i.Oqu(e.reply.name),i.xp6(4),i.Oqu(e.createdAt),i.xp6(2),i.Oqu(e.reply.text))},styles:[".avatar[_ngcontent-%COMP%]{border-radius:50%;font-size:.85rem;height:2rem;margin-right:.5rem;margin-top:.25rem;width:2rem}.reply[_ngcontent-%COMP%]{font-size:.875rem;cursor:pointer}"]}),t})(),pN=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-loader"]],decls:4,vars:0,consts:[[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border","text-secondary"],[1,"visually-hidden"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"span",2),i._uU(3,"Loading..."),i.qZA(),i.qZA(),i.qZA())},styles:[".spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}"]}),t})();function fN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"img",18),i.NdJ("click",function(){return i.CHM(t),i.oxw(3).rate(!0)}),i.qZA(),i.TgZ(1,"img",19),i.NdJ("click",function(){return i.CHM(t),i.oxw(3).rate(!1)}),i.qZA()}if(2&t){const t=i.oxw(3);i.Gre("mx-2 ",t.canVote?"":" inactive",""),i.xp6(1),i.Tol(t.canVote?"":" inactive")}}function mN(t,e){if(1&t&&(i.TgZ(0,"div",17),i.TgZ(1,"span"),i._uU(2),i.qZA(),i.YNc(3,fN,2,6,"ng-template",8),i.qZA()),2&t){const t=e.$implicit,n=i.oxw(2);i.xp6(2),i.AsE("",t.r," (",t.v," g\u0142os\xf3w)"),i.xp6(1),i.Q6J("ngIf",n.canVote)}}function gN(t,e){if(1&t&&(i.TgZ(0,"p"),i._uU(1),i.qZA()),2&t){const t=i.oxw(2);i.xp6(1),i.Oqu(t.entry.dsc)}}function yN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"a",20),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw(2).navigateToTag(e)}),i._uU(1),i.qZA()}if(2&t){const t=e.$implicit;i.xp6(1),i.Oqu(t)}}function _N(t,e){if(1&t&&(i.TgZ(0,"div"),i._UZ(1,"hr"),i.YNc(2,mN,4,3,"div",14),i.ALo(3,"async"),i.YNc(4,gN,2,1,"p",13),i.TgZ(5,"div",15),i.YNc(6,yN,2,1,"a",16),i.qZA(),i.qZA()),2&t){const t=i.oxw();i.Q6J("@slideDownUp",void 0),i.xp6(2),i.Q6J("ngIf",i.lcZ(3,4,t.vote$)),i.xp6(2),i.Q6J("ngIf",t.entry.dsc),i.xp6(2),i.Q6J("ngForOf",t.entry.tags)}}function vN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div"),i.TgZ(1,"span",23),i._uU(2),i.qZA(),i.TgZ(3,"button",24),i.NdJ("click",function(){return i.CHM(t),i.oxw(2).toggleReplies()}),i._uU(4),i.qZA(),i.qZA()}if(2&t){const t=i.oxw().$implicit,e=i.oxw();i.xp6(2),i.AsE("",t.length," ",1===t.length?"komentarz":t.length<5?"komentarze":"komentarzy"," "),i.xp6(2),i.hij(" ",e.showReplies?"Ukryj":"Poka\u017c"," ")}}function wN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",25),i.NdJ("click",function(){i.CHM(t);const e=i.oxw(2);return e.setReplyId(e.entry.id)}),i._uU(1," Skomentuj jako pierwszy! "),i.qZA()}}function bN(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,vN,5,3,"div",21),i.YNc(2,wN,2,0,"ng-template",null,22,i.W1O),i.qZA()),2&t){const t=e.$implicit,n=i.MAs(3);i.xp6(1),i.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function TN(t,e){1&t&&i._UZ(0,"app-reply",30),2&t&&i.Q6J("reply",e.$implicit)}function IN(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,TN,1,1,"app-reply",29),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.Q6J("ngForOf",t)}}function SN(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,IN,2,1,"div",13),i.qZA()),2&t){const t=e.$implicit;i.xp6(1),i.Q6J("ngIf",t.length>0)}}function CN(t,e){1&t&&i._UZ(0,"app-loader")}function EN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div"),i.YNc(1,SN,2,1,"div",21),i.ALo(2,"async"),i.TgZ(3,"div",26),i.TgZ(4,"button",27),i.NdJ("click",function(){i.CHM(t);const e=i.oxw();return e.setReplyId(e.entry.id)}),i._uU(5," Odpowiedz "),i.qZA(),i.qZA(),i.YNc(6,CN,1,0,"ng-template",null,28,i.W1O),i.qZA()}if(2&t){const t=i.MAs(7),e=i.oxw();i.xp6(1),i.Q6J("ngIf",i.lcZ(2,2,e.replies$))("ngIfElse",t)}}let xN=(()=>{class t{constructor(t,e,n){this._replyService=t,this._router=e,this._votingService=n,this.canVote=!1,this.dt2Formatted="",this.presentImg=!0,this.imgSize=this._getImageSize(window.innerWidth)}changeState(){this.presentImg=!this.presentImg}onResize(t){this.imgSize=this._getImageSize(t.target.innerWidth)}navigateToTag(t){this._router.routeReuseStrategy.shouldReuseRoute=()=>!1,this._router.onSameUrlNavigation="reload",this._router.navigate([`/tag/${t}`])}navigateToEntry(){this._router.navigate([`/wpis/${this.entry.id}`])}rate(t){this.canVote&&(this._votingService.setVotes(this.entry.id,t),this.canVote=!this.canVote)}toggleDetails(){this.showDetails=!this.showDetails}toggleReplies(){this.showReplies=!this.showReplies}setReplyId(t){this._replyService.activeId=t}ngOnInit(){this.replies$=this._replyService.getRepliesById(this.entry.id),this.vote$=this._votingService.getVoteById(this.entry.id),this.canVote=this._votingService.canVote(this.entry.id),this.dt2Formatted=new Date(this.entry.dt2).toLocaleDateString("pl-PL",{year:"numeric",month:"long"})}_getImageSize(t){return t>576?"md":t>992?"lg":"sm"}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(QP),i.Y36($T),i.Y36(hN))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-card"]],hostBindings:function(t,e){1&t&&i.NdJ("resize",function(t){return e.onResize(t)},!1,i.Jf7)},inputs:{entry:"entry",showDetails:"showDetails",showReplies:"showReplies"},decls:20,vars:14,consts:[[1,"mb-5"],[1,"header"],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0",3,"click"],[1,"buttons","text-end"],["target","_blank",3,"href"],["alt","Map Icon","src","assets/icons/mapIcon.svg","title","Poka\u017c na mapie",1,"tooltip-test"],["alt","More Details","src","assets/icons/detailsIcon.svg","title","Poka\u017c szczeg\xf3\u0142y",1,"ms-3","tooltip-test",3,"click"],[3,"ngIf"],[1,"text-center","mt-3"],["loading","lazy",3,"alt","src","click"],[1,"replies"],[1,"d-flex","justify-content-end","align-items-center","mb-1"],[4,"ngIf"],["class","d-flex justify-content-end",4,"ngIf"],[1,"d-flex","flex-wrap"],["class","tag",3,"click",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end"],["alt","Thumb up","src","assets/icons/upVote.svg",3,"click"],["alt","Thumb down","src","assets/icons/downVote.svg",3,"click"],[1,"tag",3,"click"],[4,"ngIf","ngIfElse"],["button",""],[1,"fw-bold"],[1,"btn","btn-sm","btn-outline-secondary","ms-2",2,"width","60px",3,"click"],["data-bs-toggle","modal","data-bs-target","#replyModal",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"d-flex","justify-content-end","align-items-center"],["data-bs-toggle","modal","data-bs-target","#replyModal",1,"btn","btn-sm","btn-secondary",3,"click"],["loading",""],[3,"reply",4,"ngFor","ngForOf"],[3,"reply"]],template:function(t,e){1&t&&(i.TgZ(0,"article",0),i.TgZ(1,"section",1),i.TgZ(2,"header",2),i.TgZ(3,"h4",3),i.NdJ("click",function(){return e.navigateToEntry()}),i._uU(4),i.qZA(),i.TgZ(5,"div",4),i.TgZ(6,"a",5),i._UZ(7,"img",6),i.qZA(),i.TgZ(8,"img",7),i.NdJ("click",function(){return e.toggleDetails()}),i.qZA(),i.qZA(),i.qZA(),i.YNc(9,_N,7,6,"ng-template",8),i.qZA(),i.TgZ(10,"figure",9),i.TgZ(11,"img",10),i.NdJ("click",function(){return e.changeState()}),i.qZA(),i.TgZ(12,"figcaption"),i.TgZ(13,"i"),i._uU(14),i.qZA(),i.qZA(),i.qZA(),i.TgZ(15,"section",11),i.TgZ(16,"div",12),i.YNc(17,bN,4,2,"div",13),i.ALo(18,"async"),i.qZA(),i.YNc(19,EN,8,4,"div",13),i.qZA(),i.qZA()),2&t&&(i.xp6(4),i.AsE(" #",e.entry.id," - ",e.entry.name," "),i.xp6(2),i.hYB("href","https://www.google.co.uk/maps/@",e.entry.lat,",",e.entry.lon,",200m/data=!3m1!1e3",i.LSH),i.xp6(3),i.Q6J("ngIf",e.showDetails),i.xp6(2),i.MGl("alt","image",e.entry.id,""),i.cQ8("src","assets/photos/",e.imgSize,"/",e.entry.id,"",e.presentImg?"a":"b",".webp",i.LSH),i.xp6(3),i.hij("Data wykonania zdj\u0119cia: ",e.presentImg?e.dt2Formatted:e.entry.dt1,""),i.xp6(3),i.Q6J("ngIf",i.lcZ(18,12,e.replies$)),i.xp6(2),i.Q6J("ngIf",e.showReplies))},directives:[D,P,dN,pN],pipes:[U],styles:[".buttons[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0}.buttons[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:not(:last-child){margin-right:1rem}p[_ngcontent-%COMP%]{text-align:justify;text-indent:2em}figure[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:90vh;max-width:100%;border-radius:.64rem}h4[_ngcontent-%COMP%], img[_ngcontent-%COMP%]{cursor:pointer}.tag[_ngcontent-%COMP%]{background-color:#999;border-radius:.25rem;color:#fff;cursor:pointer;margin-right:.5rem;margin-bottom:.5rem;padding:.25rem .5rem;text-decoration:none;white-space:nowrap}"],data:{animation:[iN("slideDownUp",[aN(":enter",[oN({opacity:0}),rN(500)]),aN(":leave",[rN(500,oN({opacity:0}))])])]}}),t})();const kN=function(){return["/"]};let AN=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-notfound"]],decls:4,vars:2,consts:[[3,"routerLink"]],template:function(t,e){1&t&&(i.TgZ(0,"h4"),i._uU(1,"Strona nie istnieje - brak wpis\xf3w spe\u0142niaj\u0105cych kryteria"),i.qZA(),i.TgZ(2,"a",0),i._uU(3,"Powr\xf3t do strony g\u0142\xf3wnej"),i.qZA()),2&t&&(i.xp6(2),i.Q6J("routerLink",i.DdM(1,kN)))},directives:[GT],encapsulation:2}),t})();function PN(t,e){1&t&&i._UZ(0,"app-notfound")}function NN(t,e){if(1&t&&(i.TgZ(0,"div"),i._UZ(1,"app-card",2),i.YNc(2,PN,1,0,"ng-template",null,3,i.W1O),i.qZA()),2&t){const t=e.$implicit;i.xp6(1),i.Q6J("entry",t)("showDetails",!0)("showReplies",!1)}}function DN(t,e){1&t&&i._UZ(0,"app-loader")}let ON=(()=>{class t{constructor(t,e){this._dataService=t,this._route=e;const n=this._route.snapshot.paramMap.get("id");this.entry$=this._dataService.getDataById(parseInt(n))}ngOnInit(){window.scrollTo(0,0)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Wv),i.Y36(Sb))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],[3,"entry","showDetails","showReplies"],["noMathingData",""]],template:function(t,e){if(1&t&&(i.YNc(0,NN,4,3,"div",0),i.ALo(1,"async"),i.YNc(2,DN,1,0,"ng-template",null,1,i.W1O)),2&t){const t=i.MAs(3);i.Q6J("ngIf",i.lcZ(1,2,e.entry$))("ngIfElse",t)}},directives:[D,xN,AN,pN],pipes:[U],encapsulation:2}),t})();const RN=function(){return["/"]};function LN(t,e){if(1&t&&(i.TgZ(0,"div",6),i.TgZ(1,"h5",7),i._uU(2),i.qZA(),i.TgZ(3,"a",8),i._UZ(4,"img",9),i.qZA(),i.qZA()),2&t){const t=i.oxw(3);i.xp6(2),i.lnq(' Rezultaty wyszukiwania dla tagu "',t.tag.toUpperCase(),'" (',t.entriesCount," ",1===t.entriesCount?"wynik":t.entriesCount<5?"wyniki":"wynik\xf3w",") "),i.xp6(1),i.Q6J("routerLink",i.DdM(4,RN))}}function MN(t,e){1&t&&i._UZ(0,"app-card",10),2&t&&i.Q6J("entry",e.$implicit)("showDetails",!1)("showReplies",!1)}function FN(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,LN,5,5,"div",4),i.YNc(2,MN,1,3,"app-card",5),i.ALo(3,"async"),i.qZA()),2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("ngIf",t.tag),i.xp6(1),i.Q6J("ngForOf",i.lcZ(3,2,t.entries$))}}function VN(t,e){1&t&&i._UZ(0,"app-notfound")}function UN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"span",13),i.NdJ("click",function(){return i.CHM(t),i.oxw(4).navigateToPage(0)}),i._uU(1),i.qZA(),i.TgZ(2,"span",13),i.NdJ("click",function(){i.CHM(t);const e=i.oxw(4);return e.navigateToPage(e.currentPage-1)}),i._uU(3),i.qZA()}2&t&&(i.xp6(1),i.hij("","<<"," "),i.xp6(2),i.hij("","<"," "))}function jN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"span",13),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw(4).navigateToPage(e)}),i._uU(1),i.qZA()}if(2&t){const t=e.$implicit,n=i.oxw(4);i.Tol(t===n.currentPage?"fw-bold":""),i.xp6(1),i.Oqu(t+1)}}function qN(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"span",13),i.NdJ("click",function(){i.CHM(t);const e=i.oxw(4);return e.navigateToPage(e.currentPage+1)}),i._uU(1),i.qZA(),i.TgZ(2,"span",13),i.NdJ("click",function(){i.CHM(t);const e=i.oxw(4);return e.navigateToPage(e.pagesCount)}),i._uU(3),i.qZA()}2&t&&(i.xp6(1),i.Oqu(">"),i.xp6(2),i.Oqu(">>"))}function zN(t,e){if(1&t&&(i.YNc(0,UN,4,2,"ng-template",3),i.YNc(1,jN,2,4,"span",12),i.YNc(2,qN,4,2,"ng-template",3)),2&t){const t=i.oxw(3);i.Q6J("ngIf",0!==t.currentPage),i.xp6(1),i.Q6J("ngForOf",t.pagesArray),i.xp6(1),i.Q6J("ngIf",t.currentPage<t.pagesCount)}}function BN(t,e){if(1&t&&(i.TgZ(0,"div",11),i.YNc(1,zN,3,3,"ng-template",3),i.qZA()),2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("ngIf",t.pagesCount)}}function ZN(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,FN,4,4,"div",0),i.YNc(2,VN,1,0,"ng-template",null,2,i.W1O),i.YNc(4,BN,2,1,"ng-template",3),i.qZA()),2&t){const t=e.$implicit,n=i.MAs(3);i.xp6(1),i.Q6J("ngIf",t.length>0)("ngIfElse",n),i.xp6(3),i.Q6J("ngIf",!0)}}function HN(t,e){1&t&&i._UZ(0,"app-loader")}let $N=(()=>{class t{constructor(t,e){this._dataService=t,this._route=e,this.entriesCount=0,this.pagesArray=[],this.currentPage=0,this.tag=this._route.snapshot.paramMap.get("tag"),this._dataService.getDataByTagCount(this.tag).subscribe(e=>{if(this.entriesCount=e,this.pagesCount=Math.ceil(e/t.PAGE_SIZE)-1,this.pagesCount)for(let t=0;t<this.pagesCount+1;t++)this.pagesArray.push(t)}),this._reloadView()}navigateToPage(t){this.currentPage=t,this._reloadView()}_reloadView(){this.entries$=this._dataService.getViewItems(this.tag,this.currentPage),window.scrollTo(0,0)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Wv),i.Y36(Sb))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],["noMathingData",""],[3,"ngIf"],["class","d-flex align-items-center mb-4",4,"ngIf"],[3,"entry","showDetails","showReplies",4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","mb-4"],[1,"m-0"],[1,"ms-2",3,"routerLink"],["alt","Cancel Icon","src","assets/icons/cancelIcon.svg"],[3,"entry","showDetails","showReplies"],[1,"d-flex","align-items-center","justify-content-center","mb-3","pagination"],[3,"class","click",4,"ngFor","ngForOf"],[3,"click"]],template:function(t,e){if(1&t&&(i.YNc(0,ZN,5,3,"div",0),i.ALo(1,"async"),i.YNc(2,HN,1,0,"ng-template",null,1,i.W1O)),2&t){const t=i.MAs(3);i.Q6J("ngIf",i.lcZ(1,2,e.entries$))("ngIfElse",t)}},directives:[D,P,GT,xN,AN,pN],pipes:[U],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}.pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer;font-size:1.15rem;margin-left:.5rem;margin-right:.5rem}"]}),t})();var WN=n(4216);function GN(t,e){if(1&t&&(i.TgZ(0,"div"),i._UZ(1,"app-card",4),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("entry",t.entry)("showDetails",!0)("showReplies",!1)}}const KN=[{path:"",component:$N},{path:"about",component:tN},{path:"map",component:(()=>{class t{constructor(t){this._dataService=t,this.entries=[]}ngAfterViewInit(){this._initMap()}_initMap(){this._dataService.getAllData().subscribe(t=>{const{latitude:e,longitude:n}=this._getMapCenter(t);this.map=WN.map("map",{center:[e,n],zoom:13}),WN.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:16,minZoom:12}).addTo(this.map),t.forEach(t=>WN.marker([t.lat,t.lon],{icon:WN.icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/marker-icon.png",popupAnchor:[-1,-10]})}).addTo(this.map).bindPopup(`<b>${t.name}</b>`).on("click",e=>{this._dataService.getDataById(t.id).subscribe(t=>this.entry=t),this.map.setView(e.target.getLatLng())}).on("popupclose",()=>{this.entry=void 0,this.map.setView([e,n])}))})}_getAverageValue(t){return t.reduce((t,e)=>t+e,0)/t.length}_getMapCenter(t){const{latitudes:e,longitudes:n}=this._reduceCoordinates(t);return{latitude:this._getMinMaxValue(e)+.001,longitude:this._getMinMaxValue(n)}}_getMediumValue(t){const e=Math.floor(t.length/2);return t.sort((t,e)=>t-e)[e]}_getMinMaxValue(t){return(Math.max(...t)+Math.min(...t))/2}_reduceCoordinates(t){return{latitudes:t.reduce((t,e)=>[...t,e.lat],[]),longitudes:t.reduce((t,e)=>[...t,e.lon],[])}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Wv))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:4,vars:1,consts:[[1,"map-container"],[1,"map-frame"],["id","map"],[4,"ngIf"],[3,"entry","showDetails","showReplies"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._UZ(2,"div",2),i.qZA(),i.qZA(),i.YNc(3,GN,2,3,"div",3)),2&t&&(i.xp6(3),i.Q6J("ngIf",e.entry))},directives:[D,xN],styles:["#map[_ngcontent-%COMP%]{width:100%;height:50vh;margin-bottom:1rem;border-radius:.64rem}"]}),t})()},{path:"tag/:tag",component:$N},{path:"wpis/:id",component:ON},{path:"**",component:AN}];let QN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[oI.forRoot(KN)],oI]}),t})();function YN(){return"undefined"!=typeof window&&void 0!==window.document}function JN(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function XN(t){switch(t.length){case 0:return new uN;case 1:return t[0];default:return new cN(t)}}function tD(t,e,n,i,r={},s={}){const o=[],a=[];let l=-1,u=null;if(i.forEach(t=>{const n=t.offset,i=n==l,c=i&&u||{};Object.keys(t).forEach(n=>{let i=n,a=t[n];if("offset"!==n)switch(i=e.normalizePropertyName(i,o),a){case"!":a=r[n];break;case nN:a=s[n];break;default:a=e.normalizeStyleValue(n,i,a,o)}c[i]=a}),i||a.push(c),u=c,l=n}),o.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${o.join(t)}`)}return a}function eD(t,e,n,i){switch(e){case"start":t.onStart(()=>i(n&&nD(n,"start",t)));break;case"done":t.onDone(()=>i(n&&nD(n,"done",t)));break;case"destroy":t.onDestroy(()=>i(n&&nD(n,"destroy",t)))}}function nD(t,e,n){const i=n.totalTime,r=iD(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==i?t.totalTime:i,!!n.disabled),s=t._data;return null!=s&&(r._data=s),r}function iD(t,e,n,i,r="",s=0,o){return{element:t,triggerName:e,fromState:n,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function rD(t,e,n){let i;return t instanceof Map?(i=t.get(e),i||t.set(e,i=n)):(i=t[e],i||(i=t[e]=n)),i}function sD(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let oD=(t,e)=>!1,aD=(t,e)=>!1,lD=(t,e,n)=>[];const uD=JN();(uD||"undefined"!=typeof Element)&&(oD=YN()?(t,e)=>{for(;e&&e!==document.documentElement;){if(e===t)return!0;e=e.parentNode||e.host}return!1}:(t,e)=>t.contains(e),aD=(()=>{if(uD||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):aD}})(),lD=(t,e,n)=>{let i=[];if(n){const n=t.querySelectorAll(e);for(let t=0;t<n.length;t++)i.push(n[t])}else{const n=t.querySelector(e);n&&i.push(n)}return i});let cD=null,hD=!1;function dD(t){cD||(cD=("undefined"!=typeof document?document.body:null)||{},hD=!!cD.style&&"WebkitAppearance"in cD.style);let e=!0;return cD.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in cD.style,!e&&hD&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in cD.style)),e}const pD=aD,fD=oD,mD=lD;function gD(t){const e={};return Object.keys(t).forEach(n=>{const i=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[i]=t[n]}),e}let yD=(()=>{class t{validateStyleProperty(t){return dD(t)}matchesElement(t,e){return pD(t,e)}containsElement(t,e){return fD(t,e)}query(t,e,n){return mD(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,i,r,s=[],o){return new uN(n,i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),_D=(()=>{class t{}return t.NOOP=new yD,t})();const vD="ng-enter",wD="ng-leave",bD="ng-trigger",TD=".ng-trigger",ID="ng-animating",SD=".ng-animating";function CD(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:ED(parseFloat(e[1]),e[2])}function ED(t,e){return"s"===e?1e3*t:t}function xD(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let i,r=0,s="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};i=ED(parseFloat(n[1]),n[2]);const o=n[3];null!=o&&(r=ED(parseFloat(o),n[4]));const a=n[5];a&&(s=a)}else i=t;if(!n){let n=!1,s=e.length;i<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),r<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(s,0,`The provided timing value "${t}" is invalid.`)}return{duration:i,delay:r,easing:s}}(t,e,n)}function kD(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function AD(t,e,n={}){if(e)for(let i in t)n[i]=t[i];else kD(t,n);return n}function PD(t,e,n){return n?e+":"+n+";":""}function ND(t){let e="";for(let n=0;n<t.style.length;n++){const i=t.style.item(n);e+=PD(0,i,t.style.getPropertyValue(i))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=PD(0,qD(n),t.style[n]));t.setAttribute("style",e)}function DD(t,e,n){t.style&&(Object.keys(e).forEach(i=>{const r=jD(i);n&&!n.hasOwnProperty(i)&&(n[i]=t.style[r]),t.style[r]=e[i]}),JN()&&ND(t))}function OD(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=jD(e);t.style[n]=""}),JN()&&ND(t))}function RD(t){return Array.isArray(t)?1==t.length?t[0]:sN(t):t}const LD=new RegExp("{{\\s*(.+?)\\s*}}","g");function MD(t){let e=[];if("string"==typeof t){let n;for(;n=LD.exec(t);)e.push(n[1]);LD.lastIndex=0}return e}function FD(t,e,n){const i=t.toString(),r=i.replace(LD,(t,i)=>{let r=e[i];return e.hasOwnProperty(i)||(n.push(`Please provide a value for the animation param ${i}`),r=""),r.toString()});return r==i?t:r}function VD(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const UD=/-+([a-z0-9])/g;function jD(t){return t.replace(UD,(...t)=>t[1].toUpperCase())}function qD(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function zD(t,e){return 0===t||0===e}function BD(t,e,n){const i=Object.keys(n);if(i.length&&e.length){let s=e[0],o=[];if(i.forEach(t=>{s.hasOwnProperty(t)||o.push(t),s[t]=n[t]}),o.length)for(var r=1;r<e.length;r++){let n=e[r];o.forEach(function(e){n[e]=HD(t,e)})}}return e}function ZD(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function HD(t,e){return window.getComputedStyle(t)[e]}function $D(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const i=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof i)return void e.push(i);t=i}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const r=i[1],s=i[2],o=i[3];e.push(KD(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(KD(o,r))}(t,n,e)):n.push(t),n}const WD=new Set(["true","1"]),GD=new Set(["false","0"]);function KD(t,e){const n=WD.has(t)||GD.has(t),i=WD.has(e)||GD.has(e);return(r,s)=>{let o="*"==t||t==r,a="*"==e||e==s;return!o&&n&&"boolean"==typeof r&&(o=r?WD.has(t):GD.has(t)),!a&&i&&"boolean"==typeof s&&(a=s?WD.has(e):GD.has(e)),o&&a}}const QD=new RegExp("s*:selfs*,?","g");function YD(t,e,n){return new JD(t).build(e,n)}class JD{constructor(t){this._driver=t}build(t,e){const n=new XD(e);return this._resetContextStyleTimingState(n),ZD(this,RD(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,i=e.depCount=0;const r=[],s=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,i=n.name;i.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,r.push(this.visitState(n,e))}),n.name=i}else if(1==t.type){const r=this.visitTransition(t,e);n+=r.queryCount,i+=r.depCount,s.push(r)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:r,transitions:s,queryCount:n,depCount:i,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),i=t.options&&t.options.params||null;if(n.containsDynamicStyles){const r=new Set,s=i||{};if(n.styles.forEach(t=>{if(tO(t)){const e=t;Object.keys(e).forEach(t=>{MD(e[t]).forEach(t=>{s.hasOwnProperty(t)||r.add(t)})})}}),r.size){const n=VD(r.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:i?{params:i}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=ZD(this,RD(t.animation),e);return{type:1,matchers:$D(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:eO(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>ZD(this,t,e)),options:eO(t.options)}}visitGroup(t,e){const n=e.currentTime;let i=0;const r=t.steps.map(t=>{e.currentTime=n;const r=ZD(this,t,e);return i=Math.max(i,e.currentTime),r});return e.currentTime=i,{type:3,steps:r,options:eO(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return nO(xD(t,e).duration,0,"");const i=t;if(i.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=nO(0,0,"");return t.dynamic=!0,t.strValue=i,t}return n=n||xD(i,e),nO(n.duration,n.delay,n.easing)}(t.timings,e.errors);e.currentAnimateTimings=n;let i,r=t.styles?t.styles:oN({});if(5==r.type)i=this.visitKeyframes(r,e);else{let r=t.styles,s=!1;if(!r){s=!0;const t={};n.easing&&(t.easing=n.easing),r=oN(t)}e.currentTime+=n.duration+n.delay;const o=this.visitStyle(r,e);o.isEmptyStep=s,i=o}return e.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?t==nN?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let i=!1,r=null;return n.forEach(t=>{if(tO(t)){const e=t,n=e.easing;if(n&&(r=n,delete e.easing),!i)for(let t in e)if(e[t].toString().indexOf("{{")>=0){i=!0;break}}}),{type:6,styles:n,easing:r,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let i=e.currentTime,r=e.currentTime;n&&r>0&&(r-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const s=e.collectedStyles[e.currentQuerySelector],o=s[n];let a=!0;o&&(r!=i&&r>=o.startTime&&i<=o.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${r}ms" and "${i}ms"`),a=!1),r=o.startTime),a&&(s[n]={startTime:r,endTime:i}),e.options&&function(t,e,n){const i=e.params||{},r=MD(t);r.length&&r.forEach(t=>{i.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let i=0;const r=[];let s=!1,o=!1,a=0;const l=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let l=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(tO(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(tO(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),u=0;return null!=l&&(i++,u=n.offset=l),o=o||u<0||u>1,s=s||u<a,a=u,r.push(u),n});o&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&e.errors.push("Please ensure that all keyframe offsets are in order");const u=t.steps.length;let c=0;i>0&&i<u?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(c=1/(u-1));const h=u-1,d=e.currentTime,p=e.currentAnimateTimings,f=p.duration;return l.forEach((t,i)=>{const s=c>0?i==h?1:c*i:r[i],o=s*f;e.currentTime=d+p.delay+o,p.duration=o,this._validateStyleAst(t,e),t.offset=s,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:ZD(this,RD(t.animation),e),options:eO(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:eO(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:eO(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,i=t.options||{};e.queryCount++,e.currentQuery=t;const[r,s]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(QD,"")),t=t.replace(/@\*/g,TD).replace(/@\w+/g,t=>TD+"-"+t.substr(1)).replace(/:animating/g,SD),[t,e]}(t.selector);e.currentQuerySelector=n.length?n+" "+r:r,rD(e.collectedStyles,e.currentQuerySelector,{});const o=ZD(this,RD(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:r,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:o,originalSelector:t.selector,options:eO(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:xD(t.timings,e.errors,!0);return{type:12,animation:ZD(this,RD(t.animation),e),timings:n,options:null}}}class XD{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function tO(t){return!Array.isArray(t)&&"object"==typeof t}function eO(t){return t?(t=kD(t)).params&&(t.params=function(t){return t?kD(t):null}(t.params)):t={},t}function nO(t,e,n){return{duration:t,delay:e,easing:n}}function iO(t,e,n,i,r,s,o=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class rO{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const sO=new RegExp(":enter","g"),oO=new RegExp(":leave","g");function aO(t,e,n,i,r,s={},o={},a,l,u=[]){return(new lO).buildKeyframes(t,e,n,i,r,s,o,a,l,u)}class lO{buildKeyframes(t,e,n,i,r,s,o,a,l,u=[]){l=l||new rO;const c=new cO(t,e,l,i,r,u,[]);c.options=a,c.currentTimeline.setStyles([s],null,c.errors,a),ZD(this,n,c);const h=c.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(o).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([o],null,c.errors,a)}return h.length?h.map(t=>t.buildKeyframes()):[iO(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const i=e.createSubContext(t.options),r=e.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);r!=s&&e.transformIntoNewTimeline(s)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let i=e.currentTimeline.currentTime;const r=null!=n.duration?CD(n.duration):null,s=null!=n.delay?CD(n.delay):null;return 0!==r&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,r,s);i=Math.max(i,n.duration+n.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),ZD(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let i=e;const r=t.options;if(r&&(r.params||r.delay)&&(i=e.createSubContext(r),i.transformIntoNewTimeline(),null!=r.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=uO);const t=CD(r.delay);i.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>ZD(this,t,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let i=e.currentTimeline.currentTime;const r=t.options&&t.options.delay?CD(t.options.delay):0;t.steps.forEach(s=>{const o=e.createSubContext(t.options);r&&o.delayNextStep(r),ZD(this,s,o),i=Math.max(i,o.currentTimeline.currentTime),n.push(o.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(i),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return xD(e.params?FD(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),i=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),i.snapshotCurrentStyles());const r=t.style;5==r.type?this.visitKeyframes(r,e):(e.incrementTime(n.duration),this.visitStyle(r,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,i=e.currentAnimateTimings;!i&&n.getCurrentStyleProperties().length&&n.forwardFrame();const r=i&&i.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(r):n.setStyles(t.styles,r,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,i=e.currentTimeline.duration,r=n.duration,s=e.createSubContext().currentTimeline;s.easing=n.easing,t.styles.forEach(t=>{s.forwardTime((t.offset||0)*r),s.setStyles(t.styles,t.easing,e.errors,e.options),s.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(s),e.transformIntoNewTimeline(i+r),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,i=t.options||{},r=i.delay?CD(i.delay):0;r&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=uO);let s=n;const o=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=o.length;let a=null;o.forEach((n,i)=>{e.currentQueryIndex=i;const o=e.createSubContext(t.options,n);r&&o.delayNextStep(r),n===e.element&&(a=o.currentTimeline),ZD(this,t.animation,o),o.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,o.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),a&&(e.currentTimeline.mergeTimelineCollectedStyles(a),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,i=e.currentTimeline,r=t.timings,s=Math.abs(r.duration),o=s*(e.currentQueryTotal-1);let a=s*e.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":a=o-a;break;case"full":a=n.currentStaggerTime}const l=e.currentTimeline;a&&l.delayNextStep(a);const u=l.currentTime;ZD(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=i.currentTime-u+(i.startTime-n.currentTimeline.startTime)}}const uO={};class cO{constructor(t,e,n,i,r,s,o,a){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=r,this.errors=s,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=uO,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new hO(this._driver,e,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let i=this.options;null!=n.duration&&(i.duration=CD(n.duration)),null!=n.delay&&(i.delay=CD(n.delay));const r=n.params;if(r){let t=i.params;t||(t=this.options.params={}),Object.keys(r).forEach(n=>{(!e||!t.hasOwnProperty(n))&&(t[n]=FD(r[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const i=e||this.element,r=new cO(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(t),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(t){return this.previousNode=uO,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const i={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},r=new dO(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,i,t.stretchStartingKeyframe);return this.timelines.push(r),i}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,i,r,s){let o=[];if(i&&o.push(this.element),t.length>0){t=(t=t.replace(sO,"."+this._enterClassName)).replace(oO,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),o.push(...e)}return!r&&0==o.length&&s.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),o}}class hO{constructor(t,e,n,i){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new hO(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||nN,this._currentKeyframe[t]=nN}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,i){e&&(this._previousKeyframe.easing=e);const r=i&&i.params||{},s=function(t,e){const n={};let i;return t.forEach(t=>{"*"===t?(i=i||Object.keys(e),i.forEach(t=>{n[t]=nN})):AD(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(s).forEach(t=>{const e=FD(s[t],r,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:nN),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],i=t._styleSummary[e];(!n||i.time>n.time)&&this._updateStyle(e,i.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((r,s)=>{const o=AD(r,!0);Object.keys(o).forEach(n=>{const i=o[n];"!"==i?t.add(n):i==nN&&e.add(n)}),n||(o.offset=s/this.duration),i.push(o)});const r=t.size?VD(t.values()):[],s=e.size?VD(e.values()):[];if(n){const t=i[0],e=kD(t);t.offset=0,e.offset=1,i=[t,e]}return iO(this.element,i,r,s,this.duration,this.startTime,this.easing,!1)}}class dO extends hO{constructor(t,e,n,i,r,s,o=!1){super(t,e,s.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=r,this._stretchStartingKeyframe=o,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const r=[],s=n+e,o=e/s,a=AD(t[0],!1);a.offset=0,r.push(a);const l=AD(t[0],!1);l.offset=pO(o),r.push(l);const u=t.length-1;for(let i=1;i<=u;i++){let o=AD(t[i],!1);o.offset=pO((e+o.offset*n)/s),r.push(o)}n=s,e=0,i="",t=r}return iO(this.element,t,this.preStyleProps,this.postStyleProps,n,e,i,!0)}}function pO(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class fO{}class mO extends fO{normalizePropertyName(t,e){return jD(t)}normalizeStyleValue(t,e,n,i){let r="";const s=n.toString().trim();if(gO[e]&&0!==n&&"0"!==n)if("number"==typeof n)r="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&i.push(`Please provide a CSS unit value for ${t}:${n}`)}return s+r}}const gO=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function yO(t,e,n,i,r,s,o,a,l,u,c,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:r,fromState:n,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:h,errors:d}}const _O={};class vO{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,i){return function(t,e,n,i,r){return t.some(t=>t(e,n,i,r))}(this.ast.matchers,t,e,n,i)}buildStyles(t,e,n){const i=this._stateStyles["*"],r=this._stateStyles[t],s=i?i.buildStyles(e,n):{};return r?r.buildStyles(e,n):s}build(t,e,n,i,r,s,o,a,l,u){const c=[],h=this.ast.options&&this.ast.options.params||_O,d=this.buildStyles(n,o&&o.params||_O,c),p=a&&a.params||_O,f=this.buildStyles(i,p,c),m=new Set,g=new Map,y=new Map,_="void"===i,v={params:Object.assign(Object.assign({},h),p)},w=u?[]:aO(t,e,this.ast.animation,r,s,d,f,v,l,c);let b=0;if(w.forEach(t=>{b=Math.max(t.duration+t.delay,b)}),c.length)return yO(e,this._triggerName,n,i,_,d,f,[],[],g,y,b,c);w.forEach(t=>{const n=t.element,i=rD(g,n,{});t.preStyleProps.forEach(t=>i[t]=!0);const r=rD(y,n,{});t.postStyleProps.forEach(t=>r[t]=!0),n!==e&&m.add(n)});const T=VD(m.values());return yO(e,this._triggerName,n,i,_,d,f,w,T,g,y,b)}}class wO{constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){const n={},i=kD(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(i[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const r=t;Object.keys(r).forEach(t=>{let s=r[t];s.length>1&&(s=FD(s,i,e));const o=this.normalizer.normalizePropertyName(t,e);s=this.normalizer.normalizeStyleValue(t,o,s,e),n[o]=s})}}),n}}class bO{constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new wO(t.style,t.options&&t.options.params||{},n)}),TO(this.states,"true","1"),TO(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new vO(t,e,this.states))}),this.fallbackTransition=function(t,e,n){return new vO(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},e)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,i){return this.transitionFactories.find(r=>r.match(t,e,n,i))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function TO(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const IO=new rO;class SO{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],i=YD(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=i}_buildPlayer(t,e,n){const i=t.element,r=tD(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(i,r,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const i=[],r=this._animations[t];let s;const o=new Map;if(r?(s=aO(this._driver,e,r,vD,wD,{},{},n,IO,i),s.forEach(t=>{const e=rD(o,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(i.push("The requested animation doesn't exist or has already been destroyed"),s=[]),i.length)throw new Error(`Unable to create the animation due to the following errors: ${i.join("\n")}`);o.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,nN)})});const a=XN(s.map(t=>{const e=o.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=a,a.onDestroy(()=>this.destroy(t)),this.players.push(a),a}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,i){const r=iD(e,"","","");return eD(this._getPlayer(t),n,r,i),()=>{}}command(t,e,n,i){if("register"==n)return void this.register(t,i[0]);if("create"==n)return void this.create(t,e,i[0]||{});const r=this._getPlayer(t);switch(n){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(t)}}}const CO="ng-animate-queued",EO="ng-animate-disabled",xO=".ng-animate-disabled",kO=[],AO={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},PO={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},NO="__ng_removed";class DO{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function(t){return null!=t?t:null}(n?t.value:t),n){const e=kD(t);delete e.value,this.options=e}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const OO="void",RO=new DO(OO);class LO{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,BO(e,this._hostClassName)}listen(t,e,n,i){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if(!function(t){return"start"==t||"done"==t}(n))throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);const r=rD(this._elementListeners,t,[]),s={name:e,phase:n,callback:i};r.push(s);const o=rD(this._engine.statesByElement,t,{});return o.hasOwnProperty(e)||(BO(t,bD),BO(t,bD+"-"+e),o[e]=RO),()=>{this._engine.afterFlush(()=>{const t=r.indexOf(s);t>=0&&r.splice(t,1),this._triggers[e]||delete o[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,i=!0){const r=this._getTrigger(e),s=new FO(this.id,e,t);let o=this._engine.statesByElement.get(t);o||(BO(t,bD),BO(t,bD+"-"+e),this._engine.statesByElement.set(t,o={}));let a=o[e];const l=new DO(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),o[e]=l,a||(a=RO),l.value!==OO&&a.value===l.value){if(!function(t,e){const n=Object.keys(t),i=Object.keys(e);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const i=n[r];if(!e.hasOwnProperty(i)||t[i]!==e[i])return!1}return!0}(a.params,l.params)){const e=[],n=r.matchStyles(a.value,a.params,e),i=r.matchStyles(l.value,l.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{OD(t,n),DD(t,i)})}return}const u=rD(this._engine.playersByElement,t,[]);u.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let c=r.matchTransition(a.value,l.value,t,l.params),h=!1;if(!c){if(!i)return;c=r.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:c,fromState:a,toState:l,player:s,isFallbackTransition:h}),h||(BO(t,CO),s.onStart(()=>{ZO(t,CO)})),s.onDone(()=>{let e=this.players.indexOf(s);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(s);t>=0&&n.splice(t,1)}}),this.players.push(s),u.push(s),s}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,TD,!0);n.forEach(t=>{if(t[NO])return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(t=>this.clearElementCache(t)))}triggerLeaveAnimation(t,e,n,i){const r=this._engine.statesByElement.get(t);if(r){const s=[];if(Object.keys(r).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,OO,i);n&&s.push(n)}}),s.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&XN(s).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const i=new Set;e.forEach(e=>{const r=e.name;if(i.has(r))return;i.add(r);const s=this._triggers[r].fallbackTransition,o=n[r]||RO,a=new DO(OO),l=new FO(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:s,fromState:o,toState:a,player:l,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let i=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)i=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(t),i)n.markElementAsRemoved(this.id,t,!1,e);else{const i=t[NO];(!i||i===AO)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){BO(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const r=n.element,s=this._elementListeners.get(r);s&&s.forEach(e=>{if(e.name==n.triggerName){const i=iD(r,n.triggerName,n.fromState.value,n.toState.value);i._data=t,eD(n.player,e.phase,i,e.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,i=e.transition.ast.depCount;return 0==n||0==i?n-i:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class MO{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new LO(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let i=!1;for(let r=n;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,e)){this._namespaceList.splice(r+1,0,t),i=!0;break}i||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let i=this._namespaceLookup[t];i&&i.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let i=0;i<t.length;i++){const r=n[t[i]].namespaceId;if(r){const t=this._fetchNamespace(r);t&&e.add(t)}}}return e}trigger(t,e,n,i){if(VO(e)){const r=this._fetchNamespace(t);if(r)return r.trigger(e,n,i),!0}return!1}insertNode(t,e,n,i){if(!VO(e))return;const r=e[NO];if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const i=this._fetchNamespace(t);i&&i.insertNode(e,n)}i&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),BO(t,EO)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),ZO(t,EO))}removeNode(t,e,n,i){if(VO(e)){const r=t?this._fetchNamespace(t):null;if(r?r.removeNode(e,i):this.markElementAsRemoved(t,e,!1,i),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,i)}}else this._onRemovalComplete(e,i)}markElementAsRemoved(t,e,n,i){this.collectedLeaveElements.push(e),e[NO]={namespaceId:t,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,i,r){return VO(e)?this._fetchNamespace(t).listen(e,n,i,r):()=>{}}_buildInstruction(t,e,n,i,r){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,i,t.fromState.options,t.toState.options,e,r)}destroyInnerAnimations(t){let e=this.driver.query(t,TD,!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,SD,!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return XN(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[NO];if(e&&e.setForRemoval){if(t[NO]=AO,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,xO)&&this.markElementAsDisabled(t,!1),this.driver.query(t,xO,!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)BO(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?XN(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new rO,i=[],r=new Map,s=[],o=new Map,a=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(t=>{u.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)u.add(e[n])});const c=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=qO(h,this.collectedEnterElements),p=new Map;let f=0;d.forEach((t,e)=>{const n=vD+f++;p.set(e,n),t.forEach(t=>BO(t,n))});const m=[],g=new Set,y=new Set;for(let P=0;P<this.collectedLeaveElements.length;P++){const t=this.collectedLeaveElements[P],e=t[NO];e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):y.add(t))}const _=new Map,v=qO(h,Array.from(g));v.forEach((t,e)=>{const n=wD+f++;_.set(e,n),t.forEach(t=>BO(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=p.get(e);t.forEach(t=>ZO(t,n))}),v.forEach((t,e)=>{const n=_.get(e);t.forEach(t=>ZO(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const w=[],b=[];for(let P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(e).forEach(t=>{const e=t.player,r=t.element;if(w.push(e),this.collectedEnterElements.length){const t=r[NO];if(t&&t.setForMove)return void e.destroy()}const u=!c||!this.driver.containsElement(c,r),h=_.get(r),d=p.get(r),f=this._buildInstruction(t,n,d,h,u);if(f.errors&&f.errors.length)b.push(f);else{if(u)return e.onStart(()=>OD(r,f.fromStyles)),e.onDestroy(()=>DD(r,f.toStyles)),void i.push(e);if(t.isFallbackTransition)return e.onStart(()=>OD(r,f.fromStyles)),e.onDestroy(()=>DD(r,f.toStyles)),void i.push(e);f.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(r,f.timelines),s.push({instruction:f,player:e,element:r}),f.queriedElements.forEach(t=>rD(o,t,[]).push(e)),f.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=a.get(e);t||a.set(e,t=new Set),n.forEach(e=>t.add(e))}}),f.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let i=l.get(e);i||l.set(e,i=new Set),n.forEach(t=>i.add(t))})}});if(b.length){const t=[];b.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),w.forEach(t=>t.destroy()),this.reportError(t)}const T=new Map,I=new Map;s.forEach(t=>{const e=t.element;n.has(e)&&(I.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,T))}),i.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{rD(T,e,[]).push(t),t.destroy()})});const S=m.filter(t=>WO(t,a,l)),C=new Map;jO(C,this.driver,y,l,nN).forEach(t=>{WO(t,a,l)&&S.push(t)});const E=new Map;d.forEach((t,e)=>{jO(E,this.driver,new Set(t),a,"!")}),S.forEach(t=>{const e=C.get(t),n=E.get(t);C.set(t,Object.assign(Object.assign({},e),n))});const x=[],k=[],A={};s.forEach(t=>{const{element:e,player:s,instruction:o}=t;if(n.has(e)){if(u.has(e))return s.onDestroy(()=>DD(e,o.toStyles)),s.disabled=!0,s.overrideTotalTime(o.totalTime),void i.push(s);let t=A;if(I.size>1){let n=e;const i=[];for(;n=n.parentNode;){const e=I.get(n);if(e){t=e;break}i.push(n)}i.forEach(e=>I.set(e,t))}const n=this._buildAnimation(s.namespaceId,o,T,r,E,C);if(s.setRealPlayer(n),t===A)x.push(s);else{const e=this.playersByElement.get(t);e&&e.length&&(s.parentPlayer=XN(e)),i.push(s)}}else OD(e,o.fromStyles),s.onDestroy(()=>DD(e,o.toStyles)),k.push(s),u.has(e)&&i.push(s)}),k.forEach(t=>{const e=r.get(t.element);if(e&&e.length){const n=XN(e);t.setRealPlayer(n)}}),i.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let P=0;P<m.length;P++){const t=m[P],e=t[NO];if(ZO(t,wD),e&&e.hasAnimation)continue;let n=[];if(o.size){let e=o.get(t);e&&e.length&&n.push(...e);let i=this.driver.query(t,SD,!0);for(let t=0;t<i.length;t++){let e=o.get(i[t]);e&&e.length&&n.push(...e)}}const i=n.filter(t=>!t.destroyed);i.length?HO(this,t,i):this.processLeaveNode(t)}return m.length=0,x.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),x}elementContainsData(t,e){let n=!1;const i=e[NO];return i&&i.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,i,r){let s=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(s=e)}else{const e=this.playersByElement.get(t);if(e){const t=!r||r==OO;e.forEach(e=>{e.queued||!t&&e.triggerName!=i||s.push(e)})}}return(n||i)&&(s=s.filter(t=>!(n&&n!=t.namespaceId||i&&i!=t.triggerName))),s}_beforeAnimationBuild(t,e,n){const i=e.element,r=e.isRemovalTransition?void 0:t,s=e.isRemovalTransition?void 0:e.triggerName;for(const o of e.timelines){const t=o.element,a=t!==i,l=rD(n,t,[]);this._getPreviousPlayers(t,a,r,s,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),l.push(t)})}OD(i,e.fromStyles)}_buildAnimation(t,e,n,i,r,s){const o=e.triggerName,a=e.element,l=[],u=new Set,c=new Set,h=e.timelines.map(e=>{const h=e.element;u.add(h);const d=h[NO];if(d&&d.removedBeforeQueried)return new uN(e.duration,e.delay);const p=h!==a,f=function(t){const e=[];return $O(t,e),e}((n.get(h)||kO).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=r.get(h),g=s.get(h),y=tD(0,this._normalizer,0,e.keyframes,m,g),_=this._buildPlayer(e,y,f);if(e.subTimeline&&i&&c.add(h),p){const e=new FO(t,o,h);e.setRealPlayer(_),l.push(e)}return _});l.forEach(t=>{rD(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let i;if(t instanceof Map){if(i=t.get(e),i){if(i.length){const t=i.indexOf(n);i.splice(t,1)}0==i.length&&t.delete(e)}}else if(i=t[e],i){if(i.length){const t=i.indexOf(n);i.splice(t,1)}0==i.length&&delete t[e]}return i}(this.playersByQueriedElement,t.element,t))}),u.forEach(t=>BO(t,ID));const d=XN(h);return d.onDestroy(()=>{u.forEach(t=>ZO(t,ID)),DD(a,e.toStyles)}),c.forEach(t=>{rD(i,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new uN(t.duration,t.delay)}}class FO{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new uN,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>eD(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){rD(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function VO(t){return t&&1===t.nodeType}function UO(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function jO(t,e,n,i,r){const s=[];n.forEach(t=>s.push(UO(t)));const o=[];i.forEach((n,i)=>{const s={};n.forEach(t=>{const n=s[t]=e.computeStyle(i,t,r);(!n||0==n.length)&&(i[NO]=PO,o.push(i))}),t.set(i,s)});let a=0;return n.forEach(t=>UO(t,s[a++])),o}function qO(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const i=new Set(e),r=new Map;function s(t){if(!t)return 1;let e=r.get(t);if(e)return e;const o=t.parentNode;return e=n.has(o)?o:i.has(o)?1:s(o),r.set(t,e),e}return e.forEach(t=>{const e=s(t);1!==e&&n.get(e).push(t)}),n}const zO="$$classes";function BO(t,e){if(t.classList)t.classList.add(e);else{let n=t[zO];n||(n=t[zO]={}),n[e]=!0}}function ZO(t,e){if(t.classList)t.classList.remove(e);else{let n=t[zO];n&&delete n[e]}}function HO(t,e,n){XN(n).onDone(()=>t.processLeaveNode(e))}function $O(t,e){for(let n=0;n<t.length;n++){const i=t[n];i instanceof cN?$O(i.players,e):e.push(i)}}function WO(t,e,n){const i=n.get(t);if(!i)return!1;let r=e.get(t);return r?i.forEach(t=>r.add(t)):e.set(t,i),n.delete(t),!0}class GO{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new MO(t,e,n),this._timelineEngine=new SO(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,i,r){const s=t+"-"+i;let o=this._triggerCache[s];if(!o){const t=[],e=YD(this._driver,r,t);if(t.length)throw new Error(`The animation trigger "${i}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);o=function(t,e,n){return new bO(t,e,n)}(i,e,this._normalizer),this._triggerCache[s]=o}this._transitionEngine.registerTrigger(e,i,o)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,i){this._transitionEngine.insertNode(t,e,n,i)}onRemove(t,e,n,i){this._transitionEngine.removeNode(t,e,i||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,i){if("@"==n.charAt(0)){const[t,r]=sD(n);this._timelineEngine.command(t,e,r,i)}else this._transitionEngine.trigger(t,e,n,i)}listen(t,e,n,i,r){if("@"==n.charAt(0)){const[t,i]=sD(n);return this._timelineEngine.listen(t,e,i,r)}return this._transitionEngine.listen(t,e,n,i,r)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function KO(t,e){let n=null,i=null;return Array.isArray(e)&&e.length?(n=YO(e[0]),e.length>1&&(i=YO(e[e.length-1]))):e&&(n=YO(e)),n||i?new QO(t,n,i):null}let QO=(()=>{class t{constructor(e,n,i){this._element=e,this._startStyles=n,this._endStyles=i,this._state=0;let r=t.initialStylesByElement.get(e);r||t.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&DD(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(DD(this._element,this._initialStyles),this._endStyles&&(DD(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(OD(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(OD(this._element,this._endStyles),this._endStyles=null),DD(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function YO(t){let e=null;const n=Object.keys(t);for(let i=0;i<n.length;i++){const r=n[i];JO(r)&&(e=e||{},e[r]=t[r])}return e}function JO(t){return"display"===t||"position"===t}const XO="animation",tR="animationend";class eR{constructor(t,e,n,i,r,s,o){this._element=t,this._name=e,this._duration=n,this._delay=i,this._easing=r,this._fillMode=s,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){(function(t,e){const n=aR(t,"").trim();let i=0;n.length&&(function(t,e){let n=0;for(let i=0;i<t.length;i++)","===t.charAt(i)&&n++;return n}(n)+1,e=`${n}, ${e}`),oR(t,"",e)})(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),sR(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){nR(this._element,this._name,"paused")}resume(){nR(this._element,this._name,"running")}setPosition(t){const e=iR(this._element,this._name);this._position=t*this._duration,oR(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),sR(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=aR(t,"").split(","),i=rR(n,e);i>=0&&(n.splice(i,1),oR(t,"",n.join(",")))}(this._element,this._name))}}function nR(t,e,n){oR(t,"PlayState",n,iR(t,e))}function iR(t,e){const n=aR(t,"");return n.indexOf(",")>0?rR(n.split(","),e):rR([n],e)}function rR(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function sR(t,e,n){n?t.removeEventListener(tR,e):t.addEventListener(tR,e)}function oR(t,e,n,i){const r=XO+e;if(null!=i){const e=t.style[r];if(e.length){const t=e.split(",");t[i]=n,n=t.join(",")}}t.style[r]=n}function aR(t,e){return t.style[XO+e]||""}class lR{constructor(t,e,n,i,r,s,o,a){this.element=t,this.keyframes=e,this.animationName=n,this._duration=i,this._delay=r,this._finalStyles=o,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=s||"linear",this.totalTime=i+r,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new eR(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:HD(this.element,n))})}this.currentSnapshot=t}}class uR extends uN{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=gD(e)}init(){this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){!this._startingStyles||(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class cR{constructor(){this._count=0}validateStyleProperty(t){return dD(t)}matchesElement(t,e){return pD(t,e)}containsElement(t,e){return fD(t,e)}query(t,e,n){return mD(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>gD(t));let i=`@keyframes ${e} {\n`,r="";n.forEach(t=>{r=" ";const e=parseFloat(t.offset);i+=`${r}${100*e}% {\n`,r+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(i+=`${r}animation-timing-function: ${n};\n`));default:return void(i+=`${r}${e}: ${n};\n`)}}),i+=`${r}}\n`}),i+="}\n";const s=document.createElement("style");return s.textContent=i,s}animate(t,e,n,i,r,s=[],o){const a=s.filter(t=>t instanceof lR),l={};zD(n,i)&&a.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const u=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"==n||"easing"==n||(e[n]=t[n])})}),e}(e=BD(t,e,l));if(0==n)return new uR(t,u);const c="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(t,c,e);(function(t){var e;const n=null===(e=t.getRootNode)||void 0===e?void 0:e.call(t);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(t).appendChild(h);const d=KO(t,e),p=new lR(t,e,c,n,i,r,u,d);return p.onDestroy(()=>function(t){t.parentNode.removeChild(t)}(h)),p}}class hR{constructor(t,e,n,i){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:HD(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class dR{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(pR().toString()),this._cssKeyframesDriver=new cR}validateStyleProperty(t){return dD(t)}matchesElement(t,e){return pD(t,e)}containsElement(t,e){return fD(t,e)}query(t,e,n){return mD(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,i,r,s=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,i,r,s);const a={duration:n,delay:i,fill:0==i?"both":"forwards"};r&&(a.easing=r);const l={},u=s.filter(t=>t instanceof hR);zD(n,i)&&u.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const c=KO(t,e=BD(t,e=e.map(t=>AD(t,!1)),l));return new hR(t,e,a,c)}}function pR(){return YN()&&Element.prototype.animate||{}}let fR=(()=>{class t extends eN{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:i.ifc.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?sN(t):t;return yR(this._renderer,null,e,"register",[n]),new mR(e,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.FYo),i.LFG(o))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class mR extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new gR(this._id,t,e||{},this._renderer)}}class gR{constructor(t,e,n,i){this.id=t,this.element=e,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return yR(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function yR(t,e,n,i,r){return t.setProperty(e,`@@${n}:${i}`,r)}const _R="@.disabled";let vR=(()=>{class t{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new wR("",n,this.engine),this._rendererCache.set(n,t)),t}const i=e.id,r=e.id+"-"+this._currentId;this._currentId++,this.engine.register(r,t);const s=e=>{Array.isArray(e)?e.forEach(s):this.engine.registerTrigger(i,r,t,e.name,e)};return e.data.animation.forEach(s),new bR(this,r,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.FYo),i.LFG(GO),i.LFG(i.R0b))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class wR{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,i=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,i)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,i){this.delegate.setAttribute(t,e,n,i)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,i){this.delegate.setStyle(t,e,n,i)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&e==_R?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class bR extends wR{constructor(t,e,n,i){super(e,n,i),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==_R?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const i=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let r=e.substr(1),s="";return"@"!=r.charAt(0)&&([r,s]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(r)),this.engine.listen(this.namespaceId,i,r,s,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let TR=(()=>{class t extends GO{constructor(t,e,n){super(t.body,e,n)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o),i.LFG(_D),i.LFG(fO))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const IR=new i.OlP("AnimationModuleType"),SR=[{provide:eN,useClass:fR},{provide:fO,useFactory:function(){return new mO}},{provide:GO,useClass:TR},{provide:i.FYo,useFactory:function(t,e,n){return new vR(t,e,n)},deps:[ut,GO,i.R0b]}],CR=[{provide:_D,useFactory:function(){return"function"==typeof pR()?new dR:new cR}},{provide:IR,useValue:"BrowserAnimations"},...SR],ER=[{provide:_D,useClass:yD},{provide:IR,useValue:"NoopAnimations"},...SR];let xR=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?ER:CR}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:CR,imports:[bt]}),t})();const kR={apiKey:"AIzaSyDXvvPWVSvKQAr4sLfYskstSKLRYfRsSaw",authDomain:"poznandawniejdzis-79c46.firebaseapp.com",databaseURL:"https://poznandawniejdzis-79c46-default-rtdb.firebaseio.com",projectId:"poznandawniejdzis-79c46",storageBucket:"poznandawniejdzis-79c46.appspot.com",messagingSenderId:"1033991145858",appId:"1:1033991145858:web:28d914c9b8fc24ef88679b",measurementId:"G-MZRRG17H7D"};let AR=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t,bootstrap:[XP]}),t.\u0275inj=i.cJS({providers:[],imports:[[QN,xR,bt,$v,vS,Tt.hO.initializeApp(kR),cv]]}),t})();(0,i.G48)(),vt().bootstrapModule(AR).catch(t=>console.error(t))},3394:function(t,e,n){"use strict";n.d(e,{Z:function(){return h}});var i=n(3854),r=n(3910),s=n(8026),o=n(5422);class a{constructor(t,e){this._delegate=t,this.firebase=e,(0,s._addComponent)(t,new r.wA("app-compat",()=>this,"PUBLIC")),this.container=t.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this._delegate.automaticDataCollectionEnabled=t}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(t=>{this._delegate.checkDestroyed(),t()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,s.deleteApp)(this._delegate)))}_getService(t,e=s._DEFAULT_ENTRY_NAME){var n;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(t);return!i.isInitialized()&&"EXPLICIT"===(null===(n=i.getComponent())||void 0===n?void 0:n.instantiationMode)&&i.initialize(),i.getImmediate({identifier:e})}_removeServiceInstance(t,e=s._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(t).clearInstance(e)}_addComponent(t){(0,s._addComponent)(this._delegate,t)}_addOrOverwriteComponent(t){(0,s._addOrOverwriteComponent)(this._delegate,t)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const l=new i.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),u=function t(){const e=function(t){const e={},n={__esModule:!0,initializeApp:function(r,o={}){const a=s.initializeApp(r,o);if((0,i.r3)(e,a.name))return e[a.name];const l=new t(a,n);return e[a.name]=l,l},app:r,registerVersion:s.registerVersion,setLogLevel:s.setLogLevel,onLog:s.onLog,apps:null,SDK_VERSION:s.SDK_VERSION,INTERNAL:{registerComponent:function(e){const o=e.name,a=o.replace("-compat","");if(s._registerComponent(e)&&"PUBLIC"===e.type){const s=(t=r())=>{if("function"!=typeof t[a])throw l.create("invalid-app-argument",{appName:o});return t[a]()};void 0!==e.serviceProps&&(0,i.ZB)(s,e.serviceProps),n[a]=s,t.prototype[a]=function(...t){return this._getService.bind(this,o).apply(this,e.multipleInstances?t:[])}}return"PUBLIC"===e.type?n[a]:null},removeApp:function(t){delete e[t]},useAsService:function(t,e){return"serverAuth"===e?null:e},modularAPIs:s}};function r(t){if(!(0,i.r3)(e,t=t||s._DEFAULT_ENTRY_NAME))throw l.create("no-app",{appName:t});return e[t]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(e).map(t=>e[t])}}),r.App=t,n}(a);return e.INTERNAL=Object.assign(Object.assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,i.ZB)(e,t)},createSubscribe:i.ne,ErrorFactory:i.LL,deepExtend:i.ZB}),e}(),c=new o.Yd("@firebase/app-compat");if((0,i.jU)()&&void 0!==self.firebase){c.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&c.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const h=u;(0,s.registerVersion)("@firebase/app-compat","0.2.0",undefined)},8026:function(t,e,n){"use strict";n.r(e),n.d(e,{FirebaseError:function(){return o.ZR},SDK_VERSION:function(){return I},_DEFAULT_ENTRY_NAME:function(){return h},_addComponent:function(){return m},_addOrOverwriteComponent:function(){return g},_apps:function(){return p},_clearComponents:function(){return w},_components:function(){return f},_getProvider:function(){return _},_registerComponent:function(){return y},_removeServiceInstance:function(){return v},deleteApp:function(){return x},getApp:function(){return C},getApps:function(){return E},initializeApp:function(){return S},onLog:function(){return P},registerVersion:function(){return A},setLogLevel:function(){return N}});var i=n(8239),r=n(3910),s=n(5422),o=n(3854),a=n(2373);class l{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null}).filter(t=>t).join(" ")}}const u="@firebase/app",c=new s.Yd("@firebase/app"),h="[DEFAULT]",d={[u]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},p=new Map,f=new Map;function m(t,e){try{t.container.addComponent(e)}catch(n){c.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function g(t,e){t.container.addOrOverwriteComponent(e)}function y(t){const e=t.name;if(f.has(e))return c.debug(`There were multiple attempts to register component ${e}.`),!1;f.set(e,t);for(const n of p.values())m(n,t);return!0}function _(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function v(t,e,n=h){_(t,e).clearInstance(n)}function w(){f.clear()}const b=new o.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class T{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw b.create("app-deleted",{appName:this._name})}}const I="9.15.0";function S(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:h,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw b.create("bad-app-name",{appName:String(s)});if(n||(n=(0,o.aH)()),!n)throw b.create("no-options");const a=p.get(s);if(a){if((0,o.vZ)(n,a.options)&&(0,o.vZ)(i,a.config))return a;throw b.create("duplicate-app",{appName:s})}const l=new r.H0(s);for(const r of f.values())l.addComponent(r);const u=new T(n,i,l);return p.set(s,u),u}function C(t=h){const e=p.get(t);if(!e&&t===h)return S();if(!e)throw b.create("no-app",{appName:t});return e}function E(){return Array.from(p.values())}function x(t){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)(function*(t){const e=t.name;p.has(e)&&(p.delete(e),yield Promise.all(t.container.getProviders().map(t=>t.delete())),t.isDeleted=!0)})).apply(this,arguments)}function A(t,e,n){var i;let s=null!==(i=d[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${s}" with version "${e}":`];return o&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void c.warn(t.join(" "))}y(new r.wA(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function P(t,e){if(null!==t&&"function"!=typeof t)throw b.create("invalid-log-argument");(0,s.Am)(t,e)}function N(t){(0,s.Ub)(t)}const D="firebase-heartbeat-store";let O=null;function R(){return O||(O=(0,a.X3)("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(D)}}).catch(t=>{throw b.create("idb-open",{originalErrorMessage:t.message})})),O}function L(){return(L=(0,i.Z)(function*(t){try{return(yield R()).transaction(D).objectStore(D).get(V(t))}catch(e){if(e instanceof o.ZR)c.warn(e.message);else{const t=b.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});c.warn(t.message)}}})).apply(this,arguments)}function M(t,e){return F.apply(this,arguments)}function F(){return(F=(0,i.Z)(function*(t,e){try{const n=(yield R()).transaction(D,"readwrite");return yield n.objectStore(D).put(e,V(t)),n.done}catch(n){if(n instanceof o.ZR)c.warn(n.message);else{const t=b.create("idb-set",{originalErrorMessage:null==n?void 0:n.message});c.warn(t.message)}}})).apply(this,arguments)}function V(t){return`${t.name}!${t.options.appId}`}class U{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new q(e),this._heartbeatsCachePromise=this._storage.read().then(t=>(this._heartbeatsCache=t,t))}triggerHeartbeat(){var t=this;return(0,i.Z)(function*(){const e=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=j();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==n&&!t._heartbeatsCache.heartbeats.some(t=>t.date===n))return t._heartbeatsCache.heartbeats.push({date:n,agent:e}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return(0,i.Z)(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=j(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find(t=>t.agent===r.agent);if(t){if(t.dates.push(r.date),z(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),z(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(t._heartbeatsCache.heartbeats),r=(0,o.L)(JSON.stringify({version:2,heartbeats:n}));return t._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(t._heartbeatsCache.heartbeats=i,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),r})()}}function j(){return(new Date).toISOString().substring(0,10)}class q{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,i.Z)(function*(){return!!(0,o.hl)()&&(0,o.eu)().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return(0,i.Z)(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function(t){return L.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return(0,i.Z)(function*(){var n;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return M(e.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return(0,i.Z)(function*(){var n;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return M(e.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function z(t){return(0,o.L)(JSON.stringify({version:2,heartbeats:t})).length}y(new r.wA("platform-logger",t=>new l(t),"PRIVATE")),y(new r.wA("heartbeat",t=>new U(t),"PRIVATE")),A(u,"0.9.0",""),A(u,"0.9.0","esm2017"),A("fire-js","")},3910:function(t,e,n){"use strict";n.d(e,{wA:function(){return s},H0:function(){return l},zt:function(){return a}});var i=n(8239),r=n(3854);class s{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const o="[DEFAULT]";class a{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new r.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(n){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if("EAGER"===t.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}for(const[t,e]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});e.resolve(t)}catch(n){}}}}clearInstance(t=o){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return(0,i.Z)(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=o){return this.instances.has(t)}getOptions(t=o){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[r,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(r)&&s.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===o?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(r){}var i;return n||null}normalizeInstanceIdentifier(t=o){return this.component?this.component.multipleInstances?t:o:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class l{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new a(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},5422:function(t,e,n){"use strict";n.d(e,{in:function(){return r},Yd:function(){return u},Ub:function(){return c},Am:function(){return h}});const i=[];var r=(()=>{return(t=r||(r={}))[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",r;var t})();const s={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,a={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},l=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=a[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class u{constructor(t){this.name=t,this._logLevel=o,this._logHandler=l,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in r))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?s[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}function c(t){i.forEach(e=>{e.setLogLevel(t)})}function h(t,e){for(const n of i){let i=null;e&&e.level&&(i=s[e.level]),n.userLogHandler=null===t?null:(e,n,...s)=>{const o=s.map(t=>{if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}}).filter(t=>t).join(" ");n>=(null!=i?i:e.logLevel)&&t({level:r[n].toLowerCase(),message:o,args:s,type:e.name})}}}},8213:function(t,e,n){"use strict";n.d(e,{Mq:function(){return i.getApp},C6:function(){return i.getApps}});var i=n(8026);(0,i.registerVersion)("firebase","9.15.0","app")},2533:function(t,e,n){"use strict";n.d(e,{Z:function(){return i.Z}});var i=n(3394);i.Z.registerVersion("firebase","9.15.0","app-compat")},3474:function(t,e,n){"use strict";n.r(e);var i=n(8239),r=n(3394),s=n(3854),o=n(8026),a=n(5422);function l(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}var u=n(3910);const c=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},h=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},d=new s.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),p=new a.Yd("@firebase/auth");function f(t,...e){p.logLevel<=a.in.ERROR&&p.error(`Auth (${o.SDK_VERSION}): ${t}`,...e)}function m(t,...e){throw v(t,...e)}function g(t,...e){return v(t,...e)}function y(t,e,n){const i=Object.assign(Object.assign({},h()),{[e]:n});return new s.LL("auth","Firebase",i).create(e,{appName:t.name})}function _(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&m(t,"argument-error"),y(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function v(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return d.create(t,...e)}function w(t,e,...n){if(!t)throw v(e,...n)}function b(t){const e="INTERNAL ASSERTION FAILED: "+t;throw f(e),new Error(e)}function T(t,e){t||b(e)}const I=new Map;function S(t){T(t instanceof Function,"Expected a class definition");let e=I.get(t);return e?(T(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,I.set(t,e),e)}function C(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function E(){return"http:"===x()||"https:"===x()}function x(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class k{constructor(t,e){this.shortDelay=t,this.longDelay=e,T(e>t,"Short delay should be less than long delay!"),this.isMobile=(0,s.uI)()||(0,s.b$)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(E()||(0,s.ru)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function A(t,e){T(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class P{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void b("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void b("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void b("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const N={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},D=new k(3e4,6e4);function O(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function R(t,e,n,i){return L.apply(this,arguments)}function L(){return(L=(0,i.Z)(function*(t,e,n,r,o={}){return M(t,o,(0,i.Z)(function*(){let i={},o={};r&&("GET"===e?o=r:i={body:JSON.stringify(r)});const a=(0,s.xO)(Object.assign({key:t.config.apiKey},o)).slice(1),l=yield t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),P.fetch()(j(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},i))}))})).apply(this,arguments)}function M(t,e,n){return F.apply(this,arguments)}function F(){return(F=(0,i.Z)(function*(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},N),e);try{const e=new q(t),r=yield Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=yield r.json();if("needConfirmation"in s)throw z(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw z(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw z(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw z(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw y(t,a,o);m(t,a)}}catch(r){if(r instanceof s.ZR)throw r;m(t,"network-request-failed")}})).apply(this,arguments)}function V(t,e,n,i){return U.apply(this,arguments)}function U(){return(U=(0,i.Z)(function*(t,e,n,i,r={}){const s=yield R(t,e,n,i,r);return"mfaPendingCredential"in s&&m(t,"multi-factor-auth-required",{_serverResponse:s}),s})).apply(this,arguments)}function j(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?A(t.config,r):`${t.config.apiScheme}://${r}`}class q{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((t,e)=>{this.timer=setTimeout(()=>e(g(this.auth,"network-request-failed")),D.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function z(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=g(t,e,i);return r.customData._tokenResponse=n,r}function B(){return(B=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:delete",e)})).apply(this,arguments)}function Z(t,e){return H.apply(this,arguments)}function H(){return(H=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:update",e)})).apply(this,arguments)}function $(t,e){return W.apply(this,arguments)}function W(){return(W=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:lookup",e)})).apply(this,arguments)}function G(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(e){}}function K(){return(K=(0,i.Z)(function*(t,e=!1){const n=(0,s.m9)(t),i=yield n.getIdToken(e),r=Y(i);w(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const o="object"==typeof r.firebase?r.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:r,token:i,authTime:G(Q(r.auth_time)),issuedAtTime:G(Q(r.iat)),expirationTime:G(Q(r.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}})).apply(this,arguments)}function Q(t){return 1e3*Number(t)}function Y(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return f("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,s.tV)(n);return t?JSON.parse(t):(f("Failed to decode base64 JWT payload"),null)}catch(r){return f("Caught error parsing JWT payload as JSON",null==r?void 0:r.toString()),null}}function J(t,e){return X.apply(this,arguments)}function X(){return(X=(0,i.Z)(function*(t,e,n=!1){if(n)return e;try{return yield e}catch(i){throw i instanceof s.ZR&&tt(i)&&t.auth.currentUser===t&&(yield t.auth.signOut()),i}})).apply(this,arguments)}function tt({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}class et{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const n=this.getInterval(t);this.timerId=setTimeout((0,i.Z)(function*(){yield e.iteration()}),n)}iteration(){var t=this;return(0,i.Z)(function*(){try{yield t.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class nt{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=G(this.lastLoginAt),this.creationTime=G(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function it(t){return rt.apply(this,arguments)}function rt(){return(rt=(0,i.Z)(function*(t){var e;const n=t.auth,i=yield t.getIdToken(),r=yield J(t,$(n,{idToken:i}));w(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?at(s.providerUserInfo):[],a=ot(t.providerData,o),l=!!t.isAnonymous&&!(t.email&&s.passwordHash||(null==a?void 0:a.length)),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new nt(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,u)})).apply(this,arguments)}function st(){return(st=(0,i.Z)(function*(t){const e=(0,s.m9)(t);yield it(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})).apply(this,arguments)}function ot(t,e){return[...t.filter(t=>!e.some(e=>e.providerId===t.providerId)),...e]}function at(t){return t.map(t=>{var{providerId:e}=t,n=l(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function lt(){return(lt=(0,i.Z)(function*(t,e){const n=yield M(t,{},(0,i.Z)(function*(){const n=(0,s.xO)({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,o=j(t,i,"/v1/token",`key=${r}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",P.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})).apply(this,arguments)}class ut{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){w(t.idToken,"internal-error"),w(void 0!==t.idToken,"internal-error"),w(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=Y(t);return w(e,"internal-error"),w(void 0!==e.exp,"internal-error"),w(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var n=this;return(0,i.Z)(function*(){return w(!n.accessToken||n.refreshToken,t,"user-token-expired"),e||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(t,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var n=this;return(0,i.Z)(function*(){const{accessToken:i,refreshToken:r,expiresIn:s}=yield function(t,e){return lt.apply(this,arguments)}(t,e);n.updateTokensAndExpiration(i,r,Number(s))})()}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new ut;return n&&(w("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(w("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(w("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new ut,this.toJSON())}_performRefresh(){return b("not implemented")}}function ct(t,e){w("string"==typeof t||void 0===t,"internal-error",{appName:e})}class ht{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=l(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new et(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new nt(r.createdAt||void 0,r.lastLoginAt||void 0)}getIdToken(t){var e=this;return(0,i.Z)(function*(){const n=yield J(e,e.stsTokenManager.getToken(e.auth,t));return w(n,e.auth,"internal-error"),e.accessToken!==n&&(e.accessToken=n,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),n})()}getIdTokenResult(t){return function(t){return K.apply(this,arguments)}(this,t)}reload(){return function(t){return st.apply(this,arguments)}(this)}_assign(t){this!==t&&(w(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(t=>Object.assign({},t)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new ht(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){w(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var n=this;return(0,i.Z)(function*(){let i=!1;t.idToken&&t.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(t),i=!0),e&&(yield it(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var t=this;return(0,i.Z)(function*(){const e=yield t.getIdToken();return yield J(t,function(t,e){return B.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,l,u;const c=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=e.photoURL)&&void 0!==s?s:void 0,f=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=e.createdAt)&&void 0!==l?l:void 0,y=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:_,emailVerified:v,isAnonymous:b,providerData:T,stsTokenManager:I}=e;w(_&&I,t,"internal-error");const S=ut.fromJSON(this.name,I);w("string"==typeof _,t,"internal-error"),ct(c,t.name),ct(h,t.name),w("boolean"==typeof v,t,"internal-error"),w("boolean"==typeof b,t,"internal-error"),ct(d,t.name),ct(p,t.name),ct(f,t.name),ct(m,t.name),ct(g,t.name),ct(y,t.name);const C=new ht({uid:_,auth:t,email:h,emailVerified:v,displayName:c,isAnonymous:b,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:S,createdAt:g,lastLoginAt:y});return T&&Array.isArray(T)&&(C.providerData=T.map(t=>Object.assign({},t))),m&&(C._redirectEventId=m),C}static _fromIdTokenResponse(t,e,n=!1){return(0,i.Z)(function*(){const i=new ut;i.updateFromServerResponse(e);const r=new ht({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return yield it(r),r})()}}const dt=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,i.Z)(function*(){return!0})()}_set(t,e){var n=this;return(0,i.Z)(function*(){n.storage[t]=e})()}_get(t){var e=this;return(0,i.Z)(function*(){const n=e.storage[t];return void 0===n?null:n})()}_remove(t){var e=this;return(0,i.Z)(function*(){delete e.storage[t]})()}_addListener(t,e){}_removeListener(t,e){}}return t.type="NONE",t})();function pt(t,e,n){return`firebase:${t}:${e}:${n}`}class ft{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=pt(this.userKey,i.apiKey,r),this.fullPersistenceKey=pt("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return(0,i.Z)(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?ht._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return(0,i.Z)(function*(){if(e.persistence===t)return;const n=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,n?e.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,n="authUser"){return(0,i.Z)(function*(){if(!e.length)return new ft(S(dt),t,n);const r=(yield Promise.all(e.map(function(){var t=(0,i.Z)(function*(t){if(yield t._isAvailable())return t});return function(e){return t.apply(this,arguments)}}()))).filter(t=>t);let s=r[0]||S(dt);const o=pt(n,t.config.apiKey,t.name);let a=null;for(const n of e)try{const e=yield n._get(o);if(e){const i=ht._fromJSON(t,e);n!==s&&(a=i),s=n;break}}catch(u){}const l=r.filter(t=>t._shouldAllowMigration);return s._shouldAllowMigration&&l.length?(s=l[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(e.map(function(){var t=(0,i.Z)(function*(t){if(t!==s)try{yield t._remove(o)}catch(e){}});return function(e){return t.apply(this,arguments)}}())),new ft(s,t,n)):new ft(s,t,n)})()}}function mt(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vt(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gt(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bt(e))return"Blackberry";if(Tt(e))return"Webos";if(yt(e))return"Safari";if((e.includes("chrome/")||_t(e))&&!e.includes("edge/"))return"Chrome";if(wt(e))return"Android";{const e=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==e?void 0:e.length))return e[1]}return"Other"}function gt(t=(0,s.z$)()){return/firefox\//i.test(t)}function yt(t=(0,s.z$)()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _t(t=(0,s.z$)()){return/crios\//i.test(t)}function vt(t=(0,s.z$)()){return/iemobile/i.test(t)}function wt(t=(0,s.z$)()){return/android/i.test(t)}function bt(t=(0,s.z$)()){return/blackberry/i.test(t)}function Tt(t=(0,s.z$)()){return/webos/i.test(t)}function It(t=(0,s.z$)()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function St(t=(0,s.z$)()){return It(t)||wt(t)||Tt(t)||bt(t)||/windows phone/i.test(t)||vt(t)}function Ct(t,e=[]){let n;switch(t){case"Browser":n=mt((0,s.z$)());break;case"Worker":n=`${mt((0,s.z$)())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${o.SDK_VERSION}/${i}`}class Et{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise((n,i)=>{try{n(t(e))}catch(r){i(r)}});n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return(0,i.Z)(function*(){if(e.auth.currentUser===t)return;const n=[];try{for(const i of e.queue)yield i(t),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const t of n)try{t()}catch(r){}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null==i?void 0:i.message})}})()}}class xt{constructor(t,e,n){this.app=t,this.heartbeatServiceProvider=e,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new At(this),this.idTokenSubscription=new At(this),this.beforeStateQueue=new Et(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=d,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(t,e){var n=this;return e&&(this._popupRedirectResolver=S(e)),this._initializationPromise=this.queue((0,i.Z)(function*(){var i,r;if(!n._deleted&&(n.persistenceManager=yield ft.create(n,t),!n._deleted)){if(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch(s){}yield n.initializeCurrentUser(e),n.lastNotifiedUid=(null===(r=n.currentUser)||void 0===r?void 0:r.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return(0,i.Z)(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return(0,i.Z)(function*(){var n;const i=yield e.assertedPersistence.getCurrentUser();let r=i,s=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const i=null===(n=e.redirectUser)||void 0===n?void 0:n._redirectEventId,o=null==r?void 0:r._redirectEventId,a=yield e.tryRedirectSignIn(t);(!i||i===o)&&(null==a?void 0:a.user)&&(r=a.user,s=!0)}if(!r)return e.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield e.beforeStateQueue.runMiddleware(r)}catch(o){r=i,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(o))}return r?e.reloadAndSetCurrentUserOrClear(r):e.directlySetCurrentUser(null)}return w(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===r._redirectEventId?e.directlySetCurrentUser(r):e.reloadAndSetCurrentUserOrClear(r)})()}tryRedirectSignIn(t){var e=this;return(0,i.Z)(function*(){let n=null;try{n=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch(i){yield e._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(t){var e=this;return(0,i.Z)(function*(){try{yield it(t)}catch(n){if("auth/network-request-failed"!==(null==n?void 0:n.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}_delete(){var t=this;return(0,i.Z)(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return(0,i.Z)(function*(){const n=t?(0,s.m9)(t):null;return n&&w(n.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(n&&n._clone(e))})()}_updateCurrentUser(t,e=!1){var n=this;return(0,i.Z)(function*(){if(!n._deleted)return t&&w(n.tenantId===t.tenantId,n,"tenant-id-mismatch"),e||(yield n.beforeStateQueue.runMiddleware(t)),n.queue((0,i.Z)(function*(){yield n.directlySetCurrentUser(t),n.notifyAuthListeners()}))})()}signOut(){var t=this;return(0,i.Z)(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue((0,i.Z)(function*(){yield e.assertedPersistence.setPersistence(S(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new s.LL("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var n=this;return(0,i.Z)(function*(){const i=yield n.getOrInitRedirectPersistenceManager(e);return null===t?i.removeCurrentUser():i.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return(0,i.Z)(function*(){if(!e.redirectPersistenceManager){const n=t&&S(t)||e._popupRedirectResolver;w(n,e,"argument-error"),e.redirectPersistenceManager=yield ft.create(e,[S(n._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return(0,i.Z)(function*(){var n,r;return e._isInitialized&&(yield e.queue((0,i.Z)(function*(){}))),(null===(n=e._currentUser)||void 0===n?void 0:n._redirectEventId)===t?e._currentUser:(null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return(0,i.Z)(function*(){if(t===e.currentUser)return e.queue((0,i.Z)(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return w(s,this,"internal-error"),s.then(()=>r(this.currentUser)),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return(0,i.Z)(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return w(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Ct(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return(0,i.Z)(function*(){var e;const n={"X-Client-Version":t.clientVersion};t.app.options.appId&&(n["X-Firebase-gmpid"]=t.app.options.appId);const i=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return i&&(n["X-Firebase-Client"]=i),n})()}}function kt(t){return(0,s.m9)(t)}class At{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,s.ne)(t=>this.observer=t)}get next(){return w(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Pt(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Nt(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Dt{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return b("not implemented")}_getIdTokenResponse(t){return b("not implemented")}_linkToIdToken(t,e){return b("not implemented")}_getReauthenticationResolver(t){return b("not implemented")}}function Ot(t,e){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:resetPassword",O(t,e))})).apply(this,arguments)}function Lt(t,e){return Mt.apply(this,arguments)}function Mt(){return(Mt=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:update",e)})).apply(this,arguments)}function Ft(t,e){return Vt.apply(this,arguments)}function Vt(){return(Vt=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:update",O(t,e))})).apply(this,arguments)}function Ut(){return(Ut=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signInWithPassword",O(t,e))})).apply(this,arguments)}function jt(t,e){return qt.apply(this,arguments)}function qt(){return(qt=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:sendOobCode",O(t,e))})).apply(this,arguments)}function zt(t,e){return Bt.apply(this,arguments)}function Bt(){return(Bt=(0,i.Z)(function*(t,e){return jt(t,e)})).apply(this,arguments)}function Zt(t,e){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,i.Z)(function*(t,e){return jt(t,e)})).apply(this,arguments)}function $t(t,e){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,i.Z)(function*(t,e){return jt(t,e)})).apply(this,arguments)}function Gt(t,e){return Kt.apply(this,arguments)}function Kt(){return(Kt=(0,i.Z)(function*(t,e){return jt(t,e)})).apply(this,arguments)}function Qt(){return(Qt=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signInWithEmailLink",O(t,e))})).apply(this,arguments)}function Yt(){return(Yt=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signInWithEmailLink",O(t,e))})).apply(this,arguments)}class Jt extends Dt{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Jt(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Jt(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return(0,i.Z)(function*(){switch(e.signInMethod){case"password":return function(t,e){return Ut.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function(t,e){return Qt.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:m(t,"internal-error")}})()}_linkToIdToken(t,e){var n=this;return(0,i.Z)(function*(){switch(n.signInMethod){case"password":return Lt(t,{idToken:e,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function(t,e){return Yt.apply(this,arguments)}(t,{idToken:e,email:n._email,oobCode:n._password});default:m(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function Xt(t,e){return te.apply(this,arguments)}function te(){return(te=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signInWithIdp",O(t,e))})).apply(this,arguments)}class ee extends Dt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new ee(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):m("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=l(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new ee(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return Xt(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Xt(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Xt(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=(0,s.xO)(e)}return t}}function ne(t,e){return ie.apply(this,arguments)}function ie(){return(ie=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:sendVerificationCode",O(t,e))})).apply(this,arguments)}function re(){return(re=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signInWithPhoneNumber",O(t,e))})).apply(this,arguments)}function se(){return(se=(0,i.Z)(function*(t,e){const n=yield V(t,"POST","/v1/accounts:signInWithPhoneNumber",O(t,e));if(n.temporaryProof)throw z(t,"account-exists-with-different-credential",n);return n})).apply(this,arguments)}const oe={USER_NOT_FOUND:"user-not-found"};function ae(){return(ae=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signInWithPhoneNumber",O(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),oe)})).apply(this,arguments)}class le extends Dt{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new le({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new le({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return function(t,e){return re.apply(this,arguments)}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return function(t,e){return se.apply(this,arguments)}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return function(t,e){return ae.apply(this,arguments)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new le({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class ue{constructor(t){var e,n,i,r,o,a;const l=(0,s.zd)((0,s.pd)(t)),u=null!==(e=l.apiKey)&&void 0!==e?e:null,c=null!==(n=l.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=l.mode)&&void 0!==i?i:null);w(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=null!==(r=l.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(o=l.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=l.tenantId)&&void 0!==a?a:null}static parseLink(t){const e=function(t){const e=(0,s.zd)((0,s.pd)(t)).link,n=e?(0,s.zd)((0,s.pd)(e)).deep_link_id:null,i=(0,s.zd)((0,s.pd)(t)).deep_link_id;return(i?(0,s.zd)((0,s.pd)(i)).link:null)||i||n||e||t}(t);try{return new ue(e)}catch(n){return null}}}let ce=(()=>{class t{constructor(){this.providerId=t.PROVIDER_ID}static credential(t,e){return Jt._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=ue.parseLink(e);return w(n,"argument-error"),Jt._fromEmailAndCode(t,n.code,n.tenantId)}}return t.PROVIDER_ID="password",t.EMAIL_PASSWORD_SIGN_IN_METHOD="password",t.EMAIL_LINK_SIGN_IN_METHOD="emailLink",t})();class he{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class de extends he{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class pe extends de{static credentialFromJSON(t){const e="string"==typeof t?JSON.parse(t):t;return w("providerId"in e&&"signInMethod"in e,"argument-error"),ee._fromParams(e)}credential(t){return this._credential(Object.assign(Object.assign({},t),{nonce:t.rawNonce}))}_credential(t){return w(t.idToken||t.accessToken,"argument-error"),ee._fromParams(Object.assign(Object.assign({},t),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(t){return pe.oauthCredentialFromTaggedObject(t)}static credentialFromError(t){return pe.oauthCredentialFromTaggedObject(t.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:s,providerId:o}=t;if(!n&&!i&&!e&&!r||!o)return null;try{return new pe(o)._credential({idToken:e,accessToken:n,nonce:s,pendingToken:r})}catch(a){return null}}}let fe=(()=>{class t extends de{constructor(){super("facebook.com")}static credential(e){return ee._fromParams({providerId:t.PROVIDER_ID,signInMethod:t.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return t.credentialFromTaggedObject(e)}static credentialFromError(e){return t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return t.credential(e.oauthAccessToken)}catch(n){return null}}}return t.FACEBOOK_SIGN_IN_METHOD="facebook.com",t.PROVIDER_ID="facebook.com",t})(),me=(()=>{class t extends de{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ee._fromParams({providerId:t.PROVIDER_ID,signInMethod:t.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return t.credentialFromTaggedObject(e)}static credentialFromError(e){return t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return t.credential(n,i)}catch(r){return null}}}return t.GOOGLE_SIGN_IN_METHOD="google.com",t.PROVIDER_ID="google.com",t})(),ge=(()=>{class t extends de{constructor(){super("github.com")}static credential(e){return ee._fromParams({providerId:t.PROVIDER_ID,signInMethod:t.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return t.credentialFromTaggedObject(e)}static credentialFromError(e){return t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return t.credential(e.oauthAccessToken)}catch(n){return null}}}return t.GITHUB_SIGN_IN_METHOD="github.com",t.PROVIDER_ID="github.com",t})();class ye extends Dt{constructor(t,e){super(t,t),this.pendingToken=e}_getIdTokenResponse(t){return Xt(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Xt(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Xt(t,e)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i,pendingToken:r}=e;return n&&i&&r&&n===i?new ye(n,r):null}static _create(t,e){return new ye(t,e)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class _e extends he{constructor(t){w(t.startsWith("saml."),"argument-error"),super(t)}static credentialFromResult(t){return _e.samlCredentialFromTaggedObject(t)}static credentialFromError(t){return _e.samlCredentialFromTaggedObject(t.customData||{})}static credentialFromJSON(t){const e=ye.fromJSON(t);return w(e,"argument-error"),e}static samlCredentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{pendingToken:e,providerId:n}=t;if(!e||!n)return null;try{return ye._create(n,e)}catch(i){return null}}}let ve=(()=>{class t extends de{constructor(){super("twitter.com")}static credential(e,n){return ee._fromParams({providerId:t.PROVIDER_ID,signInMethod:t.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return t.credentialFromTaggedObject(e)}static credentialFromError(e){return t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return t.credential(n,i)}catch(r){return null}}}return t.TWITTER_SIGN_IN_METHOD="twitter.com",t.PROVIDER_ID="twitter.com",t})();function we(t,e){return be.apply(this,arguments)}function be(){return(be=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signUp",O(t,e))})).apply(this,arguments)}class Te{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,n,r=!1){return(0,i.Z)(function*(){const i=yield ht._fromIdTokenResponse(t,n,r),s=Ie(n);return new Te({user:i,providerId:s,_tokenResponse:n,operationType:e})})()}static _forOperation(t,e,n){return(0,i.Z)(function*(){yield t._updateTokensIfNecessary(n,!0);const i=Ie(n);return new Te({user:t,providerId:i,_tokenResponse:n,operationType:e})})()}}function Ie(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}function Se(){return(Se=(0,i.Z)(function*(t){var e;const n=kt(t);if(yield n._initializationPromise,null===(e=n.currentUser)||void 0===e?void 0:e.isAnonymous)return new Te({user:n.currentUser,providerId:null,operationType:"signIn"});const i=yield we(n,{returnSecureToken:!0}),r=yield Te._fromIdTokenResponse(n,"signIn",i,!0);return yield n._updateCurrentUser(r.user),r})).apply(this,arguments)}class Ce extends s.ZR{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Ce.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Ce(t,e,n,i)}}function Ee(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(n=>{throw"auth/multi-factor-auth-required"===n.code?Ce._fromErrorAndOperation(t,n,e,i):n})}function xe(t){return new Set(t.map(({providerId:t})=>t).filter(t=>!!t))}function ke(){return(ke=(0,i.Z)(function*(t,e){const n=(0,s.m9)(t);yield Ne(!0,n,e);const{providerUserInfo:i}=yield Z(n.auth,{idToken:yield n.getIdToken(),deleteProvider:[e]}),r=xe(i||[]);return n.providerData=n.providerData.filter(t=>r.has(t.providerId)),r.has("phone")||(n.phoneNumber=null),yield n.auth._persistUserIfCurrent(n),n})).apply(this,arguments)}function Ae(t,e){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,i.Z)(function*(t,e,n=!1){const i=yield J(t,e._linkToIdToken(t.auth,yield t.getIdToken()),n);return Te._forOperation(t,"link",i)})).apply(this,arguments)}function Ne(t,e,n){return De.apply(this,arguments)}function De(){return(De=(0,i.Z)(function*(t,e,n){yield it(e);const i=!1===t?"provider-already-linked":"no-such-provider";w(xe(e.providerData).has(n)===t,e.auth,i)})).apply(this,arguments)}function Oe(t,e){return Re.apply(this,arguments)}function Re(){return(Re=(0,i.Z)(function*(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=yield J(t,Ee(i,r,e,t),n);w(s.idToken,i,"internal-error");const o=Y(s.idToken);w(o,i,"internal-error");const{sub:a}=o;return w(t.uid===a,i,"user-mismatch"),Te._forOperation(t,r,s)}catch(s){throw"auth/user-not-found"===(null==s?void 0:s.code)&&m(i,"user-mismatch"),s}})).apply(this,arguments)}function Le(t,e){return Me.apply(this,arguments)}function Me(){return(Me=(0,i.Z)(function*(t,e,n=!1){const i="signIn",r=yield Ee(t,i,e),s=yield Te._fromIdTokenResponse(t,i,r);return n||(yield t._updateCurrentUser(s.user)),s})).apply(this,arguments)}function Fe(t,e){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,i.Z)(function*(t,e){return Le(kt(t),e)})).apply(this,arguments)}function Ue(t,e){return je.apply(this,arguments)}function je(){return(je=(0,i.Z)(function*(t,e){const n=(0,s.m9)(t);return yield Ne(!1,n,e.providerId),Ae(n,e)})).apply(this,arguments)}function qe(t,e){return ze.apply(this,arguments)}function ze(){return(ze=(0,i.Z)(function*(t,e){return Oe((0,s.m9)(t),e)})).apply(this,arguments)}function Be(t,e){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,i.Z)(function*(t,e){return V(t,"POST","/v1/accounts:signInWithCustomToken",O(t,e))})).apply(this,arguments)}function He(){return(He=(0,i.Z)(function*(t,e){const n=kt(t),i=yield Be(n,{token:e,returnSecureToken:!0}),r=yield Te._fromIdTokenResponse(n,"signIn",i);return yield n._updateCurrentUser(r.user),r})).apply(this,arguments)}class $e{constructor(t,e){this.factorId=t,this.uid=e.mfaEnrollmentId,this.enrollmentTime=new Date(e.enrolledAt).toUTCString(),this.displayName=e.displayName}static _fromServerResponse(t,e){return"phoneInfo"in e?We._fromServerResponse(t,e):m(t,"internal-error")}}class We extends $e{constructor(t){super("phone",t),this.phoneNumber=t.phoneInfo}static _fromServerResponse(t,e){return new We(e)}}function Ge(t,e,n){var i;w((null===(i=n.url)||void 0===i?void 0:i.length)>0,t,"invalid-continue-uri"),w(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(w(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(w(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}function Ke(){return(Ke=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t),r={requestType:"PASSWORD_RESET",email:e};n&&Ge(i,r,n),yield Zt(i,r)})).apply(this,arguments)}function Qe(){return(Qe=(0,i.Z)(function*(t,e,n){yield Ot((0,s.m9)(t),{oobCode:e,newPassword:n})})).apply(this,arguments)}function Ye(){return(Ye=(0,i.Z)(function*(t,e){yield Ft((0,s.m9)(t),{oobCode:e})})).apply(this,arguments)}function Je(t,e){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,i.Z)(function*(t,e){const n=(0,s.m9)(t),i=yield Ot(n,{oobCode:e}),r=i.requestType;switch(w(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":w(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":w(i.mfaInfo,n,"internal-error");default:w(i.email,n,"internal-error")}let o=null;return i.mfaInfo&&(o=$e._fromServerResponse(kt(n),i.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:r}})).apply(this,arguments)}function tn(){return(tn=(0,i.Z)(function*(t,e){const{data:n}=yield Je((0,s.m9)(t),e);return n.email})).apply(this,arguments)}function en(){return(en=(0,i.Z)(function*(t,e,n){const i=kt(t),r=yield we(i,{returnSecureToken:!0,email:e,password:n}),s=yield Te._fromIdTokenResponse(i,"signIn",r);return yield i._updateCurrentUser(s.user),s})).apply(this,arguments)}function nn(){return(nn=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t),r={requestType:"EMAIL_SIGNIN",email:e};w(n.handleCodeInApp,i,"argument-error"),n&&Ge(i,r,n),yield $t(i,r)})).apply(this,arguments)}function rn(){return(rn=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t),r=ce.credentialWithLink(e,n||C());return w(r._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),Fe(i,r)})).apply(this,arguments)}function sn(t,e){return on.apply(this,arguments)}function on(){return(on=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:createAuthUri",O(t,e))})).apply(this,arguments)}function an(){return(an=(0,i.Z)(function*(t,e){const n={identifier:e,continueUri:E()?C():"http://localhost"},{signinMethods:i}=yield sn((0,s.m9)(t),n);return i||[]})).apply(this,arguments)}function ln(){return(ln=(0,i.Z)(function*(t,e){const n=(0,s.m9)(t),i={requestType:"VERIFY_EMAIL",idToken:yield t.getIdToken()};e&&Ge(n.auth,i,e);const{email:r}=yield zt(n.auth,i);r!==t.email&&(yield t.reload())})).apply(this,arguments)}function un(){return(un=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t),r={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield t.getIdToken(),newEmail:e};n&&Ge(i.auth,r,n);const{email:o}=yield Gt(i.auth,r);o!==t.email&&(yield t.reload())})).apply(this,arguments)}function cn(t,e){return hn.apply(this,arguments)}function hn(){return(hn=(0,i.Z)(function*(t,e){return R(t,"POST","/v1/accounts:update",e)})).apply(this,arguments)}function dn(){return(dn=(0,i.Z)(function*(t,{displayName:e,photoURL:n}){if(void 0===e&&void 0===n)return;const i=(0,s.m9)(t),r={idToken:yield i.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=yield J(i,cn(i.auth,r));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find(({providerId:t})=>"password"===t);a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),yield i._updateTokensIfNecessary(o)})).apply(this,arguments)}function pn(t,e,n){return fn.apply(this,arguments)}function fn(){return(fn=(0,i.Z)(function*(t,e,n){const{auth:i}=t,r={idToken:yield t.getIdToken(),returnSecureToken:!0};e&&(r.email=e),n&&(r.password=n);const s=yield J(t,Lt(i,r));yield t._updateTokensIfNecessary(s,!0)})).apply(this,arguments)}class mn{constructor(t,e,n={}){this.isNewUser=t,this.providerId=e,this.profile=n}}class gn extends mn{constructor(t,e,n,i){super(t,e,n),this.username=i}}class yn extends mn{constructor(t,e){super(t,"facebook.com",e)}}class _n extends gn{constructor(t,e){super(t,"github.com",e,"string"==typeof(null==e?void 0:e.login)?null==e?void 0:e.login:null)}}class vn extends mn{constructor(t,e){super(t,"google.com",e)}}class wn extends gn{constructor(t,e,n){super(t,"twitter.com",e,n)}}function bn(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(t){var e,n;if(!t)return null;const{providerId:i}=t,r=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||"identitytoolkit#SignupNewUserResponse"===t.kind;if(!i&&(null==t?void 0:t.idToken)){const i=null===(n=null===(e=Y(t.idToken))||void 0===e?void 0:e.firebase)||void 0===n?void 0:n.sign_in_provider;if(i)return new mn(s,"anonymous"!==i&&"custom"!==i?i:null)}if(!i)return null;switch(i){case"facebook.com":return new yn(s,r);case"github.com":return new _n(s,r);case"google.com":return new vn(s,r);case"twitter.com":return new wn(s,r,t.screenName||null);case"custom":case"anonymous":return new mn(s,null);default:return new mn(s,i,r)}}(n)}class Tn{constructor(t,e,n){this.type=t,this.credential=e,this.auth=n}static _fromIdtoken(t,e){return new Tn("enroll",t,e)}static _fromMfaPendingCredential(t){return new Tn("signin",t)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(t){var e,n;if(null==t?void 0:t.multiFactorSession){if(null===(e=t.multiFactorSession)||void 0===e?void 0:e.pendingCredential)return Tn._fromMfaPendingCredential(t.multiFactorSession.pendingCredential);if(null===(n=t.multiFactorSession)||void 0===n?void 0:n.idToken)return Tn._fromIdtoken(t.multiFactorSession.idToken)}return null}}class In{constructor(t,e,n){this.session=t,this.hints=e,this.signInResolver=n}static _fromError(t,e){const n=kt(t),r=e.customData._serverResponse,s=(r.mfaInfo||[]).map(t=>$e._fromServerResponse(n,t));w(r.mfaPendingCredential,n,"internal-error");const o=Tn._fromMfaPendingCredential(r.mfaPendingCredential);return new In(o,s,function(){var t=(0,i.Z)(function*(t){const i=yield t._process(n,o);delete r.mfaInfo,delete r.mfaPendingCredential;const s=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(e.operationType){case"signIn":const t=yield Te._fromIdTokenResponse(n,e.operationType,s);return yield n._updateCurrentUser(t.user),t;case"reauthenticate":return w(e.user,n,"internal-error"),Te._forOperation(e.user,e.operationType,s);default:m(n,"internal-error")}});return function(e){return t.apply(this,arguments)}}())}resolveSignIn(t){var e=this;return(0,i.Z)(function*(){return e.signInResolver(t)})()}}function Sn(t,e){return R(t,"POST","/v2/accounts/mfaEnrollment:start",O(t,e))}class Cn{constructor(t){this.user=t,this.enrolledFactors=[],t._onReload(e=>{e.mfaInfo&&(this.enrolledFactors=e.mfaInfo.map(e=>$e._fromServerResponse(t.auth,e)))})}static _fromUser(t){return new Cn(t)}getSession(){var t=this;return(0,i.Z)(function*(){return Tn._fromIdtoken(yield t.user.getIdToken(),t.user.auth)})()}enroll(t,e){var n=this;return(0,i.Z)(function*(){const i=t,r=yield n.getSession(),s=yield J(n.user,i._process(n.user.auth,r,e));return yield n.user._updateTokensIfNecessary(s),n.user.reload()})()}unenroll(t){var e=this;return(0,i.Z)(function*(){const n="string"==typeof t?t:t.uid,i=yield e.user.getIdToken(),r=yield J(e.user,function(t,e){return R(t,"POST","/v2/accounts/mfaEnrollment:withdraw",O(t,e))}(e.user.auth,{idToken:i,mfaEnrollmentId:n}));e.enrolledFactors=e.enrolledFactors.filter(({uid:t})=>t!==n),yield e.user._updateTokensIfNecessary(r);try{yield e.user.reload()}catch(s){if("auth/user-token-expired"!==(null==s?void 0:s.code))throw s}})()}}const En=new WeakMap,xn="__sak";class kn{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(xn,"1"),this.storage.removeItem(xn),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const An=(()=>{class t extends kn{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=(0,s.z$)();return yt(t)||It(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=St(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys((t,e,n)=>{this.notifyListeners(t,n)});const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);!e&&this.localCache[n]===t||this.notifyListeners(n,t)},r=this.storage.getItem(n);(0,s.w1)()&&10===document.documentMode&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,e){var n=()=>super._set,r=this;return(0,i.Z)(function*(){yield n().call(r,t,e),r.localCache[t]=JSON.stringify(e)})()}_get(t){var e=()=>super._get,n=this;return(0,i.Z)(function*(){const i=yield e().call(n,t);return n.localCache[t]=JSON.stringify(i),i})()}_remove(t){var e=()=>super._remove,n=this;return(0,i.Z)(function*(){yield e().call(n,t),delete n.localCache[t]})()}}return t.type="LOCAL",t})(),Pn=(()=>{class t extends kn{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}return t.type="SESSION",t})();let Nn=(()=>{class t{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(t=>t.isListeningto(e));if(n)return n;const i=new t(e);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var e=this;return(0,i.Z)(function*(){const n=t,{eventId:r,eventType:s,data:o}=n.data,a=e.handlersMap[s];if(!(null==a?void 0:a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(function(){var t=(0,i.Z)(function*(t){return t(n.origin,o)});return function(e){return t.apply(this,arguments)}}()),u=yield function(t){return Promise.all(t.map(function(){var t=(0,i.Z)(function*(t){try{return{fulfilled:!0,value:yield t}}catch(e){return{fulfilled:!1,reason:e}}});return function(e){return t.apply(this,arguments)}}()))}(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})})()}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return t.receivers=[],t})();function Dn(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(10*Math.random());return t+n}class On{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,n=50){var r=this;return(0,i.Z)(function*(){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=Dn("",20);i.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===u)switch(e.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(e.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"))}}},r.handlers.add(o),i.port1.addEventListener("message",o.onMessage),r.target.postMessage({eventType:t,eventId:u,data:e},[i.port2])}).finally(()=>{o&&r.removeMessageHandler(o)})})()}}function Rn(){return window}function Ln(){return void 0!==Rn().WorkerGlobalScope&&"function"==typeof Rn().importScripts}function Mn(){return(Mn=(0,i.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(fr){return null}})).apply(this,arguments)}const Fn="firebaseLocalStorageDb",Vn="firebaseLocalStorage",Un="fbase_key";class jn{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function qn(t,e){return t.transaction([Vn],e?"readwrite":"readonly").objectStore(Vn)}function zn(){const t=indexedDB.open(Fn,1);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const e=t.result;try{e.createObjectStore(Vn,{keyPath:Un})}catch(i){n(i)}}),t.addEventListener("success",(0,i.Z)(function*(){const n=t.result;n.objectStoreNames.contains(Vn)?e(n):(n.close(),yield function(){const t=indexedDB.deleteDatabase(Fn);return new jn(t).toPromise()}(),e(yield zn()))}))})}function Bn(t,e,n){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,i.Z)(function*(t,e,n){const i=qn(t,!0).put({[Un]:e,value:n});return new jn(i).toPromise()})).apply(this,arguments)}function Hn(){return(Hn=(0,i.Z)(function*(t,e){const n=qn(t,!1).get(e),i=yield new jn(n).toPromise();return void 0===i?null:i.value})).apply(this,arguments)}function $n(t,e){const n=qn(t,!0).delete(e);return new jn(n).toPromise()}const Wn=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return(0,i.Z)(function*(){return t.db||(t.db=yield zn()),t.db})()}_withRetries(t){var e=this;return(0,i.Z)(function*(){let n=0;for(;;)try{const n=yield e._openDb();return yield t(n)}catch(i){if(n++>3)throw i;e.db&&(e.db.close(),e.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return(0,i.Z)(function*(){return Ln()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return(0,i.Z)(function*(){t.receiver=Nn._getInstance(Ln()?self:null),t.receiver._subscribe("keyChanged",function(){var e=(0,i.Z)(function*(e,n){return{keyProcessed:(yield t._poll()).includes(n.key)}});return function(t,n){return e.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var t=(0,i.Z)(function*(t,e){return["keyChanged"]});return function(e,n){return t.apply(this,arguments)}}())})()}initializeSender(){var t=this;return(0,i.Z)(function*(){var e,n;if(t.activeServiceWorker=yield function(){return Mn.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new On(t.activeServiceWorker);const i=yield t.sender._send("ping",{},800);!i||(null===(e=i[0])||void 0===e?void 0:e.fulfilled)&&(null===(n=i[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var e=this;return(0,i.Z)(function*(){if(e.sender&&e.activeServiceWorker&&function(){var t;return(null===(t=null==navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===e.activeServiceWorker)try{yield e.sender._send("keyChanged",{key:t},e.serviceWorkerReceiverAvailable?800:50)}catch(n){}})()}_isAvailable(){return(0,i.Z)(function*(){try{if(!indexedDB)return!1;const t=yield zn();return yield Bn(t,xn,"1"),yield $n(t,xn),!0}catch(t){}return!1})()}_withPendingWrite(t){var e=this;return(0,i.Z)(function*(){e.pendingWrites++;try{yield t()}finally{e.pendingWrites--}})()}_set(t,e){var n=this;return(0,i.Z)(function*(){return n._withPendingWrite((0,i.Z)(function*(){return yield n._withRetries(n=>Bn(n,t,e)),n.localCache[t]=e,n.notifyServiceWorker(t)}))})()}_get(t){var e=this;return(0,i.Z)(function*(){const n=yield e._withRetries(e=>function(t,e){return Hn.apply(this,arguments)}(e,t));return e.localCache[t]=n,n})()}_remove(t){var e=this;return(0,i.Z)(function*(){return e._withPendingWrite((0,i.Z)(function*(){return yield e._withRetries(e=>$n(e,t)),delete e.localCache[t],e.notifyServiceWorker(t)}))})()}_poll(){var t=this;return(0,i.Z)(function*(){const e=yield t._withRetries(t=>{const e=qn(t,!1).getAll();return new jn(e).toPromise()});if(!e)return[];if(0!==t.pendingWrites)return[];const n=[],i=new Set;for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(t.localCache[r])!==JSON.stringify(s)&&(t.notifyListeners(r,s),n.push(r));for(const r of Object.keys(t.localCache))t.localCache[r]&&!i.has(r)&&(t.notifyListeners(r,null),n.push(r));return n})()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval((0,i.Z)(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return t.type="LOCAL",t})();function Gn(t,e){return R(t,"POST","/v2/accounts/mfaSignIn:start",O(t,e))}function Kn(){return(Kn=(0,i.Z)(function*(t){return(yield R(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Qn(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=g("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(i)})}function Yn(t){return`__${t}${Math.floor(1e6*Math.random())}`}const Jn=1e12;class Xn{constructor(t){this.auth=t,this.counter=Jn,this._widgets=new Map}render(t,e){const n=this.counter;return this._widgets.set(n,new ti(t,this.auth.name,e||{})),this.counter++,n}reset(t){var e;const n=t||Jn;null===(e=this._widgets.get(n))||void 0===e||e.delete(),this._widgets.delete(n)}getResponse(t){var e;return(null===(e=this._widgets.get(t||Jn))||void 0===e?void 0:e.getResponse())||""}execute(t){var e=this;return(0,i.Z)(function*(){var n;return null===(n=e._widgets.get(t||Jn))||void 0===n||n.execute(),""})()}}class ti{constructor(t,e,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i="string"==typeof t?document.getElementById(t):t;w(i,"argument-error",{appName:e}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<50;i++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}();const{callback:t,"expired-callback":e}=this.params;if(t)try{t(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,e)try{e()}catch(n){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const ei=Yn("rcb"),ni=new k(3e4,6e4);class ii{constructor(){var t;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(t=Rn().grecaptcha)||void 0===t?void 0:t.render)}load(t,e=""){return w((n=e).length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n),t,"argument-error"),this.shouldResolveImmediately(e)?Promise.resolve(Rn().grecaptcha):new Promise((n,i)=>{const r=Rn().setTimeout(()=>{i(g(t,"network-request-failed"))},ni.get());Rn()[ei]=()=>{Rn().clearTimeout(r),delete Rn()[ei];const s=Rn().grecaptcha;if(!s)return void i(g(t,"internal-error"));const o=s.render;s.render=(t,e)=>{const n=o(t,e);return this.counter++,n},this.hostLanguage=e,n(s)},Qn(`https://www.google.com/recaptcha/api.js??${(0,s.xO)({onload:ei,render:"explicit",hl:e})}`).catch(()=>{clearTimeout(r),i(g(t,"internal-error"))})});var n}clearedOneInstance(){this.counter--}shouldResolveImmediately(t){var e;return!!(null===(e=Rn().grecaptcha)||void 0===e?void 0:e.render)&&(t===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ri{load(t){return(0,i.Z)(function*(){return new Xn(t)})()}clearedOneInstance(){}}const si="recaptcha",oi={theme:"light",type:"image"};class ai{constructor(t,e=Object.assign({},oi),n){this.parameters=e,this.type=si,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=kt(n),this.isInvisible="invisible"===this.parameters.size,w("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof t?document.getElementById(t):t;w(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ri:new ii,this.validateStartingState()}verify(){var t=this;return(0,i.Z)(function*(){t.assertNotDestroyed();const e=yield t.render(),n=t.getAssertedRecaptcha();return n.getResponse(e)||new Promise(i=>{const r=e=>{!e||(t.tokenChangeListeners.delete(r),i(e))};t.tokenChangeListeners.add(r),t.isInvisible&&n.execute(e)})})()}render(){try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(t=>{throw this.renderPromise=null,t})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(t=>{this.container.removeChild(t)})}validateStartingState(){w(!this.parameters.sitekey,this.auth,"argument-error"),w(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),w("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(t){return e=>{if(this.tokenChangeListeners.forEach(t=>t(e)),"function"==typeof t)t(e);else if("string"==typeof t){const n=Rn()[t];"function"==typeof n&&n(e)}}}assertNotDestroyed(){w(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var t=this;return(0,i.Z)(function*(){if(yield t.init(),!t.widgetId){let e=t.container;if(!t.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}t.widgetId=t.getAssertedRecaptcha().render(e,t.parameters)}return t.widgetId})()}init(){var t=this;return(0,i.Z)(function*(){w(E()&&!Ln(),t.auth,"internal-error"),yield function(){let t=null;return new Promise(e=>{"complete"!==document.readyState?(t=()=>e(),window.addEventListener("load",t)):e()}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}(),t.recaptcha=yield t._recaptchaLoader.load(t.auth,t.auth.languageCode||void 0);const e=yield function(t){return Kn.apply(this,arguments)}(t.auth);w(e,t.auth,"internal-error"),t.parameters.sitekey=e})()}getAssertedRecaptcha(){return w(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class li{constructor(t,e){this.verificationId=t,this.onConfirmation=e}confirm(t){const e=le._fromVerification(this.verificationId,t);return this.onConfirmation(e)}}function ui(){return(ui=(0,i.Z)(function*(t,e,n){const i=kt(t),r=yield di(i,e,(0,s.m9)(n));return new li(r,t=>Fe(i,t))})).apply(this,arguments)}function ci(){return(ci=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t);yield Ne(!1,i,"phone");const r=yield di(i.auth,e,(0,s.m9)(n));return new li(r,t=>Ue(i,t))})).apply(this,arguments)}function hi(){return(hi=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t),r=yield di(i.auth,e,(0,s.m9)(n));return new li(r,t=>qe(i,t))})).apply(this,arguments)}function di(t,e,n){return pi.apply(this,arguments)}function pi(){return(pi=(0,i.Z)(function*(t,e,n){var i;const r=yield n.verify();try{let s;if(w("string"==typeof r,t,"argument-error"),w(n.type===si,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s)return w("enroll"===e.type,t,"internal-error"),(yield Sn(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{w("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;return w(n,t,"missing-multi-factor-info"),(yield Gn(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=yield ne(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}})).apply(this,arguments)}function fi(){return(fi=(0,i.Z)(function*(t,e){yield Ae((0,s.m9)(t),e)})).apply(this,arguments)}let mi=(()=>{class t{constructor(e){this.providerId=t.PROVIDER_ID,this.auth=kt(e)}verifyPhoneNumber(t,e){return di(this.auth,t,(0,s.m9)(e))}static credential(t,e){return le._fromVerification(t,e)}static credentialFromResult(e){return t.credentialFromTaggedObject(e)}static credentialFromError(e){return t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?le._fromTokenResponse(e,n):null}}return t.PROVIDER_ID="phone",t.PHONE_SIGN_IN_METHOD="phone",t})();function gi(t,e){return e?S(e):(w(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class yi extends Dt{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Xt(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Xt(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Xt(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function _i(t){return Le(t.auth,new yi(t),t.bypassAuthState)}function vi(t){const{auth:e,user:n}=t;return w(n,e,"internal-error"),Oe(n,new yi(t),t.bypassAuthState)}function wi(t){return bi.apply(this,arguments)}function bi(){return(bi=(0,i.Z)(function*(t){const{auth:e,user:n}=t;return w(n,e,"internal-error"),Ae(n,new yi(t),t.bypassAuthState)})).apply(this,arguments)}class Ti{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=(0,i.Z)(function*(e,n){t.pendingPromise={resolve:e,reject:n};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(t,n){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return(0,i.Z)(function*(){const{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=t;if(o)return void e.reject(o);const l={auth:e.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(a)(l))}catch(u){e.reject(u)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return _i;case"linkViaPopup":case"linkViaRedirect":return wi;case"reauthViaPopup":case"reauthViaRedirect":return vi;default:m(this.auth,"internal-error")}}resolve(t){T(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){T(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ii=new k(2e3,1e4);function Si(){return(Si=(0,i.Z)(function*(t,e,n){const i=kt(t);_(t,e,he);const r=gi(i,n);return new xi(i,"signInViaPopup",e,r).executeNotNull()})).apply(this,arguments)}function Ci(){return(Ci=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t);_(i.auth,e,he);const r=gi(i.auth,n);return new xi(i.auth,"reauthViaPopup",e,r,i).executeNotNull()})).apply(this,arguments)}function Ei(){return(Ei=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t);_(i.auth,e,he);const r=gi(i.auth,n);return new xi(i.auth,"linkViaPopup",e,r,i).executeNotNull()})).apply(this,arguments)}let xi=(()=>{class t extends Ti{constructor(e,n,i,r,s){super(e,n,r,s),this.provider=i,this.authWindow=null,this.pollId=null,t.currentPopupAction&&t.currentPopupAction.cancel(),t.currentPopupAction=this}executeNotNull(){var t=this;return(0,i.Z)(function*(){const e=yield t.execute();return w(e,t.auth,"internal-error"),e})()}onExecution(){var t=this;return(0,i.Z)(function*(){T(1===t.filter.length,"Popup operations only handle one event");const e=Dn();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],e),t.authWindow.associatedEvent=e,t.resolver._originValidation(t.auth).catch(e=>{t.reject(e)}),t.resolver._isIframeWebStorageSupported(t.auth,e=>{e||t.reject(g(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(g(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,t.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;this.pollId=(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(g(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,Ii.get())};t()}}return t.currentPopupAction=null,t})();const ki=new Map;class Ai extends Ti{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}execute(){var t=()=>super.execute,e=this;return(0,i.Z)(function*(){let n=ki.get(e.auth._key());if(!n){try{const i=(yield function(t,e){return Pi.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;n=()=>Promise.resolve(i)}catch(i){n=()=>Promise.reject(i)}ki.set(e.auth._key(),n)}return e.bypassAuthState||ki.set(e.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,n=this;return(0,i.Z)(function*(){if("signInViaRedirect"===t.type)return e().call(n,t);if("unknown"!==t.type){if(t.eventId){const i=yield n.auth._redirectUserForId(t.eventId);if(i)return n.user=i,e().call(n,t);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return(0,i.Z)(function*(){})()}cleanUp(){}}function Pi(){return(Pi=(0,i.Z)(function*(t,e){const n=Li(e),i=Ri(t);if(!(yield i._isAvailable()))return!1;const r="true"===(yield i._get(n));return yield i._remove(n),r})).apply(this,arguments)}function Ni(t,e){return Di.apply(this,arguments)}function Di(){return(Di=(0,i.Z)(function*(t,e){return Ri(t)._set(Li(e),"true")})).apply(this,arguments)}function Oi(t,e){ki.set(t._key(),e)}function Ri(t){return S(t._redirectPersistence)}function Li(t){return pt("pendingRedirect",t.config.apiKey,t.name)}function Mi(){return(Mi=(0,i.Z)(function*(t,e,n){const i=kt(t);_(t,e,he);const r=gi(i,n);return yield Ni(r,i),r._openRedirect(i,e,"signInViaRedirect")})).apply(this,arguments)}function Fi(){return(Fi=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t);_(i.auth,e,he);const r=gi(i.auth,n);yield Ni(r,i.auth);const o=yield zi(i);return r._openRedirect(i.auth,e,"reauthViaRedirect",o)})).apply(this,arguments)}function Vi(){return(Vi=(0,i.Z)(function*(t,e,n){const i=(0,s.m9)(t);_(i.auth,e,he);const r=gi(i.auth,n);yield Ne(!1,i,e.providerId),yield Ni(r,i.auth);const o=yield zi(i);return r._openRedirect(i.auth,e,"linkViaRedirect",o)})).apply(this,arguments)}function Ui(){return(Ui=(0,i.Z)(function*(t,e){return yield kt(t)._initializationPromise,ji(t,e,!1)})).apply(this,arguments)}function ji(t,e){return qi.apply(this,arguments)}function qi(){return(qi=(0,i.Z)(function*(t,e,n=!1){const i=kt(t),r=gi(i,e),s=yield new Ai(i,r,n).execute();return s&&!n&&(delete s.user._redirectEventId,yield i._persistUserIfCurrent(s.user),yield i._setRedirectUser(null,e)),s})).apply(this,arguments)}function zi(t){return Bi.apply(this,arguments)}function Bi(){return(Bi=(0,i.Z)(function*(t){const e=Dn(`${t.uid}:::`);return t._redirectEventId=e,yield t.auth._setRedirectUser(t),yield t.auth._persistUserIfCurrent(t),e})).apply(this,arguments)}class Zi{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $i(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!$i(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(g(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hi(t))}saveEventToCache(t){this.cachedEventUids.add(Hi(t)),this.lastProcessedEventTime=Date.now()}}function Hi(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(t=>t).join("-")}function $i({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}function Wi(t){return Gi.apply(this,arguments)}function Gi(){return(Gi=(0,i.Z)(function*(t,e={}){return R(t,"GET","/v1/projects",e)})).apply(this,arguments)}const Ki=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qi=/^https?/;function Yi(){return(Yi=(0,i.Z)(function*(t){if(t.config.emulator)return;const{authorizedDomains:e}=yield Wi(t);for(const i of e)try{if(Ji(i))return}catch(n){}m(t,"unauthorized-domain")})).apply(this,arguments)}function Ji(t){const e=C(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Qi.test(n))return!1;if(Ki.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Xi=new k(3e4,6e4);function tr(){const t=Rn().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}let er=null;function nr(t){return er=er||function(t){return new Promise((e,n)=>{var i,r,s;function o(){tr(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tr(),n(g(t,"network-request-failed"))},timeout:Xi.get()})}if(null===(r=null===(i=Rn().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Rn().gapi)||void 0===s?void 0:s.load)){const e=Yn("iframefcb");return Rn()[e]=()=>{gapi.load?o():n(g(t,"network-request-failed"))},Qn(`https://apis.google.com/js/api.js?onload=${e}`).catch(t=>n(t))}o()}}).catch(t=>{throw er=null,t})}(t),er}const ir=new k(5e3,15e3),rr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function or(t){const e=t.config;w(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?A(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:o.SDK_VERSION},r=sr.get(t.config.apiHost);r&&(i.eid=r);const a=t._getFrameworks();return a.length&&(i.fw=a.join(",")),`${n}?${(0,s.xO)(i).slice(1)}`}function ar(){return ar=(0,i.Z)(function*(t){const e=yield nr(t),n=Rn().gapi;return w(n,t,"internal-error"),e.open({where:document.body,url:or(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rr,dontclear:!0},e=>new Promise(function(){var n=(0,i.Z)(function*(n,i){yield e.restyle({setHideOnLeave:!1});const r=g(t,"network-request-failed"),s=Rn().setTimeout(()=>{i(r)},ir.get());function o(){Rn().clearTimeout(s),n(e)}e.ping(o).then(o,()=>{i(r)})});return function(t,e){return n.apply(this,arguments)}}()))}),ar.apply(this,arguments)}const lr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ur{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function cr(t,e,n,i,r,a){w(t.config.authDomain,t,"auth-domain-config-required"),w(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:o.SDK_VERSION,eventId:r};if(e instanceof he){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",(0,s.xb)(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(a||{}))l[t]=e}if(e instanceof de){const t=e.getScopes().filter(t=>""!==t);t.length>0&&(l.scopes=t.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const s of Object.keys(u))void 0===u[s]&&delete u[s];return`${function({config:t}){return t.emulator?A(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${(0,s.xO)(u).slice(1)}`}const hr="webStorageSupport";class dr extends class{constructor(t){this.factorId=t}_process(t,e,n){switch(e.type){case"enroll":return this._finalizeEnroll(t,e.credential,n);case"signin":return this._finalizeSignIn(t,e.credential);default:return b("unexpected MultiFactorSessionType")}}}{constructor(t){super("phone"),this.credential=t}static _fromCredential(t){return new dr(t)}_finalizeEnroll(t,e,n){return function(t,e){return R(t,"POST","/v2/accounts/mfaEnrollment:finalize",O(t,e))}(t,{idToken:e,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(t,e){return function(t,e){return R(t,"POST","/v2/accounts/mfaSignIn:finalize",O(t,e))}(t,{mfaPendingCredential:e,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let pr=(()=>{class t{constructor(){}static assertion(t){return dr._fromCredential(t)}}return t.FACTOR_ID="phone",t})();var fr,mr="@firebase/auth";class gr{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return(0,i.Z)(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){w(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function yr(){return window}function _r(){return _r=(0,i.Z)(function*(t,e,n){var i;const{BuildInfo:r}=yr();T(e.sessionId,"AuthEvent did not contain a session ID");const s=yield br(e.sessionId),o={};return It()?o.ibi=r.packageName:wt()?o.apn=r.packageName:m(t,"operation-not-supported-in-this-environment"),r.displayName&&(o.appDisplayName=r.displayName),o.sessionId=s,cr(t,n,e.type,void 0,null!==(i=e.eventId)&&void 0!==i?i:void 0,o)}),_r.apply(this,arguments)}function vr(){return vr=(0,i.Z)(function*(t){const{BuildInfo:e}=yr(),n={};It()?n.iosBundleId=e.packageName:wt()?n.androidPackageName=e.packageName:m(t,"operation-not-supported-in-this-environment"),yield Wi(t,n)}),vr.apply(this,arguments)}function wr(){return wr=(0,i.Z)(function*(t,e,n){const{cordova:i}=yr();let r=()=>{};try{yield new Promise((s,o)=>{let a=null;function l(){var t;s();const e=null===(t=i.plugins.browsertab)||void 0===t?void 0:t.close;"function"==typeof e&&e(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout(()=>{o(g(t,"redirect-cancelled-by-user"))},2e3))}function c(){"visible"===(null==document?void 0:document.visibilityState)&&u()}e.addPassiveListener(l),document.addEventListener("resume",u,!1),wt()&&document.addEventListener("visibilitychange",c,!1),r=()=>{e.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),a&&window.clearTimeout(a)}})}finally{r()}}),wr.apply(this,arguments)}function br(t){return Tr.apply(this,arguments)}function Tr(){return Tr=(0,i.Z)(function*(t){const e=Ir(t),n=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join("")}),Tr.apply(this,arguments)}function Ir(t){if(T(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(0,s.Pz)("authIdTokenMaxAge"),fr="Browser",(0,o._registerComponent)(new u.wA("auth",(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),{apiKey:r,authDomain:s}=n.options;return((t,n)=>{w(r&&!r.includes(":"),"invalid-api-key",{appName:t.name}),w(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});const i={apiKey:r,authDomain:s,clientPlatform:fr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ct(fr)},o=new xt(t,n,i);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(S);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(o,e),o})(n,i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),(0,o._registerComponent)(new u.wA("auth-internal",t=>{const e=kt(t.getProvider("auth").getImmediate());return new gr(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,o.registerVersion)(mr,"0.21.0",void 0),(0,o.registerVersion)(mr,"0.21.0","esm2017");class Sr extends Zi{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(t=>{this.resolveInialized=t})}addPassiveListener(t){this.passiveListeners.add(t)}removePassiveListener(t){this.passiveListeners.delete(t)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(t){return this.resolveInialized(),this.passiveListeners.forEach(e=>e(t)),super.onEvent(t)}initialized(){var t=this;return(0,i.Z)(function*(){yield t.initPromise})()}}function Cr(t){return Er.apply(this,arguments)}function Er(){return Er=(0,i.Z)(function*(t){const e=yield kr()._get(Ar(t));return e&&(yield kr()._remove(Ar(t))),e}),Er.apply(this,arguments)}function xr(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(Math.random()*e.length);t.push(e.charAt(n))}return t.join("")}function kr(){return S(An)}function Ar(t){return pt("authEvent",t.config.apiKey,t.name)}function Pr(t){if(!(null==t?void 0:t.includes("?")))return{};const[e,...n]=t.split("?");return(0,s.zd)(n.join("?"))}function Nr(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:g("no-auth-event")}}function Dr(){var t;return(null===(t=null==self?void 0:self.location)||void 0===t?void 0:t.protocol)||null}function Or(t=(0,s.z$)()){return!("file:"!==Dr()&&"ionic:"!==Dr()&&"capacitor:"!==Dr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Rr(){try{const t=self.localStorage,e=Dn();if(t)return t.setItem(e,"1"),t.removeItem(e),!function(t=(0,s.z$)()){return(0,s.w1)()&&11===(null==document?void 0:document.documentMode)||function(t=(0,s.z$)()){return/Edge\/\d+/.test(t)}(t)}()||(0,s.hl)()}catch(fr){return Lr()&&(0,s.hl)()}return!1}function Lr(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function Mr(){return("http:"===Dr()||"https:"===Dr()||(0,s.ru)()||Or())&&!((0,s.b$)()||(0,s.UG)())&&Rr()&&!Lr()}function Fr(){return Or()&&"undefined"!=typeof document}function Vr(){return Vr=(0,i.Z)(function*(){return!!Fr()&&new Promise(t=>{const e=setTimeout(()=>{t(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})})}),Vr.apply(this,arguments)}const Ur={LOCAL:"local",NONE:"none",SESSION:"session"},jr=w,qr="persistence";function zr(t){return Br.apply(this,arguments)}function Br(){return Br=(0,i.Z)(function*(t){yield t._initializationPromise;const e=Zr(),n=pt(qr,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}),Br.apply(this,arguments)}function Zr(){var t;try{return(null===(t="undefined"!=typeof window?window:null)||void 0===t?void 0:t.sessionStorage)||null}catch(e){return null}}const Hr=w;class $r{constructor(){this.browserResolver=S(class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Pn,this._completeRedirectFn=ji,this._overrideRedirectResult=Oi}_openPopup(t,e,n,r){var o=this;return(0,i.Z)(function*(){var i;T(null===(i=o.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");const a=cr(t,e,n,C(),r);return function(t,e,n,i=500,r=600){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const u=Object.assign(Object.assign({},lr),{width:i.toString(),height:r.toString(),top:o,left:a}),c=(0,s.z$)().toLowerCase();n&&(l=_t(c)?"_blank":n),gt(c)&&(e=e||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce((t,[e,n])=>`${t}${e}=${n},`,"");if(function(t=(0,s.z$)()){var e;return It(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==l)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",l),new ur(null);const d=window.open(e||"",l,h);w(d,t,"popup-blocked");try{d.focus()}catch(p){}return new ur(d)}(t,a,Dn())})()}_openRedirect(t,e,n,r){var s=this;return(0,i.Z)(function*(){return yield s._originValidation(t),i=cr(t,e,n,C(),r),Rn().location.href=i,new Promise(()=>{});var i})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(T(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}initAndGetManager(t){var e=this;return(0,i.Z)(function*(){const n=yield function(t){return ar.apply(this,arguments)}(t),i=new Zi(t);return n.register("authEvent",e=>(w(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:i.onEvent(e.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:i},e.iframes[t._key()]=n,i})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(hr,{type:hr},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[hr];void 0!==r&&e(!!r),m(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function(t){return Yi.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return St()||yt()||It()}}),this.cordovaResolver=S(class{constructor(){this._redirectPersistence=Pn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ji,this._overrideRedirectResult=Oi}_initialize(t){var e=this;return(0,i.Z)(function*(){const n=t._key();let i=e.eventManagers.get(n);return i||(i=new Sr(t),e.eventManagers.set(n,i),e.attachCallbackListeners(t,i)),i})()}_openPopup(t){m(t,"operation-not-supported-in-this-environment")}_openRedirect(t,e,n,r){var o=this;return(0,i.Z)(function*(){!function(t){var e,n,i,r,s,o,a,l,u,c;const h=yr();w("function"==typeof(null===(e=null==h?void 0:h.universalLinks)||void 0===e?void 0:e.subscribe),t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),w(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),w("function"==typeof(null===(s=null===(r=null===(i=null==h?void 0:h.cordova)||void 0===i?void 0:i.plugins)||void 0===r?void 0:r.browsertab)||void 0===s?void 0:s.openUrl),t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),w("function"==typeof(null===(l=null===(a=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===l?void 0:l.isAvailable),t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),w("function"==typeof(null===(c=null===(u=null==h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===c?void 0:c.open),t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(t);const i=yield o._initialize(t);yield i.initialized(),i.resetRedirect(),ki.clear(),yield o._originValidation(t);const a=function(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:xr(),postBody:null,tenantId:t.tenantId,error:g(t,"no-auth-event")}}(t,n,r);yield function(t,e){return kr()._set(Ar(t),e)}(t,a);const l=yield function(t,e,n){return _r.apply(this,arguments)}(t,a,e),u=yield function(t){const{cordova:e}=yr();return new Promise(n=>{e.plugins.browsertab.isAvailable(i=>{let r=null;i?e.plugins.browsertab.openUrl(t):r=e.InAppBrowser.open(t,function(t=(0,s.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}()?"_blank":"_system","location=yes"),n(r)})})}(l);return function(t,e,n){return wr.apply(this,arguments)}(t,i,u)})()}_isIframeWebStorageSupported(t,e){throw new Error("Method not implemented.")}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function(t){return vr.apply(this,arguments)}(t)),this.originValidationPromises[e]}attachCallbackListeners(t,e){const{universalLinks:n,handleOpenURL:r,BuildInfo:s}=yr(),o=setTimeout((0,i.Z)(function*(){yield Cr(t),e.onEvent(Nr())}),500),a=function(){var n=(0,i.Z)(function*(n){clearTimeout(o);const i=yield Cr(t);let r=null;i&&(null==n?void 0:n.url)&&(r=function(t,e){var n,i;const r=function(t){const e=Pr(t),n=e.link?decodeURIComponent(e.link):void 0,i=Pr(n).link,r=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Pr(r).link||r||i||n||t}(e);if(r.includes("/__/auth/callback")){const s=Pr(r),o=s.firebaseError?function(t){try{return JSON.parse(t)}catch(e){return null}}(decodeURIComponent(s.firebaseError)):null,a=null===(i=null===(n=null==o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===i?void 0:i[1],l=a?g(a):null;return l?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:r,postBody:null}}return null}(i,n.url)),e.onEvent(r||Nr())});return function(t){return n.apply(this,arguments)}}();void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,a);const l=r,u=`${s.packageName.toLowerCase()}://`;yr().handleOpenURL=function(){var t=(0,i.Z)(function*(t){if(t.toLowerCase().startsWith(u)&&a({url:t}),"function"==typeof l)try{l(t)}catch(e){console.error(e)}});return function(e){return t.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Pn,this._completeRedirectFn=ji,this._overrideRedirectResult=Oi}_initialize(t){var e=this;return(0,i.Z)(function*(){return yield e.selectUnderlyingResolver(),e.assertedUnderlyingResolver._initialize(t)})()}_openPopup(t,e,n,r){var s=this;return(0,i.Z)(function*(){return yield s.selectUnderlyingResolver(),s.assertedUnderlyingResolver._openPopup(t,e,n,r)})()}_openRedirect(t,e,n,r){var s=this;return(0,i.Z)(function*(){return yield s.selectUnderlyingResolver(),s.assertedUnderlyingResolver._openRedirect(t,e,n,r)})()}_isIframeWebStorageSupported(t,e){this.assertedUnderlyingResolver._isIframeWebStorageSupported(t,e)}_originValidation(t){return this.assertedUnderlyingResolver._originValidation(t)}get _shouldInitProactively(){return Fr()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Hr(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var t=this;return(0,i.Z)(function*(){if(t.underlyingResolver)return;const e=yield function(){return Vr.apply(this,arguments)}();t.underlyingResolver=e?t.cordovaResolver:t.browserResolver})()}}function Wr(t){return t.unwrap()}function Gr(t){return Kr(t)}function Kr(t){const{_tokenResponse:e}=t instanceof s.ZR?t.customData:t;if(!e)return null;if(!(t instanceof s.ZR)&&"temporaryProof"in e&&"phoneNumber"in e)return mi.credentialFromResult(t);const n=e.providerId;if(!n||"password"===n)return null;let i;switch(n){case"google.com":i=me;break;case"facebook.com":i=fe;break;case"github.com":i=ge;break;case"twitter.com":i=ve;break;default:const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:o,nonce:a}=e;return r||s||t||o?o?n.startsWith("saml.")?ye._create(n,o):ee._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:t,accessToken:r}):new pe(n).credential({idToken:t,accessToken:r,rawNonce:a}):null}return t instanceof s.ZR?i.credentialFromError(t):i.credentialFromResult(t)}function Qr(t,e){return e.catch(e=>{throw e instanceof s.ZR&&function(t,e){var n;const i=null===(n=e.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null==e?void 0:e.code))e.resolver=new Xr(t,function(t,e){var n;const i=(0,s.m9)(t),r=e;return w(e.customData.operationType,i,"argument-error"),w(null===(n=r.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,i,"argument-error"),In._fromError(i,r)}(t,e));else if(i){const t=Kr(e),n=e;t&&(n.credential=t,n.tenantId=i.tenantId||void 0,n.email=i.email||void 0,n.phoneNumber=i.phoneNumber||void 0)}}(t,e),e}).then(t=>{const e=t.user;return{operationType:t.operationType,credential:Gr(t),additionalUserInfo:bn(t),user:ts.getOrCreate(e)}})}function Yr(t,e){return Jr.apply(this,arguments)}function Jr(){return Jr=(0,i.Z)(function*(t,e){const n=yield e;return{verificationId:n.verificationId,confirm:e=>Qr(t,n.confirm(e))}}),Jr.apply(this,arguments)}class Xr{constructor(t,e){this.resolver=e,this.auth=function(t){return t.wrapped()}(t)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(t){return Qr(Wr(this.auth),this.resolver.resolveSignIn(t))}}class ts{constructor(t){this._delegate=t,this.multiFactor=function(t){const e=(0,s.m9)(t);return En.has(e)||En.set(e,Cn._fromUser(e)),En.get(e)}(t)}static getOrCreate(t){return ts.USER_MAP.has(t)||ts.USER_MAP.set(t,new ts(t)),ts.USER_MAP.get(t)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(t){return this._delegate.getIdTokenResult(t)}getIdToken(t){return this._delegate.getIdToken(t)}linkAndRetrieveDataWithCredential(t){return this.linkWithCredential(t)}linkWithCredential(t){var e=this;return(0,i.Z)(function*(){return Qr(e.auth,Ue(e._delegate,t))})()}linkWithPhoneNumber(t,e){var n=this;return(0,i.Z)(function*(){return Yr(n.auth,function(t,e,n){return ci.apply(this,arguments)}(n._delegate,t,e))})()}linkWithPopup(t){var e=this;return(0,i.Z)(function*(){return Qr(e.auth,function(t,e,n){return Ei.apply(this,arguments)}(e._delegate,t,$r))})()}linkWithRedirect(t){var e=this;return(0,i.Z)(function*(){return yield zr(kt(e.auth)),function(t,e,n){return function(t,e,n){return Vi.apply(this,arguments)}(t,e,n)}(e._delegate,t,$r)})()}reauthenticateAndRetrieveDataWithCredential(t){return this.reauthenticateWithCredential(t)}reauthenticateWithCredential(t){var e=this;return(0,i.Z)(function*(){return Qr(e.auth,qe(e._delegate,t))})()}reauthenticateWithPhoneNumber(t,e){return Yr(this.auth,function(t,e,n){return hi.apply(this,arguments)}(this._delegate,t,e))}reauthenticateWithPopup(t){return Qr(this.auth,function(t,e,n){return Ci.apply(this,arguments)}(this._delegate,t,$r))}reauthenticateWithRedirect(t){var e=this;return(0,i.Z)(function*(){return yield zr(kt(e.auth)),function(t,e,n){return function(t,e,n){return Fi.apply(this,arguments)}(t,e,n)}(e._delegate,t,$r)})()}sendEmailVerification(t){return function(t,e){return ln.apply(this,arguments)}(this._delegate,t)}unlink(t){var e=this;return(0,i.Z)(function*(){return yield function(t,e){return ke.apply(this,arguments)}(e._delegate,t),e})()}updateEmail(t){return function(t,e){return pn((0,s.m9)(t),e,null)}(this._delegate,t)}updatePassword(t){return function(t,e){return pn((0,s.m9)(t),null,e)}(this._delegate,t)}updatePhoneNumber(t){return function(t,e){return fi.apply(this,arguments)}(this._delegate,t)}updateProfile(t){return function(t,e){return dn.apply(this,arguments)}(this._delegate,t)}verifyBeforeUpdateEmail(t,e){return function(t,e,n){return un.apply(this,arguments)}(this._delegate,t,e)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}ts.USER_MAP=new WeakMap;const es=w;let ns=(()=>{class t{constructor(t,e){if(this.app=t,e.isInitialized())return this._delegate=e.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=t.options;es(n,"invalid-api-key",{appName:t.name}),es(n,"invalid-api-key",{appName:t.name});const i="undefined"!=typeof window?$r:void 0;this._delegate=e.initialize({options:{persistence:rs(n,t.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(c),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ts.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,e){!function(t,e,n){const i=kt(t);w(i._canInitEmulator,i,"emulator-config-failed"),w(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Pt(e),{host:o,port:a}=function(t){const e=Pt(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:Nt(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:Nt(e)}}}(e);i.config.emulator={url:`${s}//${o}${null===a?"":`:${a}`}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(this._delegate,t,e)}applyActionCode(t){return function(t,e){return Ye.apply(this,arguments)}(this._delegate,t)}checkActionCode(t){return Je(this._delegate,t)}confirmPasswordReset(t,e){return function(t,e,n){return Qe.apply(this,arguments)}(this._delegate,t,e)}createUserWithEmailAndPassword(t,e){var n=this;return(0,i.Z)(function*(){return Qr(n._delegate,function(t,e,n){return en.apply(this,arguments)}(n._delegate,t,e))})()}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return function(t,e){return an.apply(this,arguments)}(this._delegate,t)}isSignInWithEmailLink(t){return function(t,e){const n=ue.parseLink(e);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(0,t)}getRedirectResult(){var t=this;return(0,i.Z)(function*(){es(Mr(),t._delegate,"operation-not-supported-in-this-environment");const e=yield function(t,e){return Ui.apply(this,arguments)}(t._delegate,$r);return e?Qr(t._delegate,Promise.resolve(e)):{credential:null,user:null}})()}addFrameworkForLogging(t){!function(t,e){kt(t)._logFramework(e)}(this._delegate,t)}onAuthStateChanged(t,e,n){const{next:i,error:r,complete:s}=is(t,e,n);return this._delegate.onAuthStateChanged(i,r,s)}onIdTokenChanged(t,e,n){const{next:i,error:r,complete:s}=is(t,e,n);return this._delegate.onIdTokenChanged(i,r,s)}sendSignInLinkToEmail(t,e){return function(t,e,n){return nn.apply(this,arguments)}(this._delegate,t,e)}sendPasswordResetEmail(t,e){return function(t,e,n){return Ke.apply(this,arguments)}(this._delegate,t,e||void 0)}setPersistence(t){var e=this;return(0,i.Z)(function*(){let n;switch(function(t,e){jr(Object.values(Ur).includes(e),t,"invalid-persistence-type"),(0,s.b$)()?jr(e!==Ur.SESSION,t,"unsupported-persistence-type"):(0,s.UG)()?jr(e===Ur.NONE,t,"unsupported-persistence-type"):Lr()?jr(e===Ur.NONE||e===Ur.LOCAL&&(0,s.hl)(),t,"unsupported-persistence-type"):jr(e===Ur.NONE||Rr(),t,"unsupported-persistence-type")}(e._delegate,t),t){case Ur.SESSION:n=Pn;break;case Ur.LOCAL:n=(yield S(Wn)._isAvailable())?Wn:An;break;case Ur.NONE:n=dt;break;default:return m("argument-error",{appName:e._delegate.name})}return e._delegate.setPersistence(n)})()}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Qr(this._delegate,function(t){return Se.apply(this,arguments)}(this._delegate))}signInWithCredential(t){return Qr(this._delegate,Fe(this._delegate,t))}signInWithCustomToken(t){return Qr(this._delegate,function(t,e){return He.apply(this,arguments)}(this._delegate,t))}signInWithEmailAndPassword(t,e){return Qr(this._delegate,function(t,e,n){return Fe((0,s.m9)(t),ce.credential(e,n))}(this._delegate,t,e))}signInWithEmailLink(t,e){return Qr(this._delegate,function(t,e,n){return rn.apply(this,arguments)}(this._delegate,t,e))}signInWithPhoneNumber(t,e){return Yr(this._delegate,function(t,e,n){return ui.apply(this,arguments)}(this._delegate,t,e))}signInWithPopup(t){var e=this;return(0,i.Z)(function*(){return es(Mr(),e._delegate,"operation-not-supported-in-this-environment"),Qr(e._delegate,function(t,e,n){return Si.apply(this,arguments)}(e._delegate,t,$r))})()}signInWithRedirect(t){var e=this;return(0,i.Z)(function*(){return es(Mr(),e._delegate,"operation-not-supported-in-this-environment"),yield zr(e._delegate),function(t,e,n){return function(t,e,n){return Mi.apply(this,arguments)}(t,e,n)}(e._delegate,t,$r)})()}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return function(t,e){return tn.apply(this,arguments)}(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return t.Persistence=Ur,t})();function is(t,e,n){let i=t;"function"!=typeof t&&({next:i,error:e,complete:n}=t);const r=i;return{next:t=>r(t&&ts.getOrCreate(t)),error:e,complete:n}}function rs(t,e){const n=function(t,e){const n=Zr();if(!n)return[];const i=pt(qr,t,e);switch(n.getItem(i)){case Ur.NONE:return[dt];case Ur.LOCAL:return[Wn,Pn];case Ur.SESSION:return[Pn];default:return[]}}(t,e);if("undefined"!=typeof self&&!n.includes(Wn)&&n.push(Wn),"undefined"!=typeof window)for(const i of[An,Pn])n.includes(i)||n.push(i);return n.includes(dt)||n.push(dt),n}class ss{constructor(){this.providerId="phone",this._delegate=new mi(Wr(r.Z.auth()))}static credential(t,e){return mi.credential(t,e)}verifyPhoneNumber(t,e){return this._delegate.verifyPhoneNumber(t,e)}unwrap(){return this._delegate}}ss.PHONE_SIGN_IN_METHOD=mi.PHONE_SIGN_IN_METHOD,ss.PROVIDER_ID=mi.PROVIDER_ID;const os=w;class as{constructor(t,e,n=r.Z.app()){var i;os(null===(i=n.options)||void 0===i?void 0:i.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new ai(t,e,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function(t){t.INTERNAL.registerComponent(new u.wA("auth-compat",t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("auth");return new ns(e,n)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:ce,FacebookAuthProvider:fe,GithubAuthProvider:ge,GoogleAuthProvider:me,OAuthProvider:pe,SAMLAuthProvider:_e,PhoneAuthProvider:ss,PhoneMultiFactorGenerator:pr,RecaptchaVerifier:as,TwitterAuthProvider:ve,Auth:ns,AuthCredential:Dt,Error:s.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion("@firebase/auth-compat","0.3.0")}(r.Z)},2373:function(t,e,n){"use strict";n.d(e,{Lj:function(){return g},X3:function(){return m}});var i=n(8239);let r,s;const o=new WeakMap,a=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap;let h={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return a.get(t);if("objectStoreNames"===e)return t.objectStoreNames||l.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function d(t){return"function"==typeof t?function(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(f(this),e),p(o.get(this))}:function(...e){return p(t.apply(f(this),e))}:function(e,...n){const i=t.call(f(this),e,...n);return l.set(i,e.sort?e.sort():[e]),p(i)}}(t):(t instanceof IDBTransaction&&function(t){if(a.has(t))return;const e=new Promise((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)});a.set(t,e)}(t),((t,e)=>e.some(e=>t instanceof e))(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,h):t)}function p(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(p(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)});return e.then(e=>{e instanceof IDBCursor&&o.set(e,t)}).catch(()=>{}),c.set(e,t),e}(t);if(u.has(t))return u.get(t);const e=d(t);return e!==t&&(u.set(t,e),c.set(e,t)),e}const f=t=>c.get(t);function m(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=p(o);return i&&o.addEventListener("upgradeneeded",t=>{i(p(o.result),t.oldVersion,t.newVersion,p(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(t=>{s&&t.addEventListener("close",()=>s()),r&&t.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}function g(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),p(n).then(()=>{})}const y=["get","getKey","getAll","getAllKeys","count"],_=["put","add","delete","clear"],v=new Map;function w(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(v.get(e))return v.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=_.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!y.includes(n))return;const o=function(){var t=(0,i.Z)(function*(t,...e){const i=this.transaction(t,s?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(e.shift())),(yield Promise.all([o[n](...e),s&&i.done]))[0]});return function(e){return t.apply(this,arguments)}}();return v.set(e,o),o}var b;h=nU(tU({},b=h),{get:(t,e,n)=>w(t,e)||b.get(t,e,n),has:(t,e)=>!!w(t,e)||b.has(t,e)})},8239:function(t,e,n){"use strict";function i(t,e,n,i,r,s,o){try{var a=t[s](o),l=a.value}catch(u){return void n(u)}a.done?e(l):Promise.resolve(l).then(i,r)}function r(t){return function(){var e=this,n=arguments;return new Promise(function(r,s){var o=t.apply(e,n);function a(t){i(o,r,s,a,l,"next",t)}function l(t){i(o,r,s,a,l,"throw",t)}a(void 0)})}}n.d(e,{Z:function(){return r}})}},function(t){t(t.s=4622)}]);